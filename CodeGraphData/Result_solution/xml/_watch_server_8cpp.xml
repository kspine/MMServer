<?xml version='1.0' encoding='UTF-8' standalone='no'?>
<doxygen xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xsi:noNamespaceSchemaLocation="compound.xsd" version="1.8.6">
  <compounddef id="_watch_server_8cpp" kind="file">
    <compoundname>WatchServer.cpp</compoundname>
    <includes refid="_watch_server_8h" local="yes">WatchServer.h</includes>
    <includes refid="_se_watch_server_mgr_8h" local="yes">SeWatchServerMgr.h</includes>
    <includes refid="_watch_server_2_src_2_se_race_mgr_8h" local="yes">SeRaceMgr.h</includes>
    <includes refid="_watch_server_2_src_2_se_town_mgr_8h" local="yes">SeTownMgr.h</includes>
    <incdepgraph>
      <node id="68345">
        <label>SeCommStream.h</label>
        <link refid="_se_comm_stream_8h"/>
        <childnode refid="68313" relation="include">
        </childnode>
        <childnode refid="68315" relation="include">
        </childnode>
      </node>
      <node id="68299">
        <label>list</label>
      </node>
      <node id="68293">
        <label>locale</label>
      </node>
      <node id="68346">
        <label>SeCWCSStream.h</label>
        <link refid="_se_c_w_c_s_stream_8h"/>
        <childnode refid="68313" relation="include">
        </childnode>
        <childnode refid="68340" relation="include">
        </childnode>
        <childnode refid="68345" relation="include">
        </childnode>
      </node>
      <node id="68362">
        <label>SeWCSCSend.inl</label>
        <link refid="_se_w_c_s_c_send_8inl"/>
      </node>
      <node id="68303">
        <label>queue</label>
      </node>
      <node id="68297">
        <label>limits</label>
      </node>
      <node id="68315">
        <label>SePtlCommDefine.h</label>
        <link refid="_se_ptl_comm_define_8h"/>
      </node>
      <node id="68316">
        <label>SeMemPool.h</label>
        <link refid="_se_mem_pool_8h"/>
        <childnode refid="68278" relation="include">
        </childnode>
        <childnode refid="68317" relation="include">
        </childnode>
        <childnode refid="68285" relation="include">
        </childnode>
      </node>
      <node id="68280">
        <label>windows.h</label>
      </node>
      <node id="68285">
        <label>assert.h</label>
      </node>
      <node id="68373">
        <label>SeServerComDef.h</label>
        <link refid="_se_server_com_def_8h"/>
        <childnode refid="68278" relation="include">
        </childnode>
        <childnode refid="68316" relation="include">
        </childnode>
        <childnode refid="68311" relation="include">
        </childnode>
        <childnode refid="68315" relation="include">
        </childnode>
      </node>
      <node id="68322">
        <label>SeRaceCmd.h</label>
        <link refid="_se_race_cmd_8h"/>
        <childnode refid="68311" relation="include">
        </childnode>
        <childnode refid="68313" relation="include">
        </childnode>
      </node>
      <node id="68348">
        <label>SeTimer.h</label>
        <link refid="_se_timer_8h"/>
      </node>
      <node id="68371">
        <label>raceRecordSaveThread.h</label>
        <link refid="_watch_server_2_src_2race_record_save_thread_8h"/>
        <childnode refid="68372" relation="include">
        </childnode>
        <childnode refid="68320" relation="include">
        </childnode>
        <childnode refid="68303" relation="include">
        </childnode>
      </node>
      <node id="68337">
        <label>SePtl_WCS_To_RS.h</label>
        <link refid="_se_ptl___w_c_s___to___r_s_8h"/>
        <childnode refid="68313" relation="include">
        </childnode>
      </node>
      <node id="68283">
        <label>stdlib.h</label>
      </node>
      <node id="68317">
        <label>EsLock.h</label>
      </node>
      <node id="68330">
        <label>WatchServerDef.h</label>
        <link refid="_watch_server_def_8h"/>
        <childnode refid="68307" relation="include">
        </childnode>
        <childnode refid="68329" relation="include">
        </childnode>
        <childnode refid="68311" relation="include">
        </childnode>
        <childnode refid="68316" relation="include">
        </childnode>
        <childnode refid="68315" relation="include">
        </childnode>
        <childnode refid="68331" relation="include">
        </childnode>
        <childnode refid="68332" relation="include">
        </childnode>
        <childnode refid="68333" relation="include">
        </childnode>
        <childnode refid="68334" relation="include">
        </childnode>
        <childnode refid="68335" relation="include">
        </childnode>
        <childnode refid="68336" relation="include">
        </childnode>
        <childnode refid="68337" relation="include">
        </childnode>
        <childnode refid="68338" relation="include">
        </childnode>
        <childnode refid="68339" relation="include">
        </childnode>
        <childnode refid="68340" relation="include">
        </childnode>
        <childnode refid="68341" relation="include">
        </childnode>
        <childnode refid="68342" relation="include">
        </childnode>
        <childnode refid="68343" relation="include">
        </childnode>
        <childnode refid="68344" relation="include">
        </childnode>
        <childnode refid="68346" relation="include">
        </childnode>
      </node>
      <node id="68326">
        <label>SePtlStream.h</label>
        <link refid="_se_ptl_stream_8h"/>
        <childnode refid="68324" relation="include">
        </childnode>
        <childnode refid="68313" relation="include">
        </childnode>
        <childnode refid="68322" relation="include">
        </childnode>
      </node>
      <node id="68287">
        <label>cmath</label>
      </node>
      <node id="68360">
        <label>SeTWCMSProcess.inl</label>
        <link refid="_se_t_w_c_m_s_process_8inl"/>
      </node>
      <node id="68372">
        <label>EsThread.h</label>
      </node>
      <node id="68296">
        <label>string</label>
      </node>
      <node id="68336">
        <label>SePtl_RS_To_WCS.h</label>
        <link refid="_se_ptl___r_s___to___w_c_s_8h"/>
        <childnode refid="68313" relation="include">
        </childnode>
      </node>
      <node id="68328">
        <label>SeFormula.h</label>
        <link refid="_se_formula_8h"/>
        <childnode refid="68278" relation="include">
        </childnode>
        <childnode refid="68313" relation="include">
        </childnode>
      </node>
      <node id="68300">
        <label>map</label>
      </node>
      <node id="68318">
        <label>SeFileLog.h</label>
        <link refid="_se_file_log_8h"/>
        <childnode refid="68319" relation="include">
        </childnode>
        <childnode refid="68289" relation="include">
        </childnode>
        <childnode refid="68317" relation="include">
        </childnode>
      </node>
      <node id="68282">
        <label>conio.h</label>
      </node>
      <node id="68342">
        <label>SePtl_NS_To_WCMS.h</label>
        <link refid="_se_ptl___n_s___to___w_c_m_s_8h"/>
        <childnode refid="68313" relation="include">
        </childnode>
      </node>
      <node id="68314">
        <label>SePtlRandomNumDef.h</label>
        <link refid="_se_ptl_random_num_def_8h"/>
      </node>
      <node id="68276">
        <label>WatchServer/Src/WatchServer.cpp</label>
        <link refid="WatchServer.cpp"/>
        <childnode refid="68277" relation="include">
        </childnode>
        <childnode refid="68365" relation="include">
        </childnode>
        <childnode refid="68370" relation="include">
        </childnode>
        <childnode refid="68374" relation="include">
        </childnode>
      </node>
      <node id="68281">
        <label>direct.h</label>
      </node>
      <node id="68356">
        <label>SeWCSSWCSSend.inl</label>
        <link refid="_se_w_c_s_s_w_c_s_send_8inl"/>
      </node>
      <node id="68353">
        <label>SeWCMSWCSProcess.inl</label>
        <link refid="_se_w_c_m_s_w_c_s_process_8inl"/>
      </node>
      <node id="68324">
        <label>SeNetStream.h</label>
        <link refid="_se_net_stream_8h"/>
        <childnode refid="68278" relation="include">
        </childnode>
        <childnode refid="68307" relation="include">
        </childnode>
        <childnode refid="68325" relation="include">
        </childnode>
      </node>
      <node id="68294">
        <label>fstream</label>
      </node>
      <node id="68367">
        <label>WatchServerRaceDef.h</label>
        <link refid="_watch_server_race_def_8h"/>
        <childnode refid="68278" relation="include">
        </childnode>
        <childnode refid="68306" relation="include">
        </childnode>
        <childnode refid="68308" relation="include">
        </childnode>
        <childnode refid="68318" relation="include">
        </childnode>
        <childnode refid="68320" relation="include">
        </childnode>
        <childnode refid="68321" relation="include">
        </childnode>
        <childnode refid="68324" relation="include">
        </childnode>
        <childnode refid="68326" relation="include">
        </childnode>
        <childnode refid="68327" relation="include">
        </childnode>
        <childnode refid="68368" relation="include">
        </childnode>
        <childnode refid="68328" relation="include">
        </childnode>
        <childnode refid="68316" relation="include">
        </childnode>
        <childnode refid="68329" relation="include">
        </childnode>
      </node>
      <node id="68309">
        <label>SeTool.h</label>
        <link refid="_se_tool_8h"/>
        <childnode refid="68278" relation="include">
        </childnode>
        <childnode refid="68307" relation="include">
        </childnode>
        <childnode refid="68310" relation="include">
        </childnode>
        <childnode refid="68311" relation="include">
        </childnode>
        <childnode refid="68291" relation="include">
        </childnode>
        <childnode refid="68312" relation="include">
        </childnode>
      </node>
      <node id="68361">
        <label>SeWCMSTSend.inl</label>
        <link refid="_se_w_c_m_s_t_send_8inl"/>
      </node>
      <node id="68357">
        <label>SeWCSWCSSProcess.inl</label>
        <link refid="_se_w_c_s_w_c_s_s_process_8inl"/>
      </node>
      <node id="68279">
        <label>winsock2.h</label>
      </node>
      <node id="68340">
        <label>SePtl_Cl_To_WCS.h</label>
        <link refid="_se_ptl___c_l___to___w_c_s_8h"/>
        <childnode refid="68313" relation="include">
        </childnode>
        <childnode refid="68315" relation="include">
        </childnode>
      </node>
      <node id="68332">
        <label>SePtl_WCS_To_WCMS.h</label>
        <link refid="_se_ptl___w_c_s___to___w_c_m_s_8h"/>
        <childnode refid="68313" relation="include">
        </childnode>
      </node>
      <node id="68327">
        <label>SeServerMainDef.h</label>
        <link refid="_se_server_main_def_8h"/>
        <childnode refid="68278" relation="include">
        </childnode>
      </node>
      <node id="68311">
        <label>TeMisc.h</label>
        <link refid="_te_misc_8h"/>
        <childnode refid="68290" relation="include">
        </childnode>
      </node>
      <node id="68359">
        <label>SeCWCSProcess.inl</label>
        <link refid="_se_c_w_c_s_process_8inl"/>
      </node>
      <node id="68364">
        <label>SeWCMSNSend.inl</label>
        <link refid="_se_w_c_m_s_n_send_8inl"/>
      </node>
      <node id="68335">
        <label>SePtl_WCS_To_WCSS.h</label>
        <link refid="_se_ptl___w_c_s___to___w_c_s_s_8h"/>
        <childnode refid="68313" relation="include">
        </childnode>
      </node>
      <node id="68320">
        <label>SeThreadMsg.h</label>
        <link refid="_se_thread_msg_8h"/>
        <childnode refid="68278" relation="include">
        </childnode>
        <childnode refid="68317" relation="include">
        </childnode>
      </node>
      <node id="68331">
        <label>SeServerDefine.h</label>
        <link refid="_se_server_define_8h"/>
        <childnode refid="68307" relation="include">
        </childnode>
        <childnode refid="68329" relation="include">
        </childnode>
        <childnode refid="68309" relation="include">
        </childnode>
      </node>
      <node id="68368">
        <label>SeSessionMgr.h</label>
        <link refid="_se_session_mgr_8h"/>
        <childnode refid="68278" relation="include">
        </childnode>
        <childnode refid="68316" relation="include">
        </childnode>
      </node>
      <node id="68290">
        <label>string.h</label>
      </node>
      <node id="68339">
        <label>SePtl_WCMS_To_TS.h</label>
        <link refid="_se_ptl___w_c_m_s___to___t_s_8h"/>
        <childnode refid="68313" relation="include">
        </childnode>
      </node>
      <node id="68363">
        <label>SeNWCMSProcess.inl</label>
        <link refid="_se_n_w_c_m_s_process_8inl"/>
      </node>
      <node id="68306">
        <label>SeConfig.h</label>
        <link refid="_se_config_8h"/>
        <childnode refid="68307" relation="include">
        </childnode>
      </node>
      <node id="68288">
        <label>ctime</label>
      </node>
      <node id="68329">
        <label>TeNetMgr.h</label>
      </node>
      <node id="68298">
        <label>vector</label>
      </node>
      <node id="68349">
        <label>SeRWCSProcess.inl</label>
        <link refid="_se_r_w_c_s_process_8inl"/>
      </node>
      <node id="68304">
        <label>new</label>
      </node>
      <node id="68313">
        <label>SePtlDefine.h</label>
        <link refid="_se_ptl_define_8h"/>
        <childnode refid="68278" relation="include">
        </childnode>
        <childnode refid="68307" relation="include">
        </childnode>
        <childnode refid="68309" relation="include">
        </childnode>
        <childnode refid="68314" relation="include">
        </childnode>
        <childnode refid="68315" relation="include">
        </childnode>
        <childnode refid="68316" relation="include">
        </childnode>
      </node>
      <node id="68307">
        <label>SeShareDef.h</label>
        <link refid="_se_share_def_8h"/>
        <childnode refid="68278" relation="include">
        </childnode>
      </node>
      <node id="68295">
        <label>sstream</label>
      </node>
      <node id="68370">
        <label>SeRaceMgr.h</label>
        <link refid="_watch_server_2_src_2_se_race_mgr_8h"/>
        <childnode refid="68367" relation="include">
        </childnode>
        <childnode refid="68330" relation="include">
        </childnode>
        <childnode refid="68371" relation="include">
        </childnode>
        <childnode refid="68373" relation="include">
        </childnode>
      </node>
      <node id="68312">
        <label>EsString.h</label>
      </node>
      <node id="68355">
        <label>SeWCSSWCSProcess.inl</label>
        <link refid="_se_w_c_s_s_w_c_s_process_8inl"/>
      </node>
      <node id="68347">
        <label>SeVirtConnMgr.h</label>
        <link refid="_se_virt_conn_mgr_8h"/>
        <childnode refid="68307" relation="include">
        </childnode>
        <childnode refid="68329" relation="include">
        </childnode>
        <childnode refid="68313" relation="include">
        </childnode>
        <childnode refid="68348" relation="include">
        </childnode>
      </node>
      <node id="68369">
        <label>SeTownMgrDef.h</label>
        <link refid="_watch_server_2_src_2_se_town_mgr_def_8h"/>
        <childnode refid="68330" relation="include">
        </childnode>
      </node>
      <node id="68278">
        <label>SeInclude.h</label>
        <link refid="_se_include_8h"/>
        <childnode refid="68279" relation="include">
        </childnode>
        <childnode refid="68280" relation="include">
        </childnode>
        <childnode refid="68281" relation="include">
        </childnode>
        <childnode refid="68282" relation="include">
        </childnode>
        <childnode refid="68283" relation="include">
        </childnode>
        <childnode refid="68284" relation="include">
        </childnode>
        <childnode refid="68285" relation="include">
        </childnode>
        <childnode refid="68286" relation="include">
        </childnode>
        <childnode refid="68287" relation="include">
        </childnode>
        <childnode refid="68288" relation="include">
        </childnode>
        <childnode refid="68289" relation="include">
        </childnode>
        <childnode refid="68290" relation="include">
        </childnode>
        <childnode refid="68291" relation="include">
        </childnode>
        <childnode refid="68292" relation="include">
        </childnode>
        <childnode refid="68293" relation="include">
        </childnode>
        <childnode refid="68294" relation="include">
        </childnode>
        <childnode refid="68295" relation="include">
        </childnode>
        <childnode refid="68296" relation="include">
        </childnode>
        <childnode refid="68297" relation="include">
        </childnode>
        <childnode refid="68298" relation="include">
        </childnode>
        <childnode refid="68299" relation="include">
        </childnode>
        <childnode refid="68300" relation="include">
        </childnode>
        <childnode refid="68301" relation="include">
        </childnode>
        <childnode refid="68302" relation="include">
        </childnode>
        <childnode refid="68303" relation="include">
        </childnode>
        <childnode refid="68304" relation="include">
        </childnode>
        <childnode refid="68305" relation="include">
        </childnode>
      </node>
      <node id="68319">
        <label>time.h</label>
      </node>
      <node id="68284">
        <label>math.h</label>
      </node>
      <node id="68341">
        <label>SePtl_WCS_To_CL.h</label>
        <link refid="_se_ptl___w_c_s___to___c_l_8h"/>
        <childnode refid="68313" relation="include">
        </childnode>
        <childnode refid="68315" relation="include">
        </childnode>
      </node>
      <node id="68291">
        <label>EsType.h</label>
      </node>
      <node id="68366">
        <label>SeWatchServerMgrDef.h</label>
        <link refid="_se_watch_server_mgr_def_8h"/>
        <childnode refid="68330" relation="include">
        </childnode>
      </node>
      <node id="68286">
        <label>cctype</label>
      </node>
      <node id="68310">
        <label>SeToolTemplate.inl</label>
        <link refid="_se_tool_template_8inl"/>
      </node>
      <node id="68352">
        <label>SeWCSWCMSSend.inl</label>
        <link refid="_se_w_c_s_w_c_m_s_send_8inl"/>
      </node>
      <node id="68374">
        <label>SeTownMgr.h</label>
        <link refid="_watch_server_2_src_2_se_town_mgr_8h"/>
        <childnode refid="68369" relation="include">
        </childnode>
      </node>
      <node id="68301">
        <label>unordered_map</label>
      </node>
      <node id="68354">
        <label>SeWCMSWCSSend.inl</label>
        <link refid="_se_w_c_m_s_w_c_s_send_8inl"/>
      </node>
      <node id="68333">
        <label>SePtl_WCMS_To_WCS.h</label>
        <link refid="_se_ptl___w_c_m_s___to___w_c_s_8h"/>
        <childnode refid="68313" relation="include">
        </childnode>
      </node>
      <node id="68305">
        <label>SeDefine.h</label>
        <link refid="_se_define_8h"/>
      </node>
      <node id="68277">
        <label>WatchServer.h</label>
        <link refid="_watch_server_8h"/>
        <childnode refid="68278" relation="include">
        </childnode>
        <childnode refid="68306" relation="include">
        </childnode>
        <childnode refid="68308" relation="include">
        </childnode>
        <childnode refid="68318" relation="include">
        </childnode>
        <childnode refid="68320" relation="include">
        </childnode>
        <childnode refid="68321" relation="include">
        </childnode>
        <childnode refid="68324" relation="include">
        </childnode>
        <childnode refid="68326" relation="include">
        </childnode>
        <childnode refid="68327" relation="include">
        </childnode>
        <childnode refid="68328" relation="include">
        </childnode>
        <childnode refid="68329" relation="include">
        </childnode>
        <childnode refid="68330" relation="include">
        </childnode>
        <childnode refid="68347" relation="include">
        </childnode>
        <childnode refid="68349" relation="include">
        </childnode>
        <childnode refid="68350" relation="include">
        </childnode>
        <childnode refid="68351" relation="include">
        </childnode>
        <childnode refid="68352" relation="include">
        </childnode>
        <childnode refid="68353" relation="include">
        </childnode>
        <childnode refid="68354" relation="include">
        </childnode>
        <childnode refid="68355" relation="include">
        </childnode>
        <childnode refid="68356" relation="include">
        </childnode>
        <childnode refid="68357" relation="include">
        </childnode>
        <childnode refid="68358" relation="include">
        </childnode>
        <childnode refid="68359" relation="include">
        </childnode>
        <childnode refid="68360" relation="include">
        </childnode>
        <childnode refid="68361" relation="include">
        </childnode>
        <childnode refid="68362" relation="include">
        </childnode>
        <childnode refid="68363" relation="include">
        </childnode>
        <childnode refid="68364" relation="include">
        </childnode>
      </node>
      <node id="68308">
        <label>SeServerTool.h</label>
        <link refid="_se_server_tool_8h"/>
        <childnode refid="68278" relation="include">
        </childnode>
        <childnode refid="68309" relation="include">
        </childnode>
        <childnode refid="68313" relation="include">
        </childnode>
      </node>
      <node id="68334">
        <label>SePtl_WCSS_To_WCS.h</label>
        <link refid="_se_ptl___w_c_s_s___to___w_c_s_8h"/>
        <childnode refid="68313" relation="include">
        </childnode>
      </node>
      <node id="68365">
        <label>SeWatchServerMgr.h</label>
        <link refid="_se_watch_server_mgr_8h"/>
        <childnode refid="68366" relation="include">
        </childnode>
        <childnode refid="68367" relation="include">
        </childnode>
        <childnode refid="68369" relation="include">
        </childnode>
      </node>
      <node id="68338">
        <label>SePtl_TS_To_WCMS.h</label>
        <link refid="_se_ptl___t_s___to___w_c_m_s_8h"/>
        <childnode refid="68313" relation="include">
        </childnode>
      </node>
      <node id="68350">
        <label>SeWCSRSend.inl</label>
        <link refid="_se_w_c_s_r_send_8inl"/>
      </node>
      <node id="68343">
        <label>SePtl_WCMS_To_NS.h</label>
        <link refid="_se_ptl___w_c_m_s___to___n_s_8h"/>
        <childnode refid="68313" relation="include">
        </childnode>
      </node>
      <node id="68325">
        <label>type_traits</label>
      </node>
      <node id="68302">
        <label>set</label>
      </node>
      <node id="68292">
        <label>algorithm</label>
      </node>
      <node id="68344">
        <label>SeWCSCStream.h</label>
        <link refid="_se_w_c_s_c_stream_8h"/>
        <childnode refid="68313" relation="include">
        </childnode>
        <childnode refid="68341" relation="include">
        </childnode>
        <childnode refid="68345" relation="include">
        </childnode>
      </node>
      <node id="68351">
        <label>SeWCSWCMSProcess.inl</label>
        <link refid="_se_w_c_s_w_c_m_s_process_8inl"/>
      </node>
      <node id="68289">
        <label>stdio.h</label>
      </node>
      <node id="68321">
        <label>SeRaceRecord.h</label>
        <link refid="_se_race_record_8h"/>
        <childnode refid="68278" relation="include">
        </childnode>
        <childnode refid="68322" relation="include">
        </childnode>
        <childnode refid="68323" relation="include">
        </childnode>
      </node>
      <node id="68358">
        <label>SeWCSWCSSSend.inl</label>
        <link refid="_se_w_c_s_w_c_s_s_send_8inl"/>
      </node>
      <node id="68323">
        <label>SeCommon.h</label>
        <link refid="_se_common_8h"/>
        <childnode refid="68296" relation="include">
        </childnode>
      </node>
    </incdepgraph>
    <innernamespace refid="namespace_watch_server">WatchServer</innernamespace>
      <sectiondef kind="var">
      <memberdef kind="variable" id="_watch_server_8cpp_1a0fe0b3e7097985c9686aa65a22e14299" prot="public" static="no" mutable="no">
        <type><ref refid="class_watch_server_1_1_c_watch_server" kindref="compound">WatchServer::CWatchServer</ref></type>
        <definition>WatchServer::CWatchServer g_kWatchServer</definition>
        <argsstring></argsstring>
        <name>g_kWatchServer</name>
        <briefdescription>
        </briefdescription>
        <detaileddescription>
        </detaileddescription>
        <inbodydescription>
        </inbodydescription>
        <location file="F:/TeamWork/ServerVersion/projects/server/Server/Server/WatchServer/Src/WatchServer.cpp" line="6" column="1" bodyfile="F:/TeamWork/ServerVersion/projects/server/Server/Server/WatchServer/Src/WatchServer.cpp" bodystart="6" bodyend="-1"/>
        <referencedby refid="class_watch_server_1_1_c_se_race_mgr_1a35ac3e03325ed01ab58edbdc3ed39cc9" compoundref="_watch_server_2_src_2_se_race_mgr_8cpp" startline="23" endline="52">WatchServer::CSeRaceMgr::addViewPlayer</referencedby>
        <referencedby refid="class_watch_server_1_1_c_se_race_mgr_1ad612bd25b9364406bd93b7b9f7e8e701" compoundref="_watch_server_2_src_2_se_race_mgr_8cpp" startline="166" endline="177">WatchServer::CSeRaceMgr::BeginView</referencedby>
        <referencedby refid="class_watch_server_1_1_c_se_race_mgr_1a76fd8f6a78749eb416e88db6d762736c" compoundref="_watch_server_2_src_2_se_race_mgr_8cpp" startline="11" endline="15">WatchServer::CSeRaceMgr::CSeRaceMgr</referencedby>
        <referencedby refid="class_watch_server_1_1_c_watch_server_mgr_1afbf92fafbe535b6a016412e0efa5673e" compoundref="_se_watch_server_mgr_8cpp" startline="123" endline="208">WatchServer::CWatchServerMgr::onRaceDetailInfoReq</referencedby>
        <referencedby refid="class_watch_server_1_1_c_se_race_mgr_1a91759ef52322a00d052b0d1f46f88def" compoundref="_watch_server_2_src_2_se_race_mgr_8cpp" startline="123" endline="136">WatchServer::CSeRaceMgr::onRaceEnd</referencedby>
        <referencedby refid="class_watch_server_1_1_c_watch_server_mgr_1a720ff56e28c1e74ed56806132094fb10" compoundref="_se_watch_server_mgr_8cpp" startline="210" endline="213">WatchServer::CWatchServerMgr::onRaceWatchUserSync</referencedby>
        <referencedby refid="class_watch_server_1_1_c_watch_server_mgr_1ae199b5643aa878f8f4bd001614e713e2" compoundref="_se_watch_server_mgr_8cpp" startline="61" endline="85">WatchServer::CWatchServerMgr::onReqView</referencedby>
        <referencedby refid="class_watch_server_1_1_c_watch_server_mgr_1ac1c4584f6b52b1cae4536a631e17ed20" compoundref="_se_watch_server_mgr_8cpp" startline="87" endline="121">WatchServer::CWatchServerMgr::onReqViewList</referencedby>
        <referencedby refid="class_watch_server_1_1_c_se_race_mgr_1ab29ba170c16ad4a86ed35921252bc365" compoundref="_watch_server_2_src_2_se_race_mgr_8cpp" startline="138" endline="164">WatchServer::CSeRaceMgr::onViewValidate</referencedby>
        <referencedby refid="class_watch_server_1_1_se_race_record_save_thread_1a56cdff87cc7b27fe325913d36f931e3f" compoundref="_watch_server_2_src_2race_record_save_thread_8cpp" startline="77" endline="107">WatchServer::SeRaceRecordSaveThread::saveRecord</referencedby>
        <referencedby refid="class_watch_server_1_1_c_se_race_mgr_1afa0e0135b773e24c67a4b2ee49e205fa" compoundref="_watch_server_2_src_2_se_race_mgr_8cpp" startline="179" endline="213">WatchServer::CSeRaceMgr::Update</referencedby>
        <referencedby refid="class_watch_server_1_1_c_se_race_mgr_1a47786cae8d9885e3e0d4b98f4c044e11" compoundref="_watch_server_2_src_2_se_race_mgr_8cpp" startline="215" endline="298">WatchServer::CSeRaceMgr::updateView</referencedby>
      </memberdef>
      </sectiondef>
      <sectiondef kind="func">
      <memberdef kind="function" id="_watch_server_8cpp_1a03595bfee2a55045aa751deab1e562d0" prot="public" static="no" const="no" explicit="no" inline="no" virt="non-virtual">
        <type>bool</type>
        <definition>bool sendRegPack</definition>
        <argsstring>(int iServerIdx)</argsstring>
        <name>sendRegPack</name>
        <param>
          <type>int</type>
          <declname>iServerIdx</declname>
        </param>
        <briefdescription>
        </briefdescription>
        <detaileddescription>
        </detaileddescription>
        <inbodydescription>
        </inbodydescription>
        <location file="F:/TeamWork/ServerVersion/projects/server/Server/Server/WatchServer/Src/WatchServer.cpp" line="9" column="1" bodyfile="F:/TeamWork/ServerVersion/projects/server/Server/Server/WatchServer/Src/WatchServer.cpp" bodystart="9" bodyend="21"/>
        <references refid="class_watch_server_1_1_c_watch_server_1a502c0b4d12916410078c3d72b20945d5" compoundref="_watch_server_8cpp" startline="56" endline="59">WatchServer::CWatchServer::GetServerID</references>
        <references refid="class_watch_server_1_1_c_watch_server_1abc5653c4b9a0ea7c41a803c9a0b4a9e1">WatchServer::CWatchServer::SendWCMSN_Register</references>
        <references refid="_se_ptl_comm_define_8h_1af62c3a00672953c86a2586d53c60663aa051b38374860159471f6a78f1167a7eb" compoundref="_se_ptl_comm_define_8h" startline="14">SSD_MSANGO_MAGIC</references>
        <references refid="_se_ptl_define_8h_1aefb47f3959b8be9e164448819e4bb7f9a8accedddcf1ed16f589b79e3f5d7e91b" compoundref="_se_ptl_define_8h" startline="29">SSI_NS</references>
        <referencedby refid="class_watch_server_1_1_c_watch_server_1a4f20c63ea79d05ad3b6f532d887fb091" compoundref="_watch_server_8cpp" startline="457" endline="530">WatchServer::CWatchServer::InitializeNet</referencedby>
      </memberdef>
      <memberdef kind="function" id="_watch_server_8cpp_1a1829928f14924b8a97ed00808758de08" prot="public" static="no" const="no" explicit="no" inline="no" virt="non-virtual">
        <type>bool</type>
        <definition>bool sendHeartPack</definition>
        <argsstring>(int iServerIdx)</argsstring>
        <name>sendHeartPack</name>
        <param>
          <type>int</type>
          <declname>iServerIdx</declname>
        </param>
        <briefdescription>
        </briefdescription>
        <detaileddescription>
        </detaileddescription>
        <inbodydescription>
        </inbodydescription>
        <location file="F:/TeamWork/ServerVersion/projects/server/Server/Server/WatchServer/Src/WatchServer.cpp" line="23" column="1" bodyfile="F:/TeamWork/ServerVersion/projects/server/Server/Server/WatchServer/Src/WatchServer.cpp" bodystart="23" bodyend="33"/>
        <references refid="class_watch_server_1_1_c_watch_server_1ad1612e38757c1938046e06de1abc91d0">WatchServer::CWatchServer::SendWCMSN_HeartPackage</references>
        <references refid="_se_ptl_define_8h_1aefb47f3959b8be9e164448819e4bb7f9a8accedddcf1ed16f589b79e3f5d7e91b" compoundref="_se_ptl_define_8h" startline="29">SSI_NS</references>
        <referencedby refid="class_watch_server_1_1_c_watch_server_1a4f20c63ea79d05ad3b6f532d887fb091" compoundref="_watch_server_8cpp" startline="457" endline="530">WatchServer::CWatchServer::InitializeNet</referencedby>
      </memberdef>
      </sectiondef>
    <briefdescription>
    </briefdescription>
    <detaileddescription>
    </detaileddescription>
    <programlisting>
<codeline lineno="1"><highlight class="preprocessor">#include<sp/>&quot;<ref refid="_watch_server_8h" kindref="compound">WatchServer.h</ref>&quot;</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="2"><highlight class="normal"></highlight><highlight class="preprocessor">#include<sp/>&quot;<ref refid="_se_watch_server_mgr_8h" kindref="compound">SeWatchServerMgr.h</ref>&quot;</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="3"><highlight class="normal"></highlight><highlight class="preprocessor">#include<sp/>&quot;<ref refid="_watch_server_2_src_2_se_race_mgr_8h" kindref="compound">SeRaceMgr.h</ref>&quot;</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="4"><highlight class="normal"></highlight><highlight class="preprocessor">#include<sp/>&quot;<ref refid="_watch_server_2_src_2_se_town_mgr_8h" kindref="compound">SeTownMgr.h</ref>&quot;</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="5"><highlight class="normal"></highlight></codeline>
<codeline lineno="6" refid="_watch_server_8h_1a0fe0b3e7097985c9686aa65a22e14299" refkind="member"><highlight class="normal"><ref refid="class_watch_server_1_1_c_watch_server" kindref="compound">WatchServer::CWatchServer</ref><sp/><ref refid="_watch_server_8cpp_1a0fe0b3e7097985c9686aa65a22e14299" kindref="member">g_kWatchServer</ref>;</highlight></codeline>
<codeline lineno="7"><highlight class="normal"></highlight></codeline>
<codeline lineno="8"><highlight class="normal"></highlight></codeline>
<codeline lineno="9" refid="_watch_server_8cpp_1a03595bfee2a55045aa751deab1e562d0" refkind="member"><highlight class="normal"></highlight><highlight class="keywordtype">bool</highlight><highlight class="normal"><sp/><ref refid="_watch_server_8cpp_1a03595bfee2a55045aa751deab1e562d0" kindref="member">sendRegPack</ref>(</highlight><highlight class="keywordtype">int</highlight><highlight class="normal"><sp/>iServerIdx)</highlight></codeline>
<codeline lineno="10"><highlight class="normal">{</highlight></codeline>
<codeline lineno="11"><highlight class="normal"></highlight></codeline>
<codeline lineno="12"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(iServerIdx<sp/>==<sp/><ref refid="_se_ptl_define_8h_1aefb47f3959b8be9e164448819e4bb7f9a8accedddcf1ed16f589b79e3f5d7e91b" kindref="member">SSI_NS</ref>)</highlight></codeline>
<codeline lineno="13"><highlight class="normal"><sp/><sp/><sp/><sp/>{</highlight></codeline>
<codeline lineno="14"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(!g_kWatchServer.<ref refid="class_watch_server_1_1_c_watch_server_1abc5653c4b9a0ea7c41a803c9a0b4a9e1" kindref="member">SendWCMSN_Register</ref>(<ref refid="_se_ptl_comm_define_8h_1af62c3a00672953c86a2586d53c60663aa051b38374860159471f6a78f1167a7eb" kindref="member">SSD_MSANGO_MAGIC</ref>,<sp/>g_kWatchServer.<ref refid="class_watch_server_1_1_c_watch_server_1a502c0b4d12916410078c3d72b20945d5" kindref="member">GetServerID</ref>()))</highlight></codeline>
<codeline lineno="15"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>{</highlight></codeline>
<codeline lineno="16"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/></highlight><highlight class="keyword">false</highlight><highlight class="normal">;</highlight></codeline>
<codeline lineno="17"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="18"><highlight class="normal"></highlight></codeline>
<codeline lineno="19"><highlight class="normal"><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="20"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/></highlight><highlight class="keyword">true</highlight><highlight class="normal">;</highlight></codeline>
<codeline lineno="21"><highlight class="normal">}</highlight></codeline>
<codeline lineno="22"><highlight class="normal"></highlight></codeline>
<codeline lineno="23" refid="_watch_server_8cpp_1a1829928f14924b8a97ed00808758de08" refkind="member"><highlight class="normal"></highlight><highlight class="keywordtype">bool</highlight><highlight class="normal"><sp/><ref refid="_watch_server_8cpp_1a1829928f14924b8a97ed00808758de08" kindref="member">sendHeartPack</ref>(</highlight><highlight class="keywordtype">int</highlight><highlight class="normal"><sp/>iServerIdx)</highlight></codeline>
<codeline lineno="24"><highlight class="normal">{</highlight></codeline>
<codeline lineno="25"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(iServerIdx<sp/>==<sp/><ref refid="_se_ptl_define_8h_1aefb47f3959b8be9e164448819e4bb7f9a8accedddcf1ed16f589b79e3f5d7e91b" kindref="member">SSI_NS</ref>)</highlight></codeline>
<codeline lineno="26"><highlight class="normal"><sp/><sp/><sp/><sp/>{</highlight></codeline>
<codeline lineno="27"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(!g_kWatchServer.<ref refid="class_watch_server_1_1_c_watch_server_1ad1612e38757c1938046e06de1abc91d0" kindref="member">SendWCMSN_HeartPackage</ref>())</highlight></codeline>
<codeline lineno="28"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>{</highlight></codeline>
<codeline lineno="29"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/></highlight><highlight class="keyword">false</highlight><highlight class="normal">;</highlight></codeline>
<codeline lineno="30"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="31"><highlight class="normal"><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="32"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/></highlight><highlight class="keyword">true</highlight><highlight class="normal">;</highlight></codeline>
<codeline lineno="33"><highlight class="normal">}</highlight></codeline>
<codeline lineno="34"><highlight class="normal"></highlight></codeline>
<codeline lineno="35"><highlight class="normal"></highlight><highlight class="keyword">namespace<sp/></highlight><highlight class="normal">WatchServer</highlight></codeline>
<codeline lineno="36"><highlight class="normal">{</highlight></codeline>
<codeline lineno="37"><highlight class="normal"><sp/><sp/><sp/><sp/><ref refid="namespace_watch_server_1a208df4681e96b5652f08391e09c39ee7" kindref="member">IMPLEMENT_POOL</ref>(<ref refid="struct_se_connect" kindref="compound">SeConnect</ref>,<sp/>256,<sp/>64);</highlight></codeline>
<codeline lineno="38"><highlight class="normal"><sp/><sp/><sp/><sp/><ref refid="namespace_watch_server_1a208df4681e96b5652f08391e09c39ee7" kindref="member">IMPLEMENT_POOL</ref>(SeInnerConnect,<sp/>256,<sp/>64);</highlight></codeline>
<codeline lineno="39"><highlight class="normal"></highlight></codeline>
<codeline lineno="40" refid="class_watch_server_1_1_c_watch_server_1afd4f20abc9ebadf1a14275c970be9851" refkind="member"><highlight class="normal"><sp/><sp/><sp/><sp/><ref refid="class_watch_server_1_1_c_watch_server_1afd4f20abc9ebadf1a14275c970be9851" kindref="member">CWatchServer::CWatchServer</ref>(</highlight><highlight class="keywordtype">void</highlight><highlight class="normal">)</highlight></codeline>
<codeline lineno="41"><highlight class="normal"><sp/><sp/><sp/><sp/>{</highlight></codeline>
<codeline lineno="42"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>memset(<ref refid="class_watch_server_1_1_c_watch_server_1ae3fc0f31e9904e96aea9f1f6e2dbdfc4" kindref="member">m_acSend</ref>,<sp/>0,<sp/></highlight><highlight class="keyword">sizeof</highlight><highlight class="normal">(<ref refid="class_watch_server_1_1_c_watch_server_1ae3fc0f31e9904e96aea9f1f6e2dbdfc4" kindref="member">m_acSend</ref>));</highlight></codeline>
<codeline lineno="43"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>memset(<ref refid="class_watch_server_1_1_c_watch_server_1a448a900c4c34e3fa62f3d6630fe29236" kindref="member">m_acPraseBuf</ref>,<sp/>0,<sp/></highlight><highlight class="keyword">sizeof</highlight><highlight class="normal">(<ref refid="class_watch_server_1_1_c_watch_server_1a448a900c4c34e3fa62f3d6630fe29236" kindref="member">m_acPraseBuf</ref>));</highlight></codeline>
<codeline lineno="44"><highlight class="normal"></highlight></codeline>
<codeline lineno="45"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="class_watch_server_1_1_c_watch_server_1a6670253c567fbbbe37b2ee78201bcfa4" kindref="member">m_dwTickCount</ref><sp/>=<sp/>GetTickCount();</highlight></codeline>
<codeline lineno="46"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="class_watch_server_1_1_c_watch_server_1a9bc827b6b1bf525952a8f637ec4b5233" kindref="member">m_dwCurTime</ref><sp/>=<sp/>0;</highlight></codeline>
<codeline lineno="47"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="class_watch_server_1_1_c_watch_server_1a42119a13b177d1ec84cbb131f2451cc7" kindref="member">m_bWCMSReady</ref><sp/>=<sp/></highlight><highlight class="keyword">false</highlight><highlight class="normal">;</highlight></codeline>
<codeline lineno="48"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="class_watch_server_1_1_c_watch_server_1ab8c3744ead527029dc2447c996d2c7e0" kindref="member">m_iRegisterCount</ref><sp/>=<sp/>0;</highlight></codeline>
<codeline lineno="49"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="class_watch_server_1_1_c_watch_server_1ab230b0e57fd9eb328c6e5ce60a09fbcc" kindref="member">m_pkNSConn</ref><sp/>=<sp/>NULL;</highlight></codeline>
<codeline lineno="50"><highlight class="normal"><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="51"><highlight class="normal"></highlight></codeline>
<codeline lineno="52" refid="class_watch_server_1_1_c_watch_server_1a06c70d08fae2a58c1be37f4187ad304a" refkind="member"><highlight class="normal"><sp/><sp/><sp/><sp/><ref refid="class_watch_server_1_1_c_watch_server_1a06c70d08fae2a58c1be37f4187ad304a" kindref="member">CWatchServer::~CWatchServer</ref>()</highlight></codeline>
<codeline lineno="53"><highlight class="normal"><sp/><sp/><sp/><sp/>{</highlight></codeline>
<codeline lineno="54"><highlight class="normal"><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="55"><highlight class="normal"></highlight></codeline>
<codeline lineno="56" refid="class_watch_server_1_1_c_watch_server_1a502c0b4d12916410078c3d72b20945d5" refkind="member"><highlight class="normal"><sp/><sp/><sp/><sp/>DWord<sp/><ref refid="class_watch_server_1_1_c_watch_server_1a502c0b4d12916410078c3d72b20945d5" kindref="member">CWatchServer::GetServerID</ref>()</highlight></codeline>
<codeline lineno="57"><highlight class="normal"><sp/><sp/><sp/><sp/>{</highlight></codeline>
<codeline lineno="58"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/><ref refid="class_watch_server_1_1_c_watch_server_1a3eb2bf017ad3579c36293ccd77faa7d6" kindref="member">m_kConfig</ref>.<ref refid="struct_watch_server_1_1_se_watch_config_1ac34ee6b0fb440f10d01713802df623d7" kindref="member">dwServerID</ref>;</highlight></codeline>
<codeline lineno="59"><highlight class="normal"><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="60"><highlight class="normal"></highlight></codeline>
<codeline lineno="61" refid="class_watch_server_1_1_c_watch_server_1ad08ef4a2d15c3ac119b072e0a714622c" refkind="member"><highlight class="normal"><sp/><sp/><sp/><sp/>DWord<sp/><ref refid="class_watch_server_1_1_c_watch_server_1ad08ef4a2d15c3ac119b072e0a714622c" kindref="member">CWatchServer::GetServerTime</ref>(</highlight><highlight class="keywordtype">void</highlight><highlight class="normal">)</highlight></codeline>
<codeline lineno="62"><highlight class="normal"><sp/><sp/><sp/><sp/>{</highlight></codeline>
<codeline lineno="63"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/><ref refid="class_watch_server_1_1_c_watch_server_1a9bc827b6b1bf525952a8f637ec4b5233" kindref="member">m_dwCurTime</ref>;</highlight></codeline>
<codeline lineno="64"><highlight class="normal"><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="65"><highlight class="normal"></highlight></codeline>
<codeline lineno="66" refid="class_watch_server_1_1_c_watch_server_1a2a0fec7f6da222842dce84e5bed8c04e" refkind="member"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordtype">bool</highlight><highlight class="normal"><sp/><ref refid="class_watch_server_1_1_c_watch_server_1a2a0fec7f6da222842dce84e5bed8c04e" kindref="member">CWatchServer::Initialize</ref>()</highlight></codeline>
<codeline lineno="67"><highlight class="normal"><sp/><sp/><sp/><sp/>{</highlight></codeline>
<codeline lineno="68"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(!<ref refid="class_watch_server_1_1_c_watch_server_1a02d324973f10d692522b461a7004be78" kindref="member">LoadConfig</ref>(</highlight><highlight class="stringliteral">&quot;./Data/WatchServer.ini&quot;</highlight><highlight class="normal">))</highlight></codeline>
<codeline lineno="69"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>{</highlight></codeline>
<codeline lineno="70"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/></highlight><highlight class="keyword">false</highlight><highlight class="normal">;</highlight></codeline>
<codeline lineno="71"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="72"><highlight class="normal"></highlight></codeline>
<codeline lineno="73"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(!<ref refid="class_watch_server_1_1_c_watch_server_1a4f20c63ea79d05ad3b6f532d887fb091" kindref="member">InitializeNet</ref>())</highlight></codeline>
<codeline lineno="74"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>{</highlight></codeline>
<codeline lineno="75"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/></highlight><highlight class="keyword">false</highlight><highlight class="normal">;</highlight></codeline>
<codeline lineno="76"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="77"><highlight class="normal"></highlight></codeline>
<codeline lineno="78"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(<ref refid="class_watch_server_1_1_c_watch_server_1a3eb2bf017ad3579c36293ccd77faa7d6" kindref="member">m_kConfig</ref>.<ref refid="struct_watch_server_1_1_se_watch_config_1a1e7b8a2841fe92c37a11df68ed224511" kindref="member">bMgr</ref><sp/>&amp;&amp;<sp/>!<ref refid="class_watch_server_1_1_c_watch_server_1a3eb2bf017ad3579c36293ccd77faa7d6" kindref="member">m_kConfig</ref>.<ref refid="struct_watch_server_1_1_se_watch_config_1a129f8e65f0f91128ee0695137cc4f479" kindref="member">kAddrToPlayer</ref>.<ref refid="struct_se_net_addr_1a35c27f89f488d9bd23ee1c19f2ae7b8a" kindref="member">IsEmpty</ref>())</highlight></codeline>
<codeline lineno="79"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>{</highlight></codeline>
<codeline lineno="80"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="class_watch_server_1_1_se_watch_server_info" kindref="compound">SeWatchServerInfo</ref>*<sp/>pInfo<sp/>=<sp/>SeWatchServerInfo::NEW();</highlight></codeline>
<codeline lineno="81"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>pInfo-&gt;<ref refid="class_watch_server_1_1_se_watch_server_info_1a76e36422386255be5dc0b769789b5c72" kindref="member">setServerID</ref>(<ref refid="class_watch_server_1_1_c_watch_server_1a502c0b4d12916410078c3d72b20945d5" kindref="member">GetServerID</ref>());</highlight></codeline>
<codeline lineno="82"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>pInfo-&gt;<ref refid="class_watch_server_1_1_se_watch_server_info_1afa277908b5872eb58027b581962e3069" kindref="member">setConnect</ref>(NULL);</highlight></codeline>
<codeline lineno="83"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>pInfo-&gt;<ref refid="class_watch_server_1_1_se_watch_server_info_1a2cd95d23bb5b5def356ec7b0119d0b50" kindref="member">setAddr2Player</ref>(<ref refid="class_watch_server_1_1_c_watch_server_1a3eb2bf017ad3579c36293ccd77faa7d6" kindref="member">m_kConfig</ref>.<ref refid="struct_watch_server_1_1_se_watch_config_1a129f8e65f0f91128ee0695137cc4f479" kindref="member">kAddrToPlayer</ref>);</highlight></codeline>
<codeline lineno="84"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="namespace_watch_server_1ab985a30dbaa554391d708254872572c9" kindref="member">g_kWatchServerMgr</ref>.<ref refid="class_watch_server_1_1_c_watch_server_mgr_1aeb82f7ffd1123540703b06dc8c659947" kindref="member">registerWCS</ref>(pInfo);</highlight></codeline>
<codeline lineno="85"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="86"><highlight class="normal"></highlight></codeline>
<codeline lineno="87"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/></highlight><highlight class="keyword">true</highlight><highlight class="normal">;</highlight></codeline>
<codeline lineno="88"><highlight class="normal"><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="89"><highlight class="normal"></highlight></codeline>
<codeline lineno="90" refid="class_watch_server_1_1_c_watch_server_1accae10b1a923a7d35b10de1cab6ddb16" refkind="member"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordtype">void</highlight><highlight class="normal"><sp/><ref refid="class_watch_server_1_1_c_watch_server_1accae10b1a923a7d35b10de1cab6ddb16" kindref="member">CWatchServer::Finialize</ref>(</highlight><highlight class="keywordtype">void</highlight><highlight class="normal">)</highlight></codeline>
<codeline lineno="91"><highlight class="normal"><sp/><sp/><sp/><sp/>{</highlight></codeline>
<codeline lineno="92"><highlight class="normal"><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="93"><highlight class="normal"></highlight></codeline>
<codeline lineno="94" refid="class_watch_server_1_1_c_watch_server_1a06346a1715803f6de7f0e5df74fb5cb7" refkind="member"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordtype">void</highlight><highlight class="normal"><sp/><ref refid="class_watch_server_1_1_c_watch_server_1a06346a1715803f6de7f0e5df74fb5cb7" kindref="member">CWatchServer::Update</ref>(</highlight><highlight class="keywordtype">void</highlight><highlight class="normal">)</highlight></codeline>
<codeline lineno="95"><highlight class="normal"><sp/><sp/><sp/><sp/>{</highlight></codeline>
<codeline lineno="96"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>DWord<sp/>dwTickCount<sp/>=<sp/>GetTickCount();</highlight></codeline>
<codeline lineno="97"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordtype">int</highlight><highlight class="normal"><sp/>iDTime<sp/>=<sp/>(int)(dwTickCount<sp/>-<sp/><ref refid="class_watch_server_1_1_c_watch_server_1a6670253c567fbbbe37b2ee78201bcfa4" kindref="member">m_dwTickCount</ref>);</highlight></codeline>
<codeline lineno="98"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="class_watch_server_1_1_c_watch_server_1a6670253c567fbbbe37b2ee78201bcfa4" kindref="member">m_dwTickCount</ref><sp/>=<sp/>dwTickCount;</highlight></codeline>
<codeline lineno="99"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="class_watch_server_1_1_c_watch_server_1a9bc827b6b1bf525952a8f637ec4b5233" kindref="member">m_dwCurTime</ref><sp/>+=<sp/>iDTime;</highlight></codeline>
<codeline lineno="100"><highlight class="normal"></highlight></codeline>
<codeline lineno="101"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="class_watch_server_1_1_c_watch_server_1a3dc54fcd755ce4e21f181aa6f4d91b4d" kindref="member">m_kNetMgr</ref>.Update();</highlight></codeline>
<codeline lineno="102"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="_se_virt_conn_mgr_8cpp_1aa8e9d5beed961f4e26b9cadd49603980" kindref="member">g_kVirtConnMgr</ref>.<ref refid="class_se_virt_conn_mgr_1a1a2056beaab510c633febd91090592ee" kindref="member">Update</ref>(<ref refid="class_watch_server_1_1_c_watch_server_1a9bc827b6b1bf525952a8f637ec4b5233" kindref="member">m_dwCurTime</ref>);</highlight></codeline>
<codeline lineno="103"><highlight class="normal"></highlight></codeline>
<codeline lineno="104"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="class_watch_server_1_1_c_watch_server_1af52df49a4bef89e148ac9eea12081f37" kindref="member">UpdateWCMSState</ref>();</highlight></codeline>
<codeline lineno="105"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="class_watch_server_1_1_c_watch_server_1a82c683624bae9a831da6f9864ebe2a81" kindref="member">UpdateHeartPkg</ref>();</highlight></codeline>
<codeline lineno="106"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="namespace_watch_server_1a1ba085da8e82bcc688d64e20a5a48f5c" kindref="member">g_kRaceMgr</ref>.<ref refid="class_watch_server_1_1_c_se_race_mgr_1afa0e0135b773e24c67a4b2ee49e205fa" kindref="member">Update</ref>();</highlight></codeline>
<codeline lineno="107"><highlight class="normal"><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="108"><highlight class="normal"></highlight></codeline>
<codeline lineno="109" refid="class_watch_server_1_1_c_watch_server_1af52df49a4bef89e148ac9eea12081f37" refkind="member"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordtype">void</highlight><highlight class="normal"><sp/><ref refid="class_watch_server_1_1_c_watch_server_1af52df49a4bef89e148ac9eea12081f37" kindref="member">CWatchServer::UpdateWCMSState</ref>()</highlight></codeline>
<codeline lineno="110"><highlight class="normal"><sp/><sp/><sp/><sp/>{</highlight></codeline>
<codeline lineno="111"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keyword">static</highlight><highlight class="normal"><sp/>DWord<sp/>s_dwPreTime<sp/>=<sp/><ref refid="class_watch_server_1_1_c_watch_server_1ad08ef4a2d15c3ac119b072e0a714622c" kindref="member">GetServerTime</ref>();</highlight></codeline>
<codeline lineno="112"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordtype">int</highlight><highlight class="normal"><sp/>iDecTime<sp/>=<sp/>(int)(<ref refid="class_watch_server_1_1_c_watch_server_1ad08ef4a2d15c3ac119b072e0a714622c" kindref="member">GetServerTime</ref>()<sp/>-<sp/>s_dwPreTime);</highlight></codeline>
<codeline lineno="113"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(iDecTime<sp/>&lt;<sp/>1000)</highlight></codeline>
<codeline lineno="114"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>{</highlight></codeline>
<codeline lineno="115"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal">;</highlight></codeline>
<codeline lineno="116"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="117"><highlight class="normal"></highlight></codeline>
<codeline lineno="118"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>s_dwPreTime<sp/>=<sp/><ref refid="class_watch_server_1_1_c_watch_server_1ad08ef4a2d15c3ac119b072e0a714622c" kindref="member">GetServerTime</ref>();</highlight></codeline>
<codeline lineno="119"><highlight class="normal"></highlight></codeline>
<codeline lineno="120"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(!<ref refid="class_watch_server_1_1_c_watch_server_1a3eb2bf017ad3579c36293ccd77faa7d6" kindref="member">m_kConfig</ref>.<ref refid="struct_watch_server_1_1_se_watch_config_1a1e7b8a2841fe92c37a11df68ed224511" kindref="member">bMgr</ref>)</highlight></codeline>
<codeline lineno="121"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>{</highlight></codeline>
<codeline lineno="122"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(<ref refid="class_watch_server_1_1_c_watch_server_1a105d719eca41577b0e28b84ce8c97239" kindref="member">m_vWcsMgrServerData</ref>.<ref refid="struct_se_server_data_1a2777bbfd27a6afe42ebd71c5d14010a0" kindref="member">kSock</ref>.IsInvalid())</highlight></codeline>
<codeline lineno="123"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>{</highlight></codeline>
<codeline lineno="124"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="class_watch_server_1_1_c_watch_server_1aeca5ad6ffae3d811dc7e7be05e7aabfb" kindref="member">Connect2WCMS</ref>();</highlight></codeline>
<codeline lineno="125"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="126"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">else</highlight><highlight class="normal"><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(!<ref refid="class_watch_server_1_1_c_watch_server_1a105d719eca41577b0e28b84ce8c97239" kindref="member">m_vWcsMgrServerData</ref>.<ref refid="struct_se_server_data_1a4d91e2d15b4bc404ebc4ec42254ac770" kindref="member">bRegistered</ref>)</highlight></codeline>
<codeline lineno="127"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>{</highlight></codeline>
<codeline lineno="128"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="class_watch_server_1_1_c_watch_server_1a013b523462f94f84af199f001d593322" kindref="member">Register2WCMS</ref>();</highlight></codeline>
<codeline lineno="129"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="130"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="131"><highlight class="normal"></highlight></codeline>
<codeline lineno="132"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="class_watch_server_1_1_c_watch_server_1a8eaae57ebcf4040e6d39809c26d891cc" kindref="member">UpdateRsState</ref>();</highlight></codeline>
<codeline lineno="133"><highlight class="normal"><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="134"><highlight class="normal"></highlight></codeline>
<codeline lineno="135" refid="class_watch_server_1_1_c_watch_server_1a8eaae57ebcf4040e6d39809c26d891cc" refkind="member"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordtype">void</highlight><highlight class="normal"><sp/><ref refid="class_watch_server_1_1_c_watch_server_1a8eaae57ebcf4040e6d39809c26d891cc" kindref="member">CWatchServer::UpdateRsState</ref>()</highlight></codeline>
<codeline lineno="136"><highlight class="normal"><sp/><sp/><sp/><sp/>{</highlight></codeline>
<codeline lineno="137"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(<ref refid="class_watch_server_1_1_c_watch_server_1aafeb8443263a74c13874ec97f4682e4b" kindref="member">m_vRsServerData</ref>.size()<sp/>&lt;<sp/><ref refid="class_watch_server_1_1_c_watch_server_1a3eb2bf017ad3579c36293ccd77faa7d6" kindref="member">m_kConfig</ref>.<ref refid="struct_watch_server_1_1_se_watch_config_1a7b543072c4adc05748e49293d19808d4" kindref="member">vAddrRS</ref>.size())</highlight></codeline>
<codeline lineno="138"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>{</highlight></codeline>
<codeline lineno="139"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="class_watch_server_1_1_c_watch_server_1aafeb8443263a74c13874ec97f4682e4b" kindref="member">m_vRsServerData</ref>.resize(<ref refid="class_watch_server_1_1_c_watch_server_1a3eb2bf017ad3579c36293ccd77faa7d6" kindref="member">m_kConfig</ref>.<ref refid="struct_watch_server_1_1_se_watch_config_1a7b543072c4adc05748e49293d19808d4" kindref="member">vAddrRS</ref>.size());</highlight></codeline>
<codeline lineno="140"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="141"><highlight class="normal"></highlight></codeline>
<codeline lineno="142"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">for</highlight><highlight class="normal"><sp/>(</highlight><highlight class="keywordtype">int</highlight><highlight class="normal"><sp/>ii<sp/>=<sp/>0;<sp/>ii<sp/>&lt;<sp/><ref refid="class_watch_server_1_1_c_watch_server_1aafeb8443263a74c13874ec97f4682e4b" kindref="member">m_vRsServerData</ref>.size();<sp/>++ii)</highlight></codeline>
<codeline lineno="143"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>{</highlight></codeline>
<codeline lineno="144"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(<ref refid="class_watch_server_1_1_c_watch_server_1aafeb8443263a74c13874ec97f4682e4b" kindref="member">m_vRsServerData</ref>[ii].kSock.IsInvalid())</highlight></codeline>
<codeline lineno="145"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>{</highlight></codeline>
<codeline lineno="146"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(!<ref refid="class_watch_server_1_1_c_watch_server_1aafeb8443263a74c13874ec97f4682e4b" kindref="member">m_vRsServerData</ref>[ii].bConnecting)</highlight></codeline>
<codeline lineno="147"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>{</highlight></codeline>
<codeline lineno="148"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="struct_se_net_addr" kindref="compound">SeNetAddr</ref>&amp;<sp/>rkMS<sp/>=<sp/><ref refid="class_watch_server_1_1_c_watch_server_1a3eb2bf017ad3579c36293ccd77faa7d6" kindref="member">m_kConfig</ref>.<ref refid="struct_watch_server_1_1_se_watch_config_1a7b543072c4adc05748e49293d19808d4" kindref="member">vAddrRS</ref>[ii];</highlight></codeline>
<codeline lineno="149"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(<ref refid="class_watch_server_1_1_c_watch_server_1a3dc54fcd755ce4e21f181aa6f4d91b4d" kindref="member">m_kNetMgr</ref>.Connect(rkMS.<ref refid="struct_se_net_addr_1a23b51e87d8b7b2201a03833c9adde232" kindref="member">acIP</ref>,<sp/>rkMS.<ref refid="struct_se_net_addr_1a989fa5b025bc039122e8d2a29838fde9" kindref="member">iPort</ref>,<sp/>2000,<sp/><ref refid="_se_server_define_8h_1a141dc49d73e6790790a053c29623f606" kindref="member">SERVER_BUFFER_SIZE</ref>))</highlight></codeline>
<codeline lineno="150"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>{</highlight></codeline>
<codeline lineno="151"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="class_watch_server_1_1_c_watch_server_1aafeb8443263a74c13874ec97f4682e4b" kindref="member">m_vRsServerData</ref>[ii].bConnecting<sp/>=<sp/></highlight><highlight class="keyword">true</highlight><highlight class="normal">;</highlight></codeline>
<codeline lineno="152"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="153"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">else</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="154"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>{</highlight></codeline>
<codeline lineno="155"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="_se_file_log_8h_1a59fe2018c00666084724bec1365b41f5" kindref="member">SeLogError</ref>(</highlight><highlight class="stringliteral">&quot;Connect<sp/>to<sp/>RS<sp/>failed:[%s:%d]&quot;</highlight><highlight class="normal">,<sp/>rkMS.<ref refid="struct_se_net_addr_1a23b51e87d8b7b2201a03833c9adde232" kindref="member">acIP</ref>,<sp/>rkMS.<ref refid="struct_se_net_addr_1a989fa5b025bc039122e8d2a29838fde9" kindref="member">iPort</ref>);</highlight></codeline>
<codeline lineno="156"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="157"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="158"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="159"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">else</highlight><highlight class="normal"><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(!<ref refid="class_watch_server_1_1_c_watch_server_1aafeb8443263a74c13874ec97f4682e4b" kindref="member">m_vRsServerData</ref>[ii].bRegistered)</highlight></codeline>
<codeline lineno="160"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>{</highlight></codeline>
<codeline lineno="161"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="class_watch_server_1_1_c_watch_server_1a63a55cf9d6cf2034c4e1f6c56fa3410e" kindref="member">Register2RS</ref>(<ref refid="class_watch_server_1_1_c_watch_server_1aafeb8443263a74c13874ec97f4682e4b" kindref="member">m_vRsServerData</ref>[ii]);</highlight></codeline>
<codeline lineno="162"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="163"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="164"><highlight class="normal"><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="165"><highlight class="normal"></highlight></codeline>
<codeline lineno="166" refid="class_watch_server_1_1_c_watch_server_1aeca5ad6ffae3d811dc7e7be05e7aabfb" refkind="member"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordtype">void</highlight><highlight class="normal"><sp/><ref refid="class_watch_server_1_1_c_watch_server_1aeca5ad6ffae3d811dc7e7be05e7aabfb" kindref="member">CWatchServer::Connect2WCMS</ref>()</highlight></codeline>
<codeline lineno="167"><highlight class="normal"><sp/><sp/><sp/><sp/>{</highlight></codeline>
<codeline lineno="168"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(!<ref refid="class_watch_server_1_1_c_watch_server_1a105d719eca41577b0e28b84ce8c97239" kindref="member">m_vWcsMgrServerData</ref>.<ref refid="struct_se_server_data_1a53fcdfea60106f5c7179d39b1e259a3e" kindref="member">bConnecting</ref>)</highlight></codeline>
<codeline lineno="169"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>{</highlight></codeline>
<codeline lineno="170"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="struct_se_net_addr" kindref="compound">SeNetAddr</ref>&amp;<sp/>rkMS<sp/>=<sp/><ref refid="class_watch_server_1_1_c_watch_server_1a3eb2bf017ad3579c36293ccd77faa7d6" kindref="member">m_kConfig</ref>.<ref refid="struct_watch_server_1_1_se_watch_config_1ae8f27d9f748f36bc397261581756ac10" kindref="member">kWatchMgrServer</ref>;</highlight></codeline>
<codeline lineno="171"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(<ref refid="class_watch_server_1_1_c_watch_server_1a3dc54fcd755ce4e21f181aa6f4d91b4d" kindref="member">m_kNetMgr</ref>.Connect(rkMS.<ref refid="struct_se_net_addr_1a23b51e87d8b7b2201a03833c9adde232" kindref="member">acIP</ref>,<sp/>rkMS.<ref refid="struct_se_net_addr_1a989fa5b025bc039122e8d2a29838fde9" kindref="member">iPort</ref>,<sp/>2000,<sp/><ref refid="_se_server_define_8h_1a141dc49d73e6790790a053c29623f606" kindref="member">SERVER_BUFFER_SIZE</ref>))</highlight></codeline>
<codeline lineno="172"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>{</highlight></codeline>
<codeline lineno="173"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="class_watch_server_1_1_c_watch_server_1a105d719eca41577b0e28b84ce8c97239" kindref="member">m_vWcsMgrServerData</ref>.<ref refid="struct_se_server_data_1a53fcdfea60106f5c7179d39b1e259a3e" kindref="member">bConnecting</ref><sp/>=<sp/></highlight><highlight class="keyword">true</highlight><highlight class="normal">;</highlight></codeline>
<codeline lineno="174"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="175"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">else</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="176"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>{</highlight></codeline>
<codeline lineno="177"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="_se_file_log_8h_1a59fe2018c00666084724bec1365b41f5" kindref="member">SeLogError</ref>(</highlight><highlight class="stringliteral">&quot;Connect<sp/>to<sp/>WCMS<sp/>failed:[%s:%d]&quot;</highlight><highlight class="normal">,<sp/>rkMS.<ref refid="struct_se_net_addr_1a23b51e87d8b7b2201a03833c9adde232" kindref="member">acIP</ref>,<sp/>rkMS.<ref refid="struct_se_net_addr_1a989fa5b025bc039122e8d2a29838fde9" kindref="member">iPort</ref>);</highlight></codeline>
<codeline lineno="178"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="179"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="180"><highlight class="normal"><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="181"><highlight class="normal"></highlight></codeline>
<codeline lineno="182" refid="class_watch_server_1_1_c_watch_server_1a013b523462f94f84af199f001d593322" refkind="member"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordtype">void</highlight><highlight class="normal"><sp/><ref refid="class_watch_server_1_1_c_watch_server_1a013b523462f94f84af199f001d593322" kindref="member">CWatchServer::Register2WCMS</ref>()</highlight></codeline>
<codeline lineno="183"><highlight class="normal"><sp/><sp/><sp/><sp/>{</highlight></codeline>
<codeline lineno="184"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordtype">int</highlight><highlight class="normal"><sp/>iDTime<sp/>=<sp/>(int)(<ref refid="class_watch_server_1_1_c_watch_server_1a9bc827b6b1bf525952a8f637ec4b5233" kindref="member">m_dwCurTime</ref><sp/>-<sp/><ref refid="class_watch_server_1_1_c_watch_server_1a105d719eca41577b0e28b84ce8c97239" kindref="member">m_vWcsMgrServerData</ref>.<ref refid="struct_se_server_data_1ad83763ea85ed3a8635ca4b9c5a393ba4" kindref="member">dwRegisterTime</ref>);</highlight></codeline>
<codeline lineno="185"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(<ref refid="class_watch_server_1_1_c_watch_server_1a105d719eca41577b0e28b84ce8c97239" kindref="member">m_vWcsMgrServerData</ref>.<ref refid="struct_se_server_data_1ad83763ea85ed3a8635ca4b9c5a393ba4" kindref="member">dwRegisterTime</ref><sp/>==<sp/>0<sp/>||<sp/>(iDTime<sp/>&gt;<sp/><ref refid="namespace_watch_server_1af999072588e5dcf3934052b5aeb5bd11acc027310b46484962852891cc538ab0c" kindref="member">RECONNECT_TIME</ref><sp/>||<sp/>iDTime<sp/>&lt;<sp/>0))</highlight></codeline>
<codeline lineno="186"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>{</highlight></codeline>
<codeline lineno="187"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(<ref refid="class_watch_server_1_1_c_watch_server_1a105d719eca41577b0e28b84ce8c97239" kindref="member">m_vWcsMgrServerData</ref>.<ref refid="struct_se_server_data_1ad83763ea85ed3a8635ca4b9c5a393ba4" kindref="member">dwRegisterTime</ref>)</highlight></codeline>
<codeline lineno="188"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>{</highlight></codeline>
<codeline lineno="189"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="_se_file_log_8h_1a59fe2018c00666084724bec1365b41f5" kindref="member">SeLogError</ref>(</highlight><highlight class="stringliteral">&quot;Register<sp/>to<sp/>WCMS<sp/>failed&quot;</highlight><highlight class="normal">,<sp/>1);</highlight></codeline>
<codeline lineno="190"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="191"><highlight class="normal"></highlight></codeline>
<codeline lineno="192"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(!<ref refid="class_watch_server_1_1_c_watch_server_1aed6feb67ff8a302e7ef609d1963303d6" kindref="member">SendWCSWCMS_Register</ref>(<ref refid="class_watch_server_1_1_c_watch_server_1a3eb2bf017ad3579c36293ccd77faa7d6" kindref="member">m_kConfig</ref>.<ref refid="struct_watch_server_1_1_se_watch_config_1ac34ee6b0fb440f10d01713802df623d7" kindref="member">dwServerID</ref>,<sp/><ref refid="class_watch_server_1_1_c_watch_server_1a3eb2bf017ad3579c36293ccd77faa7d6" kindref="member">m_kConfig</ref>.<ref refid="struct_watch_server_1_1_se_watch_config_1a129f8e65f0f91128ee0695137cc4f479" kindref="member">kAddrToPlayer</ref>,<sp/><ref refid="class_watch_server_1_1_c_watch_server_1ab8c3744ead527029dc2447c996d2c7e0" kindref="member">m_iRegisterCount</ref>++,<sp/></highlight><highlight class="keyword">true</highlight><highlight class="normal">,<sp/>&amp;<ref refid="class_watch_server_1_1_c_watch_server_1a105d719eca41577b0e28b84ce8c97239" kindref="member">m_vWcsMgrServerData</ref>.<ref refid="struct_se_server_data_1a2777bbfd27a6afe42ebd71c5d14010a0" kindref="member">kSock</ref>))</highlight></codeline>
<codeline lineno="193"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>{</highlight></codeline>
<codeline lineno="194"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="_se_file_log_8h_1a59fe2018c00666084724bec1365b41f5" kindref="member">SeLogError</ref>(</highlight><highlight class="stringliteral">&quot;Send<sp/>Register<sp/>to<sp/>WCMS<sp/>failed&quot;</highlight><highlight class="normal">,<sp/>1);</highlight></codeline>
<codeline lineno="195"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="196"><highlight class="normal"></highlight></codeline>
<codeline lineno="197"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="class_watch_server_1_1_c_watch_server_1a105d719eca41577b0e28b84ce8c97239" kindref="member">m_vWcsMgrServerData</ref>.<ref refid="struct_se_server_data_1ad83763ea85ed3a8635ca4b9c5a393ba4" kindref="member">dwRegisterTime</ref><sp/>=<sp/><ref refid="class_watch_server_1_1_c_watch_server_1a9bc827b6b1bf525952a8f637ec4b5233" kindref="member">m_dwCurTime</ref>;</highlight></codeline>
<codeline lineno="198"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="199"><highlight class="normal"><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="200"><highlight class="normal"></highlight></codeline>
<codeline lineno="201" refid="class_watch_server_1_1_c_watch_server_1a63a55cf9d6cf2034c4e1f6c56fa3410e" refkind="member"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordtype">void</highlight><highlight class="normal"><sp/><ref refid="class_watch_server_1_1_c_watch_server_1a63a55cf9d6cf2034c4e1f6c56fa3410e" kindref="member">CWatchServer::Register2RS</ref>(<ref refid="struct_se_server_data" kindref="compound">SeServerData</ref>&amp;<sp/>rServerDat)</highlight></codeline>
<codeline lineno="202"><highlight class="normal"><sp/><sp/><sp/><sp/>{</highlight></codeline>
<codeline lineno="203"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordtype">int</highlight><highlight class="normal"><sp/>iDTime<sp/>=<sp/>(int)(<ref refid="class_watch_server_1_1_c_watch_server_1a9bc827b6b1bf525952a8f637ec4b5233" kindref="member">m_dwCurTime</ref><sp/>-<sp/>rServerDat.<ref refid="struct_se_server_data_1ad83763ea85ed3a8635ca4b9c5a393ba4" kindref="member">dwRegisterTime</ref>);</highlight></codeline>
<codeline lineno="204"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(rServerDat.<ref refid="struct_se_server_data_1ad83763ea85ed3a8635ca4b9c5a393ba4" kindref="member">dwRegisterTime</ref><sp/>==<sp/>0<sp/>||<sp/>(iDTime<sp/>&gt;<sp/><ref refid="namespace_watch_server_1af999072588e5dcf3934052b5aeb5bd11acc027310b46484962852891cc538ab0c" kindref="member">RECONNECT_TIME</ref><sp/>||<sp/>iDTime<sp/>&lt;<sp/>0))</highlight></codeline>
<codeline lineno="205"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>{</highlight></codeline>
<codeline lineno="206"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(rServerDat.<ref refid="struct_se_server_data_1ad83763ea85ed3a8635ca4b9c5a393ba4" kindref="member">dwRegisterTime</ref>)</highlight></codeline>
<codeline lineno="207"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>{</highlight></codeline>
<codeline lineno="208"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="_se_file_log_8h_1a59fe2018c00666084724bec1365b41f5" kindref="member">SeLogError</ref>(</highlight><highlight class="stringliteral">&quot;Register<sp/>to<sp/>RS<sp/>failed&quot;</highlight><highlight class="normal">,<sp/>1);</highlight></codeline>
<codeline lineno="209"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="210"><highlight class="normal"></highlight></codeline>
<codeline lineno="211"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="namespace_watch_server_1adfcb820a989ad1a393cdbb0bd92de8dc" kindref="member">TWCSViewInfoArray</ref><sp/>tView;</highlight></codeline>
<codeline lineno="212"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="namespace_watch_server_1a1ba085da8e82bcc688d64e20a5a48f5c" kindref="member">g_kRaceMgr</ref>.<ref refid="class_watch_server_1_1_c_se_race_mgr_1a35f9d14c1ffd9bd1512dff8dfb383e0d" kindref="member">getRaceViewInfos</ref>(tView);</highlight></codeline>
<codeline lineno="213"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(!<ref refid="class_watch_server_1_1_c_watch_server_1a88b9d28ee32b838cd9654e38d08529c8" kindref="member">SendWCSR_Register</ref>(<ref refid="class_watch_server_1_1_c_watch_server_1a3eb2bf017ad3579c36293ccd77faa7d6" kindref="member">m_kConfig</ref>.<ref refid="struct_watch_server_1_1_se_watch_config_1ac34ee6b0fb440f10d01713802df623d7" kindref="member">dwServerID</ref>,<sp/>tView.size(),<sp/>tView,<sp/>&amp;rServerDat.<ref refid="struct_se_server_data_1a2777bbfd27a6afe42ebd71c5d14010a0" kindref="member">kSock</ref>))</highlight></codeline>
<codeline lineno="214"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>{</highlight></codeline>
<codeline lineno="215"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="_se_file_log_8h_1a59fe2018c00666084724bec1365b41f5" kindref="member">SeLogError</ref>(</highlight><highlight class="stringliteral">&quot;Send<sp/>Register<sp/>to<sp/>WCMS<sp/>failed&quot;</highlight><highlight class="normal">,<sp/>1);</highlight></codeline>
<codeline lineno="216"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="217"><highlight class="normal"></highlight></codeline>
<codeline lineno="218"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>rServerDat.<ref refid="struct_se_server_data_1ad83763ea85ed3a8635ca4b9c5a393ba4" kindref="member">dwRegisterTime</ref><sp/>=<sp/><ref refid="class_watch_server_1_1_c_watch_server_1a9bc827b6b1bf525952a8f637ec4b5233" kindref="member">m_dwCurTime</ref>;</highlight></codeline>
<codeline lineno="219"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="220"><highlight class="normal"><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="221"><highlight class="normal"></highlight></codeline>
<codeline lineno="222" refid="class_watch_server_1_1_c_watch_server_1a82c683624bae9a831da6f9864ebe2a81" refkind="member"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordtype">void</highlight><highlight class="normal"><sp/><ref refid="class_watch_server_1_1_c_watch_server_1a82c683624bae9a831da6f9864ebe2a81" kindref="member">CWatchServer::UpdateHeartPkg</ref>()</highlight></codeline>
<codeline lineno="223"><highlight class="normal"><sp/><sp/><sp/><sp/>{</highlight></codeline>
<codeline lineno="224"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keyword">static</highlight><highlight class="normal"><sp/>DWord<sp/>s_dwPreTime<sp/>=<sp/><ref refid="class_watch_server_1_1_c_watch_server_1ad08ef4a2d15c3ac119b072e0a714622c" kindref="member">GetServerTime</ref>();</highlight></codeline>
<codeline lineno="225"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordtype">int</highlight><highlight class="normal"><sp/>iDecTime<sp/>=<sp/>(int)(<ref refid="class_watch_server_1_1_c_watch_server_1ad08ef4a2d15c3ac119b072e0a714622c" kindref="member">GetServerTime</ref>()<sp/>-<sp/>s_dwPreTime);</highlight></codeline>
<codeline lineno="226"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(iDecTime<sp/>&lt;<sp/>1000)</highlight></codeline>
<codeline lineno="227"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>{</highlight></codeline>
<codeline lineno="228"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal">;</highlight></codeline>
<codeline lineno="229"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="230"><highlight class="normal"></highlight></codeline>
<codeline lineno="231"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>s_dwPreTime<sp/>=<sp/><ref refid="class_watch_server_1_1_c_watch_server_1ad08ef4a2d15c3ac119b072e0a714622c" kindref="member">GetServerTime</ref>();</highlight></codeline>
<codeline lineno="232"><highlight class="normal"></highlight></codeline>
<codeline lineno="233"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(<ref refid="class_watch_server_1_1_c_watch_server_1a3eb2bf017ad3579c36293ccd77faa7d6" kindref="member">m_kConfig</ref>.<ref refid="struct_watch_server_1_1_se_watch_config_1a549b05ef44a45e8345fcfafd34ca86bf" kindref="member">bSlave</ref>)</highlight></codeline>
<codeline lineno="234"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>{</highlight></codeline>
<codeline lineno="235"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="class_watch_server_1_1_c_watch_server_1a82c683624bae9a831da6f9864ebe2a81" kindref="member">UpdateHeartPkg</ref>(<ref refid="class_watch_server_1_1_c_watch_server_1ac227c6d43db5635c1c4ddc61a36c0504" kindref="member">m_vWCSMasterServerData</ref>,<sp/><ref refid="namespace_watch_server_1aec82ec276c66b37a2dcf12d5bee0bd91a12d88c35a35b773223ac06ef738fd7ed" kindref="member">SHS_WCS</ref>);</highlight></codeline>
<codeline lineno="236"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="237"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">else</highlight><highlight class="normal"><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(!<ref refid="class_watch_server_1_1_c_watch_server_1a3eb2bf017ad3579c36293ccd77faa7d6" kindref="member">m_kConfig</ref>.<ref refid="struct_watch_server_1_1_se_watch_config_1a1e7b8a2841fe92c37a11df68ed224511" kindref="member">bMgr</ref>)</highlight></codeline>
<codeline lineno="238"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>{</highlight></codeline>
<codeline lineno="239"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="class_watch_server_1_1_c_watch_server_1a82c683624bae9a831da6f9864ebe2a81" kindref="member">UpdateHeartPkg</ref>(<ref refid="class_watch_server_1_1_c_watch_server_1a105d719eca41577b0e28b84ce8c97239" kindref="member">m_vWcsMgrServerData</ref>,<sp/><ref refid="namespace_watch_server_1aec82ec276c66b37a2dcf12d5bee0bd91a61af076e74c089fdbfaa070b47ebbfa0" kindref="member">SHS_WCMS</ref>);</highlight></codeline>
<codeline lineno="240"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="241"><highlight class="normal"></highlight></codeline>
<codeline lineno="242"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">for</highlight><highlight class="normal"><sp/>(std::size_t<sp/>ii<sp/>=<sp/>0;<sp/>ii<sp/>&lt;<sp/><ref refid="class_watch_server_1_1_c_watch_server_1aafeb8443263a74c13874ec97f4682e4b" kindref="member">m_vRsServerData</ref>.size();<sp/>++ii)</highlight></codeline>
<codeline lineno="243"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>{</highlight></codeline>
<codeline lineno="244"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="class_watch_server_1_1_c_watch_server_1a82c683624bae9a831da6f9864ebe2a81" kindref="member">UpdateHeartPkg</ref>(<ref refid="class_watch_server_1_1_c_watch_server_1aafeb8443263a74c13874ec97f4682e4b" kindref="member">m_vRsServerData</ref>[ii],<sp/><ref refid="namespace_watch_server_1aec82ec276c66b37a2dcf12d5bee0bd91aaf9a9f2727adb45c1728e7d375df285f" kindref="member">SHS_RS</ref>);</highlight></codeline>
<codeline lineno="245"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="246"><highlight class="normal"><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="247"><highlight class="normal"></highlight></codeline>
<codeline lineno="248" refid="class_watch_server_1_1_c_watch_server_1a72a9a3dc63507da7cef39a365085038c" refkind="member"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordtype">void</highlight><highlight class="normal"><sp/><ref refid="class_watch_server_1_1_c_watch_server_1a82c683624bae9a831da6f9864ebe2a81" kindref="member">CWatchServer::UpdateHeartPkg</ref>(<ref refid="struct_se_server_data" kindref="compound">SeServerData</ref>&amp;<sp/>rSrvDat,<sp/><ref refid="namespace_watch_server_1aec82ec276c66b37a2dcf12d5bee0bd91" kindref="member">SeHeartState</ref><sp/>eHeart)</highlight></codeline>
<codeline lineno="249"><highlight class="normal"><sp/><sp/><sp/><sp/>{</highlight></codeline>
<codeline lineno="250"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>{</highlight></codeline>
<codeline lineno="251"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(rSrvDat.<ref refid="struct_se_server_data_1a2777bbfd27a6afe42ebd71c5d14010a0" kindref="member">kSock</ref>.IsInvalid())</highlight></codeline>
<codeline lineno="252"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>{</highlight></codeline>
<codeline lineno="253"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>rSrvDat.<ref refid="struct_se_server_data_1a6c75241d7cd68409f25f383feb838ca3" kindref="member">dwHeartPackageTime</ref><sp/>=<sp/>0;</highlight></codeline>
<codeline lineno="254"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="255"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">else</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="256"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>{</highlight></codeline>
<codeline lineno="257"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(rSrvDat.<ref refid="struct_se_server_data_1a6c75241d7cd68409f25f383feb838ca3" kindref="member">dwHeartPackageTime</ref><sp/>==<sp/>0)</highlight></codeline>
<codeline lineno="258"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>{</highlight></codeline>
<codeline lineno="259"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(eHeart<sp/>==<sp/><ref refid="namespace_watch_server_1aec82ec276c66b37a2dcf12d5bee0bd91aaf9a9f2727adb45c1728e7d375df285f" kindref="member">SHS_RS</ref>)</highlight></codeline>
<codeline lineno="260"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>{</highlight></codeline>
<codeline lineno="261"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(!<ref refid="class_watch_server_1_1_c_watch_server_1a069cd3aa46c51c3de8f9104a08a41e9b" kindref="member">SendWCSR_HeartPackage</ref>(&amp;rSrvDat.<ref refid="struct_se_server_data_1a2777bbfd27a6afe42ebd71c5d14010a0" kindref="member">kSock</ref>))</highlight></codeline>
<codeline lineno="262"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>{</highlight></codeline>
<codeline lineno="263"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="_se_file_log_8h_1a59fe2018c00666084724bec1365b41f5" kindref="member">SeLogError</ref>(</highlight><highlight class="stringliteral">&quot;SendWCSR_HeartPackage<sp/>Failed&quot;</highlight><highlight class="normal">,<sp/>1);</highlight></codeline>
<codeline lineno="264"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="265"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="266"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>rSrvDat.<ref refid="struct_se_server_data_1a6c75241d7cd68409f25f383feb838ca3" kindref="member">dwHeartPackageTime</ref><sp/>=<sp/><ref refid="class_watch_server_1_1_c_watch_server_1ad08ef4a2d15c3ac119b072e0a714622c" kindref="member">GetServerTime</ref>();</highlight></codeline>
<codeline lineno="267"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="268"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">else</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="269"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>{</highlight></codeline>
<codeline lineno="270"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordtype">int</highlight><highlight class="normal"><sp/>iDecTime<sp/>=<sp/>(int)(<ref refid="class_watch_server_1_1_c_watch_server_1ad08ef4a2d15c3ac119b072e0a714622c" kindref="member">GetServerTime</ref>()<sp/>-<sp/>rSrvDat.<ref refid="struct_se_server_data_1a6c75241d7cd68409f25f383feb838ca3" kindref="member">dwHeartPackageTime</ref>);</highlight></codeline>
<codeline lineno="271"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(iDecTime<sp/>&gt;=<sp/>10<sp/>*<sp/>1000)</highlight></codeline>
<codeline lineno="272"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>{</highlight></codeline>
<codeline lineno="273"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="class_watch_server_1_1_c_watch_server_1a3dc54fcd755ce4e21f181aa6f4d91b4d" kindref="member">m_kNetMgr</ref>.Disconnect(rSrvDat.<ref refid="struct_se_server_data_1a2777bbfd27a6afe42ebd71c5d14010a0" kindref="member">kSock</ref>);</highlight></codeline>
<codeline lineno="274"><highlight class="normal"></highlight></codeline>
<codeline lineno="275"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="_se_file_log_8h_1a59fe2018c00666084724bec1365b41f5" kindref="member">SeLogError</ref>(</highlight><highlight class="stringliteral">&quot;HeartPackageTime<sp/>OverTime<sp/>DisconnectSrv<sp/>TypeID[%d]<sp/>SrvID[%s]<sp/>&quot;</highlight><highlight class="normal">,<sp/>eHeart,<sp/><ref refid="_se_tool_8h_1ada81d4ae5d39c42af0a02b45f4a6f715" kindref="member">GetID2Str</ref>(rSrvDat.<ref refid="struct_se_server_data_1a00d62b0291ec6d527625afc329f5f95b" kindref="member">dwID</ref>));</highlight></codeline>
<codeline lineno="276"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>rSrvDat.<ref refid="struct_se_server_data_1a6c75241d7cd68409f25f383feb838ca3" kindref="member">dwHeartPackageTime</ref><sp/>=<sp/>0;</highlight></codeline>
<codeline lineno="277"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="278"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="279"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="280"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="281"><highlight class="normal"><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="282"><highlight class="normal"></highlight></codeline>
<codeline lineno="283" refid="class_watch_server_1_1_c_watch_server_1a33f9e96b9e585598ef84457bc2efacb3" refkind="member"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordtype">void</highlight><highlight class="normal"><sp/><ref refid="class_watch_server_1_1_c_watch_server_1a33f9e96b9e585598ef84457bc2efacb3" kindref="member">CWatchServer::ShowConsoleTitle</ref>(</highlight><highlight class="keywordtype">int</highlight><highlight class="normal"><sp/>iDTime)</highlight></codeline>
<codeline lineno="284"><highlight class="normal"><sp/><sp/><sp/><sp/>{</highlight></codeline>
<codeline lineno="285"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordtype">int</highlight><highlight class="normal"><sp/>iCurViewPlayers<sp/>=<sp/><ref refid="class_watch_server_1_1_c_watch_server_1a8bc417bec0c22716c237d38d330df336" kindref="member">m_kAllConnect</ref>.size();</highlight></codeline>
<codeline lineno="286"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordtype">int</highlight><highlight class="normal"><sp/>iCurRaceNums<sp/>=<sp/><ref refid="namespace_watch_server_1a1ba085da8e82bcc688d64e20a5a48f5c" kindref="member">g_kRaceMgr</ref>.<ref refid="class_watch_server_1_1_c_se_race_mgr_1ab7fe94e17d88067a79caf234b30e471c" kindref="member">getAllRaceCounts</ref>();</highlight></codeline>
<codeline lineno="287"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordtype">char</highlight><highlight class="normal"><sp/>acString[128];</highlight></codeline>
<codeline lineno="288"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(<ref refid="class_watch_server_1_1_c_watch_server_1a3eb2bf017ad3579c36293ccd77faa7d6" kindref="member">m_kConfig</ref>.<ref refid="struct_watch_server_1_1_se_watch_config_1a1e7b8a2841fe92c37a11df68ed224511" kindref="member">bMgr</ref>)</highlight></codeline>
<codeline lineno="289"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>{</highlight></codeline>
<codeline lineno="290"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordtype">int</highlight><highlight class="normal"><sp/>iCurTotalViewRace<sp/>=<sp/><ref refid="namespace_watch_server_1ab985a30dbaa554391d708254872572c9" kindref="member">g_kWatchServerMgr</ref>.<ref refid="class_watch_server_1_1_c_watch_server_mgr_1a3e28c375bb8d1c109552f6e63b535f8d" kindref="member">getAllRaceCounts</ref>();</highlight></codeline>
<codeline lineno="291"><highlight class="normal"></highlight></codeline>
<codeline lineno="292"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="_se_server_tool_8cpp_1ad2735ec90511f0d6ec1535cf448709b8" kindref="member">SPrintf</ref>(acString,<sp/></highlight><highlight class="keyword">sizeof</highlight><highlight class="normal">(acString),<sp/></highlight><highlight class="stringliteral">&quot;WCS[%s]ViewPlayers[%d],<sp/>TotalViewRaceNum:[%d],<sp/>localViewRace:[%d]&quot;</highlight><highlight class="normal">,</highlight></codeline>
<codeline lineno="293"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="_se_tool_8h_1ada81d4ae5d39c42af0a02b45f4a6f715" kindref="member">GetID2Str</ref>(<ref refid="class_watch_server_1_1_c_watch_server_1a502c0b4d12916410078c3d72b20945d5" kindref="member">GetServerID</ref>()),<sp/>iCurViewPlayers,<sp/>iCurTotalViewRace,<sp/>iCurRaceNums);</highlight></codeline>
<codeline lineno="294"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="295"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">else</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="296"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>{</highlight></codeline>
<codeline lineno="297"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="_se_server_tool_8cpp_1ad2735ec90511f0d6ec1535cf448709b8" kindref="member">SPrintf</ref>(acString,<sp/></highlight><highlight class="keyword">sizeof</highlight><highlight class="normal">(acString),<sp/></highlight><highlight class="stringliteral">&quot;WCS[%s]ViewPlayers[%d],<sp/>localViewRace:[%d]&quot;</highlight><highlight class="normal">,</highlight></codeline>
<codeline lineno="298"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="_se_tool_8h_1ada81d4ae5d39c42af0a02b45f4a6f715" kindref="member">GetID2Str</ref>(<ref refid="class_watch_server_1_1_c_watch_server_1a502c0b4d12916410078c3d72b20945d5" kindref="member">GetServerID</ref>()),<sp/>iCurViewPlayers,<sp/>iCurRaceNums);</highlight></codeline>
<codeline lineno="299"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="300"><highlight class="normal"></highlight></codeline>
<codeline lineno="301"><highlight class="normal"></highlight><highlight class="preprocessor">#ifdef<sp/>_WIN32</highlight></codeline>
<codeline lineno="302"><highlight class="preprocessor"></highlight><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>SetConsoleTitle(acString);</highlight></codeline>
<codeline lineno="303"><highlight class="normal"></highlight><highlight class="preprocessor">#else</highlight></codeline>
<codeline lineno="304"><highlight class="preprocessor"></highlight><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">//SeLogInfo(&quot;%s&quot;,<sp/>acString);</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="305"><highlight class="normal"></highlight><highlight class="preprocessor">#endif</highlight></codeline>
<codeline lineno="306"><highlight class="preprocessor"></highlight><highlight class="normal"><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="307"><highlight class="normal"></highlight></codeline>
<codeline lineno="308" refid="class_watch_server_1_1_c_watch_server_1a2681f68b2ea6593ea98867598263936c" refkind="member"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordtype">void</highlight><highlight class="normal"><sp/><ref refid="class_watch_server_1_1_c_watch_server_1a2681f68b2ea6593ea98867598263936c" kindref="member">CWatchServer::SetWatchMgrServerReady</ref>(</highlight><highlight class="keywordtype">bool</highlight><highlight class="normal"><sp/>bReady)</highlight></codeline>
<codeline lineno="309"><highlight class="normal"><sp/><sp/><sp/><sp/>{</highlight></codeline>
<codeline lineno="310"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="class_watch_server_1_1_c_watch_server_1a42119a13b177d1ec84cbb131f2451cc7" kindref="member">m_bWCMSReady</ref><sp/>=<sp/>bReady;</highlight></codeline>
<codeline lineno="311"><highlight class="normal"><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="312"><highlight class="normal"></highlight></codeline>
<codeline lineno="313" refid="class_watch_server_1_1_c_watch_server_1a3f81d2f99e163949b943e7e437aa3251" refkind="member"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordtype">bool</highlight><highlight class="normal"><sp/><ref refid="class_watch_server_1_1_c_watch_server_1a3f81d2f99e163949b943e7e437aa3251" kindref="member">CWatchServer::IsWatchMgrServerReady</ref>()</highlight></codeline>
<codeline lineno="314"><highlight class="normal"><sp/><sp/><sp/><sp/>{</highlight></codeline>
<codeline lineno="315"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/><ref refid="class_watch_server_1_1_c_watch_server_1a3eb2bf017ad3579c36293ccd77faa7d6" kindref="member">m_kConfig</ref>.<ref refid="struct_watch_server_1_1_se_watch_config_1a1e7b8a2841fe92c37a11df68ed224511" kindref="member">bMgr</ref><sp/>||<sp/>(!<ref refid="class_watch_server_1_1_c_watch_server_1a105d719eca41577b0e28b84ce8c97239" kindref="member">m_vWcsMgrServerData</ref>.<ref refid="struct_se_server_data_1a2777bbfd27a6afe42ebd71c5d14010a0" kindref="member">kSock</ref>.IsInvalid()<sp/>&amp;&amp;<sp/><ref refid="class_watch_server_1_1_c_watch_server_1a105d719eca41577b0e28b84ce8c97239" kindref="member">m_vWcsMgrServerData</ref>.<ref refid="struct_se_server_data_1a4d91e2d15b4bc404ebc4ec42254ac770" kindref="member">bRegistered</ref>);</highlight></codeline>
<codeline lineno="316"><highlight class="normal"><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="317"><highlight class="normal"></highlight></codeline>
<codeline lineno="318" refid="class_watch_server_1_1_c_watch_server_1a000f261be454b12d610b835f6e703a0c" refkind="member"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordtype">void</highlight><highlight class="normal"><sp/><ref refid="class_watch_server_1_1_c_watch_server_1a000f261be454b12d610b835f6e703a0c" kindref="member">CWatchServer::CheckConnect</ref>()</highlight></codeline>
<codeline lineno="319"><highlight class="normal"><sp/><sp/><sp/><sp/>{</highlight></codeline>
<codeline lineno="320"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keyword">static</highlight><highlight class="normal"><sp/>DWord<sp/>s_dwPreTime<sp/>=<sp/><ref refid="class_watch_server_1_1_c_watch_server_1a9bc827b6b1bf525952a8f637ec4b5233" kindref="member">m_dwCurTime</ref>;</highlight></codeline>
<codeline lineno="321"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordtype">int</highlight><highlight class="normal"><sp/>iDeltaTime<sp/>=<sp/>(int)(<ref refid="class_watch_server_1_1_c_watch_server_1a9bc827b6b1bf525952a8f637ec4b5233" kindref="member">m_dwCurTime</ref><sp/>-<sp/>s_dwPreTime);</highlight></codeline>
<codeline lineno="322"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(iDeltaTime<sp/>&gt;=<sp/>2000<sp/>||<sp/>iDeltaTime<sp/>&lt;<sp/>0)</highlight></codeline>
<codeline lineno="323"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>{</highlight></codeline>
<codeline lineno="324"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>s_dwPreTime<sp/>=<sp/><ref refid="class_watch_server_1_1_c_watch_server_1a9bc827b6b1bf525952a8f637ec4b5233" kindref="member">m_dwCurTime</ref>;</highlight></codeline>
<codeline lineno="325"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">for</highlight><highlight class="normal"><sp/>(MapAllConnect::iterator<sp/>itr<sp/>=<sp/><ref refid="class_watch_server_1_1_c_watch_server_1a8bc417bec0c22716c237d38d330df336" kindref="member">m_kAllConnect</ref>.begin();<sp/>itr<sp/>!=<sp/><ref refid="class_watch_server_1_1_c_watch_server_1a8bc417bec0c22716c237d38d330df336" kindref="member">m_kAllConnect</ref>.end();<sp/>++itr)</highlight></codeline>
<codeline lineno="326"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>{</highlight></codeline>
<codeline lineno="327"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="struct_watch_server_1_1_se_connect" kindref="compound">SeConnect</ref>*<sp/>pkConnect<sp/>=<sp/>itr-&gt;second;</highlight></codeline>
<codeline lineno="328"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(pkConnect-&gt;<ref refid="struct_watch_server_1_1_se_connect_1a5e5573136bf789fb821c756b2001d0e3" kindref="member">eState</ref><sp/>==<sp/><ref refid="namespace_watch_server_1ac4644e31ad5820d1529141feef0eed7aae9411688d92f7749ae30426d7901f913" kindref="member">SCS_UNKOWN</ref>)</highlight></codeline>
<codeline lineno="329"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>{</highlight></codeline>
<codeline lineno="330"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">//<sp/>15</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="331"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordtype">int</highlight><highlight class="normal"><sp/>iContinueTime<sp/>=<sp/>(int)(<ref refid="class_watch_server_1_1_c_watch_server_1a9bc827b6b1bf525952a8f637ec4b5233" kindref="member">m_dwCurTime</ref><sp/>-<sp/>pkConnect-&gt;<ref refid="struct_watch_server_1_1_se_connect_1a37b3882bb4d905834147a67ec1903e27" kindref="member">dwStateTime</ref>);</highlight></codeline>
<codeline lineno="332"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(iContinueTime<sp/>&gt;=<sp/>15<sp/>*<sp/>1000<sp/>||<sp/>iContinueTime<sp/>&lt;<sp/>0)</highlight></codeline>
<codeline lineno="333"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>{</highlight></codeline>
<codeline lineno="334"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="class_watch_server_1_1_c_watch_server_1a9aa90e76d701e864f90b995e12e05dc4" kindref="member">DisconnectPlayer</ref>(pkConnect);</highlight></codeline>
<codeline lineno="335"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="336"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="337"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">else</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="338"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>{</highlight></codeline>
<codeline lineno="339"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">//<sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>//<sp/>60</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="340"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">//<sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>int<sp/>iContinueTime<sp/>=<sp/>(int)(m_dwCurTime<sp/>-<sp/>pkConnect-&gt;dwLastRecvTime);</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="341"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">//<sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>if<sp/>(iContinueTime<sp/>&gt;=<sp/>60<sp/>*<sp/>1000)</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="342"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">//<sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>{</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="343"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">//<sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>SeLogError(&quot;WCS<sp/>id[%s]Ply[%u]<sp/>heartbeat<sp/>over<sp/>60s,disconnect!&quot;,<sp/>GetID2Str(GetServerID()),<sp/>pkConnect-&gt;dwPlayerID);</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="344"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">//<sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>DisconnectPlayer(pkConnect);</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="345"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">//<sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>}</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="346"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="347"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="348"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="349"><highlight class="normal"><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="350"><highlight class="normal"></highlight></codeline>
<codeline lineno="351" refid="class_watch_server_1_1_c_watch_server_1a02d324973f10d692522b461a7004be78" refkind="member"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordtype">bool</highlight><highlight class="normal"><sp/><ref refid="class_watch_server_1_1_c_watch_server_1a02d324973f10d692522b461a7004be78" kindref="member">CWatchServer::LoadConfig</ref>(</highlight><highlight class="keyword">const</highlight><highlight class="normal"><sp/></highlight><highlight class="keywordtype">char</highlight><highlight class="normal">*<sp/>pcFile)</highlight></codeline>
<codeline lineno="352"><highlight class="normal"><sp/><sp/><sp/><sp/>{</highlight></codeline>
<codeline lineno="353"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">//<sp/></highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="354"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="class_se_config" kindref="compound">SeConfig</ref><sp/>kConfig;</highlight></codeline>
<codeline lineno="355"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(!kConfig.<ref refid="class_se_config_1a077cfce8454c31d293c2d2341980ffca" kindref="member">Load</ref>(pcFile))</highlight></codeline>
<codeline lineno="356"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>{</highlight></codeline>
<codeline lineno="357"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="_se_file_log_8h_1a59fe2018c00666084724bec1365b41f5" kindref="member">SeLogError</ref>(</highlight><highlight class="stringliteral">&quot;Loading<sp/>config<sp/>file<sp/>failed:<sp/>%s&quot;</highlight><highlight class="normal">,<sp/>pcFile);</highlight></codeline>
<codeline lineno="358"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/></highlight><highlight class="keyword">false</highlight><highlight class="normal">;</highlight></codeline>
<codeline lineno="359"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="360"><highlight class="normal"></highlight></codeline>
<codeline lineno="361"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">//<sp/></highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="362"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keyword">const</highlight><highlight class="normal"><sp/></highlight><highlight class="keywordtype">char</highlight><highlight class="normal">*<sp/>pcValue<sp/>=<sp/>kConfig.<ref refid="class_se_config_1a8839d0f5e6b831b66fd018826a304086" kindref="member">GetValue</ref>(</highlight><highlight class="stringliteral">&quot;RecordPath&quot;</highlight><highlight class="normal">);</highlight></codeline>
<codeline lineno="363"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(!pcValue)</highlight></codeline>
<codeline lineno="364"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>{</highlight></codeline>
<codeline lineno="365"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="_se_file_log_8h_1a59fe2018c00666084724bec1365b41f5" kindref="member">SeLogError</ref>(</highlight><highlight class="stringliteral">&quot;Loading<sp/>config<sp/>file<sp/>failed:<sp/>%s[RecordPath]&quot;</highlight><highlight class="normal">,<sp/>pcFile);</highlight></codeline>
<codeline lineno="366"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/></highlight><highlight class="keyword">false</highlight><highlight class="normal">;</highlight></codeline>
<codeline lineno="367"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="368"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">else</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="369"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>{</highlight></codeline>
<codeline lineno="370"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="_se_tool_8cpp_1a4d30fbe56257fc998ebc1346e53be0d8" kindref="member">StrCpy</ref>(<ref refid="class_watch_server_1_1_c_watch_server_1a3eb2bf017ad3579c36293ccd77faa7d6" kindref="member">m_kConfig</ref>.<ref refid="struct_watch_server_1_1_se_watch_config_1a8f69980b974838e64e22525425919fe9" kindref="member">acGameRecordFilePath</ref>,<sp/></highlight><highlight class="keyword">sizeof</highlight><highlight class="normal">(<ref refid="class_watch_server_1_1_c_watch_server_1a3eb2bf017ad3579c36293ccd77faa7d6" kindref="member">m_kConfig</ref>.<ref refid="struct_watch_server_1_1_se_watch_config_1a8f69980b974838e64e22525425919fe9" kindref="member">acGameRecordFilePath</ref>),<sp/>pcValue);</highlight></codeline>
<codeline lineno="371"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="372"><highlight class="normal"></highlight></codeline>
<codeline lineno="373"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>pcValue<sp/>=<sp/>kConfig.<ref refid="class_se_config_1a8839d0f5e6b831b66fd018826a304086" kindref="member">GetValue</ref>(</highlight><highlight class="stringliteral">&quot;ServerID&quot;</highlight><highlight class="normal">);</highlight></codeline>
<codeline lineno="374"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(!pcValue)</highlight></codeline>
<codeline lineno="375"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>{</highlight></codeline>
<codeline lineno="376"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="_se_file_log_8h_1a59fe2018c00666084724bec1365b41f5" kindref="member">SeLogError</ref>(</highlight><highlight class="stringliteral">&quot;Loading<sp/>config<sp/>file<sp/>failed:<sp/>%s[ServerID]&quot;</highlight><highlight class="normal">,<sp/>pcFile);</highlight></codeline>
<codeline lineno="377"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/></highlight><highlight class="keyword">false</highlight><highlight class="normal">;</highlight></codeline>
<codeline lineno="378"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="379"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">else</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="380"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>{</highlight></codeline>
<codeline lineno="381"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="class_watch_server_1_1_c_watch_server_1a3eb2bf017ad3579c36293ccd77faa7d6" kindref="member">m_kConfig</ref>.<ref refid="struct_watch_server_1_1_se_watch_config_1ac34ee6b0fb440f10d01713802df623d7" kindref="member">dwServerID</ref><sp/>=<sp/><ref refid="_se_tool_8cpp_1a03bcc77ad4ef4845b20fc5cf4db96834" kindref="member">GetStr2ID</ref>(pcValue);</highlight></codeline>
<codeline lineno="382"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="383"><highlight class="normal"></highlight></codeline>
<codeline lineno="384"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="struct_se_net_addr" kindref="compound">SeNetAddr</ref>*<sp/>pkAddr<sp/>=<sp/>kConfig.<ref refid="class_se_config_1a0bd6ce789230fc24e8e09674c0265d5d" kindref="member">GetNetAddr</ref>(</highlight><highlight class="stringliteral">&quot;LocalServer&quot;</highlight><highlight class="normal">);</highlight></codeline>
<codeline lineno="385"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(pkAddr)</highlight></codeline>
<codeline lineno="386"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>{</highlight></codeline>
<codeline lineno="387"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="class_watch_server_1_1_c_watch_server_1a3eb2bf017ad3579c36293ccd77faa7d6" kindref="member">m_kConfig</ref>.<ref refid="struct_watch_server_1_1_se_watch_config_1a9d0f1e67a7bb863204d9d740cf6a0661" kindref="member">kLocalServer</ref><sp/>=<sp/>*pkAddr;</highlight></codeline>
<codeline lineno="388"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="389"><highlight class="normal"></highlight></codeline>
<codeline lineno="390"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">//addr<sp/>to<sp/>player</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="391"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>pkAddr<sp/>=<sp/>kConfig.<ref refid="class_se_config_1a0bd6ce789230fc24e8e09674c0265d5d" kindref="member">GetNetAddr</ref>(</highlight><highlight class="stringliteral">&quot;Addr2Player&quot;</highlight><highlight class="normal">);</highlight></codeline>
<codeline lineno="392"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(!pkAddr)</highlight></codeline>
<codeline lineno="393"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>{</highlight></codeline>
<codeline lineno="394"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="_se_file_log_8h_1a59fe2018c00666084724bec1365b41f5" kindref="member">SeLogError</ref>(</highlight><highlight class="stringliteral">&quot;Loading<sp/>config<sp/>file<sp/>failed:<sp/>%s[Addr2Player]&quot;</highlight><highlight class="normal">,<sp/>pcFile);</highlight></codeline>
<codeline lineno="395"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/></highlight><highlight class="keyword">false</highlight><highlight class="normal">;</highlight></codeline>
<codeline lineno="396"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="397"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="class_watch_server_1_1_c_watch_server_1a3eb2bf017ad3579c36293ccd77faa7d6" kindref="member">m_kConfig</ref>.<ref refid="struct_watch_server_1_1_se_watch_config_1a129f8e65f0f91128ee0695137cc4f479" kindref="member">kAddrToPlayer</ref><sp/>=<sp/>*pkAddr;</highlight></codeline>
<codeline lineno="398"><highlight class="normal"></highlight></codeline>
<codeline lineno="399"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">//</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="400"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>pkAddr<sp/>=<sp/>kConfig.<ref refid="class_se_config_1a0bd6ce789230fc24e8e09674c0265d5d" kindref="member">GetNetAddr</ref>(</highlight><highlight class="stringliteral">&quot;MasterServer&quot;</highlight><highlight class="normal">);</highlight></codeline>
<codeline lineno="401"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(pkAddr)</highlight></codeline>
<codeline lineno="402"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>{</highlight></codeline>
<codeline lineno="403"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="class_watch_server_1_1_c_watch_server_1a3eb2bf017ad3579c36293ccd77faa7d6" kindref="member">m_kConfig</ref>.<ref refid="struct_watch_server_1_1_se_watch_config_1a646452a8e07717b00ba50edd3f8138ed" kindref="member">kMasterServer</ref><sp/>=<sp/>*pkAddr;</highlight></codeline>
<codeline lineno="404"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="class_watch_server_1_1_c_watch_server_1a3eb2bf017ad3579c36293ccd77faa7d6" kindref="member">m_kConfig</ref>.<ref refid="struct_watch_server_1_1_se_watch_config_1a549b05ef44a45e8345fcfafd34ca86bf" kindref="member">bSlave</ref><sp/>=<sp/></highlight><highlight class="keyword">true</highlight><highlight class="normal">;</highlight></codeline>
<codeline lineno="405"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="406"><highlight class="normal"></highlight></codeline>
<codeline lineno="407"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">//</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="408"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>pkAddr<sp/>=<sp/>kConfig.<ref refid="class_se_config_1a0bd6ce789230fc24e8e09674c0265d5d" kindref="member">GetNetAddr</ref>(</highlight><highlight class="stringliteral">&quot;WatchMgrServer&quot;</highlight><highlight class="normal">);</highlight></codeline>
<codeline lineno="409"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(pkAddr)</highlight></codeline>
<codeline lineno="410"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>{</highlight></codeline>
<codeline lineno="411"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="class_watch_server_1_1_c_watch_server_1a3eb2bf017ad3579c36293ccd77faa7d6" kindref="member">m_kConfig</ref>.<ref refid="struct_watch_server_1_1_se_watch_config_1ae8f27d9f748f36bc397261581756ac10" kindref="member">kWatchMgrServer</ref><sp/>=<sp/>*pkAddr;</highlight></codeline>
<codeline lineno="412"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="413"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">else</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="414"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>{</highlight></codeline>
<codeline lineno="415"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="class_watch_server_1_1_c_watch_server_1a3eb2bf017ad3579c36293ccd77faa7d6" kindref="member">m_kConfig</ref>.<ref refid="struct_watch_server_1_1_se_watch_config_1a1e7b8a2841fe92c37a11df68ed224511" kindref="member">bMgr</ref><sp/>=<sp/></highlight><highlight class="keyword">true</highlight><highlight class="normal">;</highlight></codeline>
<codeline lineno="416"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="417"><highlight class="normal"></highlight></codeline>
<codeline lineno="418"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>pcValue<sp/>=<sp/>kConfig.<ref refid="class_se_config_1a8839d0f5e6b831b66fd018826a304086" kindref="member">GetValue</ref>(</highlight><highlight class="stringliteral">&quot;RaceNum&quot;</highlight><highlight class="normal">);</highlight></codeline>
<codeline lineno="419"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(pcValue)</highlight></codeline>
<codeline lineno="420"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>{</highlight></codeline>
<codeline lineno="421"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordtype">int</highlight><highlight class="normal"><sp/>iNum<sp/>=<sp/>atoi(pcValue);</highlight></codeline>
<codeline lineno="422"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordtype">char</highlight><highlight class="normal"><sp/>rsKey[1024];</highlight></codeline>
<codeline lineno="423"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">for</highlight><highlight class="normal"><sp/>(</highlight><highlight class="keywordtype">int</highlight><highlight class="normal"><sp/>ii<sp/>=<sp/>1;<sp/>ii<sp/>&lt;=<sp/>iNum;<sp/>++ii)</highlight></codeline>
<codeline lineno="424"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>{</highlight></codeline>
<codeline lineno="425"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>sprintf(rsKey,<sp/></highlight><highlight class="stringliteral">&quot;rsAddr_%d&quot;</highlight><highlight class="normal">,<sp/>ii);</highlight></codeline>
<codeline lineno="426"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>pkAddr<sp/>=<sp/>kConfig.<ref refid="class_se_config_1a0bd6ce789230fc24e8e09674c0265d5d" kindref="member">GetNetAddr</ref>(rsKey);</highlight></codeline>
<codeline lineno="427"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(pkAddr)</highlight></codeline>
<codeline lineno="428"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>{</highlight></codeline>
<codeline lineno="429"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="class_watch_server_1_1_c_watch_server_1a3eb2bf017ad3579c36293ccd77faa7d6" kindref="member">m_kConfig</ref>.<ref refid="struct_watch_server_1_1_se_watch_config_1a7b543072c4adc05748e49293d19808d4" kindref="member">vAddrRS</ref>.push_back(*pkAddr);</highlight></codeline>
<codeline lineno="430"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="431"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="432"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="433"><highlight class="normal"></highlight></codeline>
<codeline lineno="434"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>pcValue<sp/>=<sp/>kConfig.<ref refid="class_se_config_1a8839d0f5e6b831b66fd018826a304086" kindref="member">GetValue</ref>(</highlight><highlight class="stringliteral">&quot;ViewListNum&quot;</highlight><highlight class="normal">);</highlight></codeline>
<codeline lineno="435"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(!pcValue)</highlight></codeline>
<codeline lineno="436"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>{</highlight></codeline>
<codeline lineno="437"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="class_watch_server_1_1_c_watch_server_1a3eb2bf017ad3579c36293ccd77faa7d6" kindref="member">m_kConfig</ref>.<ref refid="struct_watch_server_1_1_se_watch_config_1afb565d3f4e87988d0592e2332dc53e32" kindref="member">dwViewListNum</ref><sp/>=<sp/>5;</highlight></codeline>
<codeline lineno="438"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="439"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">else</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="440"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>{</highlight></codeline>
<codeline lineno="441"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="class_watch_server_1_1_c_watch_server_1a3eb2bf017ad3579c36293ccd77faa7d6" kindref="member">m_kConfig</ref>.<ref refid="struct_watch_server_1_1_se_watch_config_1afb565d3f4e87988d0592e2332dc53e32" kindref="member">dwViewListNum</ref><sp/>=<sp/>atoi(pcValue);</highlight></codeline>
<codeline lineno="442"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="443"><highlight class="normal"></highlight></codeline>
<codeline lineno="444"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>pcValue<sp/>=<sp/>kConfig.<ref refid="class_se_config_1a8839d0f5e6b831b66fd018826a304086" kindref="member">GetValue</ref>(</highlight><highlight class="stringliteral">&quot;DebugLevel&quot;</highlight><highlight class="normal">);</highlight></codeline>
<codeline lineno="445"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(!pcValue)</highlight></codeline>
<codeline lineno="446"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>{</highlight></codeline>
<codeline lineno="447"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="class_watch_server_1_1_c_watch_server_1a3eb2bf017ad3579c36293ccd77faa7d6" kindref="member">m_kConfig</ref>.<ref refid="struct_watch_server_1_1_se_watch_config_1a2051618afc5b94d9ca99c81273caccb1" kindref="member">iDebugLevel</ref><sp/>=<sp/>0;</highlight></codeline>
<codeline lineno="448"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="449"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">else</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="450"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>{</highlight></codeline>
<codeline lineno="451"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="class_watch_server_1_1_c_watch_server_1a3eb2bf017ad3579c36293ccd77faa7d6" kindref="member">m_kConfig</ref>.<ref refid="struct_watch_server_1_1_se_watch_config_1a2051618afc5b94d9ca99c81273caccb1" kindref="member">iDebugLevel</ref><sp/>=<sp/>atoi(pcValue);</highlight></codeline>
<codeline lineno="452"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="453"><highlight class="normal"></highlight></codeline>
<codeline lineno="454"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/></highlight><highlight class="keyword">true</highlight><highlight class="normal">;</highlight></codeline>
<codeline lineno="455"><highlight class="normal"><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="456"><highlight class="normal"></highlight></codeline>
<codeline lineno="457" refid="class_watch_server_1_1_c_watch_server_1a4f20c63ea79d05ad3b6f532d887fb091" refkind="member"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordtype">bool</highlight><highlight class="normal"><sp/><ref refid="class_watch_server_1_1_c_watch_server_1a4f20c63ea79d05ad3b6f532d887fb091" kindref="member">CWatchServer::InitializeNet</ref>(</highlight><highlight class="keywordtype">void</highlight><highlight class="normal">)</highlight></codeline>
<codeline lineno="458"><highlight class="normal"><sp/><sp/><sp/><sp/>{</highlight></codeline>
<codeline lineno="459"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(!<ref refid="class_watch_server_1_1_c_watch_server_1a3dc54fcd755ce4e21f181aa6f4d91b4d" kindref="member">m_kNetMgr</ref>.Initialize(</highlight><highlight class="keyword">this</highlight><highlight class="normal">,<sp/>8))</highlight></codeline>
<codeline lineno="460"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>{</highlight></codeline>
<codeline lineno="461"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="_se_file_log_8h_1a59fe2018c00666084724bec1365b41f5" kindref="member">SeLogError</ref>(</highlight><highlight class="stringliteral">&quot;Initialize<sp/>net<sp/>failed&quot;</highlight><highlight class="normal">,<sp/>1);</highlight></codeline>
<codeline lineno="462"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/></highlight><highlight class="keyword">false</highlight><highlight class="normal">;</highlight></codeline>
<codeline lineno="463"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="464"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="_se_file_log_8h_1a83f3fe470b91cb8eed8762cc8e5e26c3" kindref="member">SeLogInfo</ref>(</highlight><highlight class="stringliteral">&quot;Initialize<sp/>net<sp/>successfully&quot;</highlight><highlight class="normal">,<sp/>1);</highlight></codeline>
<codeline lineno="465"><highlight class="normal"></highlight></codeline>
<codeline lineno="466"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>{</highlight></codeline>
<codeline lineno="467"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(!<ref refid="class_watch_server_1_1_c_watch_server_1a3dc54fcd755ce4e21f181aa6f4d91b4d" kindref="member">m_kNetMgr</ref>.Listen(<ref refid="class_watch_server_1_1_c_watch_server_1a3eb2bf017ad3579c36293ccd77faa7d6" kindref="member">m_kConfig</ref>.<ref refid="struct_watch_server_1_1_se_watch_config_1a129f8e65f0f91128ee0695137cc4f479" kindref="member">kAddrToPlayer</ref>.<ref refid="struct_se_net_addr_1a989fa5b025bc039122e8d2a29838fde9" kindref="member">iPort</ref>,<sp/>128,<sp/><ref refid="_se_server_define_8h_1a69ab2b2845a7518bddd912889d3d4811" kindref="member">CLIENT_BUFFER_SIZE</ref>,<sp/>TSF_16BIT_WIN<sp/>|<sp/>TSF_NO_DELAY))</highlight></codeline>
<codeline lineno="468"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>{</highlight></codeline>
<codeline lineno="469"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="_se_file_log_8h_1a59fe2018c00666084724bec1365b41f5" kindref="member">SeLogError</ref>(</highlight><highlight class="stringliteral">&quot;Initialize<sp/>player<sp/>tcp<sp/>port<sp/>failed:[%s:%d]&quot;</highlight><highlight class="normal">,<sp/><ref refid="class_watch_server_1_1_c_watch_server_1a3eb2bf017ad3579c36293ccd77faa7d6" kindref="member">m_kConfig</ref>.<ref refid="struct_watch_server_1_1_se_watch_config_1a129f8e65f0f91128ee0695137cc4f479" kindref="member">kAddrToPlayer</ref>.<ref refid="struct_se_net_addr_1a23b51e87d8b7b2201a03833c9adde232" kindref="member">acIP</ref>,<sp/><ref refid="class_watch_server_1_1_c_watch_server_1a3eb2bf017ad3579c36293ccd77faa7d6" kindref="member">m_kConfig</ref>.<ref refid="struct_watch_server_1_1_se_watch_config_1a129f8e65f0f91128ee0695137cc4f479" kindref="member">kAddrToPlayer</ref>.<ref refid="struct_se_net_addr_1a989fa5b025bc039122e8d2a29838fde9" kindref="member">iPort</ref>);</highlight></codeline>
<codeline lineno="470"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/></highlight><highlight class="keyword">false</highlight><highlight class="normal">;</highlight></codeline>
<codeline lineno="471"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="472"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="_se_file_log_8h_1a83f3fe470b91cb8eed8762cc8e5e26c3" kindref="member">SeLogInfo</ref>(</highlight><highlight class="stringliteral">&quot;Initialize<sp/>player<sp/>tcp<sp/>port<sp/>successfully:[%s:%d]&quot;</highlight><highlight class="normal">,<sp/><ref refid="class_watch_server_1_1_c_watch_server_1a3eb2bf017ad3579c36293ccd77faa7d6" kindref="member">m_kConfig</ref>.<ref refid="struct_watch_server_1_1_se_watch_config_1a129f8e65f0f91128ee0695137cc4f479" kindref="member">kAddrToPlayer</ref>.<ref refid="struct_se_net_addr_1a23b51e87d8b7b2201a03833c9adde232" kindref="member">acIP</ref>,<sp/><ref refid="class_watch_server_1_1_c_watch_server_1a3eb2bf017ad3579c36293ccd77faa7d6" kindref="member">m_kConfig</ref>.<ref refid="struct_watch_server_1_1_se_watch_config_1a129f8e65f0f91128ee0695137cc4f479" kindref="member">kAddrToPlayer</ref>.<ref refid="struct_se_net_addr_1a989fa5b025bc039122e8d2a29838fde9" kindref="member">iPort</ref>);</highlight></codeline>
<codeline lineno="473"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="474"><highlight class="normal"></highlight></codeline>
<codeline lineno="475"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(<ref refid="class_watch_server_1_1_c_watch_server_1a3eb2bf017ad3579c36293ccd77faa7d6" kindref="member">m_kConfig</ref>.<ref refid="struct_watch_server_1_1_se_watch_config_1a9d0f1e67a7bb863204d9d740cf6a0661" kindref="member">kLocalServer</ref>.<ref refid="struct_se_net_addr_1a989fa5b025bc039122e8d2a29838fde9" kindref="member">iPort</ref><sp/>&gt;<sp/>0)</highlight></codeline>
<codeline lineno="476"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>{</highlight></codeline>
<codeline lineno="477"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(!<ref refid="class_watch_server_1_1_c_watch_server_1a3dc54fcd755ce4e21f181aa6f4d91b4d" kindref="member">m_kNetMgr</ref>.Listen(<ref refid="class_watch_server_1_1_c_watch_server_1a3eb2bf017ad3579c36293ccd77faa7d6" kindref="member">m_kConfig</ref>.<ref refid="struct_watch_server_1_1_se_watch_config_1a9d0f1e67a7bb863204d9d740cf6a0661" kindref="member">kLocalServer</ref>.<ref refid="struct_se_net_addr_1a989fa5b025bc039122e8d2a29838fde9" kindref="member">iPort</ref>,<sp/>8,<sp/><ref refid="_se_server_define_8h_1a141dc49d73e6790790a053c29623f606" kindref="member">SERVER_BUFFER_SIZE</ref>))</highlight></codeline>
<codeline lineno="478"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>{</highlight></codeline>
<codeline lineno="479"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="_se_file_log_8h_1a59fe2018c00666084724bec1365b41f5" kindref="member">SeLogError</ref>(</highlight><highlight class="stringliteral">&quot;Initialize<sp/>MgrServer<sp/>tcp<sp/>port<sp/>failed:[%s:%d]&quot;</highlight><highlight class="normal">,<sp/><ref refid="class_watch_server_1_1_c_watch_server_1a3eb2bf017ad3579c36293ccd77faa7d6" kindref="member">m_kConfig</ref>.<ref refid="struct_watch_server_1_1_se_watch_config_1a9d0f1e67a7bb863204d9d740cf6a0661" kindref="member">kLocalServer</ref>.<ref refid="struct_se_net_addr_1a23b51e87d8b7b2201a03833c9adde232" kindref="member">acIP</ref>,<sp/><ref refid="class_watch_server_1_1_c_watch_server_1a3eb2bf017ad3579c36293ccd77faa7d6" kindref="member">m_kConfig</ref>.<ref refid="struct_watch_server_1_1_se_watch_config_1a9d0f1e67a7bb863204d9d740cf6a0661" kindref="member">kLocalServer</ref>.<ref refid="struct_se_net_addr_1a989fa5b025bc039122e8d2a29838fde9" kindref="member">iPort</ref>);</highlight></codeline>
<codeline lineno="480"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/></highlight><highlight class="keyword">false</highlight><highlight class="normal">;</highlight></codeline>
<codeline lineno="481"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="482"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="_se_file_log_8h_1a83f3fe470b91cb8eed8762cc8e5e26c3" kindref="member">SeLogInfo</ref>(</highlight><highlight class="stringliteral">&quot;Initialize<sp/>MgrServer<sp/>tcp<sp/>port<sp/>successfully:[%s:%d]&quot;</highlight><highlight class="normal">,<sp/><ref refid="class_watch_server_1_1_c_watch_server_1a3eb2bf017ad3579c36293ccd77faa7d6" kindref="member">m_kConfig</ref>.<ref refid="struct_watch_server_1_1_se_watch_config_1a9d0f1e67a7bb863204d9d740cf6a0661" kindref="member">kLocalServer</ref>.<ref refid="struct_se_net_addr_1a23b51e87d8b7b2201a03833c9adde232" kindref="member">acIP</ref>,<sp/><ref refid="class_watch_server_1_1_c_watch_server_1a3eb2bf017ad3579c36293ccd77faa7d6" kindref="member">m_kConfig</ref>.<ref refid="struct_watch_server_1_1_se_watch_config_1a9d0f1e67a7bb863204d9d740cf6a0661" kindref="member">kLocalServer</ref>.<ref refid="struct_se_net_addr_1a989fa5b025bc039122e8d2a29838fde9" kindref="member">iPort</ref>);</highlight></codeline>
<codeline lineno="483"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="484"><highlight class="normal"></highlight></codeline>
<codeline lineno="485"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">//<sp/><sp/><sp/><sp/><sp/><sp/>if<sp/>(m_kConfig.bSlave)</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="486"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">//<sp/><sp/><sp/><sp/><sp/><sp/>{</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="487"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">//<sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>SeLogInfo(&quot;Initialize<sp/>net<sp/>with<sp/>Slave&quot;,<sp/>1);</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="488"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">//<sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>return<sp/>true;</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="489"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">//<sp/><sp/><sp/><sp/><sp/><sp/>}</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="490"><highlight class="normal"></highlight></codeline>
<codeline lineno="491"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">//<sp/><sp/><sp/><sp/><sp/><sp/>if<sp/>(!m_kConfig.bSlave<sp/>&amp;&amp;<sp/>m_kConfig.kMasterServer.iPort<sp/>&gt;<sp/>0)</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="492"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">//<sp/><sp/><sp/><sp/><sp/><sp/>{</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="493"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">//<sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>if<sp/>(!m_kNetMgr.Listen(m_kConfig.kMasterServer.iPort,<sp/>8,<sp/>1<sp/>*<sp/>1024<sp/>*<sp/>1024))</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="494"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">//<sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>{</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="495"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">//<sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>SeLogError(&quot;Initialize<sp/>masterServer<sp/>tcp<sp/>port<sp/>failed:[%s:%d]&quot;,<sp/>m_kConfig.kMasterServer.acIP,<sp/>m_kConfig.kMasterServer.iPort);</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="496"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">//<sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>return<sp/>false;</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="497"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">//<sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>}</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="498"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">//<sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>SeLogInfo(&quot;Initialize<sp/>masterServer<sp/>tcp<sp/>port<sp/>successfully:[%s:%d]&quot;,<sp/>m_kConfig.kMasterServer.acIP,<sp/>m_kConfig.kMasterServer.iPort);</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="499"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">//<sp/><sp/><sp/><sp/><sp/><sp/>}</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="500"><highlight class="normal"></highlight></codeline>
<codeline lineno="501"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">//<sp/>NexusServer<sp/>Connect</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="502"><highlight class="normal"></highlight></codeline>
<codeline lineno="503"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(!<ref refid="_se_virt_conn_mgr_8cpp_1aa8e9d5beed961f4e26b9cadd49603980" kindref="member">g_kVirtConnMgr</ref>.<ref refid="class_se_virt_conn_mgr_1a6982c2146c5829aa21e4f2bd5487a3d4" kindref="member">Initialize</ref>(&amp;<ref refid="class_watch_server_1_1_c_watch_server_1a3dc54fcd755ce4e21f181aa6f4d91b4d" kindref="member">m_kNetMgr</ref>,<sp/>(</highlight><highlight class="keywordtype">void</highlight><highlight class="normal">*)<ref refid="_watch_server_8cpp_1a03595bfee2a55045aa751deab1e562d0" kindref="member">sendRegPack</ref>,<sp/>(</highlight><highlight class="keywordtype">void</highlight><highlight class="normal">*)<ref refid="_watch_server_8cpp_1a1829928f14924b8a97ed00808758de08" kindref="member">sendHeartPack</ref>))</highlight></codeline>
<codeline lineno="504"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>{</highlight></codeline>
<codeline lineno="505"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="_se_file_log_8h_1a59fe2018c00666084724bec1365b41f5" kindref="member">SeLogError</ref>(</highlight><highlight class="stringliteral">&quot;Init<sp/>VirtConnMgr<sp/>Failed&quot;</highlight><highlight class="normal">,<sp/>1);</highlight></codeline>
<codeline lineno="506"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/></highlight><highlight class="keyword">false</highlight><highlight class="normal">;</highlight></codeline>
<codeline lineno="507"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="508"><highlight class="normal"></highlight></codeline>
<codeline lineno="509"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="class_se_config" kindref="compound">SeConfig</ref><sp/>kConfig;</highlight></codeline>
<codeline lineno="510"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordtype">char</highlight><highlight class="normal"><sp/>*<sp/>pcFile<sp/>=<sp/></highlight><highlight class="stringliteral">&quot;./Data/WatchServer.ini&quot;</highlight><highlight class="normal">;</highlight></codeline>
<codeline lineno="511"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(!kConfig.<ref refid="class_se_config_1a077cfce8454c31d293c2d2341980ffca" kindref="member">Load</ref>(pcFile))</highlight></codeline>
<codeline lineno="512"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>{</highlight></codeline>
<codeline lineno="513"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="_se_file_log_8h_1a59fe2018c00666084724bec1365b41f5" kindref="member">SeLogError</ref>(</highlight><highlight class="stringliteral">&quot;Loading<sp/>config<sp/>file<sp/>failed:<sp/>%s&quot;</highlight><highlight class="normal">,<sp/>pcFile);</highlight></codeline>
<codeline lineno="514"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/></highlight><highlight class="keyword">false</highlight><highlight class="normal">;</highlight></codeline>
<codeline lineno="515"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="516"><highlight class="normal"></highlight></codeline>
<codeline lineno="517"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="struct_se_net_addr" kindref="compound">SeNetAddr</ref><sp/>*<sp/>pkAddr<sp/>=<sp/>kConfig.<ref refid="class_se_config_1a0bd6ce789230fc24e8e09674c0265d5d" kindref="member">GetNetAddr</ref>(</highlight><highlight class="stringliteral">&quot;NexusServer&quot;</highlight><highlight class="normal">);</highlight></codeline>
<codeline lineno="518"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(!pkAddr)</highlight></codeline>
<codeline lineno="519"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>{</highlight></codeline>
<codeline lineno="520"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="_se_file_log_8h_1a59fe2018c00666084724bec1365b41f5" kindref="member">SeLogError</ref>(</highlight><highlight class="stringliteral">&quot;Loading<sp/>config<sp/>file<sp/>failed:<sp/>%s[NexusServer]&quot;</highlight><highlight class="normal">,<sp/>pcFile);</highlight></codeline>
<codeline lineno="521"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/></highlight><highlight class="keyword">false</highlight><highlight class="normal">;</highlight></codeline>
<codeline lineno="522"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="523"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="class_watch_server_1_1_c_watch_server_1ab230b0e57fd9eb328c6e5ce60a09fbcc" kindref="member">m_pkNSConn</ref><sp/>=<sp/><ref refid="_se_virt_conn_mgr_8cpp_1aa8e9d5beed961f4e26b9cadd49603980" kindref="member">g_kVirtConnMgr</ref>.<ref refid="class_se_virt_conn_mgr_1a42fa65f9815b4e6876a92d0648d7619c" kindref="member">AddServerConn</ref>(<ref refid="_se_ptl_define_8h_1aefb47f3959b8be9e164448819e4bb7f9a8accedddcf1ed16f589b79e3f5d7e91b" kindref="member">SSI_NS</ref>,<sp/>*pkAddr,<sp/>2<sp/>*<sp/>1024<sp/>*<sp/>1024);</highlight></codeline>
<codeline lineno="524"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(!<ref refid="class_watch_server_1_1_c_watch_server_1ab230b0e57fd9eb328c6e5ce60a09fbcc" kindref="member">m_pkNSConn</ref>)</highlight></codeline>
<codeline lineno="525"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>{</highlight></codeline>
<codeline lineno="526"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="_se_file_log_8h_1a59fe2018c00666084724bec1365b41f5" kindref="member">SeLogError</ref>(</highlight><highlight class="stringliteral">&quot;Loading<sp/>config<sp/>file<sp/>failed:<sp/>%s[NexusServer]&quot;</highlight><highlight class="normal">,<sp/>pcFile);</highlight></codeline>
<codeline lineno="527"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/></highlight><highlight class="keyword">false</highlight><highlight class="normal">;</highlight></codeline>
<codeline lineno="528"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="529"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/></highlight><highlight class="keyword">true</highlight><highlight class="normal">;</highlight></codeline>
<codeline lineno="530"><highlight class="normal"><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="531"><highlight class="normal"></highlight></codeline>
<codeline lineno="532" refid="class_watch_server_1_1_c_watch_server_1a55927a94ad08e5ee5d2ba7d7ef6de2db" refkind="member"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordtype">void</highlight><highlight class="normal"><sp/><ref refid="class_watch_server_1_1_c_watch_server_1a55927a94ad08e5ee5d2ba7d7ef6de2db" kindref="member">CWatchServer::OnNetConnected</ref>(</highlight><highlight class="keyword">const</highlight><highlight class="normal"><sp/>HSock&amp;<sp/>rkSock,<sp/></highlight><highlight class="keyword">const</highlight><highlight class="normal"><sp/></highlight><highlight class="keywordtype">char</highlight><highlight class="normal">*<sp/>pcIP,<sp/></highlight><highlight class="keywordtype">int</highlight><highlight class="normal"><sp/>iPort)</highlight></codeline>
<codeline lineno="533"><highlight class="normal"><sp/><sp/><sp/><sp/>{</highlight></codeline>
<codeline lineno="534"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">//<sp/>NexusServer</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="535"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(!strcmp(pcIP,<sp/><ref refid="class_watch_server_1_1_c_watch_server_1ab230b0e57fd9eb328c6e5ce60a09fbcc" kindref="member">m_pkNSConn</ref>-&gt;<ref refid="struct_se_virt_conn_1ad05e8487648793f2d2340a47856acb71" kindref="member">kNetAddr</ref>.<ref refid="struct_se_net_addr_1a23b51e87d8b7b2201a03833c9adde232" kindref="member">acIP</ref>)<sp/>&amp;&amp;<sp/>iPort<sp/>==<sp/><ref refid="class_watch_server_1_1_c_watch_server_1ab230b0e57fd9eb328c6e5ce60a09fbcc" kindref="member">m_pkNSConn</ref>-&gt;<ref refid="struct_se_virt_conn_1ad05e8487648793f2d2340a47856acb71" kindref="member">kNetAddr</ref>.<ref refid="struct_se_net_addr_1a989fa5b025bc039122e8d2a29838fde9" kindref="member">iPort</ref>)</highlight></codeline>
<codeline lineno="536"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>{</highlight></codeline>
<codeline lineno="537"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="_se_virt_conn_mgr_8cpp_1aa8e9d5beed961f4e26b9cadd49603980" kindref="member">g_kVirtConnMgr</ref>.<ref refid="class_se_virt_conn_mgr_1adca74d2f39a17051600b0ea23d600b74" kindref="member">OnServerConnected</ref>(rkSock,<sp/><ref refid="class_watch_server_1_1_c_watch_server_1ab230b0e57fd9eb328c6e5ce60a09fbcc" kindref="member">m_pkNSConn</ref>);</highlight></codeline>
<codeline lineno="538"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="539"><highlight class="normal"></highlight></codeline>
<codeline lineno="540"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(!strcmp(pcIP,<sp/><ref refid="class_watch_server_1_1_c_watch_server_1a3eb2bf017ad3579c36293ccd77faa7d6" kindref="member">m_kConfig</ref>.<ref refid="struct_watch_server_1_1_se_watch_config_1ae8f27d9f748f36bc397261581756ac10" kindref="member">kWatchMgrServer</ref>.<ref refid="struct_se_net_addr_1a23b51e87d8b7b2201a03833c9adde232" kindref="member">acIP</ref>)<sp/>&amp;&amp;<sp/>iPort<sp/>==<sp/><ref refid="class_watch_server_1_1_c_watch_server_1a3eb2bf017ad3579c36293ccd77faa7d6" kindref="member">m_kConfig</ref>.<ref refid="struct_watch_server_1_1_se_watch_config_1ae8f27d9f748f36bc397261581756ac10" kindref="member">kWatchMgrServer</ref>.<ref refid="struct_se_net_addr_1a989fa5b025bc039122e8d2a29838fde9" kindref="member">iPort</ref>)</highlight></codeline>
<codeline lineno="541"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>{</highlight></codeline>
<codeline lineno="542"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="class_watch_server_1_1_c_watch_server_1a105d719eca41577b0e28b84ce8c97239" kindref="member">m_vWcsMgrServerData</ref>.<ref refid="struct_se_server_data_1a2777bbfd27a6afe42ebd71c5d14010a0" kindref="member">kSock</ref><sp/>=<sp/>rkSock;</highlight></codeline>
<codeline lineno="543"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="class_watch_server_1_1_c_watch_server_1a105d719eca41577b0e28b84ce8c97239" kindref="member">m_vWcsMgrServerData</ref>.<ref refid="struct_se_server_data_1a53fcdfea60106f5c7179d39b1e259a3e" kindref="member">bConnecting</ref><sp/>=<sp/></highlight><highlight class="keyword">false</highlight><highlight class="normal">;</highlight></codeline>
<codeline lineno="544"><highlight class="normal"></highlight></codeline>
<codeline lineno="545"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(!rkSock.IsInvalid())</highlight></codeline>
<codeline lineno="546"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>{</highlight></codeline>
<codeline lineno="547"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="_se_file_log_8h_1a83f3fe470b91cb8eed8762cc8e5e26c3" kindref="member">SeLogInfo</ref>(</highlight><highlight class="stringliteral">&quot;Connect<sp/>to<sp/>WatchMgrServer<sp/>successfully:[%s:%d]&quot;</highlight><highlight class="normal">,<sp/>pcIP,<sp/>iPort);</highlight></codeline>
<codeline lineno="548"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="549"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">else</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="550"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>{</highlight></codeline>
<codeline lineno="551"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="_se_file_log_8h_1a59fe2018c00666084724bec1365b41f5" kindref="member">SeLogError</ref>(</highlight><highlight class="stringliteral">&quot;Connect<sp/>to<sp/>WatchMgrServer<sp/>failed:[%s:%d]&quot;</highlight><highlight class="normal">,<sp/>pcIP,<sp/>iPort);</highlight></codeline>
<codeline lineno="552"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="553"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="554"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">else</highlight><highlight class="normal"><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(!strcmp(pcIP,<sp/><ref refid="class_watch_server_1_1_c_watch_server_1a3eb2bf017ad3579c36293ccd77faa7d6" kindref="member">m_kConfig</ref>.<ref refid="struct_watch_server_1_1_se_watch_config_1a646452a8e07717b00ba50edd3f8138ed" kindref="member">kMasterServer</ref>.<ref refid="struct_se_net_addr_1a23b51e87d8b7b2201a03833c9adde232" kindref="member">acIP</ref>)<sp/>&amp;&amp;<sp/>iPort<sp/>==<sp/><ref refid="class_watch_server_1_1_c_watch_server_1a3eb2bf017ad3579c36293ccd77faa7d6" kindref="member">m_kConfig</ref>.<ref refid="struct_watch_server_1_1_se_watch_config_1a646452a8e07717b00ba50edd3f8138ed" kindref="member">kMasterServer</ref>.<ref refid="struct_se_net_addr_1a989fa5b025bc039122e8d2a29838fde9" kindref="member">iPort</ref>)</highlight></codeline>
<codeline lineno="555"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>{</highlight></codeline>
<codeline lineno="556"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">//Slave</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="557"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="class_watch_server_1_1_c_watch_server_1ac227c6d43db5635c1c4ddc61a36c0504" kindref="member">m_vWCSMasterServerData</ref>.<ref refid="struct_se_server_data_1a2777bbfd27a6afe42ebd71c5d14010a0" kindref="member">kSock</ref><sp/>=<sp/>rkSock;</highlight></codeline>
<codeline lineno="558"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="class_watch_server_1_1_c_watch_server_1ac227c6d43db5635c1c4ddc61a36c0504" kindref="member">m_vWCSMasterServerData</ref>.<ref refid="struct_se_server_data_1a53fcdfea60106f5c7179d39b1e259a3e" kindref="member">bConnecting</ref><sp/>=<sp/></highlight><highlight class="keyword">false</highlight><highlight class="normal">;</highlight></codeline>
<codeline lineno="559"><highlight class="normal"></highlight></codeline>
<codeline lineno="560"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(!rkSock.IsInvalid())</highlight></codeline>
<codeline lineno="561"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>{</highlight></codeline>
<codeline lineno="562"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="_se_file_log_8h_1a83f3fe470b91cb8eed8762cc8e5e26c3" kindref="member">SeLogInfo</ref>(</highlight><highlight class="stringliteral">&quot;Connect<sp/>to<sp/>WatchMasterServer<sp/>successfully:[%s:%d]&quot;</highlight><highlight class="normal">,<sp/>pcIP,<sp/>iPort);</highlight></codeline>
<codeline lineno="563"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="564"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">else</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="565"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>{</highlight></codeline>
<codeline lineno="566"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="_se_file_log_8h_1a59fe2018c00666084724bec1365b41f5" kindref="member">SeLogError</ref>(</highlight><highlight class="stringliteral">&quot;Connect<sp/>to<sp/>WatchMasterServer<sp/>failed:[%s:%d]&quot;</highlight><highlight class="normal">,<sp/>pcIP,<sp/>iPort);</highlight></codeline>
<codeline lineno="567"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="568"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="569"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(<ref refid="class_watch_server_1_1_c_watch_server_1aa18854da00cc2a552d66854428feab8b" kindref="member">m_mSockRsServerData</ref>.find(rkSock)<sp/>==<sp/><ref refid="class_watch_server_1_1_c_watch_server_1aa18854da00cc2a552d66854428feab8b" kindref="member">m_mSockRsServerData</ref>.end())</highlight></codeline>
<codeline lineno="570"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>{</highlight></codeline>
<codeline lineno="571"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">for</highlight><highlight class="normal"><sp/>(</highlight><highlight class="keywordtype">int</highlight><highlight class="normal"><sp/>ii<sp/>=<sp/>0;<sp/>ii<sp/>&lt;<sp/><ref refid="class_watch_server_1_1_c_watch_server_1a3eb2bf017ad3579c36293ccd77faa7d6" kindref="member">m_kConfig</ref>.<ref refid="struct_watch_server_1_1_se_watch_config_1a7b543072c4adc05748e49293d19808d4" kindref="member">vAddrRS</ref>.size();<sp/>++ii)</highlight></codeline>
<codeline lineno="572"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>{</highlight></codeline>
<codeline lineno="573"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(!strcmp(pcIP,<sp/><ref refid="class_watch_server_1_1_c_watch_server_1a3eb2bf017ad3579c36293ccd77faa7d6" kindref="member">m_kConfig</ref>.<ref refid="struct_watch_server_1_1_se_watch_config_1a7b543072c4adc05748e49293d19808d4" kindref="member">vAddrRS</ref>[ii].acIP)<sp/>&amp;&amp;<sp/>iPort<sp/>==<sp/><ref refid="class_watch_server_1_1_c_watch_server_1a3eb2bf017ad3579c36293ccd77faa7d6" kindref="member">m_kConfig</ref>.<ref refid="struct_watch_server_1_1_se_watch_config_1a7b543072c4adc05748e49293d19808d4" kindref="member">vAddrRS</ref>[ii].iPort)</highlight></codeline>
<codeline lineno="574"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>{</highlight></codeline>
<codeline lineno="575"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="class_watch_server_1_1_c_watch_server_1aafeb8443263a74c13874ec97f4682e4b" kindref="member">m_vRsServerData</ref>[ii].bConnecting<sp/>=<sp/></highlight><highlight class="keyword">false</highlight><highlight class="normal">;</highlight></codeline>
<codeline lineno="576"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(!rkSock.IsInvalid())</highlight></codeline>
<codeline lineno="577"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>{</highlight></codeline>
<codeline lineno="578"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="class_watch_server_1_1_c_watch_server_1aafeb8443263a74c13874ec97f4682e4b" kindref="member">m_vRsServerData</ref>[ii].kSock<sp/>=<sp/>rkSock;</highlight></codeline>
<codeline lineno="579"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="class_watch_server_1_1_c_watch_server_1aa18854da00cc2a552d66854428feab8b" kindref="member">m_mSockRsServerData</ref>[rkSock]<sp/>=<sp/>ii;</highlight></codeline>
<codeline lineno="580"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="_se_file_log_8h_1a83f3fe470b91cb8eed8762cc8e5e26c3" kindref="member">SeLogInfo</ref>(</highlight><highlight class="stringliteral">&quot;Connect<sp/>to<sp/>RS<sp/>successfully:[%s:%d]<sp/>&quot;</highlight><highlight class="normal">,<sp/>pcIP,<sp/>iPort);</highlight></codeline>
<codeline lineno="581"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="582"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">else</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="583"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>{</highlight></codeline>
<codeline lineno="584"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="_se_file_log_8h_1a59fe2018c00666084724bec1365b41f5" kindref="member">SeLogError</ref>(</highlight><highlight class="stringliteral">&quot;Connect<sp/>to<sp/>RS<sp/>failed:[%s:%d]&quot;</highlight><highlight class="normal">,<sp/>pcIP,<sp/>iPort);</highlight></codeline>
<codeline lineno="585"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="586"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">break</highlight><highlight class="normal">;</highlight></codeline>
<codeline lineno="587"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="588"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="589"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="590"><highlight class="normal"><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="591"><highlight class="normal"></highlight></codeline>
<codeline lineno="592" refid="class_watch_server_1_1_c_watch_server_1a89eb1d5a83320410e331532d79aa53fe" refkind="member"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordtype">void</highlight><highlight class="normal"><sp/><ref refid="class_watch_server_1_1_c_watch_server_1a89eb1d5a83320410e331532d79aa53fe" kindref="member">CWatchServer::OnNetAccept</ref>(</highlight><highlight class="keyword">const</highlight><highlight class="normal"><sp/>HSock&amp;<sp/>rkSock,<sp/></highlight><highlight class="keywordtype">int</highlight><highlight class="normal"><sp/>iListenPort,<sp/></highlight><highlight class="keyword">const</highlight><highlight class="normal"><sp/></highlight><highlight class="keywordtype">char</highlight><highlight class="normal">*<sp/>pcIP,<sp/></highlight><highlight class="keywordtype">int</highlight><highlight class="normal"><sp/>iPort)</highlight></codeline>
<codeline lineno="593"><highlight class="normal"><sp/><sp/><sp/><sp/>{</highlight></codeline>
<codeline lineno="594"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(iListenPort<sp/>==<sp/><ref refid="class_watch_server_1_1_c_watch_server_1a3eb2bf017ad3579c36293ccd77faa7d6" kindref="member">m_kConfig</ref>.<ref refid="struct_watch_server_1_1_se_watch_config_1a129f8e65f0f91128ee0695137cc4f479" kindref="member">kAddrToPlayer</ref>.<ref refid="struct_se_net_addr_1a989fa5b025bc039122e8d2a29838fde9" kindref="member">iPort</ref>)</highlight></codeline>
<codeline lineno="595"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>{</highlight></codeline>
<codeline lineno="596"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">//<sp/>WCSMgr</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="597"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(!<ref refid="class_watch_server_1_1_c_watch_server_1a3f81d2f99e163949b943e7e437aa3251" kindref="member">IsWatchMgrServerReady</ref>())</highlight></codeline>
<codeline lineno="598"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>{</highlight></codeline>
<codeline lineno="599"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="class_watch_server_1_1_c_watch_server_1a3dc54fcd755ce4e21f181aa6f4d91b4d" kindref="member">m_kNetMgr</ref>.Disconnect(rkSock);</highlight></codeline>
<codeline lineno="600"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal">;</highlight></codeline>
<codeline lineno="601"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="602"><highlight class="normal"></highlight></codeline>
<codeline lineno="603"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">//<sp/></highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="604"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="struct_watch_server_1_1_se_connect" kindref="compound">SeConnect</ref>*<sp/>pkConnect<sp/>=<sp/>SeConnect::NEW();</highlight></codeline>
<codeline lineno="605"><highlight class="normal"></highlight></codeline>
<codeline lineno="606"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>pkConnect-&gt;<ref refid="struct_watch_server_1_1_se_connect_1af900a81e9f911c8efa7975390a0239b1" kindref="member">kSock</ref><sp/>=<sp/>rkSock;</highlight></codeline>
<codeline lineno="607"><highlight class="normal"></highlight></codeline>
<codeline lineno="608"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="class_watch_server_1_1_c_watch_server_1a1ca64bea8b2d3bdb67b0b6666209230d" kindref="member">OnPlayerConnected</ref>(pkConnect,<sp/>pcIP,<sp/>iPort);</highlight></codeline>
<codeline lineno="609"><highlight class="normal"></highlight></codeline>
<codeline lineno="610"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">//<sp/></highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="611"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="class_watch_server_1_1_c_watch_server_1a8bc417bec0c22716c237d38d330df336" kindref="member">m_kAllConnect</ref>[rkSock]<sp/>=<sp/>pkConnect;</highlight></codeline>
<codeline lineno="612"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="613"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">else</highlight><highlight class="normal"><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(iListenPort<sp/>==<sp/><ref refid="class_watch_server_1_1_c_watch_server_1a3eb2bf017ad3579c36293ccd77faa7d6" kindref="member">m_kConfig</ref>.<ref refid="struct_watch_server_1_1_se_watch_config_1a9d0f1e67a7bb863204d9d740cf6a0661" kindref="member">kLocalServer</ref>.<ref refid="struct_se_net_addr_1a989fa5b025bc039122e8d2a29838fde9" kindref="member">iPort</ref>)</highlight></codeline>
<codeline lineno="614"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>{</highlight></codeline>
<codeline lineno="615"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="struct_watch_server_1_1_se_inner_connect" kindref="compound">SeInnerConnect</ref>*<sp/>pkConnect<sp/>=<sp/>SeInnerConnect::NEW();</highlight></codeline>
<codeline lineno="616"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>pkConnect-&gt;<ref refid="struct_watch_server_1_1_se_inner_connect_1ae5dde9afe14e3a7d886fa04a452a3b51" kindref="member">kSock</ref><sp/>=<sp/>rkSock;</highlight></codeline>
<codeline lineno="617"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>pkConnect-&gt;<ref refid="struct_watch_server_1_1_se_inner_connect_1a0465bc27527c7e17bca19bb3f03009f2" kindref="member">eState</ref><sp/>=<sp/><ref refid="namespace_watch_server_1ac4644e31ad5820d1529141feef0eed7aae9411688d92f7749ae30426d7901f913" kindref="member">SCS_UNKOWN</ref>;</highlight></codeline>
<codeline lineno="618"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="_se_tool_8cpp_1a4d30fbe56257fc998ebc1346e53be0d8" kindref="member">StrCpy</ref>(pkConnect-&gt;<ref refid="struct_watch_server_1_1_se_inner_connect_1a2d14ccc2906c778fde9a31aa3d9b0ce3" kindref="member">kNetAddr</ref>.<ref refid="struct_se_net_addr_1a23b51e87d8b7b2201a03833c9adde232" kindref="member">acIP</ref>,<sp/><ref refid="_se_ptl_comm_define_8h_1af62c3a00672953c86a2586d53c60663aaaadf26d549f9464c83a25eeb9da2d653" kindref="member">SSD_IP_LEN</ref>,<sp/>pcIP);</highlight></codeline>
<codeline lineno="619"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>pkConnect-&gt;<ref refid="struct_watch_server_1_1_se_inner_connect_1a2d14ccc2906c778fde9a31aa3d9b0ce3" kindref="member">kNetAddr</ref>.<ref refid="struct_se_net_addr_1a989fa5b025bc039122e8d2a29838fde9" kindref="member">iPort</ref><sp/>=<sp/>iPort;</highlight></codeline>
<codeline lineno="620"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="class_watch_server_1_1_c_watch_server_1aadccc5cdd59278ba38d08569cb60682d" kindref="member">m_kAllInnerConnect</ref>[rkSock]<sp/>=<sp/>pkConnect;</highlight></codeline>
<codeline lineno="621"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="622"><highlight class="normal"><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="623"><highlight class="normal"></highlight></codeline>
<codeline lineno="624" refid="class_watch_server_1_1_c_watch_server_1a11ebf39f880e95526c64943dcf5bd6c2" refkind="member"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordtype">void</highlight><highlight class="normal"><sp/><ref refid="class_watch_server_1_1_c_watch_server_1a11ebf39f880e95526c64943dcf5bd6c2" kindref="member">CWatchServer::OnNetRecv</ref>(</highlight><highlight class="keyword">const</highlight><highlight class="normal"><sp/>HSock&amp;<sp/>rkSock,<sp/></highlight><highlight class="keywordtype">void</highlight><highlight class="normal">*<sp/>pkData,<sp/></highlight><highlight class="keywordtype">int</highlight><highlight class="normal"><sp/>iSize)</highlight></codeline>
<codeline lineno="625"><highlight class="normal"><sp/><sp/><sp/><sp/>{</highlight></codeline>
<codeline lineno="626"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(iSize<sp/>&lt;<sp/></highlight><highlight class="keyword">sizeof</highlight><highlight class="normal">(<ref refid="struct_se_c_m_d" kindref="compound">SeCMD</ref>))</highlight></codeline>
<codeline lineno="627"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>{</highlight></codeline>
<codeline lineno="628"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="class_watch_server_1_1_c_watch_server_1a3dc54fcd755ce4e21f181aa6f4d91b4d" kindref="member">m_kNetMgr</ref>.Disconnect(rkSock);</highlight></codeline>
<codeline lineno="629"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal">;</highlight></codeline>
<codeline lineno="630"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="631"><highlight class="normal"></highlight></codeline>
<codeline lineno="632"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(rkSock<sp/>==<sp/><ref refid="class_watch_server_1_1_c_watch_server_1ab230b0e57fd9eb328c6e5ce60a09fbcc" kindref="member">m_pkNSConn</ref>-&gt;<ref refid="struct_se_virt_conn_1a2ed0654cfe8f298d1dc8fbe76a310df0" kindref="member">kSock</ref>)</highlight></codeline>
<codeline lineno="633"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>{</highlight></codeline>
<codeline lineno="634"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="class_watch_server_1_1_c_watch_server_1afd0f2f0b275a13ce2437d8d33cc7c3c7" kindref="member">ProcessNWCMSData</ref>(pkData,<sp/>iSize);</highlight></codeline>
<codeline lineno="635"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal">;</highlight></codeline>
<codeline lineno="636"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="637"><highlight class="normal"></highlight></codeline>
<codeline lineno="638"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(rkSock<sp/>==<sp/><ref refid="class_watch_server_1_1_c_watch_server_1a105d719eca41577b0e28b84ce8c97239" kindref="member">m_vWcsMgrServerData</ref>.<ref refid="struct_se_server_data_1a2777bbfd27a6afe42ebd71c5d14010a0" kindref="member">kSock</ref>)</highlight></codeline>
<codeline lineno="639"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>{</highlight></codeline>
<codeline lineno="640"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="class_watch_server_1_1_c_watch_server_1a026e9aabb87164edea05d59d1027914b" kindref="member">ProcessWCMSWCSData</ref>(pkData,<sp/>iSize);</highlight></codeline>
<codeline lineno="641"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal">;</highlight></codeline>
<codeline lineno="642"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="643"><highlight class="normal"></highlight></codeline>
<codeline lineno="644"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(rkSock<sp/>==<sp/><ref refid="class_watch_server_1_1_c_watch_server_1ac227c6d43db5635c1c4ddc61a36c0504" kindref="member">m_vWCSMasterServerData</ref>.<ref refid="struct_se_server_data_1a2777bbfd27a6afe42ebd71c5d14010a0" kindref="member">kSock</ref>)</highlight></codeline>
<codeline lineno="645"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>{</highlight></codeline>
<codeline lineno="646"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="class_watch_server_1_1_c_watch_server_1a701c9e2b29a3e5c1cb3b88b5eca81b95" kindref="member">ProcessWCSWCSSData</ref>(pkData,<sp/>iSize);</highlight></codeline>
<codeline lineno="647"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal">;</highlight></codeline>
<codeline lineno="648"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="649"><highlight class="normal"></highlight></codeline>
<codeline lineno="650"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>TSockServerDataMap::iterator<sp/>_itRs<sp/>=<sp/><ref refid="class_watch_server_1_1_c_watch_server_1aa18854da00cc2a552d66854428feab8b" kindref="member">m_mSockRsServerData</ref>.find(rkSock);</highlight></codeline>
<codeline lineno="651"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(_itRs<sp/>!=<sp/><ref refid="class_watch_server_1_1_c_watch_server_1aa18854da00cc2a552d66854428feab8b" kindref="member">m_mSockRsServerData</ref>.end())</highlight></codeline>
<codeline lineno="652"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>{</highlight></codeline>
<codeline lineno="653"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="class_watch_server_1_1_c_watch_server_1a5611861fe844cb7adc8baef4d882dbeb" kindref="member">ProcessRWCSData</ref>(pkData,<sp/>iSize,<sp/>&amp;(<ref refid="class_watch_server_1_1_c_watch_server_1aafeb8443263a74c13874ec97f4682e4b" kindref="member">m_vRsServerData</ref>[_itRs-&gt;second].kSock));</highlight></codeline>
<codeline lineno="654"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal">;</highlight></codeline>
<codeline lineno="655"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="656"><highlight class="normal"></highlight></codeline>
<codeline lineno="657"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>MapAllConnect::iterator<sp/>kRaceItr<sp/>=<sp/><ref refid="class_watch_server_1_1_c_watch_server_1a8bc417bec0c22716c237d38d330df336" kindref="member">m_kAllConnect</ref>.find(rkSock);</highlight></codeline>
<codeline lineno="658"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(kRaceItr<sp/>!=<sp/><ref refid="class_watch_server_1_1_c_watch_server_1a8bc417bec0c22716c237d38d330df336" kindref="member">m_kAllConnect</ref>.end())</highlight></codeline>
<codeline lineno="659"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>{</highlight></codeline>
<codeline lineno="660"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="struct_watch_server_1_1_se_connect" kindref="compound">SeConnect</ref>*<sp/>pkConnect<sp/>=<sp/>kRaceItr-&gt;second;</highlight></codeline>
<codeline lineno="661"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>pkConnect-&gt;<ref refid="struct_watch_server_1_1_se_connect_1a1052e18ab678b25229e82e39ee11fcba" kindref="member">dwLastRecvTime</ref><sp/>=<sp/><ref refid="class_watch_server_1_1_c_watch_server_1ad08ef4a2d15c3ac119b072e0a714622c" kindref="member">GetServerTime</ref>();</highlight></codeline>
<codeline lineno="662"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>pkConnect-&gt;<ref refid="struct_watch_server_1_1_se_connect_1a7c0645ae310058f80522b05453e1259b" kindref="member">dwPackCount</ref>++;</highlight></codeline>
<codeline lineno="663"><highlight class="normal"></highlight></codeline>
<codeline lineno="664"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="class_watch_server_1_1_c_watch_server_1ae3fffecaf801b392ce5e917cec81ea5b" kindref="member">ProcessCWCSData</ref>(pkData,<sp/>iSize,<sp/>pkConnect);</highlight></codeline>
<codeline lineno="665"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal">;</highlight></codeline>
<codeline lineno="666"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="667"><highlight class="normal"></highlight></codeline>
<codeline lineno="668"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>MapAllInnerConnect::iterator<sp/>_it<sp/>=<sp/><ref refid="class_watch_server_1_1_c_watch_server_1aadccc5cdd59278ba38d08569cb60682d" kindref="member">m_kAllInnerConnect</ref>.find(rkSock);</highlight></codeline>
<codeline lineno="669"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(_it<sp/>!=<sp/><ref refid="class_watch_server_1_1_c_watch_server_1aadccc5cdd59278ba38d08569cb60682d" kindref="member">m_kAllInnerConnect</ref>.end())</highlight></codeline>
<codeline lineno="670"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>{</highlight></codeline>
<codeline lineno="671"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="struct_watch_server_1_1_se_inner_connect" kindref="compound">SeInnerConnect</ref>*<sp/>pkConnect<sp/>=<sp/>_it-&gt;second;</highlight></codeline>
<codeline lineno="672"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>pkConnect-&gt;<ref refid="struct_watch_server_1_1_se_inner_connect_1aa8d7f589bbee12a9f4cee22dc8346a5b" kindref="member">dwLastRecvTime</ref><sp/>=<sp/><ref refid="class_watch_server_1_1_c_watch_server_1ad08ef4a2d15c3ac119b072e0a714622c" kindref="member">GetServerTime</ref>();</highlight></codeline>
<codeline lineno="673"><highlight class="normal"></highlight></codeline>
<codeline lineno="674"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(pkConnect-&gt;<ref refid="struct_watch_server_1_1_se_inner_connect_1a0465bc27527c7e17bca19bb3f03009f2" kindref="member">eState</ref><sp/>==<sp/><ref refid="namespace_watch_server_1ac4644e31ad5820d1529141feef0eed7aae9411688d92f7749ae30426d7901f913" kindref="member">SCS_UNKOWN</ref>)</highlight></codeline>
<codeline lineno="675"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>{</highlight></codeline>
<codeline lineno="676"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="struct_se_c_m_d" kindref="compound">SeCMD</ref>*<sp/>pkCmd<sp/>=<sp/>(<ref refid="struct_se_c_m_d" kindref="compound">SeCMD</ref><sp/>*)pkData;</highlight></codeline>
<codeline lineno="677"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(pkCmd-&gt;<ref refid="struct_se_c_m_d_1a2efa122a60040d09cfca777f9155394c" kindref="member">wCmd</ref><sp/>==<sp/><ref refid="_se_ptl___w_c_s___to___w_c_m_s_8h_1a7e2cebf4a570b8a5dfe925f6eb15f99eaa561668d89f9b5301d655419ad9fb22c" kindref="member">CMD_WCSWCMS_REGISTER</ref>)</highlight></codeline>
<codeline lineno="678"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>{</highlight></codeline>
<codeline lineno="679"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="class_watch_server_1_1_c_watch_server_1af2723037e4cb791ef3121ada91c9df13" kindref="member">ProcessWCSWCMSData</ref>(pkData,<sp/>iSize,<sp/>pkConnect);</highlight></codeline>
<codeline lineno="680"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="681"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">else</highlight><highlight class="normal"><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(pkCmd-&gt;<ref refid="struct_se_c_m_d_1a2efa122a60040d09cfca777f9155394c" kindref="member">wCmd</ref><sp/>==<sp/><ref refid="_se_ptl___w_c_s_s___to___w_c_s_8h_1a4872f0dc3c3a62b332f16f619c36ca4ba8c258b7d4ba5c13f6c20f347d6b199b3" kindref="member">CMD_WCSSWCS_REGISTER</ref>)</highlight></codeline>
<codeline lineno="682"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>{</highlight></codeline>
<codeline lineno="683"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="class_watch_server_1_1_c_watch_server_1a201bda571441d035f8f603c0629bbab1" kindref="member">ProcessWCSSWCSData</ref>(pkData,<sp/>iSize,<sp/>pkConnect);</highlight></codeline>
<codeline lineno="684"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="685"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">else</highlight><highlight class="normal"><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(pkCmd-&gt;<ref refid="struct_se_c_m_d_1a2efa122a60040d09cfca777f9155394c" kindref="member">wCmd</ref><sp/>==<sp/><ref refid="_se_ptl___t_s___to___w_c_m_s_8h_1af0428570573ee58d0168745c39d33596a9869ad4664d7086486da2c8c12710d5d" kindref="member">CMD_TWCMS_REGISTER</ref>)</highlight></codeline>
<codeline lineno="686"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>{</highlight></codeline>
<codeline lineno="687"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="class_watch_server_1_1_c_watch_server_1af737fbc9d9b6ec4b91b1e2f2b85758d9" kindref="member">ProcessTWCMSData</ref>(pkData,<sp/>iSize,<sp/>pkConnect);</highlight></codeline>
<codeline lineno="688"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="689"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="690"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">else</highlight><highlight class="normal"><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(pkConnect-&gt;<ref refid="struct_watch_server_1_1_se_inner_connect_1a0465bc27527c7e17bca19bb3f03009f2" kindref="member">eState</ref><sp/>==<sp/><ref refid="namespace_watch_server_1ac4644e31ad5820d1529141feef0eed7aa7534948ab845d1a99ccf7e53828a0009" kindref="member">SCS_WATCHSERVER_OK</ref>)</highlight></codeline>
<codeline lineno="691"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>{</highlight></codeline>
<codeline lineno="692"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="class_watch_server_1_1_c_watch_server_1af2723037e4cb791ef3121ada91c9df13" kindref="member">ProcessWCSWCMSData</ref>(pkData,<sp/>iSize,<sp/>pkConnect);</highlight></codeline>
<codeline lineno="693"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="694"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">else</highlight><highlight class="normal"><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(pkConnect-&gt;<ref refid="struct_watch_server_1_1_se_inner_connect_1a0465bc27527c7e17bca19bb3f03009f2" kindref="member">eState</ref><sp/>==<sp/><ref refid="namespace_watch_server_1ac4644e31ad5820d1529141feef0eed7aa6b9654464090ca0ab76a5fac9134baaf" kindref="member">SCS_WATCHSLAVESERVER_OK</ref>)</highlight></codeline>
<codeline lineno="695"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>{</highlight></codeline>
<codeline lineno="696"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="class_watch_server_1_1_c_watch_server_1a201bda571441d035f8f603c0629bbab1" kindref="member">ProcessWCSSWCSData</ref>(pkData,<sp/>iSize,<sp/>pkConnect);</highlight></codeline>
<codeline lineno="697"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="698"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">else</highlight><highlight class="normal"><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(pkConnect-&gt;<ref refid="struct_watch_server_1_1_se_inner_connect_1a0465bc27527c7e17bca19bb3f03009f2" kindref="member">eState</ref><sp/>==<sp/><ref refid="namespace_watch_server_1ac4644e31ad5820d1529141feef0eed7aa4aed545bd211a01094654bcca1255cb0" kindref="member">SCS_TOWN_OK</ref>)</highlight></codeline>
<codeline lineno="699"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>{</highlight></codeline>
<codeline lineno="700"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="class_watch_server_1_1_c_watch_server_1af737fbc9d9b6ec4b91b1e2f2b85758d9" kindref="member">ProcessTWCMSData</ref>(pkData,<sp/>iSize,<sp/>pkConnect);</highlight></codeline>
<codeline lineno="701"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="702"><highlight class="normal"></highlight></codeline>
<codeline lineno="703"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal">;</highlight></codeline>
<codeline lineno="704"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="705"><highlight class="normal"></highlight></codeline>
<codeline lineno="706"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="class_watch_server_1_1_c_watch_server_1a3dc54fcd755ce4e21f181aa6f4d91b4d" kindref="member">m_kNetMgr</ref>.Disconnect(rkSock);</highlight></codeline>
<codeline lineno="707"><highlight class="normal"><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="708"><highlight class="normal"></highlight></codeline>
<codeline lineno="709" refid="class_watch_server_1_1_c_watch_server_1a16c4aafd626d1586aaaae1a112e8d071" refkind="member"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordtype">void</highlight><highlight class="normal"><sp/><ref refid="class_watch_server_1_1_c_watch_server_1a16c4aafd626d1586aaaae1a112e8d071" kindref="member">CWatchServer::OnNetDisconnect</ref>(</highlight><highlight class="keyword">const</highlight><highlight class="normal"><sp/>HSock&amp;<sp/>rkSock,<sp/>TeDisconnectCode<sp/>eCode,<sp/></highlight><highlight class="keywordtype">int</highlight><highlight class="normal"><sp/>iParam)</highlight></codeline>
<codeline lineno="710"><highlight class="normal"><sp/><sp/><sp/><sp/>{</highlight></codeline>
<codeline lineno="711"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(rkSock<sp/>==<sp/><ref refid="class_watch_server_1_1_c_watch_server_1ab230b0e57fd9eb328c6e5ce60a09fbcc" kindref="member">m_pkNSConn</ref>-&gt;<ref refid="struct_se_virt_conn_1a2ed0654cfe8f298d1dc8fbe76a310df0" kindref="member">kSock</ref>)</highlight></codeline>
<codeline lineno="712"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>{</highlight></codeline>
<codeline lineno="713"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="_se_virt_conn_mgr_8cpp_1aa8e9d5beed961f4e26b9cadd49603980" kindref="member">g_kVirtConnMgr</ref>.<ref refid="class_se_virt_conn_mgr_1ad75abfada4de2eb3107aca79b1c99642" kindref="member">OnServerDisconnect</ref>(<ref refid="class_watch_server_1_1_c_watch_server_1ab230b0e57fd9eb328c6e5ce60a09fbcc" kindref="member">m_pkNSConn</ref>);</highlight></codeline>
<codeline lineno="714"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal">;</highlight></codeline>
<codeline lineno="715"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="716"><highlight class="normal"></highlight></codeline>
<codeline lineno="717"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(rkSock<sp/>==<sp/><ref refid="class_watch_server_1_1_c_watch_server_1a105d719eca41577b0e28b84ce8c97239" kindref="member">m_vWcsMgrServerData</ref>.<ref refid="struct_se_server_data_1a2777bbfd27a6afe42ebd71c5d14010a0" kindref="member">kSock</ref>)</highlight></codeline>
<codeline lineno="718"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>{</highlight></codeline>
<codeline lineno="719"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="class_watch_server_1_1_c_watch_server_1a105d719eca41577b0e28b84ce8c97239" kindref="member">m_vWcsMgrServerData</ref>.<ref refid="struct_se_server_data_1a2777bbfd27a6afe42ebd71c5d14010a0" kindref="member">kSock</ref><sp/>=<sp/>NULL;</highlight></codeline>
<codeline lineno="720"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="class_watch_server_1_1_c_watch_server_1a105d719eca41577b0e28b84ce8c97239" kindref="member">m_vWcsMgrServerData</ref>.<ref refid="struct_se_server_data_1a53fcdfea60106f5c7179d39b1e259a3e" kindref="member">bConnecting</ref><sp/>=<sp/></highlight><highlight class="keyword">false</highlight><highlight class="normal">;</highlight></codeline>
<codeline lineno="721"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="class_watch_server_1_1_c_watch_server_1a105d719eca41577b0e28b84ce8c97239" kindref="member">m_vWcsMgrServerData</ref>.<ref refid="struct_se_server_data_1ad83763ea85ed3a8635ca4b9c5a393ba4" kindref="member">dwRegisterTime</ref><sp/>=<sp/>0;</highlight></codeline>
<codeline lineno="722"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="class_watch_server_1_1_c_watch_server_1a105d719eca41577b0e28b84ce8c97239" kindref="member">m_vWcsMgrServerData</ref>.<ref refid="struct_se_server_data_1a4d91e2d15b4bc404ebc4ec42254ac770" kindref="member">bRegistered</ref><sp/>=<sp/></highlight><highlight class="keyword">false</highlight><highlight class="normal">;</highlight></codeline>
<codeline lineno="723"><highlight class="normal"></highlight></codeline>
<codeline lineno="724"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="_se_file_log_8h_1a59fe2018c00666084724bec1365b41f5" kindref="member">SeLogError</ref>(</highlight><highlight class="stringliteral">&quot;Disconnect<sp/>from<sp/>WatchMgrServer:[%s:%d]<sp/>DisconnectCode[%d]<sp/>Param[%d]&quot;</highlight><highlight class="normal">,<sp/><ref refid="class_watch_server_1_1_c_watch_server_1a3eb2bf017ad3579c36293ccd77faa7d6" kindref="member">m_kConfig</ref>.<ref refid="struct_watch_server_1_1_se_watch_config_1ae8f27d9f748f36bc397261581756ac10" kindref="member">kWatchMgrServer</ref>.<ref refid="struct_se_net_addr_1a23b51e87d8b7b2201a03833c9adde232" kindref="member">acIP</ref>,<sp/><ref refid="class_watch_server_1_1_c_watch_server_1a3eb2bf017ad3579c36293ccd77faa7d6" kindref="member">m_kConfig</ref>.<ref refid="struct_watch_server_1_1_se_watch_config_1ae8f27d9f748f36bc397261581756ac10" kindref="member">kWatchMgrServer</ref>.<ref refid="struct_se_net_addr_1a989fa5b025bc039122e8d2a29838fde9" kindref="member">iPort</ref>,<sp/>eCode,<sp/>iParam);</highlight></codeline>
<codeline lineno="725"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal">;</highlight></codeline>
<codeline lineno="726"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="727"><highlight class="normal"></highlight></codeline>
<codeline lineno="728"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(rkSock<sp/>==<sp/><ref refid="class_watch_server_1_1_c_watch_server_1ac227c6d43db5635c1c4ddc61a36c0504" kindref="member">m_vWCSMasterServerData</ref>.<ref refid="struct_se_server_data_1a2777bbfd27a6afe42ebd71c5d14010a0" kindref="member">kSock</ref>)</highlight></codeline>
<codeline lineno="729"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>{</highlight></codeline>
<codeline lineno="730"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="class_watch_server_1_1_c_watch_server_1ac227c6d43db5635c1c4ddc61a36c0504" kindref="member">m_vWCSMasterServerData</ref>.<ref refid="struct_se_server_data_1a2777bbfd27a6afe42ebd71c5d14010a0" kindref="member">kSock</ref><sp/>=<sp/>NULL;</highlight></codeline>
<codeline lineno="731"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="class_watch_server_1_1_c_watch_server_1ac227c6d43db5635c1c4ddc61a36c0504" kindref="member">m_vWCSMasterServerData</ref>.<ref refid="struct_se_server_data_1a53fcdfea60106f5c7179d39b1e259a3e" kindref="member">bConnecting</ref><sp/>=<sp/></highlight><highlight class="keyword">false</highlight><highlight class="normal">;</highlight></codeline>
<codeline lineno="732"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="class_watch_server_1_1_c_watch_server_1ac227c6d43db5635c1c4ddc61a36c0504" kindref="member">m_vWCSMasterServerData</ref>.<ref refid="struct_se_server_data_1ad83763ea85ed3a8635ca4b9c5a393ba4" kindref="member">dwRegisterTime</ref><sp/>=<sp/>0;</highlight></codeline>
<codeline lineno="733"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="class_watch_server_1_1_c_watch_server_1ac227c6d43db5635c1c4ddc61a36c0504" kindref="member">m_vWCSMasterServerData</ref>.<ref refid="struct_se_server_data_1a4d91e2d15b4bc404ebc4ec42254ac770" kindref="member">bRegistered</ref><sp/>=<sp/></highlight><highlight class="keyword">false</highlight><highlight class="normal">;</highlight></codeline>
<codeline lineno="734"><highlight class="normal"></highlight></codeline>
<codeline lineno="735"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="_se_file_log_8h_1a59fe2018c00666084724bec1365b41f5" kindref="member">SeLogError</ref>(</highlight><highlight class="stringliteral">&quot;Disconnect<sp/>from<sp/>WatchMasterServer:[%s:%d]<sp/>DisconnectCode[%d]<sp/>Param[%d]&quot;</highlight><highlight class="normal">,<sp/><ref refid="class_watch_server_1_1_c_watch_server_1a3eb2bf017ad3579c36293ccd77faa7d6" kindref="member">m_kConfig</ref>.<ref refid="struct_watch_server_1_1_se_watch_config_1a646452a8e07717b00ba50edd3f8138ed" kindref="member">kMasterServer</ref>.<ref refid="struct_se_net_addr_1a23b51e87d8b7b2201a03833c9adde232" kindref="member">acIP</ref>,<sp/><ref refid="class_watch_server_1_1_c_watch_server_1a3eb2bf017ad3579c36293ccd77faa7d6" kindref="member">m_kConfig</ref>.<ref refid="struct_watch_server_1_1_se_watch_config_1a646452a8e07717b00ba50edd3f8138ed" kindref="member">kMasterServer</ref>.<ref refid="struct_se_net_addr_1a989fa5b025bc039122e8d2a29838fde9" kindref="member">iPort</ref>,<sp/>eCode,<sp/>iParam);</highlight></codeline>
<codeline lineno="736"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal">;</highlight></codeline>
<codeline lineno="737"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="738"><highlight class="normal"></highlight></codeline>
<codeline lineno="739"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>MapAllConnect::iterator<sp/>itr<sp/>=<sp/><ref refid="class_watch_server_1_1_c_watch_server_1a8bc417bec0c22716c237d38d330df336" kindref="member">m_kAllConnect</ref>.find(rkSock);</highlight></codeline>
<codeline lineno="740"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(itr<sp/>!=<sp/><ref refid="class_watch_server_1_1_c_watch_server_1a8bc417bec0c22716c237d38d330df336" kindref="member">m_kAllConnect</ref>.end())</highlight></codeline>
<codeline lineno="741"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>{</highlight></codeline>
<codeline lineno="742"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="struct_watch_server_1_1_se_connect" kindref="compound">SeConnect</ref>*<sp/>pkConnect<sp/>=<sp/>itr-&gt;second;</highlight></codeline>
<codeline lineno="743"><highlight class="normal"></highlight></codeline>
<codeline lineno="744"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="class_watch_server_1_1_c_watch_server_1a3444555cdeb5bcef2d385962308f43a1" kindref="member">OnPlayerDisconnect</ref>(rkSock,<sp/>eCode);</highlight></codeline>
<codeline lineno="745"><highlight class="normal"></highlight></codeline>
<codeline lineno="746"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">//<sp/></highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="747"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="class_watch_server_1_1_c_watch_server_1a8bc417bec0c22716c237d38d330df336" kindref="member">m_kAllConnect</ref>.erase(itr);</highlight></codeline>
<codeline lineno="748"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>SeConnect::DEL(pkConnect);</highlight></codeline>
<codeline lineno="749"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal">;</highlight></codeline>
<codeline lineno="750"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="751"><highlight class="normal"></highlight></codeline>
<codeline lineno="752"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>MapAllInnerConnect::iterator<sp/>_it<sp/>=<sp/><ref refid="class_watch_server_1_1_c_watch_server_1aadccc5cdd59278ba38d08569cb60682d" kindref="member">m_kAllInnerConnect</ref>.find(rkSock);</highlight></codeline>
<codeline lineno="753"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(_it<sp/>!=<sp/><ref refid="class_watch_server_1_1_c_watch_server_1aadccc5cdd59278ba38d08569cb60682d" kindref="member">m_kAllInnerConnect</ref>.end())</highlight></codeline>
<codeline lineno="754"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>{</highlight></codeline>
<codeline lineno="755"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="struct_watch_server_1_1_se_inner_connect" kindref="compound">SeInnerConnect</ref>*<sp/>pkConnect<sp/>=<sp/>_it-&gt;second;</highlight></codeline>
<codeline lineno="756"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(pkConnect-&gt;<ref refid="struct_watch_server_1_1_se_inner_connect_1a0465bc27527c7e17bca19bb3f03009f2" kindref="member">eState</ref><sp/>==<sp/><ref refid="namespace_watch_server_1ac4644e31ad5820d1529141feef0eed7aa4aed545bd211a01094654bcca1255cb0" kindref="member">SCS_TOWN_OK</ref>)</highlight></codeline>
<codeline lineno="757"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>{</highlight></codeline>
<codeline lineno="758"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="_se_file_log_8h_1a59fe2018c00666084724bec1365b41f5" kindref="member">SeLogError</ref>(</highlight><highlight class="stringliteral">&quot;Disconnect<sp/>from<sp/>TS[%s:%d]<sp/>DisconnectCode[%d]<sp/>Param[%d]&quot;</highlight><highlight class="normal">,<sp/>pkConnect-&gt;<ref refid="struct_watch_server_1_1_se_inner_connect_1a2d14ccc2906c778fde9a31aa3d9b0ce3" kindref="member">kNetAddr</ref>.<ref refid="struct_se_net_addr_1a23b51e87d8b7b2201a03833c9adde232" kindref="member">acIP</ref>,<sp/>pkConnect-&gt;<ref refid="struct_watch_server_1_1_se_inner_connect_1a2d14ccc2906c778fde9a31aa3d9b0ce3" kindref="member">kNetAddr</ref>.<ref refid="struct_se_net_addr_1a989fa5b025bc039122e8d2a29838fde9" kindref="member">iPort</ref>,<sp/>eCode,<sp/>iParam);</highlight></codeline>
<codeline lineno="759"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="namespace_watch_server_1a7cc13eccd78c1d1334b1863395dd6127" kindref="member">g_kTownMgr</ref>.<ref refid="class_watch_server_1_1_se_town_mgr_1a7b4b1e9cc7ae7f37c34341e203b571f1" kindref="member">OnTSDisconnect</ref>(pkConnect-&gt;<ref refid="struct_watch_server_1_1_se_inner_connect_1a429f39bca83bc053de5ebda37c9a2ddf" kindref="member">kTownSign</ref>);</highlight></codeline>
<codeline lineno="760"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="761"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="class_watch_server_1_1_c_watch_server_1aadccc5cdd59278ba38d08569cb60682d" kindref="member">m_kAllInnerConnect</ref>.erase(_it);</highlight></codeline>
<codeline lineno="762"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>SeInnerConnect::DEL(pkConnect);</highlight></codeline>
<codeline lineno="763"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal">;</highlight></codeline>
<codeline lineno="764"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="765"><highlight class="normal"></highlight></codeline>
<codeline lineno="766"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>TSockServerDataMap::iterator<sp/>_itRs<sp/>=<sp/><ref refid="class_watch_server_1_1_c_watch_server_1aa18854da00cc2a552d66854428feab8b" kindref="member">m_mSockRsServerData</ref>.find(rkSock);</highlight></codeline>
<codeline lineno="767"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(_itRs<sp/>!=<sp/><ref refid="class_watch_server_1_1_c_watch_server_1aa18854da00cc2a552d66854428feab8b" kindref="member">m_mSockRsServerData</ref>.end())</highlight></codeline>
<codeline lineno="768"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>{</highlight></codeline>
<codeline lineno="769"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="class_watch_server_1_1_c_watch_server_1aafeb8443263a74c13874ec97f4682e4b" kindref="member">m_vRsServerData</ref>[_itRs-&gt;second].bRegistered<sp/>=<sp/></highlight><highlight class="keyword">false</highlight><highlight class="normal">;</highlight></codeline>
<codeline lineno="770"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="class_watch_server_1_1_c_watch_server_1aafeb8443263a74c13874ec97f4682e4b" kindref="member">m_vRsServerData</ref>[_itRs-&gt;second].kSock.dwAllocID<sp/>=<sp/>0;</highlight></codeline>
<codeline lineno="771"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="class_watch_server_1_1_c_watch_server_1aafeb8443263a74c13874ec97f4682e4b" kindref="member">m_vRsServerData</ref>[_itRs-&gt;second].kSock.pkSock<sp/>=<sp/>NULL;</highlight></codeline>
<codeline lineno="772"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="class_watch_server_1_1_c_watch_server_1aafeb8443263a74c13874ec97f4682e4b" kindref="member">m_vRsServerData</ref>[_itRs-&gt;second].bConnecting<sp/>=<sp/></highlight><highlight class="keyword">false</highlight><highlight class="normal">;</highlight></codeline>
<codeline lineno="773"><highlight class="normal"></highlight></codeline>
<codeline lineno="774"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="_se_file_log_8h_1a59fe2018c00666084724bec1365b41f5" kindref="member">SeLogError</ref>(</highlight><highlight class="stringliteral">&quot;Disconnect<sp/>from<sp/>RS[%s:%d]<sp/>DisconnectCode[%d]<sp/>Param[%d]&quot;</highlight><highlight class="normal">,<sp/><ref refid="class_watch_server_1_1_c_watch_server_1a3eb2bf017ad3579c36293ccd77faa7d6" kindref="member">m_kConfig</ref>.<ref refid="struct_watch_server_1_1_se_watch_config_1a7b543072c4adc05748e49293d19808d4" kindref="member">vAddrRS</ref>[_itRs-&gt;second].acIP,<sp/><ref refid="class_watch_server_1_1_c_watch_server_1a3eb2bf017ad3579c36293ccd77faa7d6" kindref="member">m_kConfig</ref>.<ref refid="struct_watch_server_1_1_se_watch_config_1a7b543072c4adc05748e49293d19808d4" kindref="member">vAddrRS</ref>[_itRs-&gt;second].iPort,<sp/>eCode,<sp/>iParam);</highlight></codeline>
<codeline lineno="775"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="class_watch_server_1_1_c_watch_server_1aa18854da00cc2a552d66854428feab8b" kindref="member">m_mSockRsServerData</ref>.erase(_itRs);</highlight></codeline>
<codeline lineno="776"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal">;</highlight></codeline>
<codeline lineno="777"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="778"><highlight class="normal"><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="779"><highlight class="normal"></highlight></codeline>
<codeline lineno="780" refid="class_watch_server_1_1_c_watch_server_1a1ca64bea8b2d3bdb67b0b6666209230d" refkind="member"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordtype">void</highlight><highlight class="normal"><sp/><ref refid="class_watch_server_1_1_c_watch_server_1a1ca64bea8b2d3bdb67b0b6666209230d" kindref="member">CWatchServer::OnPlayerConnected</ref>(<ref refid="struct_watch_server_1_1_se_connect" kindref="compound">SeConnect</ref>*<sp/>pkConnect,<sp/></highlight><highlight class="keyword">const</highlight><highlight class="normal"><sp/></highlight><highlight class="keywordtype">char</highlight><highlight class="normal">*<sp/>pcIP,<sp/></highlight><highlight class="keywordtype">int</highlight><highlight class="normal"><sp/>iPort)</highlight></codeline>
<codeline lineno="781"><highlight class="normal"><sp/><sp/><sp/><sp/>{</highlight></codeline>
<codeline lineno="782"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>pkConnect-&gt;<ref refid="struct_watch_server_1_1_se_connect_1a5e5573136bf789fb821c756b2001d0e3" kindref="member">eState</ref><sp/>=<sp/><ref refid="namespace_watch_server_1ac4644e31ad5820d1529141feef0eed7aae9411688d92f7749ae30426d7901f913" kindref="member">SCS_UNKOWN</ref>;</highlight></codeline>
<codeline lineno="783"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>pkConnect-&gt;<ref refid="struct_watch_server_1_1_se_connect_1a37b3882bb4d905834147a67ec1903e27" kindref="member">dwStateTime</ref><sp/>=<sp/><ref refid="class_watch_server_1_1_c_watch_server_1a9bc827b6b1bf525952a8f637ec4b5233" kindref="member">m_dwCurTime</ref>;</highlight></codeline>
<codeline lineno="784"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>pkConnect-&gt;<ref refid="struct_watch_server_1_1_se_connect_1a1052e18ab678b25229e82e39ee11fcba" kindref="member">dwLastRecvTime</ref><sp/>=<sp/><ref refid="class_watch_server_1_1_c_watch_server_1a9bc827b6b1bf525952a8f637ec4b5233" kindref="member">m_dwCurTime</ref>;</highlight></codeline>
<codeline lineno="785"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="_se_tool_8cpp_1a4d30fbe56257fc998ebc1346e53be0d8" kindref="member">StrCpy</ref>(pkConnect-&gt;<ref refid="struct_watch_server_1_1_se_connect_1a9957675b49f98dd0576e63332c9f4842" kindref="member">kNetAddr</ref>.<ref refid="struct_se_net_addr_1a23b51e87d8b7b2201a03833c9adde232" kindref="member">acIP</ref>,<sp/></highlight><highlight class="keyword">sizeof</highlight><highlight class="normal">(pkConnect-&gt;<ref refid="struct_watch_server_1_1_se_connect_1a9957675b49f98dd0576e63332c9f4842" kindref="member">kNetAddr</ref>.<ref refid="struct_se_net_addr_1a23b51e87d8b7b2201a03833c9adde232" kindref="member">acIP</ref>),<sp/>pcIP);</highlight></codeline>
<codeline lineno="786"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>pkConnect-&gt;<ref refid="struct_watch_server_1_1_se_connect_1a9957675b49f98dd0576e63332c9f4842" kindref="member">kNetAddr</ref>.<ref refid="struct_se_net_addr_1a989fa5b025bc039122e8d2a29838fde9" kindref="member">iPort</ref><sp/>=<sp/>iPort;</highlight></codeline>
<codeline lineno="787"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>pkConnect-&gt;<ref refid="struct_watch_server_1_1_se_connect_1af905c998f89e5d5d83271e3c5b7ab586" kindref="member">dwPlayerID</ref><sp/>=<sp/>0;</highlight></codeline>
<codeline lineno="788"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="_se_tool_8cpp_1a1cf7ec78fb6f69a807c3f15e0554909a" kindref="member">GenEncryptKey</ref>(pkConnect-&gt;<ref refid="struct_watch_server_1_1_se_connect_1a8f9f1eafded5d3c415b6e8f53dd8c3ff" kindref="member">acEncryptKey</ref>,<sp/><ref refid="_se_ptl_comm_define_8h_1af62c3a00672953c86a2586d53c60663aa545aa5c585c544fb7b25a57dc400909b" kindref="member">SSD_EN_KEY_LEN</ref>);</highlight></codeline>
<codeline lineno="789"><highlight class="normal"></highlight></codeline>
<codeline lineno="790"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">//<sp/><sp/><sp/><sp/><sp/><sp/>SeUDPSender<sp/>kSender;</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="791"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">//<sp/><sp/><sp/><sp/><sp/><sp/>kSender.kSock<sp/>=<sp/>pkConnect-&gt;kSock;</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="792"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">//<sp/><sp/><sp/><sp/><sp/><sp/>//<sp/></highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="793"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">//<sp/><sp/><sp/><sp/><sp/><sp/>if<sp/>(IsTestRobotMode())</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="794"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">//<sp/><sp/><sp/><sp/><sp/><sp/>{</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="795"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">//<sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>SendRC_EncryptKey(pkConnect-&gt;acEncryptKey,<sp/>++m_kConfig.dwGenRobotID,<sp/>&amp;kSender);</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="796"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">//<sp/><sp/><sp/><sp/><sp/><sp/>}</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="797"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">//<sp/><sp/><sp/><sp/><sp/><sp/>else</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="798"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">//<sp/><sp/><sp/><sp/><sp/><sp/>{</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="799"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">//<sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>SendRC_EncryptKey(pkConnect-&gt;acEncryptKey,<sp/>LOGIC_VERSION,<sp/>&amp;kSender);</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="800"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">//<sp/><sp/><sp/><sp/><sp/><sp/>}</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="801"><highlight class="normal"></highlight></codeline>
<codeline lineno="802"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="class_watch_server_1_1_c_watch_server_1ab018a647c2f30b04f411a6441a20e0b0" kindref="member">SendWCSC_EncryptKey</ref>(pkConnect-&gt;<ref refid="struct_watch_server_1_1_se_connect_1a8f9f1eafded5d3c415b6e8f53dd8c3ff" kindref="member">acEncryptKey</ref>,<sp/><ref refid="_se_define_8h_1adc43374bec4aa6c4c8af612a8592592d" kindref="member">LOGIC_VERSION</ref>,<sp/>&amp;pkConnect-&gt;<ref refid="struct_watch_server_1_1_se_connect_1af900a81e9f911c8efa7975390a0239b1" kindref="member">kSock</ref>);</highlight></codeline>
<codeline lineno="803"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="_se_file_log_8h_1a83f3fe470b91cb8eed8762cc8e5e26c3" kindref="member">SeLogInfo</ref>(</highlight><highlight class="stringliteral">&quot;Create<sp/>new<sp/>player<sp/>conn[%u]:<sp/>ip[%s]<sp/>port[%d]&quot;</highlight><highlight class="normal">,<sp/>pkConnect-&gt;<ref refid="struct_watch_server_1_1_se_connect_1af900a81e9f911c8efa7975390a0239b1" kindref="member">kSock</ref>.dwAllocID,<sp/>pcIP,<sp/>iPort);</highlight></codeline>
<codeline lineno="804"><highlight class="normal"><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="805"><highlight class="normal"></highlight></codeline>
<codeline lineno="806" refid="class_watch_server_1_1_c_watch_server_1a3444555cdeb5bcef2d385962308f43a1" refkind="member"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordtype">void</highlight><highlight class="normal"><sp/><ref refid="class_watch_server_1_1_c_watch_server_1a3444555cdeb5bcef2d385962308f43a1" kindref="member">CWatchServer::OnPlayerDisconnect</ref>(HSock<sp/>rkSock,<sp/>TeDisconnectCode<sp/>eCode)</highlight></codeline>
<codeline lineno="807"><highlight class="normal"><sp/><sp/><sp/><sp/>{</highlight></codeline>
<codeline lineno="808"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>MapAllConnect::iterator<sp/>iMapItr<sp/>=<sp/><ref refid="class_watch_server_1_1_c_watch_server_1a8bc417bec0c22716c237d38d330df336" kindref="member">m_kAllConnect</ref>.find(rkSock);</highlight></codeline>
<codeline lineno="809"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(iMapItr<sp/>!=<sp/><ref refid="class_watch_server_1_1_c_watch_server_1a8bc417bec0c22716c237d38d330df336" kindref="member">m_kAllConnect</ref>.end())</highlight></codeline>
<codeline lineno="810"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>{</highlight></codeline>
<codeline lineno="811"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="struct_watch_server_1_1_se_connect" kindref="compound">SeConnect</ref>*<sp/>pkConn<sp/>=<sp/>iMapItr-&gt;second;</highlight></codeline>
<codeline lineno="812"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="namespace_watch_server_1a1ba085da8e82bcc688d64e20a5a48f5c" kindref="member">g_kRaceMgr</ref>.<ref refid="class_watch_server_1_1_c_se_race_mgr_1ae136650b49230a072a448b76121707be" kindref="member">removeViewPlayer</ref>(pkConn-&gt;<ref refid="struct_watch_server_1_1_se_connect_1af905c998f89e5d5d83271e3c5b7ab586" kindref="member">dwPlayerID</ref>);</highlight></codeline>
<codeline lineno="813"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(eCode<sp/>!=<sp/>TDC_SELF_DISC)</highlight></codeline>
<codeline lineno="814"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>{</highlight></codeline>
<codeline lineno="815"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="class_watch_server_1_1_c_watch_server_1a9aa90e76d701e864f90b995e12e05dc4" kindref="member">DisconnectPlayer</ref>(pkConn);</highlight></codeline>
<codeline lineno="816"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="817"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="818"><highlight class="normal"><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="819"><highlight class="normal"></highlight></codeline>
<codeline lineno="820" refid="class_watch_server_1_1_c_watch_server_1a9df940da12db52a3c98459b398c558a1" refkind="member"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordtype">void</highlight><highlight class="normal"><sp/><ref refid="class_watch_server_1_1_c_watch_server_1a9aa90e76d701e864f90b995e12e05dc4" kindref="member">CWatchServer::DisconnectPlayer</ref>(<ref refid="struct_watch_server_1_1_se_connect" kindref="compound">SeConnect</ref>*<sp/>pkConn)</highlight></codeline>
<codeline lineno="821"><highlight class="normal"><sp/><sp/><sp/><sp/>{</highlight></codeline>
<codeline lineno="822"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>{</highlight></codeline>
<codeline lineno="823"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="class_watch_server_1_1_c_watch_server_1a3dc54fcd755ce4e21f181aa6f4d91b4d" kindref="member">m_kNetMgr</ref>.Disconnect(pkConn-&gt;<ref refid="struct_watch_server_1_1_se_connect_1af900a81e9f911c8efa7975390a0239b1" kindref="member">kSock</ref>);</highlight></codeline>
<codeline lineno="824"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="825"><highlight class="normal"><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="826"><highlight class="normal"></highlight></codeline>
<codeline lineno="827" refid="class_watch_server_1_1_c_watch_server_1a9aa90e76d701e864f90b995e12e05dc4" refkind="member"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordtype">void</highlight><highlight class="normal"><sp/><ref refid="class_watch_server_1_1_c_watch_server_1a9aa90e76d701e864f90b995e12e05dc4" kindref="member">CWatchServer::DisconnectPlayer</ref>(HSock&amp;<sp/>rSock)</highlight></codeline>
<codeline lineno="828"><highlight class="normal"><sp/><sp/><sp/><sp/>{</highlight></codeline>
<codeline lineno="829"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="class_watch_server_1_1_c_watch_server_1a3dc54fcd755ce4e21f181aa6f4d91b4d" kindref="member">m_kNetMgr</ref>.Disconnect(rSock);</highlight></codeline>
<codeline lineno="830"><highlight class="normal"><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="831"><highlight class="normal"></highlight></codeline>
<codeline lineno="832" refid="class_watch_server_1_1_c_watch_server_1a12d36ae4e2d6851452f7af36d1e5784d" refkind="member"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordtype">void</highlight><highlight class="normal"><sp/><ref refid="class_watch_server_1_1_c_watch_server_1a12d36ae4e2d6851452f7af36d1e5784d" kindref="member">CWatchServer::onHandleNewRace</ref>(</highlight><highlight class="keyword">const</highlight><highlight class="normal"><sp/><ref refid="struct_te_m_d5" kindref="compound">TeMD5</ref>&amp;<sp/>rRaceID)</highlight></codeline>
<codeline lineno="833"><highlight class="normal"><sp/><sp/><sp/><sp/>{</highlight></codeline>
<codeline lineno="834"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(<ref refid="class_watch_server_1_1_c_watch_server_1a3eb2bf017ad3579c36293ccd77faa7d6" kindref="member">m_kConfig</ref>.<ref refid="struct_watch_server_1_1_se_watch_config_1a1e7b8a2841fe92c37a11df68ed224511" kindref="member">bMgr</ref>)</highlight></codeline>
<codeline lineno="835"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>{</highlight></codeline>
<codeline lineno="836"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="namespace_watch_server_1ab985a30dbaa554391d708254872572c9" kindref="member">g_kWatchServerMgr</ref>.<ref refid="class_watch_server_1_1_c_watch_server_mgr_1a083dcc7adeb0dedb99743529bd65a0ab" kindref="member">addViewRace</ref>(rRaceID,<sp/><ref refid="class_watch_server_1_1_c_watch_server_1a502c0b4d12916410078c3d72b20945d5" kindref="member">GetServerID</ref>());</highlight></codeline>
<codeline lineno="837"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="838"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">else</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="839"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>{</highlight></codeline>
<codeline lineno="840"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">//TODO:</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="841"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">//Send<sp/>new<sp/>race<sp/>to<sp/>WCMS;</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="842"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="843"><highlight class="normal"><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="844"><highlight class="normal"></highlight></codeline>
<codeline lineno="845" refid="class_watch_server_1_1_c_watch_server_1a1b5f8ee69896e5c63de2406acc664fac" refkind="member"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordtype">void</highlight><highlight class="normal"><sp/><ref refid="class_watch_server_1_1_c_watch_server_1a1b5f8ee69896e5c63de2406acc664fac" kindref="member">CWatchServer::onDelRace</ref>(</highlight><highlight class="keyword">const</highlight><highlight class="normal"><sp/><ref refid="struct_te_m_d5" kindref="compound">TeMD5</ref>&amp;<sp/>rRaceID)</highlight></codeline>
<codeline lineno="846"><highlight class="normal"><sp/><sp/><sp/><sp/>{</highlight></codeline>
<codeline lineno="847"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(<ref refid="class_watch_server_1_1_c_watch_server_1a3eb2bf017ad3579c36293ccd77faa7d6" kindref="member">m_kConfig</ref>.<ref refid="struct_watch_server_1_1_se_watch_config_1a1e7b8a2841fe92c37a11df68ed224511" kindref="member">bMgr</ref>)</highlight></codeline>
<codeline lineno="848"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>{</highlight></codeline>
<codeline lineno="849"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="namespace_watch_server_1ab985a30dbaa554391d708254872572c9" kindref="member">g_kWatchServerMgr</ref>.<ref refid="class_watch_server_1_1_c_watch_server_mgr_1ab7a7ce81a54ae80eb421ef9e5bb482c7" kindref="member">delViewRace</ref>(rRaceID);</highlight></codeline>
<codeline lineno="850"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="851"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">else</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="852"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>{</highlight></codeline>
<codeline lineno="853"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">//TODO:</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="854"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">//Send<sp/>del<sp/>race<sp/>to<sp/>WCMS;</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="855"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="856"><highlight class="normal"><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="857"><highlight class="normal"></highlight></codeline>
<codeline lineno="858" refid="class_watch_server_1_1_c_watch_server_1a11f16d3238f2f1006675bff5d704c12b" refkind="member"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordtype">void</highlight><highlight class="normal"><sp/><ref refid="class_watch_server_1_1_c_watch_server_1a11f16d3238f2f1006675bff5d704c12b" kindref="member">CWatchServer::SetPlayerConnect</ref>(HSock<sp/>kSock,<sp/>DWord<sp/>dwPlayerID)</highlight></codeline>
<codeline lineno="859"><highlight class="normal"><sp/><sp/><sp/><sp/>{</highlight></codeline>
<codeline lineno="860"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>MapAllConnect::iterator<sp/>it<sp/>=<sp/><ref refid="class_watch_server_1_1_c_watch_server_1a8bc417bec0c22716c237d38d330df336" kindref="member">m_kAllConnect</ref>.find(kSock);</highlight></codeline>
<codeline lineno="861"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(it<sp/>==<sp/><ref refid="class_watch_server_1_1_c_watch_server_1a8bc417bec0c22716c237d38d330df336" kindref="member">m_kAllConnect</ref>.end())</highlight></codeline>
<codeline lineno="862"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>{</highlight></codeline>
<codeline lineno="863"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal">;</highlight></codeline>
<codeline lineno="864"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="865"><highlight class="normal"></highlight></codeline>
<codeline lineno="866"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="struct_watch_server_1_1_se_connect" kindref="compound">SeConnect</ref>*<sp/>pConnect<sp/>=<sp/>it-&gt;second;</highlight></codeline>
<codeline lineno="867"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(NULL<sp/>==<sp/>pConnect)</highlight></codeline>
<codeline lineno="868"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>{</highlight></codeline>
<codeline lineno="869"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal">;</highlight></codeline>
<codeline lineno="870"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="871"><highlight class="normal"></highlight></codeline>
<codeline lineno="872"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>pConnect-&gt;<ref refid="struct_watch_server_1_1_se_connect_1af905c998f89e5d5d83271e3c5b7ab586" kindref="member">dwPlayerID</ref><sp/>=<sp/>dwPlayerID;</highlight></codeline>
<codeline lineno="873"><highlight class="normal"></highlight></codeline>
<codeline lineno="874"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="class_watch_server_1_1_c_watch_server_1a8bc417bec0c22716c237d38d330df336" kindref="member">m_kAllConnect</ref>[kSock]<sp/>=<sp/>pConnect;</highlight></codeline>
<codeline lineno="875"><highlight class="normal"><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="876"><highlight class="normal"></highlight></codeline>
<codeline lineno="877" refid="class_watch_server_1_1_c_watch_server_1a7ac28b5d931fa58008b5d34107df294e" refkind="member"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordtype">void</highlight><highlight class="normal"><sp/><ref refid="class_watch_server_1_1_c_watch_server_1a7ac28b5d931fa58008b5d34107df294e" kindref="member">CWatchServer::RaceWatchUserSync</ref>(DWord<sp/>dwPlayerID,<sp/>DWord<sp/>dwStateID)</highlight></codeline>
<codeline lineno="878"><highlight class="normal"><sp/><sp/><sp/><sp/>{</highlight></codeline>
<codeline lineno="879"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="namespace_watch_server_1ab985a30dbaa554391d708254872572c9" kindref="member">g_kWatchServerMgr</ref>.<ref refid="class_watch_server_1_1_c_watch_server_mgr_1a720ff56e28c1e74ed56806132094fb10" kindref="member">onRaceWatchUserSync</ref>(dwPlayerID,<sp/>dwStateID);</highlight></codeline>
<codeline lineno="880"><highlight class="normal"><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="881"><highlight class="normal">}</highlight></codeline>
    </programlisting>
    <location file="F:/TeamWork/ServerVersion/projects/server/Server/Server/WatchServer/Src/WatchServer.cpp"/>
  </compounddef>
</doxygen>
