<?xml version='1.0' encoding='UTF-8' standalone='no'?>
<doxygen xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xsi:noNamespaceSchemaLocation="compound.xsd" version="1.8.6">
  <compounddef id="_match_server_2src_2_se_race_mgr_8cpp" kind="file">
    <compoundname>SeRaceMgr.cpp</compoundname>
    <includes refid="_match_server_2src_2_se_race_mgr_8h" local="yes">SeRaceMgr.h</includes>
    <includes refid="src_2_match_server_8h" local="yes">MatchServer.h</includes>
    <includes refid="src_2_se_race_query_mgr_8h" local="yes">SeRaceQueryMgr.h</includes>
    <incdepgraph>
      <node id="36604">
        <label>list</label>
      </node>
      <node id="36598">
        <label>locale</label>
      </node>
      <node id="36723">
        <label>AchievementTask_table.hpp</label>
        <link refid="_achievement_task__table_8hpp"/>
        <childnode refid="36601" relation="include">
        </childnode>
        <childnode refid="36605" relation="include">
        </childnode>
        <childnode refid="36627" relation="include">
        </childnode>
      </node>
      <node id="36733">
        <label>SeHttpProcess.inl</label>
        <link refid="_match_server_2src_2_se_http_process_8inl"/>
      </node>
      <node id="36637">
        <label>SePtl_MS_To_WS.h</label>
        <link refid="_se_ptl___m_s___to___w_s_8h"/>
        <childnode refid="36618" relation="include">
        </childnode>
      </node>
      <node id="36636">
        <label>SePtl_WS_To_MS.h</label>
        <link refid="_se_ptl___w_s___to___m_s_8h"/>
        <childnode refid="36618" relation="include">
        </childnode>
      </node>
      <node id="36732">
        <label>SeHttpSend.inl</label>
        <link refid="_match_server_2src_2_se_http_send_8inl"/>
      </node>
      <node id="36694">
        <label>MGClientExport.h</label>
        <link refid="_m_g_client_export_8h"/>
      </node>
      <node id="36687">
        <label>EffectSwitch_table.hpp</label>
        <link refid="_effect_switch__table_8hpp"/>
        <childnode refid="36601" relation="include">
        </childnode>
        <childnode refid="36605" relation="include">
        </childnode>
        <childnode refid="36627" relation="include">
        </childnode>
      </node>
      <node id="36662">
        <label>Racehelp_table.hpp</label>
        <link refid="_racehelp__table_8hpp"/>
        <childnode refid="36601" relation="include">
        </childnode>
        <childnode refid="36605" relation="include">
        </childnode>
        <childnode refid="36627" relation="include">
        </childnode>
      </node>
      <node id="36608">
        <label>queue</label>
      </node>
      <node id="36602">
        <label>limits</label>
      </node>
      <node id="36647">
        <label>SeTownMgr.h</label>
        <link refid="_match_server_2src_2_se_town_mgr_8h"/>
        <childnode refid="36648" relation="include">
        </childnode>
      </node>
      <node id="36620">
        <label>SePtlCommDefine.h</label>
        <link refid="_se_ptl_comm_define_8h"/>
      </node>
      <node id="36720">
        <label>KillBounty_table.hpp</label>
        <link refid="_kill_bounty__table_8hpp"/>
        <childnode refid="36601" relation="include">
        </childnode>
        <childnode refid="36605" relation="include">
        </childnode>
        <childnode refid="36627" relation="include">
        </childnode>
      </node>
      <node id="36649">
        <label>SeRaceSvrMgr.h</label>
        <link refid="src_2_se_race_svr_mgr_8h"/>
        <childnode refid="36650" relation="include">
        </childnode>
      </node>
      <node id="36621">
        <label>SeMemPool.h</label>
        <link refid="_se_mem_pool_8h"/>
        <childnode refid="36583" relation="include">
        </childnode>
        <childnode refid="36622" relation="include">
        </childnode>
        <childnode refid="36590" relation="include">
        </childnode>
      </node>
      <node id="36585">
        <label>windows.h</label>
      </node>
      <node id="36675">
        <label>Pet_table.hpp</label>
        <link refid="_pet__table_8hpp"/>
        <childnode refid="36601" relation="include">
        </childnode>
        <childnode refid="36605" relation="include">
        </childnode>
        <childnode refid="36627" relation="include">
        </childnode>
      </node>
      <node id="36734">
        <label>SeTMProcess.inl</label>
        <link refid="_se_t_m_process_8inl"/>
      </node>
      <node id="36590">
        <label>assert.h</label>
      </node>
      <node id="36715">
        <label>FreeHeroes_table.hpp</label>
        <link refid="_free_heroes__table_8hpp"/>
        <childnode refid="36601" relation="include">
        </childnode>
        <childnode refid="36605" relation="include">
        </childnode>
        <childnode refid="36627" relation="include">
        </childnode>
      </node>
      <node id="36729">
        <label>SeMTSend.inl</label>
        <link refid="_se_m_t_send_8inl"/>
      </node>
      <node id="36638">
        <label>SePtl_BLS_To_MS.h</label>
        <link refid="_se_ptl___b_l_s___to___m_s_8h"/>
        <childnode refid="36618" relation="include">
        </childnode>
        <childnode refid="36611" relation="include">
        </childnode>
      </node>
      <node id="36726">
        <label>SeMatchMgr.h</label>
        <link refid="src_2_se_match_mgr_8h"/>
        <childnode refid="36583" relation="include">
        </childnode>
        <childnode refid="36620" relation="include">
        </childnode>
        <childnode refid="36611" relation="include">
        </childnode>
        <childnode refid="36648" relation="include">
        </childnode>
        <childnode refid="36621" relation="include">
        </childnode>
        <childnode refid="36582" relation="include">
        </childnode>
        <childnode refid="36727" relation="include">
        </childnode>
      </node>
      <node id="36684">
        <label>RandomName_table.hpp</label>
        <link refid="_random_name__table_8hpp"/>
        <childnode refid="36601" relation="include">
        </childnode>
        <childnode refid="36605" relation="include">
        </childnode>
        <childnode refid="36627" relation="include">
        </childnode>
      </node>
      <node id="36640">
        <label>SeDBDefine.h</label>
        <link refid="_se_d_b_define_8h"/>
        <childnode refid="36618" relation="include">
        </childnode>
      </node>
      <node id="36623">
        <label>SeTimer.h</label>
        <link refid="_se_timer_8h"/>
      </node>
      <node id="36702">
        <label>MapShopRes_table.hpp</label>
        <link refid="_map_shop_res__table_8hpp"/>
        <childnode refid="36601" relation="include">
        </childnode>
        <childnode refid="36605" relation="include">
        </childnode>
        <childnode refid="36627" relation="include">
        </childnode>
      </node>
      <node id="36678">
        <label>chance_table.hpp</label>
        <link refid="_chance__table_8hpp"/>
        <childnode refid="36601" relation="include">
        </childnode>
        <childnode refid="36605" relation="include">
        </childnode>
        <childnode refid="36627" relation="include">
        </childnode>
      </node>
      <node id="36588">
        <label>stdlib.h</label>
      </node>
      <node id="36622">
        <label>EsLock.h</label>
      </node>
      <node id="36654">
        <label>Unit_table.hpp</label>
        <link refid="_unit__table_8hpp"/>
        <childnode refid="36601" relation="include">
        </childnode>
        <childnode refid="36605" relation="include">
        </childnode>
        <childnode refid="36627" relation="include">
        </childnode>
      </node>
      <node id="36628">
        <label>MatchServer.h</label>
        <link refid="src_2_match_server_8h"/>
        <childnode refid="36629" relation="include">
        </childnode>
        <childnode refid="36630" relation="include">
        </childnode>
        <childnode refid="36631" relation="include">
        </childnode>
        <childnode refid="36643" relation="include">
        </childnode>
        <childnode refid="36645" relation="include">
        </childnode>
        <childnode refid="36611" relation="include">
        </childnode>
        <childnode refid="36646" relation="include">
        </childnode>
        <childnode refid="36621" relation="include">
        </childnode>
        <childnode refid="36647" relation="include">
        </childnode>
        <childnode refid="36649" relation="include">
        </childnode>
        <childnode refid="36582" relation="include">
        </childnode>
        <childnode refid="36651" relation="include">
        </childnode>
        <childnode refid="36652" relation="include">
        </childnode>
        <childnode refid="36724" relation="include">
        </childnode>
        <childnode refid="36725" relation="include">
        </childnode>
        <childnode refid="36620" relation="include">
        </childnode>
        <childnode refid="36726" relation="include">
        </childnode>
        <childnode refid="36729" relation="include">
        </childnode>
        <childnode refid="36730" relation="include">
        </childnode>
        <childnode refid="36731" relation="include">
        </childnode>
        <childnode refid="36732" relation="include">
        </childnode>
        <childnode refid="36733" relation="include">
        </childnode>
        <childnode refid="36734" relation="include">
        </childnode>
        <childnode refid="36735" relation="include">
        </childnode>
        <childnode refid="36736" relation="include">
        </childnode>
        <childnode refid="36737" relation="include">
        </childnode>
        <childnode refid="36738" relation="include">
        </childnode>
        <childnode refid="36739" relation="include">
        </childnode>
        <childnode refid="36740" relation="include">
        </childnode>
        <childnode refid="36741" relation="include">
        </childnode>
      </node>
      <node id="36582">
        <label>SeRaceMgrDef.h</label>
        <link refid="_match_server_2src_2_se_race_mgr_def_8h"/>
        <childnode refid="36583" relation="include">
        </childnode>
        <childnode refid="36611" relation="include">
        </childnode>
        <childnode refid="36618" relation="include">
        </childnode>
      </node>
      <node id="36735">
        <label>SeRMProcess.inl</label>
        <link refid="_se_r_m_process_8inl"/>
      </node>
      <node id="36669">
        <label>RenJiCustomData_table.hpp</label>
        <link refid="_ren_ji_custom_data__table_8hpp"/>
        <childnode refid="36601" relation="include">
        </childnode>
        <childnode refid="36605" relation="include">
        </childnode>
        <childnode refid="36627" relation="include">
        </childnode>
      </node>
      <node id="36677">
        <label>Dress_table.hpp</label>
        <link refid="_dress__table_8hpp"/>
        <childnode refid="36601" relation="include">
        </childnode>
        <childnode refid="36605" relation="include">
        </childnode>
        <childnode refid="36627" relation="include">
        </childnode>
      </node>
      <node id="36592">
        <label>cmath</label>
      </node>
      <node id="36700">
        <label>AvatarEffect_table.hpp</label>
        <link refid="_avatar_effect__table_8hpp"/>
        <childnode refid="36601" relation="include">
        </childnode>
        <childnode refid="36605" relation="include">
        </childnode>
        <childnode refid="36627" relation="include">
        </childnode>
      </node>
      <node id="36705">
        <label>MapMisc_table.hpp</label>
        <link refid="_map_misc__table_8hpp"/>
        <childnode refid="36601" relation="include">
        </childnode>
        <childnode refid="36605" relation="include">
        </childnode>
        <childnode refid="36627" relation="include">
        </childnode>
      </node>
      <node id="36709">
        <label>UpgradeCost_table.hpp</label>
        <link refid="_upgrade_cost__table_8hpp"/>
        <childnode refid="36601" relation="include">
        </childnode>
        <childnode refid="36605" relation="include">
        </childnode>
        <childnode refid="36627" relation="include">
        </childnode>
      </node>
      <node id="36722">
        <label>VideoTag_table.hpp</label>
        <link refid="_video_tag__table_8hpp"/>
        <childnode refid="36601" relation="include">
        </childnode>
        <childnode refid="36605" relation="include">
        </childnode>
        <childnode refid="36627" relation="include">
        </childnode>
      </node>
      <node id="36667">
        <label>RenJiActions_table.hpp</label>
        <link refid="_ren_ji_actions__table_8hpp"/>
        <childnode refid="36601" relation="include">
        </childnode>
        <childnode refid="36605" relation="include">
        </childnode>
        <childnode refid="36627" relation="include">
        </childnode>
      </node>
      <node id="36627">
        <label>SeTableResBase.h</label>
        <link refid="_se_table_res_base_8h"/>
        <childnode refid="36603" relation="include">
        </childnode>
      </node>
      <node id="36601">
        <label>string</label>
      </node>
      <node id="36635">
        <label>SePtl_HS_To_HS.h</label>
        <link refid="_se_ptl___h_s___to___h_s_8h"/>
        <childnode refid="36618" relation="include">
        </childnode>
      </node>
      <node id="36711">
        <label>AppendSkill_table.hpp</label>
        <link refid="_append_skill__table_8hpp"/>
        <childnode refid="36601" relation="include">
        </childnode>
        <childnode refid="36605" relation="include">
        </childnode>
        <childnode refid="36627" relation="include">
        </childnode>
      </node>
      <node id="36605">
        <label>map</label>
      </node>
      <node id="36643">
        <label>SeFileLog.h</label>
        <link refid="_se_file_log_8h"/>
        <childnode refid="36644" relation="include">
        </childnode>
        <childnode refid="36594" relation="include">
        </childnode>
        <childnode refid="36622" relation="include">
        </childnode>
      </node>
      <node id="36650">
        <label>SeRaceSvrMgrDef.h</label>
        <link refid="src_2_se_race_svr_mgr_def_8h"/>
        <childnode refid="36631" relation="include">
        </childnode>
      </node>
      <node id="36651">
        <label>SeRaceQueryMgrDef.h</label>
        <link refid="src_2_se_race_query_mgr_def_8h"/>
        <childnode refid="36583" relation="include">
        </childnode>
        <childnode refid="36618" relation="include">
        </childnode>
        <childnode refid="36582" relation="include">
        </childnode>
      </node>
      <node id="36587">
        <label>conio.h</label>
      </node>
      <node id="36668">
        <label>RenJiConditions_table.hpp</label>
        <link refid="_ren_ji_conditions__table_8hpp"/>
        <childnode refid="36601" relation="include">
        </childnode>
        <childnode refid="36605" relation="include">
        </childnode>
        <childnode refid="36627" relation="include">
        </childnode>
      </node>
      <node id="36619">
        <label>SePtlRandomNumDef.h</label>
        <link refid="_se_ptl_random_num_def_8h"/>
      </node>
      <node id="36642">
        <label>SePtl_MS_To_NS.h</label>
        <link refid="_se_ptl___m_s___to___n_s_8h"/>
        <childnode refid="36618" relation="include">
        </childnode>
      </node>
      <node id="36641">
        <label>SePtl_NS_To_MS.h</label>
        <link refid="_se_ptl___n_s___to___m_s_8h"/>
        <childnode refid="36618" relation="include">
        </childnode>
      </node>
      <node id="36710">
        <label>Decompose_table.hpp</label>
        <link refid="_decompose__table_8hpp"/>
        <childnode refid="36601" relation="include">
        </childnode>
        <childnode refid="36605" relation="include">
        </childnode>
        <childnode refid="36627" relation="include">
        </childnode>
      </node>
      <node id="36664">
        <label>ItemExchange_table.hpp</label>
        <link refid="_item_exchange__table_8hpp"/>
        <childnode refid="36601" relation="include">
        </childnode>
        <childnode refid="36605" relation="include">
        </childnode>
        <childnode refid="36627" relation="include">
        </childnode>
      </node>
      <node id="36696">
        <label>HeroInfo_table.hpp</label>
        <link refid="_hero_info__table_8hpp"/>
        <childnode refid="36601" relation="include">
        </childnode>
        <childnode refid="36605" relation="include">
        </childnode>
        <childnode refid="36627" relation="include">
        </childnode>
      </node>
      <node id="36586">
        <label>direct.h</label>
      </node>
      <node id="36693">
        <label>GlobalTableMgr.h</label>
        <link refid="_global_table_mgr_8h"/>
        <childnode refid="36694" relation="include">
        </childnode>
        <childnode refid="36626" relation="include">
        </childnode>
        <childnode refid="36655" relation="include">
        </childnode>
        <childnode refid="36659" relation="include">
        </childnode>
        <childnode refid="36654" relation="include">
        </childnode>
        <childnode refid="36657" relation="include">
        </childnode>
        <childnode refid="36689" relation="include">
        </childnode>
        <childnode refid="36690" relation="include">
        </childnode>
        <childnode refid="36692" relation="include">
        </childnode>
        <childnode refid="36695" relation="include">
        </childnode>
        <childnode refid="36696" relation="include">
        </childnode>
        <childnode refid="36697" relation="include">
        </childnode>
        <childnode refid="36698" relation="include">
        </childnode>
        <childnode refid="36699" relation="include">
        </childnode>
        <childnode refid="36700" relation="include">
        </childnode>
        <childnode refid="36656" relation="include">
        </childnode>
        <childnode refid="36701" relation="include">
        </childnode>
        <childnode refid="36682" relation="include">
        </childnode>
        <childnode refid="36702" relation="include">
        </childnode>
        <childnode refid="36703" relation="include">
        </childnode>
        <childnode refid="36704" relation="include">
        </childnode>
        <childnode refid="36691" relation="include">
        </childnode>
        <childnode refid="36705" relation="include">
        </childnode>
        <childnode refid="36706" relation="include">
        </childnode>
        <childnode refid="36661" relation="include">
        </childnode>
        <childnode refid="36707" relation="include">
        </childnode>
        <childnode refid="36708" relation="include">
        </childnode>
        <childnode refid="36709" relation="include">
        </childnode>
        <childnode refid="36710" relation="include">
        </childnode>
        <childnode refid="36711" relation="include">
        </childnode>
        <childnode refid="36665" relation="include">
        </childnode>
        <childnode refid="36663" relation="include">
        </childnode>
        <childnode refid="36712" relation="include">
        </childnode>
        <childnode refid="36713" relation="include">
        </childnode>
        <childnode refid="36714" relation="include">
        </childnode>
        <childnode refid="36715" relation="include">
        </childnode>
        <childnode refid="36678" relation="include">
        </childnode>
        <childnode refid="36716" relation="include">
        </childnode>
      </node>
      <node id="36691">
        <label>BattleTips_table.hpp</label>
        <link refid="_battle_tips__table_8hpp"/>
        <childnode refid="36601" relation="include">
        </childnode>
        <childnode refid="36605" relation="include">
        </childnode>
        <childnode refid="36627" relation="include">
        </childnode>
      </node>
      <node id="36673">
        <label>TaskInfo_table.hpp</label>
        <link refid="_task_info__table_8hpp"/>
        <childnode refid="36601" relation="include">
        </childnode>
        <childnode refid="36605" relation="include">
        </childnode>
        <childnode refid="36627" relation="include">
        </childnode>
      </node>
      <node id="36714">
        <label>Propaganda_table.hpp</label>
        <link refid="_propaganda__table_8hpp"/>
        <childnode refid="36601" relation="include">
        </childnode>
        <childnode refid="36605" relation="include">
        </childnode>
        <childnode refid="36627" relation="include">
        </childnode>
      </node>
      <node id="36706">
        <label>MapsInfo_table.hpp</label>
        <link refid="_maps_info__table_8hpp"/>
        <childnode refid="36601" relation="include">
        </childnode>
        <childnode refid="36605" relation="include">
        </childnode>
        <childnode refid="36627" relation="include">
        </childnode>
      </node>
      <node id="36599">
        <label>fstream</label>
      </node>
      <node id="36631">
        <label>MatchServerDef.h</label>
        <link refid="src_2_match_server_def_8h"/>
        <childnode refid="36612" relation="include">
        </childnode>
        <childnode refid="36621" relation="include">
        </childnode>
        <childnode refid="36613" relation="include">
        </childnode>
        <childnode refid="36618" relation="include">
        </childnode>
        <childnode refid="36632" relation="include">
        </childnode>
        <childnode refid="36611" relation="include">
        </childnode>
        <childnode refid="36624" relation="include">
        </childnode>
        <childnode refid="36633" relation="include">
        </childnode>
        <childnode refid="36625" relation="include">
        </childnode>
        <childnode refid="36634" relation="include">
        </childnode>
        <childnode refid="36635" relation="include">
        </childnode>
        <childnode refid="36636" relation="include">
        </childnode>
        <childnode refid="36637" relation="include">
        </childnode>
        <childnode refid="36638" relation="include">
        </childnode>
        <childnode refid="36639" relation="include">
        </childnode>
        <childnode refid="36641" relation="include">
        </childnode>
        <childnode refid="36642" relation="include">
        </childnode>
      </node>
      <node id="36614">
        <label>SeTool.h</label>
        <link refid="_se_tool_8h"/>
        <childnode refid="36583" relation="include">
        </childnode>
        <childnode refid="36612" relation="include">
        </childnode>
        <childnode refid="36615" relation="include">
        </childnode>
        <childnode refid="36616" relation="include">
        </childnode>
        <childnode refid="36596" relation="include">
        </childnode>
        <childnode refid="36617" relation="include">
        </childnode>
      </node>
      <node id="36645">
        <label>SeRandNum.h</label>
        <link refid="_se_rand_num_8h"/>
        <childnode refid="36583" relation="include">
        </childnode>
      </node>
      <node id="36584">
        <label>winsock2.h</label>
      </node>
      <node id="36688">
        <label>SearchChoice_table.hpp</label>
        <link refid="_search_choice__table_8hpp"/>
        <childnode refid="36601" relation="include">
        </childnode>
        <childnode refid="36605" relation="include">
        </childnode>
        <childnode refid="36627" relation="include">
        </childnode>
      </node>
      <node id="36712">
        <label>AcSystem_table.hpp</label>
        <link refid="_ac_system__table_8hpp"/>
        <childnode refid="36601" relation="include">
        </childnode>
        <childnode refid="36605" relation="include">
        </childnode>
        <childnode refid="36627" relation="include">
        </childnode>
      </node>
      <node id="36663">
        <label>ModelRes_table.hpp</label>
        <link refid="_model_res__table_8hpp"/>
        <childnode refid="36601" relation="include">
        </childnode>
        <childnode refid="36605" relation="include">
        </childnode>
        <childnode refid="36627" relation="include">
        </childnode>
      </node>
      <node id="36661">
        <label>TownItem_table.hpp</label>
        <link refid="_town_item__table_8hpp"/>
        <childnode refid="36601" relation="include">
        </childnode>
        <childnode refid="36605" relation="include">
        </childnode>
        <childnode refid="36627" relation="include">
        </childnode>
      </node>
      <node id="36646">
        <label>SeServerMainDef.h</label>
        <link refid="_se_server_main_def_8h"/>
        <childnode refid="36583" relation="include">
        </childnode>
      </node>
      <node id="36616">
        <label>TeMisc.h</label>
        <link refid="_te_misc_8h"/>
        <childnode refid="36595" relation="include">
        </childnode>
      </node>
      <node id="36739">
        <label>SeBLMProcess.inl</label>
        <link refid="_se_b_l_m_process_8inl"/>
      </node>
      <node id="36742">
        <label>SeRaceQueryMgr.h</label>
        <link refid="src_2_se_race_query_mgr_8h"/>
        <childnode refid="36651" relation="include">
        </childnode>
        <childnode refid="36625" relation="include">
        </childnode>
      </node>
      <node id="36721">
        <label>CreepTowerGrowth_table.hpp</label>
        <link refid="_creep_tower_growth__table_8hpp"/>
        <childnode refid="36601" relation="include">
        </childnode>
        <childnode refid="36605" relation="include">
        </childnode>
        <childnode refid="36627" relation="include">
        </childnode>
      </node>
      <node id="36653">
        <label>Addtional_table.hpp</label>
        <link refid="_addtional__table_8hpp"/>
        <childnode refid="36601" relation="include">
        </childnode>
        <childnode refid="36605" relation="include">
        </childnode>
        <childnode refid="36627" relation="include">
        </childnode>
      </node>
      <node id="36634">
        <label>SePtl_MS_To_RS.h</label>
        <link refid="_se_ptl___m_s___to___r_s_8h"/>
        <childnode refid="36618" relation="include">
        </childnode>
      </node>
      <node id="36625">
        <label>SePtl_RS_To_MS.h</label>
        <link refid="_se_ptl___r_s___to___m_s_8h"/>
        <childnode refid="36618" relation="include">
        </childnode>
      </node>
      <node id="36611">
        <label>SeServerDefine.h</label>
        <link refid="_se_server_define_8h"/>
        <childnode refid="36612" relation="include">
        </childnode>
        <childnode refid="36613" relation="include">
        </childnode>
        <childnode refid="36614" relation="include">
        </childnode>
      </node>
      <node id="36719">
        <label>AttackArmorRatio_table.hpp</label>
        <link refid="_attack_armor_ratio__table_8hpp"/>
        <childnode refid="36601" relation="include">
        </childnode>
        <childnode refid="36605" relation="include">
        </childnode>
        <childnode refid="36627" relation="include">
        </childnode>
      </node>
      <node id="36655">
        <label>Skill_table.hpp</label>
        <link refid="_skill__table_8hpp"/>
        <childnode refid="36601" relation="include">
        </childnode>
        <childnode refid="36605" relation="include">
        </childnode>
        <childnode refid="36627" relation="include">
        </childnode>
      </node>
      <node id="36595">
        <label>string.h</label>
      </node>
      <node id="36704">
        <label>Level_table.hpp</label>
        <link refid="_level__table_8hpp"/>
        <childnode refid="36601" relation="include">
        </childnode>
        <childnode refid="36605" relation="include">
        </childnode>
        <childnode refid="36627" relation="include">
        </childnode>
      </node>
      <node id="36629">
        <label>SeConfig.h</label>
        <link refid="_se_config_8h"/>
        <childnode refid="36612" relation="include">
        </childnode>
      </node>
      <node id="36593">
        <label>ctime</label>
      </node>
      <node id="36682">
        <label>Voice_table.hpp</label>
        <link refid="_voice__table_8hpp"/>
        <childnode refid="36601" relation="include">
        </childnode>
        <childnode refid="36605" relation="include">
        </childnode>
        <childnode refid="36627" relation="include">
        </childnode>
      </node>
      <node id="36652">
        <label>TableMgr.h</label>
        <link refid="_table_mgr_8h"/>
        <childnode refid="36653" relation="include">
        </childnode>
        <childnode refid="36654" relation="include">
        </childnode>
        <childnode refid="36655" relation="include">
        </childnode>
        <childnode refid="36656" relation="include">
        </childnode>
        <childnode refid="36626" relation="include">
        </childnode>
        <childnode refid="36657" relation="include">
        </childnode>
        <childnode refid="36658" relation="include">
        </childnode>
        <childnode refid="36659" relation="include">
        </childnode>
        <childnode refid="36660" relation="include">
        </childnode>
        <childnode refid="36661" relation="include">
        </childnode>
        <childnode refid="36662" relation="include">
        </childnode>
        <childnode refid="36663" relation="include">
        </childnode>
        <childnode refid="36664" relation="include">
        </childnode>
        <childnode refid="36665" relation="include">
        </childnode>
        <childnode refid="36666" relation="include">
        </childnode>
        <childnode refid="36667" relation="include">
        </childnode>
        <childnode refid="36668" relation="include">
        </childnode>
        <childnode refid="36669" relation="include">
        </childnode>
        <childnode refid="36670" relation="include">
        </childnode>
        <childnode refid="36671" relation="include">
        </childnode>
        <childnode refid="36672" relation="include">
        </childnode>
        <childnode refid="36673" relation="include">
        </childnode>
        <childnode refid="36674" relation="include">
        </childnode>
        <childnode refid="36675" relation="include">
        </childnode>
        <childnode refid="36676" relation="include">
        </childnode>
        <childnode refid="36677" relation="include">
        </childnode>
        <childnode refid="36678" relation="include">
        </childnode>
        <childnode refid="36679" relation="include">
        </childnode>
        <childnode refid="36680" relation="include">
        </childnode>
        <childnode refid="36681" relation="include">
        </childnode>
        <childnode refid="36682" relation="include">
        </childnode>
        <childnode refid="36683" relation="include">
        </childnode>
        <childnode refid="36684" relation="include">
        </childnode>
        <childnode refid="36685" relation="include">
        </childnode>
        <childnode refid="36686" relation="include">
        </childnode>
        <childnode refid="36603" relation="include">
        </childnode>
        <childnode refid="36687" relation="include">
        </childnode>
        <childnode refid="36688" relation="include">
        </childnode>
        <childnode refid="36689" relation="include">
        </childnode>
        <childnode refid="36690" relation="include">
        </childnode>
        <childnode refid="36691" relation="include">
        </childnode>
        <childnode refid="36692" relation="include">
        </childnode>
        <childnode refid="36693" relation="include">
        </childnode>
        <childnode refid="36701" relation="include">
        </childnode>
        <childnode refid="36695" relation="include">
        </childnode>
        <childnode refid="36696" relation="include">
        </childnode>
        <childnode refid="36698" relation="include">
        </childnode>
        <childnode refid="36717" relation="include">
        </childnode>
        <childnode refid="36700" relation="include">
        </childnode>
        <childnode refid="36699" relation="include">
        </childnode>
        <childnode refid="36718" relation="include">
        </childnode>
        <childnode refid="36697" relation="include">
        </childnode>
        <childnode refid="36702" relation="include">
        </childnode>
        <childnode refid="36704" relation="include">
        </childnode>
        <childnode refid="36719" relation="include">
        </childnode>
        <childnode refid="36703" relation="include">
        </childnode>
        <childnode refid="36720" relation="include">
        </childnode>
        <childnode refid="36721" relation="include">
        </childnode>
        <childnode refid="36707" relation="include">
        </childnode>
        <childnode refid="36711" relation="include">
        </childnode>
        <childnode refid="36722" relation="include">
        </childnode>
        <childnode refid="36712" relation="include">
        </childnode>
        <childnode refid="36713" relation="include">
        </childnode>
        <childnode refid="36714" relation="include">
        </childnode>
        <childnode refid="36715" relation="include">
        </childnode>
        <childnode refid="36723" relation="include">
        </childnode>
      </node>
      <node id="36613">
        <label>TeNetMgr.h</label>
      </node>
      <node id="36603">
        <label>vector</label>
      </node>
      <node id="36685">
        <label>TableMgrDef.h</label>
        <link refid="_table_mgr_def_8h"/>
        <childnode refid="36603" relation="include">
        </childnode>
        <childnode refid="36606" relation="include">
        </childnode>
      </node>
      <node id="36728">
        <label>MobaApi.hpp</label>
        <link refid="_moba_api_8hpp"/>
      </node>
      <node id="36656">
        <label>Buffer_table.hpp</label>
        <link refid="_buffer__table_8hpp"/>
        <childnode refid="36601" relation="include">
        </childnode>
        <childnode refid="36605" relation="include">
        </childnode>
        <childnode refid="36627" relation="include">
        </childnode>
      </node>
      <node id="36626">
        <label>MapInfo_table.hpp</label>
        <link refid="_map_info__table_8hpp"/>
        <childnode refid="36601" relation="include">
        </childnode>
        <childnode refid="36605" relation="include">
        </childnode>
        <childnode refid="36627" relation="include">
        </childnode>
      </node>
      <node id="36730">
        <label>SeMRSend.inl</label>
        <link refid="_se_m_r_send_8inl"/>
      </node>
      <node id="36698">
        <label>Avatar_table.hpp</label>
        <link refid="_avatar__table_8hpp"/>
        <childnode refid="36601" relation="include">
        </childnode>
        <childnode refid="36605" relation="include">
        </childnode>
        <childnode refid="36627" relation="include">
        </childnode>
      </node>
      <node id="36609">
        <label>new</label>
      </node>
      <node id="36731">
        <label>SeMatchOther.inl</label>
        <link refid="src_2_se_match_other_8inl"/>
      </node>
      <node id="36724">
        <label>SeResMgr.h</label>
        <link refid="_match_server_2src_2_se_res_mgr_8h"/>
        <childnode refid="36652" relation="include">
        </childnode>
        <childnode refid="36631" relation="include">
        </childnode>
      </node>
      <node id="36618">
        <label>SePtlDefine.h</label>
        <link refid="_se_ptl_define_8h"/>
        <childnode refid="36583" relation="include">
        </childnode>
        <childnode refid="36612" relation="include">
        </childnode>
        <childnode refid="36614" relation="include">
        </childnode>
        <childnode refid="36619" relation="include">
        </childnode>
        <childnode refid="36620" relation="include">
        </childnode>
        <childnode refid="36621" relation="include">
        </childnode>
      </node>
      <node id="36612">
        <label>SeShareDef.h</label>
        <link refid="_se_share_def_8h"/>
        <childnode refid="36583" relation="include">
        </childnode>
      </node>
      <node id="36648">
        <label>SeTownMgrDef.h</label>
        <link refid="_match_server_2src_2_se_town_mgr_def_8h"/>
        <childnode refid="36631" relation="include">
        </childnode>
      </node>
      <node id="36600">
        <label>sstream</label>
      </node>
      <node id="36689">
        <label>ItemCompose_table.hpp</label>
        <link refid="_item_compose__table_8hpp"/>
        <childnode refid="36601" relation="include">
        </childnode>
        <childnode refid="36605" relation="include">
        </childnode>
        <childnode refid="36627" relation="include">
        </childnode>
      </node>
      <node id="36617">
        <label>EsString.h</label>
      </node>
      <node id="36671">
        <label>Indexoffer_table.hpp</label>
        <link refid="_indexoffer__table_8hpp"/>
        <childnode refid="36601" relation="include">
        </childnode>
        <childnode refid="36605" relation="include">
        </childnode>
        <childnode refid="36627" relation="include">
        </childnode>
      </node>
      <node id="36725">
        <label>SeVirtConnMgr.h</label>
        <link refid="_se_virt_conn_mgr_8h"/>
        <childnode refid="36612" relation="include">
        </childnode>
        <childnode refid="36613" relation="include">
        </childnode>
        <childnode refid="36618" relation="include">
        </childnode>
        <childnode refid="36623" relation="include">
        </childnode>
      </node>
      <node id="36665">
        <label>Rack_table.hpp</label>
        <link refid="_rack__table_8hpp"/>
        <childnode refid="36601" relation="include">
        </childnode>
        <childnode refid="36605" relation="include">
        </childnode>
        <childnode refid="36627" relation="include">
        </childnode>
      </node>
      <node id="36583">
        <label>SeInclude.h</label>
        <link refid="_se_include_8h"/>
        <childnode refid="36584" relation="include">
        </childnode>
        <childnode refid="36585" relation="include">
        </childnode>
        <childnode refid="36586" relation="include">
        </childnode>
        <childnode refid="36587" relation="include">
        </childnode>
        <childnode refid="36588" relation="include">
        </childnode>
        <childnode refid="36589" relation="include">
        </childnode>
        <childnode refid="36590" relation="include">
        </childnode>
        <childnode refid="36591" relation="include">
        </childnode>
        <childnode refid="36592" relation="include">
        </childnode>
        <childnode refid="36593" relation="include">
        </childnode>
        <childnode refid="36594" relation="include">
        </childnode>
        <childnode refid="36595" relation="include">
        </childnode>
        <childnode refid="36596" relation="include">
        </childnode>
        <childnode refid="36597" relation="include">
        </childnode>
        <childnode refid="36598" relation="include">
        </childnode>
        <childnode refid="36599" relation="include">
        </childnode>
        <childnode refid="36600" relation="include">
        </childnode>
        <childnode refid="36601" relation="include">
        </childnode>
        <childnode refid="36602" relation="include">
        </childnode>
        <childnode refid="36603" relation="include">
        </childnode>
        <childnode refid="36604" relation="include">
        </childnode>
        <childnode refid="36605" relation="include">
        </childnode>
        <childnode refid="36606" relation="include">
        </childnode>
        <childnode refid="36607" relation="include">
        </childnode>
        <childnode refid="36608" relation="include">
        </childnode>
        <childnode refid="36609" relation="include">
        </childnode>
        <childnode refid="36610" relation="include">
        </childnode>
      </node>
      <node id="36644">
        <label>time.h</label>
      </node>
      <node id="36589">
        <label>math.h</label>
      </node>
      <node id="36690">
        <label>PresetShop_table.hpp</label>
        <link refid="_preset_shop__table_8hpp"/>
        <childnode refid="36601" relation="include">
        </childnode>
        <childnode refid="36605" relation="include">
        </childnode>
        <childnode refid="36627" relation="include">
        </childnode>
      </node>
      <node id="36679">
        <label>Language_table.hpp</label>
        <link refid="_language__table_8hpp"/>
        <childnode refid="36601" relation="include">
        </childnode>
        <childnode refid="36605" relation="include">
        </childnode>
        <childnode refid="36627" relation="include">
        </childnode>
      </node>
      <node id="36632">
        <label>SeSynMgr.h</label>
        <link refid="_se_syn_mgr_8h"/>
        <childnode refid="36583" relation="include">
        </childnode>
      </node>
      <node id="36596">
        <label>EsType.h</label>
      </node>
      <node id="36708">
        <label>AppendCost_table.hpp</label>
        <link refid="_append_cost__table_8hpp"/>
        <childnode refid="36601" relation="include">
        </childnode>
        <childnode refid="36605" relation="include">
        </childnode>
        <childnode refid="36627" relation="include">
        </childnode>
      </node>
      <node id="36670">
        <label>RaceText_table.hpp</label>
        <link refid="_race_text__table_8hpp"/>
        <childnode refid="36601" relation="include">
        </childnode>
        <childnode refid="36605" relation="include">
        </childnode>
        <childnode refid="36627" relation="include">
        </childnode>
      </node>
      <node id="36591">
        <label>cctype</label>
      </node>
      <node id="36615">
        <label>SeToolTemplate.inl</label>
        <link refid="_se_tool_template_8inl"/>
      </node>
      <node id="36740">
        <label>SeMNSend.inl</label>
        <link refid="_se_m_n_send_8inl"/>
      </node>
      <node id="36672">
        <label>UnitHeadArea_table.hpp</label>
        <link refid="_unit_head_area__table_8hpp"/>
        <childnode refid="36601" relation="include">
        </childnode>
        <childnode refid="36605" relation="include">
        </childnode>
        <childnode refid="36627" relation="include">
        </childnode>
      </node>
      <node id="36713">
        <label>RankStage_table.hpp</label>
        <link refid="_rank_stage__table_8hpp"/>
        <childnode refid="36601" relation="include">
        </childnode>
        <childnode refid="36605" relation="include">
        </childnode>
        <childnode refid="36627" relation="include">
        </childnode>
      </node>
      <node id="36727">
        <label>utils/Clock.hpp</label>
        <link refid="_clock_8hpp"/>
        <childnode refid="36622" relation="include">
        </childnode>
        <childnode refid="36644" relation="include">
        </childnode>
        <childnode refid="36728" relation="include">
        </childnode>
      </node>
      <node id="36716">
        <label>MissionInfo_table.hpp</label>
        <link refid="_mission_info__table_8hpp"/>
        <childnode refid="36601" relation="include">
        </childnode>
        <childnode refid="36605" relation="include">
        </childnode>
        <childnode refid="36627" relation="include">
        </childnode>
      </node>
      <node id="36703">
        <label>ChoiceItem_table.hpp</label>
        <link refid="_choice_item__table_8hpp"/>
        <childnode refid="36601" relation="include">
        </childnode>
        <childnode refid="36605" relation="include">
        </childnode>
        <childnode refid="36627" relation="include">
        </childnode>
      </node>
      <node id="36699">
        <label>AvatarModel_table.hpp</label>
        <link refid="_avatar_model__table_8hpp"/>
        <childnode refid="36601" relation="include">
        </childnode>
        <childnode refid="36605" relation="include">
        </childnode>
        <childnode refid="36627" relation="include">
        </childnode>
      </node>
      <node id="36606">
        <label>unordered_map</label>
      </node>
      <node id="36692">
        <label>Shop_table.hpp</label>
        <link refid="_shop__table_8hpp"/>
        <childnode refid="36601" relation="include">
        </childnode>
        <childnode refid="36605" relation="include">
        </childnode>
        <childnode refid="36627" relation="include">
        </childnode>
      </node>
      <node id="36610">
        <label>SeDefine.h</label>
        <link refid="_se_define_8h"/>
      </node>
      <node id="36680">
        <label>StarWheel_table.hpp</label>
        <link refid="_star_wheel__table_8hpp"/>
        <childnode refid="36601" relation="include">
        </childnode>
        <childnode refid="36605" relation="include">
        </childnode>
        <childnode refid="36627" relation="include">
        </childnode>
      </node>
      <node id="36658">
        <label>Racedrop_table.hpp</label>
        <link refid="_racedrop__table_8hpp"/>
        <childnode refid="36601" relation="include">
        </childnode>
        <childnode refid="36605" relation="include">
        </childnode>
        <childnode refid="36627" relation="include">
        </childnode>
      </node>
      <node id="36736">
        <label>SeMWSend.inl</label>
        <link refid="_se_m_w_send_8inl"/>
      </node>
      <node id="36717">
        <label>AvatarAnimation_table.hpp</label>
        <link refid="_avatar_animation__table_8hpp"/>
        <childnode refid="36601" relation="include">
        </childnode>
        <childnode refid="36605" relation="include">
        </childnode>
        <childnode refid="36627" relation="include">
        </childnode>
      </node>
      <node id="36630">
        <label>SeServerTool.h</label>
        <link refid="_se_server_tool_8h"/>
        <childnode refid="36583" relation="include">
        </childnode>
        <childnode refid="36614" relation="include">
        </childnode>
        <childnode refid="36618" relation="include">
        </childnode>
      </node>
      <node id="36633">
        <label>SePtl_MS_To_TS.h</label>
        <link refid="_se_ptl___m_s___to___t_s_8h"/>
        <childnode refid="36618" relation="include">
        </childnode>
      </node>
      <node id="36624">
        <label>SePtl_TS_To_MS.h</label>
        <link refid="_se_ptl___t_s___to___m_s_8h"/>
        <childnode refid="36618" relation="include">
        </childnode>
      </node>
      <node id="36666">
        <label>RenJi_table.hpp</label>
        <link refid="_ren_ji__table_8hpp"/>
        <childnode refid="36601" relation="include">
        </childnode>
        <childnode refid="36605" relation="include">
        </childnode>
        <childnode refid="36627" relation="include">
        </childnode>
      </node>
      <node id="36674">
        <label>TaskRecom_table.hpp</label>
        <link refid="_task_recom__table_8hpp"/>
        <childnode refid="36601" relation="include">
        </childnode>
        <childnode refid="36605" relation="include">
        </childnode>
        <childnode refid="36627" relation="include">
        </childnode>
      </node>
      <node id="36657">
        <label>Item_table.hpp</label>
        <link refid="_item__table_8hpp"/>
        <childnode refid="36601" relation="include">
        </childnode>
        <childnode refid="36605" relation="include">
        </childnode>
        <childnode refid="36607" relation="include">
        </childnode>
        <childnode refid="36603" relation="include">
        </childnode>
        <childnode refid="36627" relation="include">
        </childnode>
      </node>
      <node id="36718">
        <label>AvatarShop_table.hpp</label>
        <link refid="_avatar_shop__table_8hpp"/>
        <childnode refid="36601" relation="include">
        </childnode>
        <childnode refid="36605" relation="include">
        </childnode>
        <childnode refid="36627" relation="include">
        </childnode>
      </node>
      <node id="36681">
        <label>LeagueRank_table.hpp</label>
        <link refid="_league_rank__table_8hpp"/>
        <childnode refid="36601" relation="include">
        </childnode>
        <childnode refid="36605" relation="include">
        </childnode>
        <childnode refid="36627" relation="include">
        </childnode>
      </node>
      <node id="36676">
        <label>Horse_table.hpp</label>
        <link refid="_horse__table_8hpp"/>
        <childnode refid="36601" relation="include">
        </childnode>
        <childnode refid="36605" relation="include">
        </childnode>
        <childnode refid="36627" relation="include">
        </childnode>
      </node>
      <node id="36738">
        <label>SeMBLSend.inl</label>
        <link refid="_se_m_b_l_send_8inl"/>
      </node>
      <node id="36697">
        <label>Achievement_table.hpp</label>
        <link refid="_achievement__table_8hpp"/>
        <childnode refid="36601" relation="include">
        </childnode>
        <childnode refid="36605" relation="include">
        </childnode>
        <childnode refid="36627" relation="include">
        </childnode>
      </node>
      <node id="36607">
        <label>set</label>
      </node>
      <node id="36683">
        <label>TableLoader.h</label>
        <link refid="_table_loader_8h"/>
      </node>
      <node id="36701">
        <label>SkillTips_table.hpp</label>
        <link refid="_skill_tips__table_8hpp"/>
        <childnode refid="36601" relation="include">
        </childnode>
        <childnode refid="36605" relation="include">
        </childnode>
        <childnode refid="36607" relation="include">
        </childnode>
        <childnode refid="36627" relation="include">
        </childnode>
      </node>
      <node id="36597">
        <label>algorithm</label>
      </node>
      <node id="36741">
        <label>SeNMProcess.inl</label>
        <link refid="_se_n_m_process_8inl"/>
      </node>
      <node id="36686">
        <label>AddtionalFunction.h</label>
        <link refid="_addtional_function_8h"/>
        <childnode refid="36601" relation="include">
        </childnode>
        <childnode refid="36653" relation="include">
        </childnode>
      </node>
      <node id="36737">
        <label>SeWMProcess.inl</label>
        <link refid="_se_w_m_process_8inl"/>
      </node>
      <node id="36659">
        <label>SelHero_table.hpp</label>
        <link refid="_sel_hero__table_8hpp"/>
        <childnode refid="36601" relation="include">
        </childnode>
        <childnode refid="36605" relation="include">
        </childnode>
        <childnode refid="36627" relation="include">
        </childnode>
      </node>
      <node id="36594">
        <label>stdio.h</label>
      </node>
      <node id="36660">
        <label>AI_table.hpp</label>
        <link refid="_a_i__table_8hpp"/>
        <childnode refid="36601" relation="include">
        </childnode>
        <childnode refid="36605" relation="include">
        </childnode>
        <childnode refid="36627" relation="include">
        </childnode>
      </node>
      <node id="36580">
        <label>MatchServer/src/SeRaceMgr.cpp</label>
        <link refid="MatchServer/src/SeRaceMgr.cpp"/>
        <childnode refid="36581" relation="include">
        </childnode>
        <childnode refid="36628" relation="include">
        </childnode>
        <childnode refid="36742" relation="include">
        </childnode>
      </node>
      <node id="36581">
        <label>SeRaceMgr.h</label>
        <link refid="_match_server_2src_2_se_race_mgr_8h"/>
        <childnode refid="36582" relation="include">
        </childnode>
        <childnode refid="36623" relation="include">
        </childnode>
        <childnode refid="36624" relation="include">
        </childnode>
        <childnode refid="36625" relation="include">
        </childnode>
        <childnode refid="36626" relation="include">
        </childnode>
      </node>
      <node id="36695">
        <label>SystemPrompt_table.hpp</label>
        <link refid="_system_prompt__table_8hpp"/>
        <childnode refid="36601" relation="include">
        </childnode>
        <childnode refid="36605" relation="include">
        </childnode>
        <childnode refid="36627" relation="include">
        </childnode>
      </node>
      <node id="36707">
        <label>Strengthen_table.hpp</label>
        <link refid="_strengthen__table_8hpp"/>
        <childnode refid="36601" relation="include">
        </childnode>
        <childnode refid="36605" relation="include">
        </childnode>
        <childnode refid="36627" relation="include">
        </childnode>
      </node>
      <node id="36639">
        <label>SePtl_MS_To_BLS.h</label>
        <link refid="_se_ptl___m_s___to___b_l_s_8h"/>
        <childnode refid="36618" relation="include">
        </childnode>
        <childnode refid="36611" relation="include">
        </childnode>
        <childnode refid="36640" relation="include">
        </childnode>
      </node>
    </incdepgraph>
      <sectiondef kind="var">
      <memberdef kind="variable" id="_match_server_2src_2_se_race_mgr_8cpp_1a1f83db99b647792f31ca33007bb173f3" prot="public" static="no" mutable="no">
        <type><ref refid="class_se_race_mgr" kindref="compound">SeRaceMgr</ref></type>
        <definition>SeRaceMgr g_kRaceMgr</definition>
        <argsstring></argsstring>
        <name>g_kRaceMgr</name>
        <briefdescription>
        </briefdescription>
        <detaileddescription>
        </detaileddescription>
        <inbodydescription>
        </inbodydescription>
        <location file="F:/TeamWork/ServerVersion/projects/server/Server/Server/MatchServer/src/SeRaceMgr.cpp" line="5" column="1" bodyfile="F:/TeamWork/ServerVersion/projects/server/Server/Server/MatchServer/src/SeRaceMgr.cpp" bodystart="5" bodyend="-1"/>
      </memberdef>
      </sectiondef>
      <sectiondef kind="func">
      <memberdef kind="function" id="_match_server_2src_2_se_race_mgr_8cpp_1ae65494849119df3b0b3c443594207c5a" prot="public" static="no" const="no" explicit="no" inline="no" virt="non-virtual">
        <type></type>
        <definition>IMPLEMENT_POOL</definition>
        <argsstring>(SeMatchRace, 512, 512)</argsstring>
        <name>IMPLEMENT_POOL</name>
        <param>
          <type><ref refid="struct_se_match_race" kindref="compound">SeMatchRace</ref></type>
        </param>
        <param>
          <type>512</type>
        </param>
        <param>
          <type>512</type>
        </param>
        <briefdescription>
        </briefdescription>
        <detaileddescription>
        </detaileddescription>
        <inbodydescription>
        </inbodydescription>
        <location file="F:/TeamWork/ServerVersion/projects/server/Server/Server/MatchServer/src/SeRaceMgr.cpp" line="7" column="1"/>
      </memberdef>
      <memberdef kind="function" id="_match_server_2src_2_se_race_mgr_8cpp_1a13bc13284683e6c7898139a27c8230cb" prot="public" static="no" const="no" explicit="no" inline="no" virt="non-virtual">
        <type></type>
        <definition>IMPLEMENT_POOL</definition>
        <argsstring>(SeWaitValidPlayer, 256, 256)</argsstring>
        <name>IMPLEMENT_POOL</name>
        <param>
          <type><ref refid="struct_se_wait_valid_player" kindref="compound">SeWaitValidPlayer</ref></type>
        </param>
        <param>
          <type>256</type>
        </param>
        <param>
          <type>256</type>
        </param>
        <briefdescription>
        </briefdescription>
        <detaileddescription>
        </detaileddescription>
        <inbodydescription>
        </inbodydescription>
        <location file="F:/TeamWork/ServerVersion/projects/server/Server/Server/MatchServer/src/SeRaceMgr.cpp" line="8" column="1"/>
      </memberdef>
      </sectiondef>
    <briefdescription>
    </briefdescription>
    <detaileddescription>
    </detaileddescription>
    <programlisting>
<codeline lineno="1"><highlight class="preprocessor">#include<sp/>&quot;<ref refid="_match_server_2src_2_se_race_mgr_8h" kindref="compound">SeRaceMgr.h</ref>&quot;</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="2"><highlight class="normal"></highlight><highlight class="preprocessor">#include<sp/>&quot;<ref refid="src_2_match_server_8h" kindref="compound">MatchServer.h</ref>&quot;</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="3"><highlight class="normal"></highlight><highlight class="preprocessor">#include<sp/>&quot;<ref refid="src_2_se_race_query_mgr_8h" kindref="compound">SeRaceQueryMgr.h</ref>&quot;</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="4"><highlight class="normal"></highlight></codeline>
<codeline lineno="5" refid="_match_server_2src_2_se_race_mgr_8cpp_1a1f83db99b647792f31ca33007bb173f3" refkind="member"><highlight class="normal"><ref refid="class_se_race_mgr" kindref="compound">SeRaceMgr</ref><sp/><ref refid="_match_server_2_src_2_se_race_mgr_8cpp_1a1f83db99b647792f31ca33007bb173f3" kindref="member">g_kRaceMgr</ref>;</highlight></codeline>
<codeline lineno="6"><highlight class="normal"></highlight></codeline>
<codeline lineno="7"><highlight class="normal"><ref refid="_match_server_2_src_2_se_race_mgr_8cpp_1ae65494849119df3b0b3c443594207c5a" kindref="member">IMPLEMENT_POOL</ref>(<ref refid="struct_se_match_race" kindref="compound">SeMatchRace</ref>,512,512);</highlight></codeline>
<codeline lineno="8"><highlight class="normal"><ref refid="_match_server_2_src_2_se_race_mgr_8cpp_1ae65494849119df3b0b3c443594207c5a" kindref="member">IMPLEMENT_POOL</ref>(<ref refid="struct_se_wait_valid_player" kindref="compound">SeWaitValidPlayer</ref>,256,256);</highlight></codeline>
<codeline lineno="9"><highlight class="normal"></highlight></codeline>
<codeline lineno="10"><highlight class="normal"><ref refid="struct_se_match_race_1aeeab399e24b6a2b1752a36101794700e" kindref="member">SeMatchRace::SeMatchRace</ref>()</highlight></codeline>
<codeline lineno="11"><highlight class="normal">{</highlight></codeline>
<codeline lineno="12"><highlight class="normal"><sp/><sp/><sp/><sp/><ref refid="struct_se_match_race_1a8523887086f21641745b808f82cc1828" kindref="member">dwMatchSession</ref><sp/>=<sp/>0;</highlight></codeline>
<codeline lineno="13"><highlight class="normal"><sp/><sp/><sp/><sp/><ref refid="struct_se_match_race_1a3a9af85294d2e4f80524c28c498324b1" kindref="member">eRaceState</ref><sp/>=<sp/><ref refid="_match_server_2_src_2_se_race_mgr_def_8h_1a3f0f87c08c5c7566ba4e99c73d523f20a55d9d56f8e6f35691b1784eae15ced6d" kindref="member">SMRS_NONE</ref>;</highlight></codeline>
<codeline lineno="14"><highlight class="normal"><sp/><sp/><sp/><sp/><ref refid="struct_se_match_race_1ae0e7766eee9aa76f30450689370bd2a3" kindref="member">bAllLoad</ref><sp/>=<sp/></highlight><highlight class="keyword">false</highlight><highlight class="normal">;</highlight></codeline>
<codeline lineno="15"><highlight class="normal"><sp/><sp/><sp/><sp/><ref refid="struct_se_match_race_1a30a4dd82bc1c90da9e624e34d3fdc69c" kindref="member">dwKey</ref><sp/>=<sp/>0;</highlight></codeline>
<codeline lineno="16"><highlight class="normal"><sp/><sp/><sp/><sp/><ref refid="struct_se_match_race_1a5c7ab2cd8f14bbfa4bfd87f2bbb624f9" kindref="member">dwMapID</ref><sp/>=<sp/>0;</highlight></codeline>
<codeline lineno="17"><highlight class="normal"><sp/><sp/><sp/><sp/><ref refid="struct_se_match_race_1a6b8c33732efa862321b7ae44106e9a3c" kindref="member">iDifficulty</ref><sp/>=<sp/>0;</highlight></codeline>
<codeline lineno="18"><highlight class="normal"><sp/><sp/><sp/><sp/><ref refid="struct_se_match_race_1ac98eae2e335d69e4acbf6f7f869f8ef3" kindref="member">dwLastRecvTime</ref><sp/>=<sp/>0;</highlight></codeline>
<codeline lineno="19"><highlight class="normal"><sp/><sp/><sp/><sp/><ref refid="struct_se_match_race_1a2b2ba94026424d343fd55b9308b49c38" kindref="member">iRoomIndex</ref><sp/>=<sp/>-1;</highlight></codeline>
<codeline lineno="20"><highlight class="normal"></highlight></codeline>
<codeline lineno="21"><highlight class="normal"><sp/><sp/><sp/><sp/><ref refid="struct_se_match_race_1a6b5eb0e64d829b9da814a5e024fe0878" kindref="member">dwMatchAreaID</ref><sp/>=<sp/>0;</highlight></codeline>
<codeline lineno="22"><highlight class="normal"><sp/><sp/><sp/><sp/><ref refid="struct_se_match_race_1a97a790bb865b5d4cb6d95b3a3ab937a4" kindref="member">iBiVoiceRoomID</ref><sp/>=<sp/>0;</highlight></codeline>
<codeline lineno="23"><highlight class="normal"><sp/><sp/><sp/><sp/><ref refid="struct_se_match_race_1af7fd4b9eef403239ffce20dfec790705" kindref="member">bSendMatchAddr</ref><sp/>=<sp/></highlight><highlight class="keyword">false</highlight><highlight class="normal">;</highlight></codeline>
<codeline lineno="24"><highlight class="normal">}</highlight></codeline>
<codeline lineno="25"><highlight class="normal"></highlight></codeline>
<codeline lineno="26"><highlight class="normal"><ref refid="struct_se_match_race_1a904f9f2268bf2c33b8adf615613d34ed" kindref="member">SeMatchRace::~SeMatchRace</ref>()</highlight></codeline>
<codeline lineno="27"><highlight class="normal">{</highlight></codeline>
<codeline lineno="28"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(<ref refid="struct_se_match_race_1a97a790bb865b5d4cb6d95b3a3ab937a4" kindref="member">iBiVoiceRoomID</ref><sp/>!=<sp/>0)</highlight></codeline>
<codeline lineno="29"><highlight class="normal"><sp/><sp/><sp/><sp/>{</highlight></codeline>
<codeline lineno="30"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">//<sp/></highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="31"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>HSock<sp/>kHttpSock;</highlight></codeline>
<codeline lineno="32"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(<ref refid="_src_2_match_server_8cpp_1a1cd9d6d0396497f8a9d48e44d672f368" kindref="member">g_kMatchServer</ref>.<ref refid="class_match_server_1a2b7111c85a75dd776b6c11ed4d860425" kindref="member">GetRandHttpSock</ref>(kHttpSock))</highlight></codeline>
<codeline lineno="33"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>{</highlight></codeline>
<codeline lineno="34"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">//<sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="35"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="_src_2_match_server_8cpp_1a1cd9d6d0396497f8a9d48e44d672f368" kindref="member">g_kMatchServer</ref>.<ref refid="class_match_server_1a63ac22015b3cc4dd9d772d9d123563bc" kindref="member">SendHS_BiVoiceDelChatRoom</ref>(kHttpSock,<sp/><ref refid="struct_se_match_race_1a97a790bb865b5d4cb6d95b3a3ab937a4" kindref="member">iBiVoiceRoomID</ref>);</highlight></codeline>
<codeline lineno="36"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="37"><highlight class="normal"><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="38"><highlight class="normal">}</highlight></codeline>
<codeline lineno="39"><highlight class="normal"></highlight><highlight class="keywordtype">bool</highlight><highlight class="normal"><sp/><ref refid="struct_se_match_race_1ab4b83af04dd204b42b4a4f0f7682b75c" kindref="member">SeMatchRace::IsAllPlayerLoad</ref>()</highlight></codeline>
<codeline lineno="40"><highlight class="normal">{</highlight></codeline>
<codeline lineno="41"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">for</highlight><highlight class="normal"><sp/>(MRacePlayer::iterator<sp/>itr<sp/>=<sp/><ref refid="struct_se_match_race_1a1f51c90f643641518fc163f150a11419" kindref="member">akMRacePlayer</ref>.begin();<sp/>itr<sp/>!=<sp/><ref refid="struct_se_match_race_1a1f51c90f643641518fc163f150a11419" kindref="member">akMRacePlayer</ref>.end();<sp/>++itr)</highlight></codeline>
<codeline lineno="42"><highlight class="normal"><sp/><sp/><sp/><sp/>{</highlight></codeline>
<codeline lineno="43"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(!itr-&gt;second.bLoadEnd)</highlight></codeline>
<codeline lineno="44"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>{</highlight></codeline>
<codeline lineno="45"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/></highlight><highlight class="keyword">false</highlight><highlight class="normal">;</highlight></codeline>
<codeline lineno="46"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="47"><highlight class="normal"><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="48"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/></highlight><highlight class="keyword">true</highlight><highlight class="normal">;</highlight></codeline>
<codeline lineno="49"><highlight class="normal">}</highlight></codeline>
<codeline lineno="50"><highlight class="normal"></highlight></codeline>
<codeline lineno="51"><highlight class="normal"></highlight><highlight class="keywordtype">void</highlight><highlight class="normal"><sp/><ref refid="struct_se_match_race_1a6766acda61038d049284862620a2384f" kindref="member">SeMatchRace::GetMatchRaceInfo</ref>(<ref refid="_se_ptl_define_8h_1a8eca7bda0a54efc38fadd9448b7947f9" kindref="member">VMatchRaceInfo</ref>&amp;<sp/>rakRaceInfo)</highlight></codeline>
<codeline lineno="52"><highlight class="normal">{</highlight></codeline>
<codeline lineno="53"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordtype">int</highlight><highlight class="normal"><sp/>iSize<sp/>=<sp/>(int)<ref refid="struct_se_match_race_1a1f51c90f643641518fc163f150a11419" kindref="member">akMRacePlayer</ref>.size();</highlight></codeline>
<codeline lineno="54"><highlight class="normal"><sp/><sp/><sp/><sp/>rakRaceInfo.resize(iSize);</highlight></codeline>
<codeline lineno="55"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordtype">int</highlight><highlight class="normal"><sp/>i<sp/>=<sp/>0;</highlight></codeline>
<codeline lineno="56"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">for</highlight><highlight class="normal"><sp/>(MRacePlayer::iterator<sp/>itr<sp/>=<sp/><ref refid="struct_se_match_race_1a1f51c90f643641518fc163f150a11419" kindref="member">akMRacePlayer</ref>.begin();<sp/>itr<sp/>!=<sp/><ref refid="struct_se_match_race_1a1f51c90f643641518fc163f150a11419" kindref="member">akMRacePlayer</ref>.end();<sp/>++itr)</highlight></codeline>
<codeline lineno="57"><highlight class="normal"><sp/><sp/><sp/><sp/>{</highlight></codeline>
<codeline lineno="58"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="struct_se_race_player" kindref="compound">SeRacePlayer</ref>&amp;<sp/>rkPlayer<sp/>=<sp/>itr-&gt;second;</highlight></codeline>
<codeline lineno="59"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>rakRaceInfo[i].<ref refid="struct_se_race_player_1a1562e06b4a18a384dc8b152668a9c62f" kindref="member">dwPlayerID</ref><sp/>=<sp/>rkPlayer.<ref refid="struct_se_race_player_1a1562e06b4a18a384dc8b152668a9c62f" kindref="member">dwPlayerID</ref>;</highlight></codeline>
<codeline lineno="60"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>rakRaceInfo[i].eCamp<sp/>=<sp/>rkPlayer.<ref refid="struct_se_race_player_1ad9851bb0940139ae58a6b6ff561bed43" kindref="member">eCamp</ref>;</highlight></codeline>
<codeline lineno="61"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>rakRaceInfo[i].dwAreaID<sp/>=<sp/>rkPlayer.<ref refid="struct_se_race_player_1ac5601dda3e2dfc69b74649cbbfe6e141" kindref="member">kTownSign</ref>.<ref refid="struct_h_town_sign_1ad2078fab8662517a20a8c8702861c430" kindref="member">dwAreaID</ref>;</highlight></codeline>
<codeline lineno="62"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>rakRaceInfo[i].dwServerID<sp/>=<sp/>rkPlayer.<ref refid="struct_se_race_player_1ac5601dda3e2dfc69b74649cbbfe6e141" kindref="member">kTownSign</ref>.<ref refid="struct_h_town_sign_1aad795425c3c60114ef0578356b339d2c" kindref="member">dwServerID</ref>;</highlight></codeline>
<codeline lineno="63"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>rakRaceInfo[i].iTownRoomIndex<sp/>=<sp/>rkPlayer.<ref refid="struct_se_race_player_1a7691bd1ec8aedc1ad18ed942231e3e4b" kindref="member">iRoomIndex</ref>;</highlight></codeline>
<codeline lineno="64"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>rakRaceInfo[i].iSeatIndex<sp/>=<sp/>rkPlayer.<ref refid="struct_se_race_player_1a1558451c3d50c30090110db7b8d63ca4" kindref="member">iSeatIndex</ref>;</highlight></codeline>
<codeline lineno="65"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>rakRaceInfo[i].iTeamMemberNum<sp/>=<sp/>rkPlayer.<ref refid="struct_se_race_player_1a2d21779dfc5ea3a3e6514f73224d9bcd" kindref="member">iTeamMemberNum</ref>;</highlight></codeline>
<codeline lineno="66"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>rakRaceInfo[i].dwTeamID<sp/>=<sp/>rkPlayer.<ref refid="struct_se_race_player_1aee76a5fe2548f6382ea8066b4da31ab3" kindref="member">dwTeamID</ref>;</highlight></codeline>
<codeline lineno="67"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>rakRaceInfo[i].kFightInfo<sp/>=<sp/>rkPlayer.<ref refid="struct_se_race_player_1a60f7f82c910596c34438e67f590f7b7f" kindref="member">kFightInfo</ref>;</highlight></codeline>
<codeline lineno="68"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>rakRaceInfo[i].akPlayerInfo<sp/>=<sp/>rkPlayer.<ref refid="struct_se_race_player_1afa52af4dc9c6a2c07cb13b72f9e832fc" kindref="member">akPlayerInfo</ref>;</highlight></codeline>
<codeline lineno="69"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>rakRaceInfo[i].akDayHeroID<sp/>=<sp/>rkPlayer.<ref refid="struct_se_race_player_1afacfc51eafd66b516e134b744af1537b" kindref="member">akDayHeroID</ref>;</highlight></codeline>
<codeline lineno="70"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>i++;</highlight></codeline>
<codeline lineno="71"><highlight class="normal"><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="72"><highlight class="normal">}</highlight></codeline>
<codeline lineno="73"><highlight class="normal"></highlight></codeline>
<codeline lineno="74"><highlight class="normal">DWord<sp/><ref refid="struct_se_match_race_1aeae4054dac0ac31850d6a1cb0f1eb41c" kindref="member">SeMatchRace::GetFirstPlayerID</ref>()</highlight></codeline>
<codeline lineno="75"><highlight class="normal">{</highlight></codeline>
<codeline lineno="76"><highlight class="normal"><sp/><sp/><sp/><sp/>DWord<sp/>dwPlayerID<sp/>=<sp/>0;</highlight></codeline>
<codeline lineno="77"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">for</highlight><highlight class="normal"><sp/>(MRacePlayer::iterator<sp/>itr<sp/>=<sp/><ref refid="struct_se_match_race_1a1f51c90f643641518fc163f150a11419" kindref="member">akMRacePlayer</ref>.begin();<sp/>itr<sp/>!=<sp/><ref refid="struct_se_match_race_1a1f51c90f643641518fc163f150a11419" kindref="member">akMRacePlayer</ref>.end();<sp/>++itr)</highlight></codeline>
<codeline lineno="78"><highlight class="normal"><sp/><sp/><sp/><sp/>{</highlight></codeline>
<codeline lineno="79"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="struct_se_race_player" kindref="compound">SeRacePlayer</ref>&amp;<sp/>rkPlayer<sp/>=<sp/>itr-&gt;second;</highlight></codeline>
<codeline lineno="80"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>dwPlayerID<sp/>=<sp/>rkPlayer.<ref refid="struct_se_race_player_1a1562e06b4a18a384dc8b152668a9c62f" kindref="member">dwPlayerID</ref>;</highlight></codeline>
<codeline lineno="81"><highlight class="normal"><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="82"><highlight class="normal"></highlight></codeline>
<codeline lineno="83"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/>dwPlayerID;</highlight></codeline>
<codeline lineno="84"><highlight class="normal">}</highlight></codeline>
<codeline lineno="85"><highlight class="normal"></highlight></codeline>
<codeline lineno="86"><highlight class="normal"><ref refid="struct_se_race_player" kindref="compound">SeRacePlayer</ref>*<sp/><ref refid="struct_se_match_race_1a3ca2e37d06ca150904873fb695310259" kindref="member">SeMatchRace::GetRacePlayerByID</ref>(DWord<sp/>dwPlayerID)</highlight></codeline>
<codeline lineno="87"><highlight class="normal">{</highlight></codeline>
<codeline lineno="88"><highlight class="normal"><sp/><sp/><sp/><sp/>MRacePlayer::iterator<sp/>itr<sp/>=<sp/><ref refid="struct_se_match_race_1a1f51c90f643641518fc163f150a11419" kindref="member">akMRacePlayer</ref>.find(dwPlayerID);</highlight></codeline>
<codeline lineno="89"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(itr<sp/>==<sp/><ref refid="struct_se_match_race_1a1f51c90f643641518fc163f150a11419" kindref="member">akMRacePlayer</ref>.end())</highlight></codeline>
<codeline lineno="90"><highlight class="normal"><sp/><sp/><sp/><sp/>{</highlight></codeline>
<codeline lineno="91"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/>NULL;</highlight></codeline>
<codeline lineno="92"><highlight class="normal"><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="93"><highlight class="normal"></highlight></codeline>
<codeline lineno="94"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/>&amp;itr-&gt;second;</highlight></codeline>
<codeline lineno="95"><highlight class="normal">}</highlight></codeline>
<codeline lineno="96"><highlight class="normal"></highlight></codeline>
<codeline lineno="97"><highlight class="normal"></highlight></codeline>
<codeline lineno="98"><highlight class="normal"><ref refid="class_se_race_mgr_1abd174a70b6c932cbc26f9f171f04aa6c" kindref="member">SeRaceMgr::SeRaceMgr</ref>()</highlight></codeline>
<codeline lineno="99"><highlight class="normal">{</highlight></codeline>
<codeline lineno="100"><highlight class="normal"><sp/><sp/><sp/><sp/><ref refid="class_se_race_mgr_1ae09f45af005d7cb2e482fec7ba22c3e2" kindref="member">m_dwGenID</ref><sp/>=<sp/>4000;</highlight></codeline>
<codeline lineno="101"><highlight class="normal"><sp/><sp/><sp/><sp/>srand(GetTickCount());</highlight></codeline>
<codeline lineno="102"><highlight class="normal"><sp/><sp/><sp/><sp/><ref refid="class_se_race_mgr_1a80c2ab087dee1e3e455ee2098777c4b9" kindref="member">m_iSvrAddFailCount</ref><sp/>=<sp/>0;</highlight></codeline>
<codeline lineno="103"><highlight class="normal"><sp/><sp/><sp/><sp/><ref refid="class_se_race_mgr_1a78023051427c080af12c34bf173ff085" kindref="member">m_dwLastRecordTime</ref><sp/>=<sp/>0;</highlight></codeline>
<codeline lineno="104"><highlight class="normal">}</highlight></codeline>
<codeline lineno="105"><highlight class="normal"></highlight></codeline>
<codeline lineno="106"><highlight class="normal"><ref refid="class_se_race_mgr_1af7505b1d887ff9ada48f83ed2cebff3a" kindref="member">SeRaceMgr::~SeRaceMgr</ref>()</highlight></codeline>
<codeline lineno="107"><highlight class="normal">{</highlight></codeline>
<codeline lineno="108"><highlight class="normal">}</highlight></codeline>
<codeline lineno="109"><highlight class="normal"></highlight></codeline>
<codeline lineno="110"><highlight class="normal"></highlight><highlight class="keywordtype">bool</highlight><highlight class="normal"><sp/><ref refid="class_se_race_mgr_1ad8a3196595fc71a878194e2a199f368c" kindref="member">SeRaceMgr::Initialize</ref>()</highlight></codeline>
<codeline lineno="111"><highlight class="normal">{</highlight></codeline>
<codeline lineno="112"><highlight class="normal"><sp/><sp/><sp/><sp/><ref refid="class_se_race_mgr_1a7904e90e268161261cd7219e971e1db3" kindref="member">m_kRaceTimer</ref>.<ref refid="class_se_timer_1a2cea8d993fa579799239a793c1640eb5" kindref="member">SetInterValue</ref>(1000);</highlight></codeline>
<codeline lineno="113"><highlight class="normal"><sp/><sp/><sp/><sp/><ref refid="class_se_race_mgr_1a9a4a1490c6d998a0041cd2a4b649648f" kindref="member">m_kValidTimer</ref>.<ref refid="class_se_timer_1a2cea8d993fa579799239a793c1640eb5" kindref="member">SetInterValue</ref>(3000);</highlight></codeline>
<codeline lineno="114"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/></highlight><highlight class="keyword">true</highlight><highlight class="normal">;</highlight></codeline>
<codeline lineno="115"><highlight class="normal">}</highlight></codeline>
<codeline lineno="116"><highlight class="normal"></highlight></codeline>
<codeline lineno="117"><highlight class="normal"></highlight><highlight class="keywordtype">void</highlight><highlight class="normal"><sp/><ref refid="class_se_race_mgr_1a985840e181436104fd3ca6c73a0aeadc" kindref="member">SeRaceMgr::Update</ref>(DWord<sp/>dwServerTime)</highlight></codeline>
<codeline lineno="118"><highlight class="normal">{</highlight></codeline>
<codeline lineno="119"><highlight class="normal"><sp/><sp/><sp/><sp/><ref refid="class_se_race_mgr_1a7904e90e268161261cd7219e971e1db3" kindref="member">m_kRaceTimer</ref>.<ref refid="class_se_timer_1a5fb0d6e81f14ba88aa3333ff3b3ddd28" kindref="member">Update</ref>(dwServerTime);</highlight></codeline>
<codeline lineno="120"><highlight class="normal"><sp/><sp/><sp/><sp/><ref refid="class_se_race_mgr_1a9a4a1490c6d998a0041cd2a4b649648f" kindref="member">m_kValidTimer</ref>.<ref refid="class_se_timer_1a5fb0d6e81f14ba88aa3333ff3b3ddd28" kindref="member">Update</ref>(dwServerTime);</highlight></codeline>
<codeline lineno="121"><highlight class="normal"></highlight></codeline>
<codeline lineno="122"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal">(<ref refid="class_se_race_mgr_1a7904e90e268161261cd7219e971e1db3" kindref="member">m_kRaceTimer</ref>.<ref refid="class_se_timer_1ad3c52817ca308cdd73be188d6ab9d65f" kindref="member">IsPassed</ref>())</highlight></codeline>
<codeline lineno="123"><highlight class="normal"><sp/><sp/><sp/><sp/>{</highlight></codeline>
<codeline lineno="124"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="class_se_race_mgr_1a110c81b7444d524500f527f553a661a5" kindref="member">RaceUpdate</ref>(dwServerTime);</highlight></codeline>
<codeline lineno="125"><highlight class="normal"><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="126"><highlight class="normal"></highlight></codeline>
<codeline lineno="127"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(<ref refid="class_se_race_mgr_1a9a4a1490c6d998a0041cd2a4b649648f" kindref="member">m_kValidTimer</ref>.<ref refid="class_se_timer_1ad3c52817ca308cdd73be188d6ab9d65f" kindref="member">IsPassed</ref>())</highlight></codeline>
<codeline lineno="128"><highlight class="normal"><sp/><sp/><sp/><sp/>{</highlight></codeline>
<codeline lineno="129"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="class_se_race_mgr_1a7c5f29d4907cb2df67da3642cdefe371" kindref="member">ValidWaitUpdate</ref>(dwServerTime);</highlight></codeline>
<codeline lineno="130"><highlight class="normal"><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="131"><highlight class="normal"></highlight></codeline>
<codeline lineno="132"><highlight class="normal"><sp/><sp/><sp/><sp/><ref refid="class_se_race_mgr_1a3af4bb17e10c2cb191f381cea5bff3f4" kindref="member">UpdateSvrStaCount</ref>();</highlight></codeline>
<codeline lineno="133"><highlight class="normal">}</highlight></codeline>
<codeline lineno="134"><highlight class="normal"></highlight></codeline>
<codeline lineno="135"><highlight class="normal"></highlight><highlight class="keywordtype">void</highlight><highlight class="normal"><sp/><ref refid="class_se_race_mgr_1abfb79a621d5c4ded6ba61a33248050a6" kindref="member">SeRaceMgr::Finalize</ref>()</highlight></codeline>
<codeline lineno="136"><highlight class="normal">{</highlight></codeline>
<codeline lineno="137"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">for</highlight><highlight class="normal">(<ref refid="_match_server_2_src_2_se_race_mgr_def_8h_1ae8205488e760719ced167c20fd921ef4" kindref="member">MRaceIter</ref><sp/>kItrLoad<sp/>=<sp/><ref refid="class_se_race_mgr_1ad346a0191bf14a69de9422c1fd03b301" kindref="member">m_kMRace</ref>.begin();kItrLoad<sp/>!=<sp/><ref refid="class_se_race_mgr_1ad346a0191bf14a69de9422c1fd03b301" kindref="member">m_kMRace</ref>.end();++kItrLoad)</highlight></codeline>
<codeline lineno="138"><highlight class="normal"><sp/><sp/><sp/><sp/>{</highlight></codeline>
<codeline lineno="139"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="struct_se_match_race" kindref="compound">SeMatchRace</ref>*<sp/>pkRace<sp/>=<sp/>kItrLoad-&gt;second;</highlight></codeline>
<codeline lineno="140"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>SeMatchRace::DEL(pkRace);</highlight></codeline>
<codeline lineno="141"><highlight class="normal"><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="142"><highlight class="normal"><sp/><sp/><sp/><sp/><ref refid="class_se_race_mgr_1ad346a0191bf14a69de9422c1fd03b301" kindref="member">m_kMRace</ref>.clear();</highlight></codeline>
<codeline lineno="143"><highlight class="normal">}</highlight></codeline>
<codeline lineno="144"><highlight class="normal"></highlight></codeline>
<codeline lineno="145"><highlight class="normal"><ref refid="struct_se_match_race" kindref="compound">SeMatchRace</ref>*<sp/><ref refid="class_se_race_mgr_1a1cf22374cc014113c7dd7c09a73ac19a" kindref="member">SeRaceMgr::CreatEmptyRace</ref>(DWord<sp/>dwMapID)</highlight></codeline>
<codeline lineno="146"><highlight class="normal">{</highlight></codeline>
<codeline lineno="147"><highlight class="normal"><sp/><sp/><sp/><sp/><ref refid="struct_se_match_race" kindref="compound">SeMatchRace</ref>*<sp/>pkRace<sp/>=<sp/>SeMatchRace::NEW();</highlight></codeline>
<codeline lineno="148"><highlight class="normal"><sp/><sp/><sp/><sp/>pkRace-&gt;<ref refid="struct_se_match_race_1a8523887086f21641745b808f82cc1828" kindref="member">dwMatchSession</ref><sp/>=<sp/><ref refid="class_se_race_mgr_1a71f19caa1f9b999539298346bdd387a6" kindref="member">GenSession</ref>();</highlight></codeline>
<codeline lineno="149"><highlight class="normal"><sp/><sp/><sp/><sp/>pkRace-&gt;<ref refid="struct_se_match_race_1ac98eae2e335d69e4acbf6f7f869f8ef3" kindref="member">dwLastRecvTime</ref><sp/>=<sp/><ref refid="_src_2_match_server_8cpp_1a1cd9d6d0396497f8a9d48e44d672f368" kindref="member">g_kMatchServer</ref>.<ref refid="class_match_server_1ad3ce38db6c10f10891dbfd700cb954ca" kindref="member">GetServerTime</ref>();</highlight></codeline>
<codeline lineno="150"><highlight class="normal"><sp/><sp/><sp/><sp/>pkRace-&gt;<ref refid="struct_se_match_race_1a3a9af85294d2e4f80524c28c498324b1" kindref="member">eRaceState</ref><sp/>=<sp/><ref refid="_match_server_2_src_2_se_race_mgr_def_8h_1a3f0f87c08c5c7566ba4e99c73d523f20a57a7cb033f87b9a0ef067cff9cab9322" kindref="member">SMRS_LOAD</ref>;</highlight></codeline>
<codeline lineno="151"><highlight class="normal"><sp/><sp/><sp/><sp/>pkRace-&gt;<ref refid="struct_se_match_race_1a5c7ab2cd8f14bbfa4bfd87f2bbb624f9" kindref="member">dwMapID</ref><sp/>=<sp/>dwMapID;</highlight></codeline>
<codeline lineno="152"><highlight class="normal"><sp/><sp/><sp/><sp/>pkRace-&gt;<ref refid="struct_se_match_race_1a30a4dd82bc1c90da9e624e34d3fdc69c" kindref="member">dwKey</ref><sp/>=<sp/><ref refid="class_se_race_mgr_1a14398a0223c50faa2013e5b3128c0874" kindref="member">GetEnterKey</ref>();</highlight></codeline>
<codeline lineno="153"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/>pkRace;</highlight></codeline>
<codeline lineno="154"><highlight class="normal">}</highlight></codeline>
<codeline lineno="155"><highlight class="normal"></highlight></codeline>
<codeline lineno="156"><highlight class="normal"></highlight><highlight class="keywordtype">void</highlight><highlight class="normal"><sp/><ref refid="class_se_race_mgr_1ad6a28d8cb029360686ab1228fd8502af" kindref="member">SeRaceMgr::AddRace</ref>(<ref refid="struct_se_match_race" kindref="compound">SeMatchRace</ref>*<sp/>pkRace)</highlight></codeline>
<codeline lineno="157"><highlight class="normal">{</highlight></codeline>
<codeline lineno="158"><highlight class="normal"><sp/><sp/><sp/><sp/><ref refid="class_se_race_mgr_1ad346a0191bf14a69de9422c1fd03b301" kindref="member">m_kMRace</ref>[pkRace-&gt;<ref refid="struct_se_match_race_1a8523887086f21641745b808f82cc1828" kindref="member">dwMatchSession</ref>]<sp/>=<sp/>pkRace;</highlight></codeline>
<codeline lineno="159"><highlight class="normal">}</highlight></codeline>
<codeline lineno="160"><highlight class="normal"></highlight></codeline>
<codeline lineno="161"><highlight class="normal"></highlight><highlight class="keywordtype">void</highlight><highlight class="normal"><sp/><ref refid="class_se_race_mgr_1a5c64abd6c38ccfa3ed9fdcbeaf7e34b9" kindref="member">SeRaceMgr::OnProcessDetailInfoReturn</ref>(DWord<sp/>dwSession,DWord<sp/>dwPlayerID,<ref refid="struct_se_ptl_match_player" kindref="compound">SePtlMatchPlayer</ref>&amp;<sp/>rakMatchPlayer)</highlight></codeline>
<codeline lineno="162"><highlight class="normal">{</highlight></codeline>
<codeline lineno="163"><highlight class="normal"><sp/><sp/><sp/><sp/><ref refid="struct_se_match_race" kindref="compound">SeMatchRace</ref>*<sp/>pkRace<sp/>=<sp/><ref refid="class_se_race_mgr_1afc891150076c0efc650aa8989cbe9fd8" kindref="member">GetRace</ref>(dwSession);</highlight></codeline>
<codeline lineno="164"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal">(!pkRace)</highlight></codeline>
<codeline lineno="165"><highlight class="normal"><sp/><sp/><sp/><sp/>{</highlight></codeline>
<codeline lineno="166"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="_se_file_log_8h_1a59fe2018c00666084724bec1365b41f5" kindref="member">SeLogError</ref>(</highlight><highlight class="stringliteral">&quot;OnProcessDetailInfoReturn<sp/>fail<sp/>race[%u]<sp/>not<sp/>exist&quot;</highlight><highlight class="normal">,<sp/>dwSession,<sp/>dwPlayerID);</highlight></codeline>
<codeline lineno="167"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal">;</highlight></codeline>
<codeline lineno="168"><highlight class="normal"><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="169"><highlight class="normal"></highlight></codeline>
<codeline lineno="170"><highlight class="normal"><sp/><sp/><sp/><sp/><ref refid="struct_se_race_player" kindref="compound">SeRacePlayer</ref>*<sp/>pkPlayer<sp/>=<sp/>pkRace-&gt;<ref refid="struct_se_match_race_1a3ca2e37d06ca150904873fb695310259" kindref="member">GetRacePlayerByID</ref>(dwPlayerID);</highlight></codeline>
<codeline lineno="171"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(!pkPlayer)</highlight></codeline>
<codeline lineno="172"><highlight class="normal"><sp/><sp/><sp/><sp/>{</highlight></codeline>
<codeline lineno="173"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="_se_file_log_8h_1a59fe2018c00666084724bec1365b41f5" kindref="member">SeLogError</ref>(</highlight><highlight class="stringliteral">&quot;OnProcessDetailInfoReturn<sp/>fail<sp/>player[%u]<sp/>not<sp/>exist&quot;</highlight><highlight class="normal">,<sp/>dwPlayerID);</highlight></codeline>
<codeline lineno="174"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal">;</highlight></codeline>
<codeline lineno="175"><highlight class="normal"><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="176"><highlight class="normal"></highlight></codeline>
<codeline lineno="177"><highlight class="normal"><sp/><sp/><sp/><sp/>pkPlayer-&gt;<ref refid="struct_se_race_player_1afa52af4dc9c6a2c07cb13b72f9e832fc" kindref="member">akPlayerInfo</ref><sp/>=<sp/>rakMatchPlayer;</highlight></codeline>
<codeline lineno="178"><highlight class="normal"><sp/><sp/><sp/><sp/>pkPlayer-&gt;<ref refid="struct_se_race_player_1ac91201769b526bcd333c7ddc3c005212" kindref="member">bLoadEnd</ref><sp/>=<sp/></highlight><highlight class="keyword">true</highlight><highlight class="normal">;</highlight></codeline>
<codeline lineno="179"><highlight class="normal"></highlight></codeline>
<codeline lineno="180"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(pkRace-&gt;<ref refid="struct_se_match_race_1ab4b83af04dd204b42b4a4f0f7682b75c" kindref="member">IsAllPlayerLoad</ref>())</highlight></codeline>
<codeline lineno="181"><highlight class="normal"><sp/><sp/><sp/><sp/>{</highlight></codeline>
<codeline lineno="182"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>pkRace-&gt;<ref refid="struct_se_match_race_1ae0e7766eee9aa76f30450689370bd2a3" kindref="member">bAllLoad</ref><sp/>=<sp/></highlight><highlight class="keyword">true</highlight><highlight class="normal">;</highlight></codeline>
<codeline lineno="183"><highlight class="normal"><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="184"><highlight class="normal">}</highlight></codeline>
<codeline lineno="185"><highlight class="normal"></highlight></codeline>
<codeline lineno="186"><highlight class="normal"></highlight><highlight class="keywordtype">void</highlight><highlight class="normal"><sp/><ref refid="class_se_race_mgr_1a953fd9cdbd27d15296b8e885687b659e" kindref="member">SeRaceMgr::OnProcessCommMsg</ref>(DWord<sp/>dwSession,<ref refid="_se_ptl_define_8h_1a05bc9da3a865896a10de16ae1763a5ba" kindref="member">SeCommMatchMsg</ref><sp/>eMsg,DWord<sp/>dwParam,</highlight><highlight class="keywordtype">int</highlight><highlight class="normal"><sp/>iParam)</highlight></codeline>
<codeline lineno="187"><highlight class="normal">{</highlight></codeline>
<codeline lineno="188"><highlight class="normal"><sp/><sp/><sp/><sp/><ref refid="struct_se_match_race" kindref="compound">SeMatchRace</ref>*<sp/>pkRace<sp/>=<sp/><ref refid="class_se_race_mgr_1afc891150076c0efc650aa8989cbe9fd8" kindref="member">GetRace</ref>(dwSession);</highlight></codeline>
<codeline lineno="189"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal">(!pkRace)</highlight></codeline>
<codeline lineno="190"><highlight class="normal"><sp/><sp/><sp/><sp/>{</highlight></codeline>
<codeline lineno="191"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal">;</highlight></codeline>
<codeline lineno="192"><highlight class="normal"><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="193"><highlight class="normal"></highlight></codeline>
<codeline lineno="194"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal">(eMsg<sp/>==<sp/><ref refid="_se_ptl_define_8h_1a05bc9da3a865896a10de16ae1763a5baa535c910e2d5db6955cbcc2299eb418e4" kindref="member">SCMM_REPORT_LOAD_FAILED</ref>)</highlight></codeline>
<codeline lineno="195"><highlight class="normal"><sp/><sp/><sp/><sp/>{</highlight></codeline>
<codeline lineno="196"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="_se_file_log_8h_1a59fe2018c00666084724bec1365b41f5" kindref="member">SeLogError</ref>(</highlight><highlight class="stringliteral">&quot;receive<sp/>CommMsg&lt;&lt;SCMM_REPORT_LOAD_FAILED![%u]&quot;</highlight><highlight class="normal">,dwSession);</highlight></codeline>
<codeline lineno="197"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="class_se_race_mgr_1aed313cc17a805bea5daeb0366013bae6" kindref="member">SendMatchCommMsg</ref>(pkRace,<ref refid="_se_ptl_define_8h_1a05bc9da3a865896a10de16ae1763a5baa71853bae867c3f91cfcbd95d2fe2081b" kindref="member">SCMM_NOTIFY_LOAD_FAILED</ref>);</highlight></codeline>
<codeline lineno="198"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="class_se_race_mgr_1a0ef051a10db4ce03c09723c3dcd5ce83" kindref="member">DelRace</ref>(dwSession);</highlight></codeline>
<codeline lineno="199"><highlight class="normal"><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="200"><highlight class="normal">}</highlight></codeline>
<codeline lineno="201"><highlight class="normal"></highlight></codeline>
<codeline lineno="202"><highlight class="normal"></highlight><highlight class="keywordtype">void</highlight><highlight class="normal"><sp/><ref refid="class_se_race_mgr_1a5ad018a80d073711ef0832d34ed93550" kindref="member">SeRaceMgr::OnProcessReconQuery</ref>(<ref refid="struct_se_t_m___recon_query" kindref="compound">SeTM_ReconQuery</ref>*<sp/>pkQuery)</highlight></codeline>
<codeline lineno="203"><highlight class="normal">{</highlight></codeline>
<codeline lineno="204"><highlight class="normal"><sp/><sp/><sp/><sp/><ref refid="struct_se_match_race" kindref="compound">SeMatchRace</ref>*<sp/>pkRace<sp/>=<sp/><ref refid="class_se_race_mgr_1afc891150076c0efc650aa8989cbe9fd8" kindref="member">GetRace</ref>(pkQuery-&gt;<ref refid="struct_se_t_m___recon_query_1aa8489d28efa095c023b74841496dc93d" kindref="member">dwRoomID</ref>);</highlight></codeline>
<codeline lineno="205"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(!pkRace)</highlight></codeline>
<codeline lineno="206"><highlight class="normal"><sp/><sp/><sp/><sp/>{</highlight></codeline>
<codeline lineno="207"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal">;</highlight></codeline>
<codeline lineno="208"><highlight class="normal"><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="209"><highlight class="normal"></highlight></codeline>
<codeline lineno="210"><highlight class="normal"><sp/><sp/><sp/><sp/>HSock<sp/>kRaceSock<sp/>=<sp/><ref refid="class_se_race_mgr_1a220a9a7426ccd94670119a48ab0cb56c" kindref="member">GetRaceSvrSock</ref>(pkRace-&gt;<ref refid="struct_se_match_race_1ac5807e52b290fa9cbf27bbe2cff05e1e" kindref="member">kRaceTownSign</ref>);</highlight></codeline>
<codeline lineno="211"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(!kRaceSock.IsInvalid())</highlight></codeline>
<codeline lineno="212"><highlight class="normal"><sp/><sp/><sp/><sp/>{</highlight></codeline>
<codeline lineno="213"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="_src_2_match_server_8cpp_1a1cd9d6d0396497f8a9d48e44d672f368" kindref="member">g_kMatchServer</ref>.<ref refid="class_match_server_1a22d84de900fa1ceeb500ae876d0a3ccb" kindref="member">SendMR_ReconQuery</ref>(pkQuery-&gt;<ref refid="struct_se_t_m___recon_query_1aa8489d28efa095c023b74841496dc93d" kindref="member">dwRoomID</ref>,<sp/>pkQuery-&gt;<ref refid="struct_se_t_m___recon_query_1a786cef236282f8b90d717fa1c455a599" kindref="member">dwAreaID</ref>,<sp/>pkQuery-&gt;<ref refid="struct_se_t_m___recon_query_1a7b7418dad9b68d4563865291bc4ae1ff" kindref="member">dwServerID</ref>,<sp/>pkQuery-&gt;<ref refid="struct_se_t_m___recon_query_1a63cd3594b679cc2cf17f250d009774e8" kindref="member">dwPlayerID</ref>,<sp/></highlight></codeline>
<codeline lineno="214"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>pkQuery-&gt;<ref refid="struct_se_t_m___recon_query_1a0ba5f737a27e5285619d2f62312dd933" kindref="member">iSeat</ref>,<sp/>pkQuery-&gt;<ref refid="struct_se_t_m___recon_query_1a6247ffecf926d7bc36c81a24059edb9a" kindref="member">iOffset</ref>,<sp/>pkQuery-&gt;<ref refid="struct_se_t_m___recon_query_1a7d1654062d30c6e1c82819dbd6ae0db8" kindref="member">dwFrame</ref>,<sp/>&amp;kRaceSock);</highlight></codeline>
<codeline lineno="215"><highlight class="normal"><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="216"><highlight class="normal">}</highlight></codeline>
<codeline lineno="217"><highlight class="normal"></highlight></codeline>
<codeline lineno="218"><highlight class="normal"></highlight><highlight class="keywordtype">void</highlight><highlight class="normal"><sp/><ref refid="class_se_race_mgr_1a75b9922a0ef07db529d63652679dc05c" kindref="member">SeRaceMgr::OnProcessViewQuery</ref>(<ref refid="struct_se_t_m___view_query" kindref="compound">SeTM_ViewQuery</ref>*<sp/>pkQuery,<sp/>HSock<sp/>rkTownSock)</highlight></codeline>
<codeline lineno="219"><highlight class="normal">{</highlight></codeline>
<codeline lineno="220"><highlight class="normal"><sp/><sp/><sp/><sp/><ref refid="struct_se_match_race" kindref="compound">SeMatchRace</ref>*<sp/>pkRace<sp/>=<sp/>NULL;</highlight></codeline>
<codeline lineno="221"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(pkQuery-&gt;<ref refid="struct_se_t_m___view_query_1ae8687ba78a792b38a041e386b4088742" kindref="member">dwSession</ref><sp/>!=<sp/>0)</highlight></codeline>
<codeline lineno="222"><highlight class="normal"><sp/><sp/><sp/><sp/>{</highlight></codeline>
<codeline lineno="223"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>pkRace<sp/>=<sp/><ref refid="class_se_race_mgr_1afc891150076c0efc650aa8989cbe9fd8" kindref="member">GetRace</ref>(pkQuery-&gt;<ref refid="struct_se_t_m___view_query_1ae8687ba78a792b38a041e386b4088742" kindref="member">dwSession</ref>);</highlight></codeline>
<codeline lineno="224"><highlight class="normal"><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="225"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">else</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="226"><highlight class="normal"><sp/><sp/><sp/><sp/>{</highlight></codeline>
<codeline lineno="227"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>pkRace<sp/>=<sp/><ref refid="class_se_race_mgr_1a211300f8529cff28321250404412fe14" kindref="member">GetRaceByPlayerID</ref>(pkQuery-&gt;<ref refid="struct_se_t_m___view_query_1aaad5bc7fa8b83c2260bd8d116a1bd175" kindref="member">dwDstPlayerID</ref>);</highlight></codeline>
<codeline lineno="228"><highlight class="normal"><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="229"><highlight class="normal"></highlight></codeline>
<codeline lineno="230"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(!pkRace)</highlight></codeline>
<codeline lineno="231"><highlight class="normal"><sp/><sp/><sp/><sp/>{</highlight></codeline>
<codeline lineno="232"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="_src_2_match_server_8cpp_1a1cd9d6d0396497f8a9d48e44d672f368" kindref="member">g_kMatchServer</ref>.<ref refid="class_match_server_1af54a983650e22174641d85a930c6ba3a" kindref="member">SendMT_ViewQueryFail</ref>(<ref refid="_se_ptl_comm_define_8h_1a099f96303c4987784812a08a343a5878ae974fb93799d5bb4ba69bfc51b22550e" kindref="member">SVQF_NOT_RACING</ref>,<sp/>pkQuery-&gt;<ref refid="struct_se_t_m___view_query_1ac2e9e5f7c20e28092139d082cb40d6cc" kindref="member">dwAreaID</ref>,<sp/>pkQuery-&gt;<ref refid="struct_se_t_m___view_query_1aabe6dc2196b007a2e6e8e82e8b58b9f2" kindref="member">dwServerID</ref>,<sp/>pkQuery-&gt;<ref refid="struct_se_t_m___view_query_1aebbe8dce22894b6d128e34e90ea5bcc8" kindref="member">dwPlayerID</ref>,<sp/>&amp;rkTownSock);</highlight></codeline>
<codeline lineno="233"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal">;</highlight></codeline>
<codeline lineno="234"><highlight class="normal"><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="235"><highlight class="normal"></highlight></codeline>
<codeline lineno="236"><highlight class="normal"><sp/><sp/><sp/><sp/>HSock<sp/>kRaceSock<sp/>=<sp/><ref refid="class_se_race_mgr_1a220a9a7426ccd94670119a48ab0cb56c" kindref="member">GetRaceSvrSock</ref>(pkRace-&gt;<ref refid="struct_se_match_race_1ac5807e52b290fa9cbf27bbe2cff05e1e" kindref="member">kRaceTownSign</ref>);</highlight></codeline>
<codeline lineno="237"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(!kRaceSock.IsInvalid())</highlight></codeline>
<codeline lineno="238"><highlight class="normal"><sp/><sp/><sp/><sp/>{</highlight></codeline>
<codeline lineno="239"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="_src_2_match_server_8cpp_1a1cd9d6d0396497f8a9d48e44d672f368" kindref="member">g_kMatchServer</ref>.<ref refid="class_match_server_1a06c929738d95ab95ae8bf9859b38faf3" kindref="member">SendMR_ViewQuery</ref>(pkRace-&gt;<ref refid="struct_se_match_race_1a8523887086f21641745b808f82cc1828" kindref="member">dwMatchSession</ref>,<sp/>pkQuery-&gt;<ref refid="struct_se_t_m___view_query_1ac2e9e5f7c20e28092139d082cb40d6cc" kindref="member">dwAreaID</ref>,<sp/>pkQuery-&gt;<ref refid="struct_se_t_m___view_query_1aabe6dc2196b007a2e6e8e82e8b58b9f2" kindref="member">dwServerID</ref>,<sp/></highlight></codeline>
<codeline lineno="240"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>pkQuery-&gt;<ref refid="struct_se_t_m___view_query_1aebbe8dce22894b6d128e34e90ea5bcc8" kindref="member">dwPlayerID</ref>,<sp/>pkQuery-&gt;<ref refid="struct_se_t_m___view_query_1ab8e8666f787b46b752376d79564d5bcf" kindref="member">iViewDelay</ref>,<sp/>&amp;kRaceSock);</highlight></codeline>
<codeline lineno="241"><highlight class="normal"><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="242"><highlight class="normal">}</highlight></codeline>
<codeline lineno="243"><highlight class="normal"></highlight></codeline>
<codeline lineno="244"><highlight class="normal"></highlight><highlight class="keywordtype">void</highlight><highlight class="normal"><sp/><ref refid="class_se_race_mgr_1ad1148f9b642dd42adf497575c5b73040" kindref="member">SeRaceMgr::OnProcessValidateInfoRet</ref>(DWord<sp/>dwSessionID,<sp/><ref refid="_se_ptl_define_8h_1a7744414426a2ffadcdaa72f8ceabe6f5" kindref="member">SeMatchValidateResult</ref><sp/>eResult)</highlight></codeline>
<codeline lineno="245"><highlight class="normal">{</highlight></codeline>
<codeline lineno="246"><highlight class="normal"><sp/><sp/><sp/><sp/><ref refid="struct_se_match_race" kindref="compound">SeMatchRace</ref>*<sp/>pkRace<sp/>=<sp/><ref refid="class_se_race_mgr_1afc891150076c0efc650aa8989cbe9fd8" kindref="member">GetRace</ref>(dwSessionID);</highlight></codeline>
<codeline lineno="247"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(!pkRace)</highlight></codeline>
<codeline lineno="248"><highlight class="normal"><sp/><sp/><sp/><sp/>{</highlight></codeline>
<codeline lineno="249"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="_se_file_log_8h_1a59fe2018c00666084724bec1365b41f5" kindref="member">SeLogError</ref>(</highlight><highlight class="stringliteral">&quot;OnProcessValidateInfoRet<sp/>fail<sp/>race[%u]<sp/>not<sp/>exist&quot;</highlight><highlight class="normal">,<sp/>dwSessionID);</highlight></codeline>
<codeline lineno="250"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal">;</highlight></codeline>
<codeline lineno="251"><highlight class="normal"><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="252"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">switch</highlight><highlight class="normal"><sp/>(eResult)</highlight></codeline>
<codeline lineno="253"><highlight class="normal"><sp/><sp/><sp/><sp/>{</highlight></codeline>
<codeline lineno="254"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">case</highlight><highlight class="normal"><sp/><ref refid="_se_ptl_define_8h_1a7744414426a2ffadcdaa72f8ceabe6f5a368f1af6af67daa6db6738b57c9e2610" kindref="member">SMVR_RECEIVE_OK</ref>:</highlight></codeline>
<codeline lineno="255"><highlight class="normal"><sp/><sp/><sp/><sp/>{</highlight></codeline>
<codeline lineno="256"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(!<ref refid="class_se_race_mgr_1a51dd9494f018279ef23edbf579d0b525" kindref="member">SendMatchAddrMsg</ref>(pkRace))</highlight></codeline>
<codeline lineno="257"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>{</highlight></codeline>
<codeline lineno="258"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="_se_file_log_8h_1a59fe2018c00666084724bec1365b41f5" kindref="member">SeLogError</ref>(<sp/></highlight><highlight class="stringliteral">&quot;OnProcessValidateInfoRet<sp/>error[%d]session[%u]&quot;</highlight><highlight class="normal">,<sp/>(</highlight><highlight class="keywordtype">int</highlight><highlight class="normal">)eResult,<sp/>dwSessionID);</highlight></codeline>
<codeline lineno="259"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="class_se_race_mgr_1aed313cc17a805bea5daeb0366013bae6" kindref="member">SendMatchCommMsg</ref>(pkRace,<sp/><ref refid="_se_ptl_define_8h_1a05bc9da3a865896a10de16ae1763a5baa85a0783a4b1917d870d90198d0e4f10c" kindref="member">SCMM_NOTIFY_VALIDATE_FAILED</ref>);</highlight></codeline>
<codeline lineno="260"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="class_se_race_mgr_1a0ef051a10db4ce03c09723c3dcd5ce83" kindref="member">DelRace</ref>(dwSessionID);</highlight></codeline>
<codeline lineno="261"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="262"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">break</highlight><highlight class="normal">;</highlight></codeline>
<codeline lineno="263"><highlight class="normal"><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="264"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">case</highlight><highlight class="normal"><sp/><ref refid="_se_ptl_define_8h_1a7744414426a2ffadcdaa72f8ceabe6f5a08ac68a031c3f71bd9775008769a0fe5" kindref="member">SMVR_REPEAT</ref>:</highlight></codeline>
<codeline lineno="265"><highlight class="normal"><sp/><sp/><sp/><sp/>{</highlight></codeline>
<codeline lineno="266"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="_se_file_log_8h_1a59fe2018c00666084724bec1365b41f5" kindref="member">SeLogError</ref>(<sp/></highlight><highlight class="stringliteral">&quot;OnProcessValidateInfoRet<sp/>error[%d]session[%u]&quot;</highlight><highlight class="normal">,<sp/>(</highlight><highlight class="keywordtype">int</highlight><highlight class="normal">)eResult,<sp/>dwSessionID);</highlight></codeline>
<codeline lineno="267"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="class_se_race_mgr_1aed313cc17a805bea5daeb0366013bae6" kindref="member">SendMatchCommMsg</ref>(pkRace,<sp/><ref refid="_se_ptl_define_8h_1a05bc9da3a865896a10de16ae1763a5baa85a0783a4b1917d870d90198d0e4f10c" kindref="member">SCMM_NOTIFY_VALIDATE_FAILED</ref>);</highlight></codeline>
<codeline lineno="268"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="class_se_race_mgr_1a0ef051a10db4ce03c09723c3dcd5ce83" kindref="member">DelRace</ref>(dwSessionID);</highlight></codeline>
<codeline lineno="269"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">break</highlight><highlight class="normal">;</highlight></codeline>
<codeline lineno="270"><highlight class="normal"><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="271"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">case</highlight><highlight class="normal"><sp/><ref refid="_se_ptl_define_8h_1a7744414426a2ffadcdaa72f8ceabe6f5ab768b2ee764a29649312e03176f3f6fd" kindref="member">SMVR_TIMEOUT</ref>:</highlight></codeline>
<codeline lineno="272"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">case</highlight><highlight class="normal"><sp/><ref refid="_se_ptl_define_8h_1a7744414426a2ffadcdaa72f8ceabe6f5adc32b8798eb109a2fc268c516dffc562" kindref="member">SMVR_LEAVE</ref>:</highlight></codeline>
<codeline lineno="273"><highlight class="normal"><sp/><sp/><sp/><sp/>{</highlight></codeline>
<codeline lineno="274"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="_se_file_log_8h_1a59fe2018c00666084724bec1365b41f5" kindref="member">SeLogError</ref>(<sp/></highlight><highlight class="stringliteral">&quot;OnProcessValidateInfoRet<sp/>error[%d]session[%u]&quot;</highlight><highlight class="normal">,<sp/>(</highlight><highlight class="keywordtype">int</highlight><highlight class="normal">)eResult,<sp/>dwSessionID);</highlight></codeline>
<codeline lineno="275"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="class_se_race_mgr_1aed313cc17a805bea5daeb0366013bae6" kindref="member">SendMatchCommMsg</ref>(pkRace,<sp/><ref refid="_se_ptl_define_8h_1a05bc9da3a865896a10de16ae1763a5baa85a0783a4b1917d870d90198d0e4f10c" kindref="member">SCMM_NOTIFY_VALIDATE_FAILED</ref>);</highlight></codeline>
<codeline lineno="276"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="class_se_race_mgr_1a0ef051a10db4ce03c09723c3dcd5ce83" kindref="member">DelRace</ref>(dwSessionID);</highlight></codeline>
<codeline lineno="277"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">break</highlight><highlight class="normal">;</highlight></codeline>
<codeline lineno="278"><highlight class="normal"><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="279"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">case</highlight><highlight class="normal"><sp/><ref refid="_se_ptl_define_8h_1a7744414426a2ffadcdaa72f8ceabe6f5a3efcae168fd60696ec6aea47fe31c82b" kindref="member">SMVR_OK</ref>:</highlight></codeline>
<codeline lineno="280"><highlight class="normal"><sp/><sp/><sp/><sp/>{</highlight></codeline>
<codeline lineno="281"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>pkRace-&gt;<ref refid="struct_se_match_race_1a3a9af85294d2e4f80524c28c498324b1" kindref="member">eRaceState</ref><sp/>=<sp/><ref refid="_match_server_2_src_2_se_race_mgr_def_8h_1a3f0f87c08c5c7566ba4e99c73d523f20ae3d9982b64c7a66198cd9ab4087da446" kindref="member">SMRS_SEL_HERO</ref>;</highlight></codeline>
<codeline lineno="282"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>pkRace-&gt;<ref refid="struct_se_match_race_1ac98eae2e335d69e4acbf6f7f869f8ef3" kindref="member">dwLastRecvTime</ref><sp/>=<sp/><ref refid="_src_2_match_server_8cpp_1a1cd9d6d0396497f8a9d48e44d672f368" kindref="member">g_kMatchServer</ref>.<ref refid="class_match_server_1ad3ce38db6c10f10891dbfd700cb954ca" kindref="member">GetServerTime</ref>();</highlight></codeline>
<codeline lineno="283"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="class_se_race_mgr_1aed313cc17a805bea5daeb0366013bae6" kindref="member">SendMatchCommMsg</ref>(pkRace,<sp/><ref refid="_se_ptl_define_8h_1a05bc9da3a865896a10de16ae1763a5baa13a9d86cba49bd797195cae1f5de27d1" kindref="member">SCMM_ENTER_SEL_HERO</ref>);</highlight></codeline>
<codeline lineno="284"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">break</highlight><highlight class="normal">;</highlight></codeline>
<codeline lineno="285"><highlight class="normal"><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="286"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">default</highlight><highlight class="normal">:</highlight></codeline>
<codeline lineno="287"><highlight class="normal"><sp/><sp/><sp/><sp/>{</highlight></codeline>
<codeline lineno="288"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">break</highlight><highlight class="normal">;</highlight></codeline>
<codeline lineno="289"><highlight class="normal"><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="290"><highlight class="normal"><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="291"><highlight class="normal">}</highlight></codeline>
<codeline lineno="292"><highlight class="normal"></highlight></codeline>
<codeline lineno="293"><highlight class="normal"></highlight><highlight class="keywordtype">void</highlight><highlight class="normal"><sp/><ref refid="class_se_race_mgr_1ace94e8eda413a3dc4ec9424a8d49fde5" kindref="member">SeRaceMgr::OnProcessUpdateMisc</ref>(<ref refid="struct_se_r_m___update_misc" kindref="compound">SeRM_UpdateMisc</ref>*<sp/>pkMisc,<sp/></highlight><highlight class="keywordtype">int</highlight><highlight class="normal"><sp/>iSize)</highlight></codeline>
<codeline lineno="294"><highlight class="normal">{</highlight></codeline>
<codeline lineno="295"><highlight class="normal"><sp/><sp/><sp/><sp/>HSock<sp/>kTownSock;</highlight></codeline>
<codeline lineno="296"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(pkMisc-&gt;<ref refid="struct_se_r_m___update_misc_1afad307287d71286cba8296228c4398e7" kindref="member">eType</ref><sp/>==<sp/><ref refid="_se_ptl_define_8h_1a0439ce57b5c52e594faa12cea06edf1dadaba700b75c2bf5ca8411d5e079204e0" kindref="member">MM_VIEW_STATE</ref>)</highlight></codeline>
<codeline lineno="297"><highlight class="normal"><sp/><sp/><sp/><sp/>{</highlight></codeline>
<codeline lineno="298"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="struct_h_town_sign" kindref="compound">HTownSign</ref><sp/>kViewSign;</highlight></codeline>
<codeline lineno="299"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>kViewSign.<ref refid="struct_h_town_sign_1ad2078fab8662517a20a8c8702861c430" kindref="member">dwAreaID</ref><sp/>=<sp/>pkMisc-&gt;<ref refid="struct_se_r_m___update_misc_1a68eac35056e5782f9463603daff19de1" kindref="member">dwParam1</ref>;</highlight></codeline>
<codeline lineno="300"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>kViewSign.<ref refid="struct_h_town_sign_1aad795425c3c60114ef0578356b339d2c" kindref="member">dwServerID</ref><sp/>=<sp/>pkMisc-&gt;<ref refid="struct_se_r_m___update_misc_1a2c17d4d67f6579298145da40533d986c" kindref="member">dwParam2</ref>;</highlight></codeline>
<codeline lineno="301"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>kTownSock<sp/>=<sp/><ref refid="class_se_race_mgr_1a3a7dd145633602ee3b6b491eabaff87f" kindref="member">GetTownSock</ref>(kViewSign);</highlight></codeline>
<codeline lineno="302"><highlight class="normal"><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="303"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">else</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="304"><highlight class="normal"><sp/><sp/><sp/><sp/>{</highlight></codeline>
<codeline lineno="305"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="struct_se_match_race" kindref="compound">SeMatchRace</ref>*<sp/>pkRace<sp/>=<sp/><ref refid="class_se_race_mgr_1afc891150076c0efc650aa8989cbe9fd8" kindref="member">GetRace</ref>(pkMisc-&gt;<ref refid="struct_se_r_m___update_misc_1ae781e0f2976c5f2b8c4589979e7399b1" kindref="member">dwSession</ref>);</highlight></codeline>
<codeline lineno="306"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(!pkRace)</highlight></codeline>
<codeline lineno="307"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>{</highlight></codeline>
<codeline lineno="308"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal">;</highlight></codeline>
<codeline lineno="309"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="310"><highlight class="normal"></highlight></codeline>
<codeline lineno="311"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="struct_se_race_player" kindref="compound">SeRacePlayer</ref>*<sp/>pkPlayer<sp/>=<sp/>pkRace-&gt;<ref refid="struct_se_match_race_1a3ca2e37d06ca150904873fb695310259" kindref="member">GetRacePlayerByID</ref>(pkMisc-&gt;<ref refid="struct_se_r_m___update_misc_1a8fd861706421ba5d3bb2c05c1ed0cf39" kindref="member">dwPlayerID</ref>);</highlight></codeline>
<codeline lineno="312"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(!pkPlayer)</highlight></codeline>
<codeline lineno="313"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>{</highlight></codeline>
<codeline lineno="314"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal">;</highlight></codeline>
<codeline lineno="315"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="316"><highlight class="normal"></highlight></codeline>
<codeline lineno="317"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(pkMisc-&gt;<ref refid="struct_se_r_m___update_misc_1afad307287d71286cba8296228c4398e7" kindref="member">eType</ref><sp/>==<sp/><ref refid="_se_ptl_define_8h_1a0439ce57b5c52e594faa12cea06edf1da557dfcad2765dfd614033b59b0426954" kindref="member">MM_GAME_STATE</ref><sp/>&amp;&amp;<sp/>pkMisc-&gt;<ref refid="struct_se_r_m___update_misc_1a6b5678a861cee716f4f71e9da7d7715e" kindref="member">iValue</ref><sp/>==<sp/></highlight><highlight class="keyword">true</highlight><highlight class="normal">)</highlight></codeline>
<codeline lineno="318"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>{</highlight></codeline>
<codeline lineno="319"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">//</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="320"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordtype">int</highlight><highlight class="normal"><sp/>iSeat<sp/>=<sp/>pkMisc-&gt;<ref refid="struct_se_r_m___update_misc_1a2c17d4d67f6579298145da40533d986c" kindref="member">dwParam2</ref>;</highlight></codeline>
<codeline lineno="321"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>g_kRaceMgr.<ref refid="class_se_race_mgr_1a5661c924e708c442a79549e4d2782185" kindref="member">OnProcessReconPlayerInfo</ref>(pkMisc-&gt;<ref refid="struct_se_r_m___update_misc_1ae781e0f2976c5f2b8c4589979e7399b1" kindref="member">dwSession</ref>,<sp/>pkMisc-&gt;<ref refid="struct_se_r_m___update_misc_1a8fd861706421ba5d3bb2c05c1ed0cf39" kindref="member">dwPlayerID</ref>,<sp/>iSeat);</highlight></codeline>
<codeline lineno="322"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="323"><highlight class="normal"></highlight></codeline>
<codeline lineno="324"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>kTownSock<sp/>=<sp/><ref refid="class_se_race_mgr_1a3a7dd145633602ee3b6b491eabaff87f" kindref="member">GetTownSock</ref>(pkPlayer-&gt;<ref refid="struct_se_race_player_1ac5601dda3e2dfc69b74649cbbfe6e141" kindref="member">kTownSign</ref>);</highlight></codeline>
<codeline lineno="325"><highlight class="normal"><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="326"><highlight class="normal"></highlight></codeline>
<codeline lineno="327"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(!kTownSock.IsInvalid())</highlight></codeline>
<codeline lineno="328"><highlight class="normal"><sp/><sp/><sp/><sp/>{</highlight></codeline>
<codeline lineno="329"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="_src_2_match_server_8cpp_1a1cd9d6d0396497f8a9d48e44d672f368" kindref="member">g_kMatchServer</ref>.<ref refid="class_match_server_1a25193f7b03db08a1be4caf74cb3f474a" kindref="member">SendMT_UpdateMisc</ref>(pkMisc-&gt;<ref refid="struct_se_r_m___update_misc_1a8fd861706421ba5d3bb2c05c1ed0cf39" kindref="member">dwPlayerID</ref>,<sp/>pkMisc-&gt;<ref refid="struct_se_r_m___update_misc_1ae781e0f2976c5f2b8c4589979e7399b1" kindref="member">dwSession</ref>,<sp/>pkMisc-&gt;<ref refid="struct_se_r_m___update_misc_1afad307287d71286cba8296228c4398e7" kindref="member">eType</ref>,<sp/></highlight></codeline>
<codeline lineno="330"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>pkMisc-&gt;<ref refid="struct_se_r_m___update_misc_1a6b5678a861cee716f4f71e9da7d7715e" kindref="member">iValue</ref>,<sp/>pkMisc-&gt;<ref refid="struct_se_r_m___update_misc_1a68eac35056e5782f9463603daff19de1" kindref="member">dwParam1</ref>,<sp/>pkMisc-&gt;<ref refid="struct_se_r_m___update_misc_1a2c17d4d67f6579298145da40533d986c" kindref="member">dwParam2</ref>,<sp/>&amp;kTownSock);</highlight></codeline>
<codeline lineno="331"><highlight class="normal"><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="332"><highlight class="normal">}</highlight></codeline>
<codeline lineno="333"><highlight class="normal"></highlight></codeline>
<codeline lineno="334"><highlight class="normal"></highlight><highlight class="keywordtype">void</highlight><highlight class="normal"><sp/><ref refid="class_se_race_mgr_1a0694b0603edde7b9a9ca3cb04d12dfbd" kindref="member">SeRaceMgr::OnProcessRaceEndReport</ref>(<ref refid="struct_se_r_m___race_end_report" kindref="compound">SeRM_RaceEndReport</ref>*<sp/>pkRaceEnd,<sp/></highlight><highlight class="keywordtype">int</highlight><highlight class="normal"><sp/>iSize)</highlight></codeline>
<codeline lineno="335"><highlight class="normal">{</highlight></codeline>
<codeline lineno="336"><highlight class="normal"><sp/><sp/><sp/><sp/>std::set&lt;DWord&gt;<sp/>kSetAreaID;</highlight></codeline>
<codeline lineno="337"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">for</highlight><highlight class="normal"><sp/>(</highlight><highlight class="keywordtype">int</highlight><highlight class="normal"><sp/>i<sp/>=<sp/>0;<sp/>i<sp/>&lt;<sp/>pkRaceEnd-&gt;<ref refid="struct_se_r_m___race_end_report_1af668214ec0363c8e89caf64f3e20b055" kindref="member">iNum</ref>;<sp/>++i)</highlight></codeline>
<codeline lineno="338"><highlight class="normal"><sp/><sp/><sp/><sp/>{</highlight></codeline>
<codeline lineno="339"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="struct_se_w_s_race_send_info" kindref="compound">SeWSRaceSendInfo</ref>&amp;<sp/>rkEndInfo<sp/>=<sp/>pkRaceEnd-&gt;<ref refid="struct_se_r_m___race_end_report_1a32a412b06a7b87aca41e92aad63cee5a" kindref="member">akInfo</ref>[i];</highlight></codeline>
<codeline lineno="340"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>kSetAreaID.insert(rkEndInfo.<ref refid="struct_se_w_s_race_send_info_1add8fa78c25c6fcc351b949b0891a16ee" kindref="member">dwAreaID</ref>);</highlight></codeline>
<codeline lineno="341"><highlight class="normal"><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="342"><highlight class="normal"></highlight></codeline>
<codeline lineno="343"><highlight class="normal"><sp/><sp/><sp/><sp/><ref refid="struct_se_match_race" kindref="compound">SeMatchRace</ref>*<sp/>pkRace<sp/>=<sp/><ref refid="class_se_race_mgr_1afc891150076c0efc650aa8989cbe9fd8" kindref="member">GetRace</ref>(pkRaceEnd-&gt;<ref refid="struct_se_r_m___race_end_report_1a98f03b6146c6b2d6d876a5c5773325c2" kindref="member">dwMatchSession</ref>);</highlight></codeline>
<codeline lineno="344"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(!pkRace)</highlight></codeline>
<codeline lineno="345"><highlight class="normal"><sp/><sp/><sp/><sp/>{</highlight></codeline>
<codeline lineno="346"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">//<sp/></highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="347"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">for</highlight><highlight class="normal"><sp/>(std::set&lt;DWord&gt;::iterator<sp/>itr<sp/>=<sp/>kSetAreaID.begin();<sp/>itr<sp/>!=<sp/>kSetAreaID.end();<sp/>++itr)</highlight></codeline>
<codeline lineno="348"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>{</highlight></codeline>
<codeline lineno="349"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>HSock<sp/>kTownSock<sp/>=<sp/><ref refid="_match_server_2_src_2_se_town_mgr_8cpp_1a0d99b78f6d107c2f607862b30d586175" kindref="member">g_kTownMgr</ref>.<ref refid="class_se_town_mgr_1a0840b23b1554442e1b59dd99e998d06d" kindref="member">GetTownSockByArea</ref>(*itr);</highlight></codeline>
<codeline lineno="350"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(!kTownSock.IsInvalid())</highlight></codeline>
<codeline lineno="351"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>{</highlight></codeline>
<codeline lineno="352"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="_src_2_match_server_8cpp_1a1cd9d6d0396497f8a9d48e44d672f368" kindref="member">g_kMatchServer</ref>.<ref refid="class_match_server_1a3d86b9b2c53fcdce7facacfdc61ed2c5" kindref="member">SendMT_RaceEndSend</ref>(pkRaceEnd-&gt;<ref refid="struct_se_r_m___race_end_report_1ac0bc2289796d6b370940f70f2a79b883" kindref="member">dwTime</ref>,<sp/>pkRaceEnd-&gt;<ref refid="struct_se_r_m___race_end_report_1a2bfee09ba33dccfc8b995b17090beee6" kindref="member">dwMapID</ref>,<sp/>pkRaceEnd-&gt;<ref refid="struct_se_r_m___race_end_report_1a98f03b6146c6b2d6d876a5c5773325c2" kindref="member">dwMatchSession</ref>,</highlight></codeline>
<codeline lineno="353"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>pkRaceEnd-&gt;<ref refid="struct_se_r_m___race_end_report_1a81dd49f43a39c99f3d0fdb0d3dc7c793" kindref="member">eMatchType</ref>,<sp/>pkRaceEnd-&gt;<ref refid="struct_se_r_m___race_end_report_1af668214ec0363c8e89caf64f3e20b055" kindref="member">iNum</ref>,<sp/>pkRaceEnd-&gt;<ref refid="struct_se_r_m___race_end_report_1a32a412b06a7b87aca41e92aad63cee5a" kindref="member">akInfo</ref>,&amp;kTownSock);</highlight></codeline>
<codeline lineno="354"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="355"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="356"><highlight class="normal"></highlight></codeline>
<codeline lineno="357"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">//<sp/>fixme:</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="358"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal">;</highlight></codeline>
<codeline lineno="359"><highlight class="normal"><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="360"><highlight class="normal"></highlight></codeline>
<codeline lineno="361"><highlight class="normal"><sp/><sp/><sp/><sp/>std::vector&lt;HTownSign&gt;<sp/>akNeedSendTown;</highlight></codeline>
<codeline lineno="362"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">for</highlight><highlight class="normal"><sp/>(std::set&lt;DWord&gt;::iterator<sp/>itr<sp/>=<sp/>kSetAreaID.begin();<sp/>itr<sp/>!=<sp/>kSetAreaID.end();<sp/>++itr)</highlight></codeline>
<codeline lineno="363"><highlight class="normal"><sp/><sp/><sp/><sp/>{</highlight></codeline>
<codeline lineno="364"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>DWord<sp/>dwAreaID<sp/>=<sp/>*itr;</highlight></codeline>
<codeline lineno="365"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="struct_h_town_sign" kindref="compound">HTownSign</ref><sp/>kTownSign<sp/>=<sp/><ref refid="class_se_race_mgr_1a9dabb6c38e2b0997f05aae05078c3325" kindref="member">GetTownSignByAreaID</ref>(pkRace-&gt;<ref refid="struct_se_match_race_1a1f51c90f643641518fc163f150a11419" kindref="member">akMRacePlayer</ref>,<sp/>dwAreaID);</highlight></codeline>
<codeline lineno="366"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>akNeedSendTown.push_back(kTownSign);</highlight></codeline>
<codeline lineno="367"><highlight class="normal"><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="368"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">for</highlight><highlight class="normal"><sp/>(</highlight><highlight class="keywordtype">int</highlight><highlight class="normal"><sp/>j<sp/>=<sp/>0;<sp/>j<sp/>&lt;<sp/>(int)akNeedSendTown.size();<sp/>j++)</highlight></codeline>
<codeline lineno="369"><highlight class="normal"><sp/><sp/><sp/><sp/>{</highlight></codeline>
<codeline lineno="370"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="struct_h_town_sign" kindref="compound">HTownSign</ref>&amp;<sp/>rkTownSign<sp/>=<sp/>akNeedSendTown[j];</highlight></codeline>
<codeline lineno="371"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>HSock<sp/>kTownSock<sp/>=<sp/><ref refid="class_se_race_mgr_1a3a7dd145633602ee3b6b491eabaff87f" kindref="member">GetTownSock</ref>(rkTownSign);</highlight></codeline>
<codeline lineno="372"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(kTownSock.IsInvalid())</highlight></codeline>
<codeline lineno="373"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>{</highlight></codeline>
<codeline lineno="374"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>kTownSock<sp/>=<sp/><ref refid="_match_server_2_src_2_se_town_mgr_8cpp_1a0d99b78f6d107c2f607862b30d586175" kindref="member">g_kTownMgr</ref>.<ref refid="class_se_town_mgr_1a0840b23b1554442e1b59dd99e998d06d" kindref="member">GetTownSockByArea</ref>(rkTownSign.<ref refid="struct_h_town_sign_1ad2078fab8662517a20a8c8702861c430" kindref="member">dwAreaID</ref>);</highlight></codeline>
<codeline lineno="375"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="376"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(!kTownSock.IsInvalid())</highlight></codeline>
<codeline lineno="377"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>{</highlight></codeline>
<codeline lineno="378"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="_src_2_match_server_8cpp_1a1cd9d6d0396497f8a9d48e44d672f368" kindref="member">g_kMatchServer</ref>.<ref refid="class_match_server_1a3d86b9b2c53fcdce7facacfdc61ed2c5" kindref="member">SendMT_RaceEndSend</ref>(pkRaceEnd-&gt;<ref refid="struct_se_r_m___race_end_report_1ac0bc2289796d6b370940f70f2a79b883" kindref="member">dwTime</ref>,<sp/>pkRaceEnd-&gt;<ref refid="struct_se_r_m___race_end_report_1a2bfee09ba33dccfc8b995b17090beee6" kindref="member">dwMapID</ref>,<sp/>pkRaceEnd-&gt;<ref refid="struct_se_r_m___race_end_report_1a98f03b6146c6b2d6d876a5c5773325c2" kindref="member">dwMatchSession</ref>,</highlight></codeline>
<codeline lineno="379"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>pkRaceEnd-&gt;<ref refid="struct_se_r_m___race_end_report_1a81dd49f43a39c99f3d0fdb0d3dc7c793" kindref="member">eMatchType</ref>,<sp/>pkRaceEnd-&gt;<ref refid="struct_se_r_m___race_end_report_1af668214ec0363c8e89caf64f3e20b055" kindref="member">iNum</ref>,<sp/>pkRaceEnd-&gt;<ref refid="struct_se_r_m___race_end_report_1a32a412b06a7b87aca41e92aad63cee5a" kindref="member">akInfo</ref>,&amp;kTownSock);</highlight></codeline>
<codeline lineno="380"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="381"><highlight class="normal"><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="382"><highlight class="normal">}</highlight></codeline>
<codeline lineno="383"><highlight class="normal"></highlight></codeline>
<codeline lineno="384"><highlight class="normal"></highlight><highlight class="keywordtype">void</highlight><highlight class="normal"><sp/><ref refid="class_se_race_mgr_1a883a0435bb8fb11955f93d6e3214f373" kindref="member">SeRaceMgr::OnProcessRaceEndGuanqia</ref>(<ref refid="struct_se_r_m___race_end_guanqia" kindref="compound">SeRM_RaceEndGuanqia</ref>*<sp/>pkRaceEnd,<sp/></highlight><highlight class="keywordtype">int</highlight><highlight class="normal"><sp/>iSize)</highlight></codeline>
<codeline lineno="385"><highlight class="normal">{</highlight></codeline>
<codeline lineno="386"><highlight class="normal"><sp/><sp/><sp/><sp/>std::set&lt;DWord&gt;<sp/>kSetAreaID;</highlight></codeline>
<codeline lineno="387"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">for</highlight><highlight class="normal"><sp/>(</highlight><highlight class="keywordtype">int</highlight><highlight class="normal"><sp/>i<sp/>=<sp/>0;<sp/>i<sp/>&lt;<sp/>pkRaceEnd-&gt;<ref refid="struct_se_r_m___race_end_guanqia_1a0b58bb5a82d60016829fe14a0add9665" kindref="member">iNum</ref>;<sp/>++i)</highlight></codeline>
<codeline lineno="388"><highlight class="normal"><sp/><sp/><sp/><sp/>{</highlight></codeline>
<codeline lineno="389"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="struct_se_w_s_guanqia_send_info" kindref="compound">SeWSGuanqiaSendInfo</ref>&amp;<sp/>rkEndInfo<sp/>=<sp/>pkRaceEnd-&gt;<ref refid="struct_se_r_m___race_end_guanqia_1a715aee4b3c1374cad019a478613ff5da" kindref="member">akInfo</ref>[i];</highlight></codeline>
<codeline lineno="390"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>kSetAreaID.insert(rkEndInfo.<ref refid="struct_se_w_s_guanqia_send_info_1a58a0ab44f0fdbea00d35d14e13bb1dfe" kindref="member">dwAreaID</ref>);</highlight></codeline>
<codeline lineno="391"><highlight class="normal"><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="392"><highlight class="normal"></highlight></codeline>
<codeline lineno="393"><highlight class="normal"><sp/><sp/><sp/><sp/><ref refid="struct_se_match_race" kindref="compound">SeMatchRace</ref>*<sp/>pkRace<sp/>=<sp/><ref refid="class_se_race_mgr_1afc891150076c0efc650aa8989cbe9fd8" kindref="member">GetRace</ref>(pkRaceEnd-&gt;<ref refid="struct_se_r_m___race_end_guanqia_1a28dad20a64907b89420098a2a24dc0cd" kindref="member">dwMatchSession</ref>);</highlight></codeline>
<codeline lineno="394"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(!pkRace)</highlight></codeline>
<codeline lineno="395"><highlight class="normal"><sp/><sp/><sp/><sp/>{</highlight></codeline>
<codeline lineno="396"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">//<sp/></highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="397"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">for</highlight><highlight class="normal"><sp/>(std::set&lt;DWord&gt;::iterator<sp/>itr<sp/>=<sp/>kSetAreaID.begin();<sp/>itr<sp/>!=<sp/>kSetAreaID.end();<sp/>++itr)</highlight></codeline>
<codeline lineno="398"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>{</highlight></codeline>
<codeline lineno="399"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>HSock<sp/>kTownSock<sp/>=<sp/><ref refid="_match_server_2_src_2_se_town_mgr_8cpp_1a0d99b78f6d107c2f607862b30d586175" kindref="member">g_kTownMgr</ref>.<ref refid="class_se_town_mgr_1a0840b23b1554442e1b59dd99e998d06d" kindref="member">GetTownSockByArea</ref>(*itr);</highlight></codeline>
<codeline lineno="400"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(!kTownSock.IsInvalid())</highlight></codeline>
<codeline lineno="401"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>{</highlight></codeline>
<codeline lineno="402"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="_src_2_match_server_8cpp_1a1cd9d6d0396497f8a9d48e44d672f368" kindref="member">g_kMatchServer</ref>.<ref refid="class_match_server_1a25a32302af6c42c1d2977299004c6c1c" kindref="member">SendMT_GuanqiaEndSend</ref>(pkRaceEnd-&gt;<ref refid="struct_se_r_m___race_end_guanqia_1a57b84229ac8db1551e18453b7df2bd2a" kindref="member">dwTime</ref>,<sp/>pkRaceEnd-&gt;<ref refid="struct_se_r_m___race_end_guanqia_1a90fc6c6661157dad2c12530cf8dcecfc" kindref="member">dwMapID</ref>,<sp/>pkRaceEnd-&gt;<ref refid="struct_se_r_m___race_end_guanqia_1a28dad20a64907b89420098a2a24dc0cd" kindref="member">dwMatchSession</ref>,<sp/>pkRaceEnd-&gt;<ref refid="struct_se_r_m___race_end_guanqia_1a0b58bb5a82d60016829fe14a0add9665" kindref="member">iNum</ref>,<sp/>pkRaceEnd-&gt;<ref refid="struct_se_r_m___race_end_guanqia_1a715aee4b3c1374cad019a478613ff5da" kindref="member">akInfo</ref>,<sp/>&amp;kTownSock);</highlight></codeline>
<codeline lineno="403"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="404"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="405"><highlight class="normal"></highlight></codeline>
<codeline lineno="406"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">//<sp/>fixme:</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="407"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal">;</highlight></codeline>
<codeline lineno="408"><highlight class="normal"><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="409"><highlight class="normal"></highlight></codeline>
<codeline lineno="410"><highlight class="normal"><sp/><sp/><sp/><sp/>std::vector&lt;HTownSign&gt;<sp/>akNeedSendTown;</highlight></codeline>
<codeline lineno="411"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">for</highlight><highlight class="normal"><sp/>(std::set&lt;DWord&gt;::iterator<sp/>itr<sp/>=<sp/>kSetAreaID.begin();<sp/>itr<sp/>!=<sp/>kSetAreaID.end();<sp/>++itr)</highlight></codeline>
<codeline lineno="412"><highlight class="normal"><sp/><sp/><sp/><sp/>{</highlight></codeline>
<codeline lineno="413"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>DWord<sp/>dwAreaID<sp/>=<sp/>*itr;</highlight></codeline>
<codeline lineno="414"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="struct_h_town_sign" kindref="compound">HTownSign</ref><sp/>kTownSign<sp/>=<sp/><ref refid="class_se_race_mgr_1a9dabb6c38e2b0997f05aae05078c3325" kindref="member">GetTownSignByAreaID</ref>(pkRace-&gt;<ref refid="struct_se_match_race_1a1f51c90f643641518fc163f150a11419" kindref="member">akMRacePlayer</ref>,<sp/>dwAreaID);</highlight></codeline>
<codeline lineno="415"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>akNeedSendTown.push_back(kTownSign);</highlight></codeline>
<codeline lineno="416"><highlight class="normal"><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="417"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">for</highlight><highlight class="normal"><sp/>(</highlight><highlight class="keywordtype">int</highlight><highlight class="normal"><sp/>j<sp/>=<sp/>0;<sp/>j<sp/>&lt;<sp/>(int)akNeedSendTown.size();<sp/>j++)</highlight></codeline>
<codeline lineno="418"><highlight class="normal"><sp/><sp/><sp/><sp/>{</highlight></codeline>
<codeline lineno="419"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="struct_h_town_sign" kindref="compound">HTownSign</ref>&amp;<sp/>rkTownSign<sp/>=<sp/>akNeedSendTown[j];</highlight></codeline>
<codeline lineno="420"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>HSock<sp/>kTownSock<sp/>=<sp/><ref refid="class_se_race_mgr_1a3a7dd145633602ee3b6b491eabaff87f" kindref="member">GetTownSock</ref>(rkTownSign);</highlight></codeline>
<codeline lineno="421"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(kTownSock.IsInvalid())</highlight></codeline>
<codeline lineno="422"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>{</highlight></codeline>
<codeline lineno="423"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>kTownSock<sp/>=<sp/><ref refid="_match_server_2_src_2_se_town_mgr_8cpp_1a0d99b78f6d107c2f607862b30d586175" kindref="member">g_kTownMgr</ref>.<ref refid="class_se_town_mgr_1a0840b23b1554442e1b59dd99e998d06d" kindref="member">GetTownSockByArea</ref>(rkTownSign.<ref refid="struct_h_town_sign_1ad2078fab8662517a20a8c8702861c430" kindref="member">dwAreaID</ref>);</highlight></codeline>
<codeline lineno="424"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="425"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(!kTownSock.IsInvalid())</highlight></codeline>
<codeline lineno="426"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>{</highlight></codeline>
<codeline lineno="427"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="_src_2_match_server_8cpp_1a1cd9d6d0396497f8a9d48e44d672f368" kindref="member">g_kMatchServer</ref>.<ref refid="class_match_server_1a25a32302af6c42c1d2977299004c6c1c" kindref="member">SendMT_GuanqiaEndSend</ref>(pkRaceEnd-&gt;<ref refid="struct_se_r_m___race_end_guanqia_1a57b84229ac8db1551e18453b7df2bd2a" kindref="member">dwTime</ref>,<sp/>pkRaceEnd-&gt;<ref refid="struct_se_r_m___race_end_guanqia_1a90fc6c6661157dad2c12530cf8dcecfc" kindref="member">dwMapID</ref>,<sp/>pkRaceEnd-&gt;<ref refid="struct_se_r_m___race_end_guanqia_1a28dad20a64907b89420098a2a24dc0cd" kindref="member">dwMatchSession</ref>,<sp/>pkRaceEnd-&gt;<ref refid="struct_se_r_m___race_end_guanqia_1a0b58bb5a82d60016829fe14a0add9665" kindref="member">iNum</ref>,<sp/>pkRaceEnd-&gt;<ref refid="struct_se_r_m___race_end_guanqia_1a715aee4b3c1374cad019a478613ff5da" kindref="member">akInfo</ref>,<sp/>&amp;kTownSock);</highlight></codeline>
<codeline lineno="428"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="429"><highlight class="normal"><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="430"><highlight class="normal">}</highlight></codeline>
<codeline lineno="431"><highlight class="normal"></highlight></codeline>
<codeline lineno="432"><highlight class="normal"></highlight><highlight class="keywordtype">void</highlight><highlight class="normal"><sp/><ref refid="class_se_race_mgr_1a5a38c592cc990a8049a08f87512860d5" kindref="member">SeRaceMgr::OnProcessCommRaceMsg</ref>(DWord<sp/>dwSession,<sp/><ref refid="_se_ptl_define_8h_1a6fcdce81cb421a7d62217407f549cb81" kindref="member">SeRaceSvrCommMsg</ref><sp/>eMsg,<sp/>DWord<sp/>dwParam,<sp/></highlight><highlight class="keywordtype">int</highlight><highlight class="normal"><sp/>iParam)</highlight></codeline>
<codeline lineno="433"><highlight class="normal">{</highlight></codeline>
<codeline lineno="434"><highlight class="normal"><sp/><sp/><sp/><sp/><ref refid="struct_se_match_race" kindref="compound">SeMatchRace</ref>*<sp/>pkRace<sp/>=<sp/><ref refid="class_se_race_mgr_1afc891150076c0efc650aa8989cbe9fd8" kindref="member">GetRace</ref>(dwSession);</highlight></codeline>
<codeline lineno="435"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(!pkRace)</highlight></codeline>
<codeline lineno="436"><highlight class="normal"><sp/><sp/><sp/><sp/>{</highlight></codeline>
<codeline lineno="437"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal">;</highlight></codeline>
<codeline lineno="438"><highlight class="normal"><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="439"><highlight class="normal"></highlight></codeline>
<codeline lineno="440"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(eMsg<sp/>==<sp/><ref refid="_se_ptl_define_8h_1a6fcdce81cb421a7d62217407f549cb81a73dbe5ad0e28c848fceae9f1fbaf84e7" kindref="member">SRCM_BEGIN_RACE</ref>)</highlight></codeline>
<codeline lineno="441"><highlight class="normal"><sp/><sp/><sp/><sp/>{</highlight></codeline>
<codeline lineno="442"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>pkRace-&gt;<ref refid="struct_se_match_race_1a3a9af85294d2e4f80524c28c498324b1" kindref="member">eRaceState</ref><sp/>=<sp/><ref refid="_match_server_2_src_2_se_race_mgr_def_8h_1a3f0f87c08c5c7566ba4e99c73d523f20a5a6f5fdafa8060518864fb7d117460a3" kindref="member">SMRS_RACING</ref>;</highlight></codeline>
<codeline lineno="443"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>pkRace-&gt;<ref refid="struct_se_match_race_1ac98eae2e335d69e4acbf6f7f869f8ef3" kindref="member">dwLastRecvTime</ref><sp/>=<sp/><ref refid="_src_2_match_server_8cpp_1a1cd9d6d0396497f8a9d48e44d672f368" kindref="member">g_kMatchServer</ref>.<ref refid="class_match_server_1ad3ce38db6c10f10891dbfd700cb954ca" kindref="member">GetServerTime</ref>();</highlight></codeline>
<codeline lineno="444"><highlight class="normal"></highlight></codeline>
<codeline lineno="445"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>pkRace-&gt;<ref refid="struct_se_match_race_1a2b2ba94026424d343fd55b9308b49c38" kindref="member">iRoomIndex</ref><sp/>=<sp/><ref refid="_src_2_se_race_query_mgr_8cpp_1a57ccbe85ab92907667a84b975fab68e1" kindref="member">g_kRaceQueryMgr</ref>.<ref refid="class_se_race_query_mgr_1ab862bb65fc01300ad62dd8dffb0a4bca" kindref="member">OnCreateRoom</ref>(pkRace,<sp/>pkRace-&gt;<ref refid="struct_se_match_race_1ac98eae2e335d69e4acbf6f7f869f8ef3" kindref="member">dwLastRecvTime</ref>);</highlight></codeline>
<codeline lineno="446"><highlight class="normal"><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="447"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">else</highlight><highlight class="normal"><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(eMsg<sp/>==<sp/><ref refid="_se_ptl_define_8h_1a6fcdce81cb421a7d62217407f549cb81aa2b368cfc5e5606bfe3e82af437f9331" kindref="member">SRCM_END_RACE</ref>)</highlight></codeline>
<codeline lineno="448"><highlight class="normal"><sp/><sp/><sp/><sp/>{</highlight></codeline>
<codeline lineno="449"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="class_se_race_mgr_1a555f6464f6b7113ca16fbe22555faa9f" kindref="member">DoRaceOver</ref>(pkRace);</highlight></codeline>
<codeline lineno="450"><highlight class="normal"><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="451"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">else</highlight><highlight class="normal"><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(eMsg<sp/>==<sp/><ref refid="_se_ptl_define_8h_1a6fcdce81cb421a7d62217407f549cb81a99d9f6615a988c9138c0f161aeadc3ad" kindref="member">SRCM_LEAVE_RACE</ref>)</highlight></codeline>
<codeline lineno="452"><highlight class="normal"><sp/><sp/><sp/><sp/>{</highlight></codeline>
<codeline lineno="453"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>DWord<sp/>dwPlayerID<sp/>=<sp/>dwParam;</highlight></codeline>
<codeline lineno="454"><highlight class="normal"></highlight></codeline>
<codeline lineno="455"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="struct_se_race_player" kindref="compound">SeRacePlayer</ref>*<sp/>pkPlayer<sp/>=<sp/>pkRace-&gt;<ref refid="struct_se_match_race_1a3ca2e37d06ca150904873fb695310259" kindref="member">GetRacePlayerByID</ref>(dwPlayerID);</highlight></codeline>
<codeline lineno="456"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(!pkPlayer)</highlight></codeline>
<codeline lineno="457"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>{</highlight></codeline>
<codeline lineno="458"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal">;</highlight></codeline>
<codeline lineno="459"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="460"><highlight class="normal"></highlight></codeline>
<codeline lineno="461"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>pkPlayer-&gt;<ref refid="struct_se_race_player_1ad077386dd022c176ccbc26db40615bf9" kindref="member">bLeaveRace</ref><sp/>=<sp/></highlight><highlight class="keyword">true</highlight><highlight class="normal">;</highlight></codeline>
<codeline lineno="462"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>pkPlayer-&gt;<ref refid="struct_se_race_player_1a7691bd1ec8aedc1ad18ed942231e3e4b" kindref="member">iRoomIndex</ref><sp/>=<sp/>-1;</highlight></codeline>
<codeline lineno="463"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>pkPlayer-&gt;<ref refid="struct_se_race_player_1aee76a5fe2548f6382ea8066b4da31ab3" kindref="member">dwTeamID</ref><sp/>=<sp/>0;</highlight></codeline>
<codeline lineno="464"><highlight class="normal"></highlight></codeline>
<codeline lineno="465"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>HSock<sp/>kTownSock<sp/>=<sp/><ref refid="class_se_race_mgr_1a3a7dd145633602ee3b6b491eabaff87f" kindref="member">GetTownSock</ref>(pkPlayer-&gt;<ref refid="struct_se_race_player_1ac5601dda3e2dfc69b74649cbbfe6e141" kindref="member">kTownSign</ref>);</highlight></codeline>
<codeline lineno="466"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(!kTownSock.IsInvalid())</highlight></codeline>
<codeline lineno="467"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>{</highlight></codeline>
<codeline lineno="468"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="_src_2_match_server_8cpp_1a1cd9d6d0396497f8a9d48e44d672f368" kindref="member">g_kMatchServer</ref>.<ref refid="class_match_server_1af089eef4def1791b5a230aa9c6e5ac08" kindref="member">SendMT_CommMatchMsg</ref>(pkRace-&gt;<ref refid="struct_se_match_race_1a8523887086f21641745b808f82cc1828" kindref="member">dwMatchSession</ref>,<sp/><ref refid="_se_ptl_define_8h_1a05bc9da3a865896a10de16ae1763a5baa5237aca345cc4c54216b1bce17907d9e" kindref="member">SCMM_NOTIFY_LEAVE_RACE</ref>,<sp/>dwPlayerID,<sp/>pkPlayer-&gt;<ref refid="struct_se_race_player_1a1558451c3d50c30090110db7b8d63ca4" kindref="member">iSeatIndex</ref>,<sp/>dwParam,<sp/>&amp;kTownSock);</highlight></codeline>
<codeline lineno="469"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="470"><highlight class="normal"></highlight></codeline>
<codeline lineno="471"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="_src_2_se_race_query_mgr_8cpp_1a57ccbe85ab92907667a84b975fab68e1" kindref="member">g_kRaceQueryMgr</ref>.<ref refid="class_se_race_query_mgr_1a619b9fbef8c53b61db7e3272cb157c60" kindref="member">OnRaceSeatUpdateState</ref>(pkRace-&gt;<ref refid="struct_se_match_race_1a2b2ba94026424d343fd55b9308b49c38" kindref="member">iRoomIndex</ref>,<sp/>pkPlayer-&gt;<ref refid="struct_se_race_player_1a1558451c3d50c30090110db7b8d63ca4" kindref="member">iSeatIndex</ref>,<sp/></highlight><highlight class="keyword">false</highlight><highlight class="normal">);</highlight></codeline>
<codeline lineno="472"><highlight class="normal"><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="473"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">else</highlight><highlight class="normal"><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(eMsg<sp/>==<sp/><ref refid="_se_ptl_define_8h_1a6fcdce81cb421a7d62217407f549cb81a64cea400bc69853cbcad1ebfa40afa75" kindref="member">SRCM_BREAK_RACE</ref>)</highlight></codeline>
<codeline lineno="474"><highlight class="normal"><sp/><sp/><sp/><sp/>{</highlight></codeline>
<codeline lineno="475"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="class_se_race_mgr_1aed313cc17a805bea5daeb0366013bae6" kindref="member">SendMatchCommMsg</ref>(pkRace,<sp/><ref refid="_se_ptl_define_8h_1a05bc9da3a865896a10de16ae1763a5baafa80f37a35c646f2d508599a64d0d697" kindref="member">SCMM_NOTIFY_RACE_ESCAPE</ref>,<sp/>dwParam);</highlight></codeline>
<codeline lineno="476"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="class_se_race_mgr_1a0ef051a10db4ce03c09723c3dcd5ce83" kindref="member">DelRace</ref>(dwSession);</highlight></codeline>
<codeline lineno="477"><highlight class="normal"><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="478"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">else</highlight><highlight class="normal"><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(eMsg<sp/>==<sp/><ref refid="_se_ptl_define_8h_1a6fcdce81cb421a7d62217407f549cb81a8c96df99b0de4e1cc0f1cd256ea1868f" kindref="member">SRCM_UPDATE_REVERSE</ref>)</highlight></codeline>
<codeline lineno="479"><highlight class="normal"><sp/><sp/><sp/><sp/>{</highlight></codeline>
<codeline lineno="480"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordtype">int</highlight><highlight class="normal"><sp/>iSeatIndex<sp/>=<sp/>(int)dwParam;</highlight></codeline>
<codeline lineno="481"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="_src_2_se_race_query_mgr_8cpp_1a57ccbe85ab92907667a84b975fab68e1" kindref="member">g_kRaceQueryMgr</ref>.<ref refid="class_se_race_query_mgr_1ac5961a48bb6a89907ba0411ad7b6e6a5" kindref="member">OnRaceSeatUpdateReverse</ref>(pkRace-&gt;<ref refid="struct_se_match_race_1a2b2ba94026424d343fd55b9308b49c38" kindref="member">iRoomIndex</ref>,<sp/>iSeatIndex,<sp/></highlight><highlight class="keyword">false</highlight><highlight class="normal">);</highlight></codeline>
<codeline lineno="482"><highlight class="normal"><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="483"><highlight class="normal">}</highlight></codeline>
<codeline lineno="484"><highlight class="normal"></highlight></codeline>
<codeline lineno="485"><highlight class="normal"></highlight><highlight class="keywordtype">void</highlight><highlight class="normal"><sp/><ref refid="class_se_race_mgr_1a19038a3183d29249b81dd4110db567f1" kindref="member">SeRaceMgr::OnProcessReconQuerySuccess</ref>(<ref refid="struct_se_r_m___recon_query_success" kindref="compound">SeRM_ReconQuerySuccess</ref>*<sp/>pkQuery)</highlight></codeline>
<codeline lineno="486"><highlight class="normal">{</highlight></codeline>
<codeline lineno="487"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="comment">//<sp/>fixme</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="488"><highlight class="normal"><sp/><sp/><sp/><sp/><ref refid="struct_se_match_race" kindref="compound">SeMatchRace</ref>*<sp/>pkRace<sp/>=<sp/><ref refid="class_se_race_mgr_1afc891150076c0efc650aa8989cbe9fd8" kindref="member">GetRace</ref>(pkQuery-&gt;<ref refid="struct_se_r_m___recon_query_success_1a6697b2c8d290e715caba0c94089d4b0e" kindref="member">dwRoomID</ref>);</highlight></codeline>
<codeline lineno="489"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(!pkRace)</highlight></codeline>
<codeline lineno="490"><highlight class="normal"><sp/><sp/><sp/><sp/>{</highlight></codeline>
<codeline lineno="491"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal">;</highlight></codeline>
<codeline lineno="492"><highlight class="normal"><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="493"><highlight class="normal"></highlight></codeline>
<codeline lineno="494"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keyword">const</highlight><highlight class="normal"><sp/><ref refid="struct_se_race_svr" kindref="compound">SeRaceSvr</ref>*<sp/>pkSvr<sp/>=<sp/><ref refid="_src_2_se_race_svr_mgr_8cpp_1a2d3d387da69f6fc93ec49db8bf1ee871" kindref="member">g_kRaceSvrMgr</ref>.<ref refid="class_se_race_svr_mgr_1a5cb837611a3d12df40c032445a38666a" kindref="member">GetRaceSvr</ref>(pkRace-&gt;<ref refid="struct_se_match_race_1ac5807e52b290fa9cbf27bbe2cff05e1e" kindref="member">kRaceTownSign</ref>);</highlight></codeline>
<codeline lineno="495"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(!pkSvr)</highlight></codeline>
<codeline lineno="496"><highlight class="normal"><sp/><sp/><sp/><sp/>{</highlight></codeline>
<codeline lineno="497"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal">;</highlight></codeline>
<codeline lineno="498"><highlight class="normal"><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="499"><highlight class="normal"></highlight></codeline>
<codeline lineno="500"><highlight class="normal"><sp/><sp/><sp/><sp/><ref refid="struct_h_town_sign" kindref="compound">HTownSign</ref><sp/>kTownSign(pkQuery-&gt;<ref refid="struct_se_r_m___recon_query_success_1aee429866421e757818abf3ba3110003b" kindref="member">dwAreaID</ref>,<sp/>pkQuery-&gt;<ref refid="struct_se_r_m___recon_query_success_1a3b83b45cabc8bed8eae0d4fa37e48b20" kindref="member">dwServerID</ref>);</highlight></codeline>
<codeline lineno="501"><highlight class="normal"></highlight></codeline>
<codeline lineno="502"><highlight class="normal"><sp/><sp/><sp/><sp/>HSock<sp/>kTownSock<sp/>=<sp/><ref refid="class_se_race_mgr_1a3a7dd145633602ee3b6b491eabaff87f" kindref="member">GetTownSock</ref>(kTownSign);</highlight></codeline>
<codeline lineno="503"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(!kTownSock.IsInvalid())</highlight></codeline>
<codeline lineno="504"><highlight class="normal"><sp/><sp/><sp/><sp/>{</highlight></codeline>
<codeline lineno="505"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="_src_2_match_server_8cpp_1a1cd9d6d0396497f8a9d48e44d672f368" kindref="member">g_kMatchServer</ref>.<ref refid="class_match_server_1ab0504e9a552891a7e72692321ff81964" kindref="member">SendMT_NotifyAddrToMatch</ref>(pkQuery-&gt;<ref refid="struct_se_r_m___recon_query_success_1a34593e9f9993aa3e003bd45504072fa8" kindref="member">dwPlayerID</ref>,<sp/>pkRace-&gt;<ref refid="struct_se_match_race_1a8523887086f21641745b808f82cc1828" kindref="member">dwMatchSession</ref>,</highlight></codeline>
<codeline lineno="506"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>pkSvr-&gt;<ref refid="struct_se_race_svr_1ab7a203f16140661a867aed5a3010cbba" kindref="member">kAddrToMatch</ref>,<sp/>pkSvr-&gt;<ref refid="struct_se_race_svr_1a913ff58728829f631f4d5d2c8a7def48" kindref="member">kAddrToMatchUdp</ref>,<sp/>pkRace-&gt;<ref refid="struct_se_match_race_1a30a4dd82bc1c90da9e624e34d3fdc69c" kindref="member">dwKey</ref>,<sp/><ref refid="_se_ptl_comm_define_8h_1a77f91e01c5c1d6e63aeae4848cd17d45a823d1a771c071c7d6f2b560dc758920d" kindref="member">SRVT_RECON</ref>,<sp/>pkQuery-&gt;<ref refid="struct_se_r_m___recon_query_success_1a3119570afcb0cee5d295ab51f7de1245" kindref="member">iSeat</ref>,<sp/>0,<sp/></highlight><highlight class="keyword">nullptr</highlight><highlight class="normal">,<sp/>&amp;kTownSock);</highlight></codeline>
<codeline lineno="507"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">//MATCH_SERVER.SendTown_ValidOKGetInfo(kTownSock,<sp/>pkQuery-&gt;dwPlayerID,<sp/>SRVT_VIEW);</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="508"><highlight class="normal"><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="509"><highlight class="normal">}</highlight></codeline>
<codeline lineno="510"><highlight class="normal"></highlight></codeline>
<codeline lineno="511"><highlight class="normal"></highlight><highlight class="keywordtype">void</highlight><highlight class="normal"><sp/><ref refid="class_se_race_mgr_1a41cde4726b8109dc2c4bc4d622ebc659" kindref="member">SeRaceMgr::OnProcessViewQuerySuccess</ref>(<ref refid="struct_se_r_m___view_query_success" kindref="compound">SeRM_ViewQuerySuccess</ref>*<sp/>pkQuery)</highlight></codeline>
<codeline lineno="512"><highlight class="normal">{</highlight></codeline>
<codeline lineno="513"><highlight class="normal"><sp/><sp/><sp/><sp/><ref refid="struct_se_match_race" kindref="compound">SeMatchRace</ref>*<sp/>pkRace<sp/>=<sp/><ref refid="class_se_race_mgr_1afc891150076c0efc650aa8989cbe9fd8" kindref="member">GetRace</ref>(pkQuery-&gt;<ref refid="struct_se_r_m___view_query_success_1a0ec20148398c94401de2cd8e6a8530f0" kindref="member">dwSession</ref>);</highlight></codeline>
<codeline lineno="514"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(!pkRace)</highlight></codeline>
<codeline lineno="515"><highlight class="normal"><sp/><sp/><sp/><sp/>{</highlight></codeline>
<codeline lineno="516"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal">;</highlight></codeline>
<codeline lineno="517"><highlight class="normal"><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="518"><highlight class="normal"></highlight></codeline>
<codeline lineno="519"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keyword">const</highlight><highlight class="normal"><sp/><ref refid="struct_se_race_svr" kindref="compound">SeRaceSvr</ref>*<sp/>pkSvr<sp/>=<sp/><ref refid="_src_2_se_race_svr_mgr_8cpp_1a2d3d387da69f6fc93ec49db8bf1ee871" kindref="member">g_kRaceSvrMgr</ref>.<ref refid="class_se_race_svr_mgr_1a5cb837611a3d12df40c032445a38666a" kindref="member">GetRaceSvr</ref>(pkRace-&gt;<ref refid="struct_se_match_race_1ac5807e52b290fa9cbf27bbe2cff05e1e" kindref="member">kRaceTownSign</ref>);</highlight></codeline>
<codeline lineno="520"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(!pkSvr)</highlight></codeline>
<codeline lineno="521"><highlight class="normal"><sp/><sp/><sp/><sp/>{</highlight></codeline>
<codeline lineno="522"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal">;</highlight></codeline>
<codeline lineno="523"><highlight class="normal"><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="524"><highlight class="normal"></highlight></codeline>
<codeline lineno="525"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordtype">bool</highlight><highlight class="normal"><sp/>bCanView<sp/>=<sp/></highlight><highlight class="keyword">true</highlight><highlight class="normal">;</highlight></codeline>
<codeline lineno="526"><highlight class="normal"><sp/><sp/><sp/><sp/>MWaitValidPlayer::iterator<sp/>itr<sp/>=<sp/><ref refid="class_se_race_mgr_1aef4c8f4087ebc261a26cc362d5e94279" kindref="member">m_kMWaitValidPlayer</ref>.find(pkQuery-&gt;<ref refid="struct_se_r_m___view_query_success_1a2834676e46a519a52b77dd86a9049af9" kindref="member">dwPlayerID</ref>);</highlight></codeline>
<codeline lineno="527"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(itr<sp/>!=<sp/><ref refid="class_se_race_mgr_1aef4c8f4087ebc261a26cc362d5e94279" kindref="member">m_kMWaitValidPlayer</ref>.end())</highlight></codeline>
<codeline lineno="528"><highlight class="normal"><sp/><sp/><sp/><sp/>{</highlight></codeline>
<codeline lineno="529"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>bCanView<sp/>=<sp/></highlight><highlight class="keyword">false</highlight><highlight class="normal">;</highlight></codeline>
<codeline lineno="530"><highlight class="normal"><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="531"><highlight class="normal"></highlight></codeline>
<codeline lineno="532"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(bCanView)</highlight></codeline>
<codeline lineno="533"><highlight class="normal"><sp/><sp/><sp/><sp/>{</highlight></codeline>
<codeline lineno="534"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="struct_se_wait_valid_player" kindref="compound">SeWaitValidPlayer</ref>*<sp/>pkPlayer<sp/>=<sp/>SeWaitValidPlayer::NEW();</highlight></codeline>
<codeline lineno="535"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>pkPlayer-&gt;<ref refid="struct_se_wait_valid_player_1a8b86a3dd0fb861250095d75f0f83f833" kindref="member">dwCreateTime</ref><sp/>=<sp/><ref refid="_src_2_match_server_8cpp_1a1cd9d6d0396497f8a9d48e44d672f368" kindref="member">g_kMatchServer</ref>.<ref refid="class_match_server_1ad3ce38db6c10f10891dbfd700cb954ca" kindref="member">GetServerTime</ref>();</highlight></codeline>
<codeline lineno="536"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>pkPlayer-&gt;<ref refid="struct_se_wait_valid_player_1ac35a05d7e739bc7f1f3ca2895b7a2c42" kindref="member">dwSession</ref><sp/>=<sp/>pkQuery-&gt;<ref refid="struct_se_r_m___view_query_success_1a0ec20148398c94401de2cd8e6a8530f0" kindref="member">dwSession</ref>;</highlight></codeline>
<codeline lineno="537"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>pkPlayer-&gt;<ref refid="struct_se_wait_valid_player_1a3e20f22a4504b692bfc1311e70bcb632" kindref="member">dwKey</ref><sp/>=<sp/><ref refid="class_se_race_mgr_1a14398a0223c50faa2013e5b3128c0874" kindref="member">GetEnterKey</ref>();</highlight></codeline>
<codeline lineno="538"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="struct_h_town_sign" kindref="compound">HTownSign</ref><sp/>kTownSign(pkQuery-&gt;<ref refid="struct_se_r_m___view_query_success_1a2826534d82b185001eae4a32d75f0f3a" kindref="member">dwAreaID</ref>,<sp/>pkQuery-&gt;<ref refid="struct_se_r_m___view_query_success_1a9c64afc0eccfb4212b9e4d5a47aa40d9" kindref="member">dwServerID</ref>);</highlight></codeline>
<codeline lineno="539"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>pkPlayer-&gt;<ref refid="struct_se_wait_valid_player_1a3de8a2b8d30de4612e7725212a1e7cc4" kindref="member">kTownSign</ref><sp/>=<sp/>kTownSign;</highlight></codeline>
<codeline lineno="540"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>pkPlayer-&gt;<ref refid="struct_se_wait_valid_player_1a5da815f0c8e7e7b8a7190ff9c45b02d6" kindref="member">iViewDelay</ref><sp/>=<sp/>pkQuery-&gt;<ref refid="struct_se_r_m___view_query_success_1a1dd33174e8982bdc2f72c4fe6948aabd" kindref="member">iViewDelay</ref>;</highlight></codeline>
<codeline lineno="541"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>pkPlayer-&gt;<ref refid="struct_se_wait_valid_player_1ac5172c10d2b6c0bc82d1c2ef40a4bc21" kindref="member">eValidType</ref><sp/>=<sp/><ref refid="_se_ptl_comm_define_8h_1a77f91e01c5c1d6e63aeae4848cd17d45a32121b6f4ca7f86ab06da20db0949f2b" kindref="member">SRVT_VIEW</ref>;</highlight></codeline>
<codeline lineno="542"><highlight class="normal"></highlight></codeline>
<codeline lineno="543"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="class_se_race_mgr_1aef4c8f4087ebc261a26cc362d5e94279" kindref="member">m_kMWaitValidPlayer</ref>[pkQuery-&gt;<ref refid="struct_se_r_m___view_query_success_1a2834676e46a519a52b77dd86a9049af9" kindref="member">dwPlayerID</ref>]<sp/>=<sp/>pkPlayer;</highlight></codeline>
<codeline lineno="544"><highlight class="normal"></highlight></codeline>
<codeline lineno="545"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>HSock<sp/>kTownSock<sp/>=<sp/><ref refid="class_se_race_mgr_1a3a7dd145633602ee3b6b491eabaff87f" kindref="member">GetTownSock</ref>(kTownSign);</highlight></codeline>
<codeline lineno="546"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(!kTownSock.IsInvalid())</highlight></codeline>
<codeline lineno="547"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>{</highlight></codeline>
<codeline lineno="548"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="_src_2_match_server_8cpp_1a1cd9d6d0396497f8a9d48e44d672f368" kindref="member">g_kMatchServer</ref>.<ref refid="class_match_server_1ab0504e9a552891a7e72692321ff81964" kindref="member">SendMT_NotifyAddrToMatch</ref>(pkQuery-&gt;<ref refid="struct_se_r_m___view_query_success_1a2834676e46a519a52b77dd86a9049af9" kindref="member">dwPlayerID</ref>,<sp/>pkPlayer-&gt;<ref refid="struct_se_wait_valid_player_1ac35a05d7e739bc7f1f3ca2895b7a2c42" kindref="member">dwSession</ref>,</highlight></codeline>
<codeline lineno="549"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>pkSvr-&gt;<ref refid="struct_se_race_svr_1ab7a203f16140661a867aed5a3010cbba" kindref="member">kAddrToMatch</ref>,<sp/>pkSvr-&gt;<ref refid="struct_se_race_svr_1a913ff58728829f631f4d5d2c8a7def48" kindref="member">kAddrToMatchUdp</ref>,<sp/>pkPlayer-&gt;<ref refid="struct_se_wait_valid_player_1a3e20f22a4504b692bfc1311e70bcb632" kindref="member">dwKey</ref>,<sp/><ref refid="_se_ptl_comm_define_8h_1a77f91e01c5c1d6e63aeae4848cd17d45a32121b6f4ca7f86ab06da20db0949f2b" kindref="member">SRVT_VIEW</ref>,<sp/>0,<sp/>0,<sp/></highlight><highlight class="keyword">nullptr</highlight><highlight class="normal">,<sp/>&amp;kTownSock);</highlight></codeline>
<codeline lineno="550"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">//MATCH_SERVER.SendTown_ValidOKGetInfo(kTownSock,<sp/>pkQuery-&gt;dwPlayerID,<sp/>SRVT_VIEW);</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="551"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="552"><highlight class="normal"><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="553"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">else</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="554"><highlight class="normal"><sp/><sp/><sp/><sp/>{</highlight></codeline>
<codeline lineno="555"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="struct_h_town_sign" kindref="compound">HTownSign</ref><sp/>kTownSign;</highlight></codeline>
<codeline lineno="556"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>kTownSign.<ref refid="struct_h_town_sign_1ad2078fab8662517a20a8c8702861c430" kindref="member">dwAreaID</ref><sp/>=<sp/>pkQuery-&gt;<ref refid="struct_se_r_m___view_query_success_1a2826534d82b185001eae4a32d75f0f3a" kindref="member">dwAreaID</ref>;</highlight></codeline>
<codeline lineno="557"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>kTownSign.<ref refid="struct_h_town_sign_1aad795425c3c60114ef0578356b339d2c" kindref="member">dwServerID</ref><sp/>=<sp/>pkQuery-&gt;<ref refid="struct_se_r_m___view_query_success_1a9c64afc0eccfb4212b9e4d5a47aa40d9" kindref="member">dwServerID</ref>;</highlight></codeline>
<codeline lineno="558"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>HSock<sp/>kTownSock<sp/>=<sp/><ref refid="class_se_race_mgr_1a3a7dd145633602ee3b6b491eabaff87f" kindref="member">GetTownSock</ref>(kTownSign);</highlight></codeline>
<codeline lineno="559"><highlight class="normal"></highlight></codeline>
<codeline lineno="560"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(!kTownSock.IsInvalid())</highlight></codeline>
<codeline lineno="561"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>{</highlight></codeline>
<codeline lineno="562"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="_src_2_match_server_8cpp_1a1cd9d6d0396497f8a9d48e44d672f368" kindref="member">g_kMatchServer</ref>.<ref refid="class_match_server_1af54a983650e22174641d85a930c6ba3a" kindref="member">SendMT_ViewQueryFail</ref>(<ref refid="_se_ptl_comm_define_8h_1a099f96303c4987784812a08a343a5878a231f4a1f65c94dae67926d7e6376f126" kindref="member">SVQF_COMMON</ref>,<sp/>pkQuery-&gt;<ref refid="struct_se_r_m___view_query_success_1a2826534d82b185001eae4a32d75f0f3a" kindref="member">dwAreaID</ref>,<sp/>pkQuery-&gt;<ref refid="struct_se_r_m___view_query_success_1a9c64afc0eccfb4212b9e4d5a47aa40d9" kindref="member">dwServerID</ref>,<sp/>pkQuery-&gt;<ref refid="struct_se_r_m___view_query_success_1a2834676e46a519a52b77dd86a9049af9" kindref="member">dwPlayerID</ref>,<sp/>&amp;kTownSock);</highlight></codeline>
<codeline lineno="563"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="564"><highlight class="normal"><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="565"><highlight class="normal">}</highlight></codeline>
<codeline lineno="566"><highlight class="normal"></highlight></codeline>
<codeline lineno="567"><highlight class="normal"></highlight><highlight class="keywordtype">void</highlight><highlight class="normal"><sp/><ref refid="class_se_race_mgr_1acf3cbf4e4445c515d1c82f342245447c" kindref="member">SeRaceMgr::OnProcessReconViewValid</ref>(<ref refid="struct_se_r_m___recon_view_valid" kindref="compound">SeRM_ReconViewValid</ref>*<sp/>pkValid)</highlight></codeline>
<codeline lineno="568"><highlight class="normal">{</highlight></codeline>
<codeline lineno="569"><highlight class="normal"><sp/><sp/><sp/><sp/><ref refid="struct_se_match_race" kindref="compound">SeMatchRace</ref>*<sp/>pkRace<sp/>=<sp/><ref refid="class_se_race_mgr_1afc891150076c0efc650aa8989cbe9fd8" kindref="member">GetRace</ref>(pkValid-&gt;<ref refid="struct_se_r_m___recon_view_valid_1a78d155d1bb73d5821cbab26695a05944" kindref="member">dwSession</ref>);</highlight></codeline>
<codeline lineno="570"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(!pkRace)</highlight></codeline>
<codeline lineno="571"><highlight class="normal"><sp/><sp/><sp/><sp/>{</highlight></codeline>
<codeline lineno="572"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal">;</highlight></codeline>
<codeline lineno="573"><highlight class="normal"><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="574"><highlight class="normal"></highlight></codeline>
<codeline lineno="575"><highlight class="normal"><sp/><sp/><sp/><sp/>HSock<sp/>kRaceSock<sp/>=<sp/><ref refid="class_se_race_mgr_1a220a9a7426ccd94670119a48ab0cb56c" kindref="member">GetRaceSvrSock</ref>(pkRace-&gt;<ref refid="struct_se_match_race_1ac5807e52b290fa9cbf27bbe2cff05e1e" kindref="member">kRaceTownSign</ref>);</highlight></codeline>
<codeline lineno="576"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(kRaceSock.IsInvalid())</highlight></codeline>
<codeline lineno="577"><highlight class="normal"><sp/><sp/><sp/><sp/>{</highlight></codeline>
<codeline lineno="578"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal">;</highlight></codeline>
<codeline lineno="579"><highlight class="normal"><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="580"><highlight class="normal"></highlight></codeline>
<codeline lineno="581"><highlight class="normal"><sp/><sp/><sp/><sp/>MWaitValidPlayer::iterator<sp/>itr<sp/>=<sp/><ref refid="class_se_race_mgr_1aef4c8f4087ebc261a26cc362d5e94279" kindref="member">m_kMWaitValidPlayer</ref>.find(pkValid-&gt;<ref refid="struct_se_r_m___recon_view_valid_1a5ddf4354562e37d71a6eb7cee096accf" kindref="member">dwPlayerID</ref>);</highlight></codeline>
<codeline lineno="582"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(itr<sp/>==<sp/><ref refid="class_se_race_mgr_1aef4c8f4087ebc261a26cc362d5e94279" kindref="member">m_kMWaitValidPlayer</ref>.end())</highlight></codeline>
<codeline lineno="583"><highlight class="normal"><sp/><sp/><sp/><sp/>{</highlight></codeline>
<codeline lineno="584"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="_src_2_match_server_8cpp_1a1cd9d6d0396497f8a9d48e44d672f368" kindref="member">g_kMatchServer</ref>.<ref refid="class_match_server_1a928d9d0666bdeebd41fecd757f4f97da" kindref="member">SendMR_ValidFailRet</ref>(pkValid-&gt;<ref refid="struct_se_r_m___recon_view_valid_1a78d155d1bb73d5821cbab26695a05944" kindref="member">dwSession</ref>,<sp/>pkValid-&gt;<ref refid="struct_se_r_m___recon_view_valid_1a5ddf4354562e37d71a6eb7cee096accf" kindref="member">dwPlayerID</ref>,<sp/>&amp;kRaceSock);</highlight></codeline>
<codeline lineno="585"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal">;</highlight></codeline>
<codeline lineno="586"><highlight class="normal"><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="587"><highlight class="normal"></highlight></codeline>
<codeline lineno="588"><highlight class="normal"><sp/><sp/><sp/><sp/><ref refid="struct_se_wait_valid_player" kindref="compound">SeWaitValidPlayer</ref>*<sp/>pkPlayer<sp/>=<sp/>itr-&gt;second;</highlight></codeline>
<codeline lineno="589"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(pkValid-&gt;<ref refid="struct_se_r_m___recon_view_valid_1a91e920fd28f109b5193e8fb5b6647838" kindref="member">dwKey</ref><sp/>!=<sp/>pkPlayer-&gt;<ref refid="struct_se_wait_valid_player_1a3e20f22a4504b692bfc1311e70bcb632" kindref="member">dwKey</ref>)</highlight></codeline>
<codeline lineno="590"><highlight class="normal"><sp/><sp/><sp/><sp/>{</highlight></codeline>
<codeline lineno="591"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="_src_2_match_server_8cpp_1a1cd9d6d0396497f8a9d48e44d672f368" kindref="member">g_kMatchServer</ref>.<ref refid="class_match_server_1a928d9d0666bdeebd41fecd757f4f97da" kindref="member">SendMR_ValidFailRet</ref>(pkValid-&gt;<ref refid="struct_se_r_m___recon_view_valid_1a78d155d1bb73d5821cbab26695a05944" kindref="member">dwSession</ref>,<sp/>pkValid-&gt;<ref refid="struct_se_r_m___recon_view_valid_1a5ddf4354562e37d71a6eb7cee096accf" kindref="member">dwPlayerID</ref>,<sp/>&amp;kRaceSock);</highlight></codeline>
<codeline lineno="592"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal">;</highlight></codeline>
<codeline lineno="593"><highlight class="normal"><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="594"><highlight class="normal"></highlight></codeline>
<codeline lineno="595"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(pkValid-&gt;<ref refid="struct_se_r_m___recon_view_valid_1a66e3e786daa04f7a5d8360747fbd1a59" kindref="member">eValidType</ref><sp/>==<sp/><ref refid="_se_ptl_comm_define_8h_1a77f91e01c5c1d6e63aeae4848cd17d45a823d1a771c071c7d6f2b560dc758920d" kindref="member">SRVT_RECON</ref>)</highlight></codeline>
<codeline lineno="596"><highlight class="normal"><sp/><sp/><sp/><sp/>{</highlight></codeline>
<codeline lineno="597"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">//MATCH_SERVER.SendRaceSvr_ReconValidOKRet(kRaceSock,<sp/>pkValid-&gt;dwPlayerID,<sp/>pkPlayer);</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="598"><highlight class="normal"><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="599"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">else</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="600"><highlight class="normal"><sp/><sp/><sp/><sp/>{</highlight></codeline>
<codeline lineno="601"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="struct_se_view_init_info" kindref="compound">SeViewInitInfo</ref><sp/>kInitInfo;</highlight></codeline>
<codeline lineno="602"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>kInitInfo.<ref refid="struct_se_view_init_info_1a1f83aceed2c5cc38c6ab77b10d38a5e4" kindref="member">dwPlayerID</ref><sp/>=<sp/>pkValid-&gt;<ref refid="struct_se_r_m___recon_view_valid_1a5ddf4354562e37d71a6eb7cee096accf" kindref="member">dwPlayerID</ref>;</highlight></codeline>
<codeline lineno="603"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>kInitInfo.<ref refid="struct_se_view_init_info_1a3c6e6cc0f84c3deac54c9b814ab8ab00" kindref="member">dwAreaID</ref><sp/>=<sp/>pkPlayer-&gt;<ref refid="struct_se_wait_valid_player_1a3de8a2b8d30de4612e7725212a1e7cc4" kindref="member">kTownSign</ref>.<ref refid="struct_h_town_sign_1ad2078fab8662517a20a8c8702861c430" kindref="member">dwAreaID</ref>;</highlight></codeline>
<codeline lineno="604"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>kInitInfo.<ref refid="struct_se_view_init_info_1a3bf9846b53738d125685d50f57c0f2bc" kindref="member">dwServerID</ref><sp/>=<sp/>pkPlayer-&gt;<ref refid="struct_se_wait_valid_player_1a3de8a2b8d30de4612e7725212a1e7cc4" kindref="member">kTownSign</ref>.<ref refid="struct_h_town_sign_1aad795425c3c60114ef0578356b339d2c" kindref="member">dwServerID</ref>;</highlight></codeline>
<codeline lineno="605"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>kInitInfo.<ref refid="struct_se_view_init_info_1abc506badc95813f53612c233a2229e8e" kindref="member">iViewDelay</ref><sp/>=<sp/>pkPlayer-&gt;<ref refid="struct_se_wait_valid_player_1a5da815f0c8e7e7b8a7190ff9c45b02d6" kindref="member">iViewDelay</ref>;</highlight></codeline>
<codeline lineno="606"><highlight class="normal"></highlight></codeline>
<codeline lineno="607"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="_src_2_match_server_8cpp_1a1cd9d6d0396497f8a9d48e44d672f368" kindref="member">g_kMatchServer</ref>.<ref refid="class_match_server_1aa245fdc9ca49595a82a826bf95b06ae3" kindref="member">SendMR_ViewValidOKRet</ref>(pkValid-&gt;<ref refid="struct_se_r_m___recon_view_valid_1a78d155d1bb73d5821cbab26695a05944" kindref="member">dwSession</ref>,<sp/>kInitInfo,<sp/>&amp;kRaceSock);</highlight></codeline>
<codeline lineno="608"><highlight class="normal"><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="609"><highlight class="normal">}</highlight></codeline>
<codeline lineno="610"><highlight class="normal"></highlight></codeline>
<codeline lineno="611"><highlight class="normal"></highlight><highlight class="keywordtype">void</highlight><highlight class="normal"><sp/><ref refid="class_se_race_mgr_1a81d87e41081d3d73d69f6ca9c04301e7" kindref="member">SeRaceMgr::OnProcessReloadRoomList</ref>(<ref refid="struct_h_town_sign" kindref="compound">HTownSign</ref><sp/>kRaceSign,<sp/></highlight><highlight class="keywordtype">int</highlight><highlight class="normal"><sp/>iNum,<sp/><ref refid="struct_se_re_load_room_info" kindref="compound">SeReLoadRoomInfo</ref>*<sp/>pkRoomInfo)</highlight></codeline>
<codeline lineno="612"><highlight class="normal">{</highlight></codeline>
<codeline lineno="613"><highlight class="normal"><sp/><sp/><sp/><sp/>DWord<sp/>dwMaxSession<sp/>=<sp/><ref refid="class_se_race_mgr_1a76dcbd2c0436dd8172ddb326b4a1f2a1" kindref="member">GetSession</ref>();</highlight></codeline>
<codeline lineno="614"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">for</highlight><highlight class="normal"><sp/>(</highlight><highlight class="keywordtype">int</highlight><highlight class="normal"><sp/>i<sp/>=<sp/>0;<sp/>i<sp/>&lt;<sp/>iNum;<sp/>i++)</highlight></codeline>
<codeline lineno="615"><highlight class="normal"><sp/><sp/><sp/><sp/>{</highlight></codeline>
<codeline lineno="616"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>DWord<sp/>dwRaceSession<sp/>=<sp/>pkRoomInfo[i].<ref refid="struct_se_re_load_room_info_1afd27ebaff606eccb5d4dc9815080e7f2" kindref="member">dwSession</ref>;</highlight></codeline>
<codeline lineno="617"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(<ref refid="class_se_race_mgr_1acde9baec1a0425067a7f2376b52a87e2" kindref="member">IsSessionExist</ref>(dwRaceSession))</highlight></codeline>
<codeline lineno="618"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>{</highlight></codeline>
<codeline lineno="619"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">continue</highlight><highlight class="normal">;</highlight></codeline>
<codeline lineno="620"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="621"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(dwRaceSession<sp/>&gt;<sp/>dwMaxSession)</highlight></codeline>
<codeline lineno="622"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>{</highlight></codeline>
<codeline lineno="623"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>dwMaxSession<sp/>=<sp/>dwRaceSession;</highlight></codeline>
<codeline lineno="624"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="625"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="struct_se_match_race" kindref="compound">SeMatchRace</ref>*<sp/>pkRace<sp/>=<sp/>SeMatchRace::NEW();</highlight></codeline>
<codeline lineno="626"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>pkRace-&gt;<ref refid="struct_se_match_race_1ac5807e52b290fa9cbf27bbe2cff05e1e" kindref="member">kRaceTownSign</ref><sp/>=<sp/>kRaceSign;</highlight></codeline>
<codeline lineno="627"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>pkRace-&gt;<ref refid="struct_se_match_race_1a8523887086f21641745b808f82cc1828" kindref="member">dwMatchSession</ref><sp/>=<sp/>dwRaceSession;</highlight></codeline>
<codeline lineno="628"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>pkRace-&gt;<ref refid="struct_se_match_race_1ac98eae2e335d69e4acbf6f7f869f8ef3" kindref="member">dwLastRecvTime</ref><sp/>=<sp/><ref refid="_src_2_match_server_8cpp_1a1cd9d6d0396497f8a9d48e44d672f368" kindref="member">g_kMatchServer</ref>.<ref refid="class_match_server_1ad3ce38db6c10f10891dbfd700cb954ca" kindref="member">GetServerTime</ref>();</highlight></codeline>
<codeline lineno="629"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(pkRoomInfo[i].bRacing)</highlight></codeline>
<codeline lineno="630"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>{</highlight></codeline>
<codeline lineno="631"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>pkRace-&gt;<ref refid="struct_se_match_race_1a3a9af85294d2e4f80524c28c498324b1" kindref="member">eRaceState</ref><sp/>=<sp/><ref refid="_match_server_2_src_2_se_race_mgr_def_8h_1a3f0f87c08c5c7566ba4e99c73d523f20a5a6f5fdafa8060518864fb7d117460a3" kindref="member">SMRS_RACING</ref>;</highlight></codeline>
<codeline lineno="632"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="633"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">else</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="634"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>{</highlight></codeline>
<codeline lineno="635"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>pkRace-&gt;<ref refid="struct_se_match_race_1a3a9af85294d2e4f80524c28c498324b1" kindref="member">eRaceState</ref><sp/>=<sp/><ref refid="_match_server_2_src_2_se_race_mgr_def_8h_1a3f0f87c08c5c7566ba4e99c73d523f20ae3d9982b64c7a66198cd9ab4087da446" kindref="member">SMRS_SEL_HERO</ref>;</highlight></codeline>
<codeline lineno="636"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="637"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>pkRace-&gt;<ref refid="struct_se_match_race_1a5c7ab2cd8f14bbfa4bfd87f2bbb624f9" kindref="member">dwMapID</ref><sp/>=<sp/>pkRoomInfo[i].<ref refid="struct_se_re_load_room_info_1a8153ca17838489c814de750512adac56" kindref="member">dwMapID</ref>;</highlight></codeline>
<codeline lineno="638"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">//pkRace-&gt;bIsSvrRace<sp/>=<sp/>pkRoomInfo[i].bIsSvrRace;</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="639"><highlight class="normal"></highlight></codeline>
<codeline lineno="640"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="_match_server_2_src_2_se_race_mgr_def_8h_1ab101f4de5df82aa4152f3bb13da3b518" kindref="member">MRacePlayer</ref>&amp;<sp/>rkMRacePlayer<sp/>=<sp/>pkRace-&gt;<ref refid="struct_se_match_race_1a1f51c90f643641518fc163f150a11419" kindref="member">akMRacePlayer</ref>;</highlight></codeline>
<codeline lineno="641"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">for</highlight><highlight class="normal"><sp/>(</highlight><highlight class="keywordtype">int</highlight><highlight class="normal"><sp/>j<sp/>=<sp/>0;<sp/>j<sp/>&lt;<sp/><ref refid="_se_ptl_comm_define_8h_1af62c3a00672953c86a2586d53c60663aa4d18e8e3cf1c5fba177f688bde4f0738" kindref="member">SSD_MAX_ROOM_PLAYER</ref>;<sp/>j++)</highlight></codeline>
<codeline lineno="642"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>{</highlight></codeline>
<codeline lineno="643"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="struct_se_race_player" kindref="compound">SeRacePlayer</ref><sp/>kRacePlayer;</highlight></codeline>
<codeline lineno="644"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="struct_se_re_load_player_info" kindref="compound">SeReLoadPlayerInfo</ref>&amp;<sp/>rkReLoadPlayerInfo<sp/>=<sp/>pkRoomInfo[i].<ref refid="struct_se_re_load_room_info_1a836194b3ca4247e04b080f1d6e753a6d" kindref="member">akPlayerInfo</ref>[j];</highlight></codeline>
<codeline lineno="645"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(rkReLoadPlayerInfo.<ref refid="struct_se_re_load_player_info_1a12e0c6a5b5c44be6b36361c2c44c1438" kindref="member">dwPlayerID</ref><sp/>&gt;<sp/>0)</highlight></codeline>
<codeline lineno="646"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>{</highlight></codeline>
<codeline lineno="647"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>kRacePlayer.<ref refid="struct_se_race_player_1a1562e06b4a18a384dc8b152668a9c62f" kindref="member">dwPlayerID</ref><sp/>=<sp/>rkReLoadPlayerInfo.<ref refid="struct_se_re_load_player_info_1a12e0c6a5b5c44be6b36361c2c44c1438" kindref="member">dwPlayerID</ref>;</highlight></codeline>
<codeline lineno="648"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>kRacePlayer.<ref refid="struct_se_race_player_1ac5601dda3e2dfc69b74649cbbfe6e141" kindref="member">kTownSign</ref>.<ref refid="struct_h_town_sign_1ad2078fab8662517a20a8c8702861c430" kindref="member">dwAreaID</ref><sp/>=<sp/>rkReLoadPlayerInfo.<ref refid="struct_se_re_load_player_info_1ad6cd2cfae7d66fa78426774cd83082b0" kindref="member">dwAreaID</ref>;</highlight></codeline>
<codeline lineno="649"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>kRacePlayer.<ref refid="struct_se_race_player_1ac5601dda3e2dfc69b74649cbbfe6e141" kindref="member">kTownSign</ref>.<ref refid="struct_h_town_sign_1aad795425c3c60114ef0578356b339d2c" kindref="member">dwServerID</ref><sp/>=<sp/>rkReLoadPlayerInfo.<ref refid="struct_se_re_load_player_info_1a78fe45769826052b93cb782e578cb954" kindref="member">dwServerID</ref>;</highlight></codeline>
<codeline lineno="650"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>kRacePlayer.<ref refid="struct_se_race_player_1ad9851bb0940139ae58a6b6ff561bed43" kindref="member">eCamp</ref><sp/>=<sp/>rkReLoadPlayerInfo.<ref refid="struct_se_re_load_player_info_1ad537eee944298b396ad23c891da0f933" kindref="member">eCamp</ref>;</highlight></codeline>
<codeline lineno="651"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>kRacePlayer.<ref refid="struct_se_race_player_1a1558451c3d50c30090110db7b8d63ca4" kindref="member">iSeatIndex</ref><sp/>=<sp/>rkReLoadPlayerInfo.<ref refid="struct_se_re_load_player_info_1a87f5db3ba86b4e66e2d6bd328038f896" kindref="member">iSeatIndex</ref>;</highlight></codeline>
<codeline lineno="652"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>kRacePlayer.<ref refid="struct_se_race_player_1a7691bd1ec8aedc1ad18ed942231e3e4b" kindref="member">iRoomIndex</ref><sp/>=<sp/>rkReLoadPlayerInfo.<ref refid="struct_se_re_load_player_info_1ad123014c1515f9abf1dc716d2d0c693d" kindref="member">iTownRoomIndex</ref>;</highlight></codeline>
<codeline lineno="653"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>kRacePlayer.<ref refid="struct_se_race_player_1ad077386dd022c176ccbc26db40615bf9" kindref="member">bLeaveRace</ref><sp/>=<sp/>rkReLoadPlayerInfo.<ref refid="struct_se_re_load_player_info_1ac63634bb0d9a9b8497e8c041b0c360be" kindref="member">bLeaveRace</ref>;</highlight></codeline>
<codeline lineno="654"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>kRacePlayer.<ref refid="struct_se_race_player_1afc254a2c9ef3b204162b644e0892aafb" kindref="member">bOwner</ref><sp/>=<sp/></highlight><highlight class="keyword">true</highlight><highlight class="normal">;</highlight></codeline>
<codeline lineno="655"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>rkMRacePlayer[kRacePlayer.<ref refid="struct_se_race_player_1a1562e06b4a18a384dc8b152668a9c62f" kindref="member">dwPlayerID</ref>]<sp/>=<sp/>kRacePlayer;</highlight></codeline>
<codeline lineno="656"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="657"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="658"><highlight class="normal"></highlight></codeline>
<codeline lineno="659"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(pkRace-&gt;<ref refid="struct_se_match_race_1a3a9af85294d2e4f80524c28c498324b1" kindref="member">eRaceState</ref><sp/>==<sp/><ref refid="_match_server_2_src_2_se_race_mgr_def_8h_1a3f0f87c08c5c7566ba4e99c73d523f20a5a6f5fdafa8060518864fb7d117460a3" kindref="member">SMRS_RACING</ref>)</highlight></codeline>
<codeline lineno="660"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>{</highlight></codeline>
<codeline lineno="661"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>DWord<sp/>dwRaceBeginTime<sp/>=<sp/><ref refid="_src_2_match_server_8cpp_1a1cd9d6d0396497f8a9d48e44d672f368" kindref="member">g_kMatchServer</ref>.<ref refid="class_match_server_1ad3ce38db6c10f10891dbfd700cb954ca" kindref="member">GetServerTime</ref>()<sp/>-<sp/>pkRoomInfo[i].<ref refid="struct_se_re_load_room_info_1a5b5f5385b62581eab6ba208252138652" kindref="member">dwRaceBeginTime</ref>;</highlight></codeline>
<codeline lineno="662"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>pkRace-&gt;<ref refid="struct_se_match_race_1a2b2ba94026424d343fd55b9308b49c38" kindref="member">iRoomIndex</ref><sp/>=<sp/><ref refid="_src_2_se_race_query_mgr_8cpp_1a57ccbe85ab92907667a84b975fab68e1" kindref="member">g_kRaceQueryMgr</ref>.<ref refid="class_se_race_query_mgr_1ab862bb65fc01300ad62dd8dffb0a4bca" kindref="member">OnCreateRoom</ref>(pkRace,<sp/>dwRaceBeginTime);</highlight></codeline>
<codeline lineno="663"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="_src_2_se_race_query_mgr_8cpp_1a57ccbe85ab92907667a84b975fab68e1" kindref="member">g_kRaceQueryMgr</ref>.<ref refid="class_se_race_query_mgr_1a65ecdc877600d45b47726af680c570bf" kindref="member">OnReloadPlayerInfo</ref>(pkRace-&gt;<ref refid="struct_se_match_race_1a2b2ba94026424d343fd55b9308b49c38" kindref="member">iRoomIndex</ref>,<sp/>SSD_MAX_ROOM_PLAYER,<sp/>pkRoomInfo[i].<ref refid="struct_se_re_load_room_info_1a836194b3ca4247e04b080f1d6e753a6d" kindref="member">akPlayerInfo</ref>);</highlight></codeline>
<codeline lineno="664"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="665"><highlight class="normal"></highlight></codeline>
<codeline lineno="666"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="class_se_race_mgr_1ad346a0191bf14a69de9422c1fd03b301" kindref="member">m_kMRace</ref>[dwRaceSession]<sp/>=<sp/>pkRace;</highlight></codeline>
<codeline lineno="667"><highlight class="normal"><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="668"><highlight class="normal"></highlight></codeline>
<codeline lineno="669"><highlight class="normal"><sp/><sp/><sp/><sp/><ref refid="class_se_race_mgr_1a4849cd078753c28044be5fe511fca562" kindref="member">ResetSession</ref>(dwMaxSession);</highlight></codeline>
<codeline lineno="670"><highlight class="normal">}</highlight></codeline>
<codeline lineno="671"><highlight class="normal"></highlight></codeline>
<codeline lineno="672"><highlight class="normal"></highlight><highlight class="keywordtype">void</highlight><highlight class="normal"><sp/><ref refid="class_se_race_mgr_1a9f0dc9d2ca549de472fe4ca915ad1642" kindref="member">SeRaceMgr::OnProcessMatchRaceLoad</ref>(<ref refid="struct_se_r_m___match_race_load" kindref="compound">SeRM_MatchRaceLoad</ref>*<sp/>pkLoad)</highlight></codeline>
<codeline lineno="673"><highlight class="normal">{</highlight></codeline>
<codeline lineno="674"><highlight class="normal"><sp/><sp/><sp/><sp/><ref refid="struct_se_match_race" kindref="compound">SeMatchRace</ref>*<sp/>pkRace<sp/>=<sp/><ref refid="class_se_race_mgr_1afc891150076c0efc650aa8989cbe9fd8" kindref="member">GetRace</ref>(pkLoad-&gt;<ref refid="struct_se_r_m___match_race_load_1acf95a11e6dc67008462356b5c84f83ca" kindref="member">dwRoomSession</ref>);</highlight></codeline>
<codeline lineno="675"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(!pkRace)</highlight></codeline>
<codeline lineno="676"><highlight class="normal"><sp/><sp/><sp/><sp/>{</highlight></codeline>
<codeline lineno="677"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal">;</highlight></codeline>
<codeline lineno="678"><highlight class="normal"><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="679"><highlight class="normal"></highlight></codeline>
<codeline lineno="680"><highlight class="normal"><sp/><sp/><sp/><sp/><ref refid="_match_server_2_src_2_se_race_mgr_def_8h_1ab101f4de5df82aa4152f3bb13da3b518" kindref="member">MRacePlayer</ref>&amp;<sp/>rkMRacePlayer<sp/>=<sp/>pkRace-&gt;<ref refid="struct_se_match_race_1a1f51c90f643641518fc163f150a11419" kindref="member">akMRacePlayer</ref>;</highlight></codeline>
<codeline lineno="681"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">for</highlight><highlight class="normal"><sp/>(MRacePlayer::iterator<sp/>itr<sp/>=<sp/>rkMRacePlayer.begin();<sp/>itr<sp/>!=<sp/>rkMRacePlayer.end();<sp/>++itr)</highlight></codeline>
<codeline lineno="682"><highlight class="normal"><sp/><sp/><sp/><sp/>{</highlight></codeline>
<codeline lineno="683"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="struct_se_race_player" kindref="compound">SeRacePlayer</ref>&amp;<sp/>rkPlayer<sp/>=<sp/>itr-&gt;second;</highlight></codeline>
<codeline lineno="684"><highlight class="normal"></highlight></codeline>
<codeline lineno="685"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>HSock<sp/>kTownSock<sp/>=<sp/><ref refid="class_se_race_mgr_1a3a7dd145633602ee3b6b491eabaff87f" kindref="member">GetTownSock</ref>(rkPlayer.<ref refid="struct_se_race_player_1ac5601dda3e2dfc69b74649cbbfe6e141" kindref="member">kTownSign</ref>);</highlight></codeline>
<codeline lineno="686"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(kTownSock.IsInvalid())</highlight></codeline>
<codeline lineno="687"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>{</highlight></codeline>
<codeline lineno="688"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>kTownSock<sp/>=<sp/><ref refid="_match_server_2_src_2_se_town_mgr_8cpp_1a0d99b78f6d107c2f607862b30d586175" kindref="member">g_kTownMgr</ref>.<ref refid="class_se_town_mgr_1a0840b23b1554442e1b59dd99e998d06d" kindref="member">GetTownSockByArea</ref>(rkPlayer.<ref refid="struct_se_race_player_1ac5601dda3e2dfc69b74649cbbfe6e141" kindref="member">kTownSign</ref>.<ref refid="struct_h_town_sign_1ad2078fab8662517a20a8c8702861c430" kindref="member">dwAreaID</ref>);</highlight></codeline>
<codeline lineno="689"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="690"><highlight class="normal"></highlight></codeline>
<codeline lineno="691"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(!kTownSock.IsInvalid())</highlight></codeline>
<codeline lineno="692"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>{</highlight></codeline>
<codeline lineno="693"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="_src_2_match_server_8cpp_1a1cd9d6d0396497f8a9d48e44d672f368" kindref="member">g_kMatchServer</ref>.<ref refid="class_match_server_1a444a390ae55685333edd4f6e7f77cead" kindref="member">SendMT_MatchRaceLoad</ref>(pkLoad-&gt;<ref refid="struct_se_r_m___match_race_load_1acf95a11e6dc67008462356b5c84f83ca" kindref="member">dwRoomSession</ref>,<sp/>rkPlayer.<ref refid="struct_se_race_player_1a1562e06b4a18a384dc8b152668a9c62f" kindref="member">dwPlayerID</ref>,<sp/>pkLoad-&gt;<ref refid="struct_se_r_m___match_race_load_1af4ca3e3f347b8a0688f617a7bc02da2f" kindref="member">dwMapID</ref>,<sp/>&amp;kTownSock);</highlight></codeline>
<codeline lineno="694"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="695"><highlight class="normal"><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="696"><highlight class="normal">}</highlight></codeline>
<codeline lineno="697"><highlight class="normal"></highlight></codeline>
<codeline lineno="698"><highlight class="normal"></highlight><highlight class="keywordtype">bool</highlight><highlight class="normal"><sp/><ref refid="class_se_race_mgr_1ab70d7cfd8f3f04643db17117e842c4cd" kindref="member">SeRaceMgr::OnProcessRaceBuy</ref>(<ref refid="struct_se_r_m___race_buy" kindref="compound">SeRM_RaceBuy</ref>*<sp/>pkBuy)</highlight></codeline>
<codeline lineno="699"><highlight class="normal">{</highlight></codeline>
<codeline lineno="700"><highlight class="normal"><sp/><sp/><sp/><sp/><ref refid="struct_se_match_race" kindref="compound">SeMatchRace</ref>*<sp/>pkRace<sp/>=<sp/><ref refid="class_se_race_mgr_1afc891150076c0efc650aa8989cbe9fd8" kindref="member">GetRace</ref>(pkBuy-&gt;<ref refid="struct_se_r_m___race_buy_1ac4c41ea6b89399533f3ee3920c845738" kindref="member">dwSession</ref>);</highlight></codeline>
<codeline lineno="701"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(!pkRace)</highlight></codeline>
<codeline lineno="702"><highlight class="normal"><sp/><sp/><sp/><sp/>{</highlight></codeline>
<codeline lineno="703"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/></highlight><highlight class="keyword">false</highlight><highlight class="normal">;</highlight></codeline>
<codeline lineno="704"><highlight class="normal"><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="705"><highlight class="normal"></highlight></codeline>
<codeline lineno="706"><highlight class="normal"><sp/><sp/><sp/><sp/><ref refid="struct_se_race_player" kindref="compound">SeRacePlayer</ref>*<sp/>pkPlayer<sp/>=<sp/>pkRace-&gt;<ref refid="struct_se_match_race_1a3ca2e37d06ca150904873fb695310259" kindref="member">GetRacePlayerByID</ref>(pkBuy-&gt;<ref refid="struct_se_r_m___race_buy_1a8d8cd22a8dcf0ab4ef5d9dec302caab5" kindref="member">dwPlayerID</ref>);</highlight></codeline>
<codeline lineno="707"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(!pkPlayer)</highlight></codeline>
<codeline lineno="708"><highlight class="normal"><sp/><sp/><sp/><sp/>{</highlight></codeline>
<codeline lineno="709"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/></highlight><highlight class="keyword">false</highlight><highlight class="normal">;</highlight></codeline>
<codeline lineno="710"><highlight class="normal"><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="711"><highlight class="normal"></highlight></codeline>
<codeline lineno="712"><highlight class="normal"><sp/><sp/><sp/><sp/>HSock<sp/>kTownSock<sp/>=<sp/><ref refid="class_se_race_mgr_1a3a7dd145633602ee3b6b491eabaff87f" kindref="member">GetTownSock</ref>(pkPlayer-&gt;<ref refid="struct_se_race_player_1ac5601dda3e2dfc69b74649cbbfe6e141" kindref="member">kTownSign</ref>);</highlight></codeline>
<codeline lineno="713"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(kTownSock.IsInvalid())</highlight></codeline>
<codeline lineno="714"><highlight class="normal"><sp/><sp/><sp/><sp/>{</highlight></codeline>
<codeline lineno="715"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>kTownSock<sp/>=<sp/><ref refid="_match_server_2_src_2_se_town_mgr_8cpp_1a0d99b78f6d107c2f607862b30d586175" kindref="member">g_kTownMgr</ref>.<ref refid="class_se_town_mgr_1a0840b23b1554442e1b59dd99e998d06d" kindref="member">GetTownSockByArea</ref>(pkPlayer-&gt;<ref refid="struct_se_race_player_1ac5601dda3e2dfc69b74649cbbfe6e141" kindref="member">kTownSign</ref>.<ref refid="struct_h_town_sign_1ad2078fab8662517a20a8c8702861c430" kindref="member">dwAreaID</ref>);</highlight></codeline>
<codeline lineno="716"><highlight class="normal"><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="717"><highlight class="normal"></highlight></codeline>
<codeline lineno="718"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(kTownSock.IsInvalid())</highlight></codeline>
<codeline lineno="719"><highlight class="normal"><sp/><sp/><sp/><sp/>{</highlight></codeline>
<codeline lineno="720"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/></highlight><highlight class="keyword">false</highlight><highlight class="normal">;</highlight></codeline>
<codeline lineno="721"><highlight class="normal"><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="722"><highlight class="normal"></highlight></codeline>
<codeline lineno="723"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/><ref refid="_src_2_match_server_8cpp_1a1cd9d6d0396497f8a9d48e44d672f368" kindref="member">g_kMatchServer</ref>.<ref refid="class_match_server_1a1bd4ffa39210acd94edac70b28f1621c" kindref="member">SendMT_RaceBuy</ref>(pkBuy-&gt;<ref refid="struct_se_r_m___race_buy_1ac4c41ea6b89399533f3ee3920c845738" kindref="member">dwSession</ref>,<sp/>pkPlayer-&gt;<ref refid="struct_se_race_player_1a1562e06b4a18a384dc8b152668a9c62f" kindref="member">dwPlayerID</ref>,<sp/>pkBuy-&gt;<ref refid="struct_se_r_m___race_buy_1a39049dbcc9946a164bd15df9703aa02a" kindref="member">iType</ref>,<sp/>pkBuy-&gt;<ref refid="struct_se_r_m___race_buy_1a0aec40e76daa3ef800eadad05840d187" kindref="member">dwParam1</ref>,<sp/>pkBuy-&gt;<ref refid="struct_se_r_m___race_buy_1abf79cbd8bbc669bb7a2f9589487924b7" kindref="member">dwParam2</ref>,<sp/>&amp;kTownSock);</highlight></codeline>
<codeline lineno="724"><highlight class="normal">}</highlight></codeline>
<codeline lineno="725"><highlight class="normal"></highlight></codeline>
<codeline lineno="726"><highlight class="normal"></highlight><highlight class="keywordtype">void</highlight><highlight class="normal"><sp/><ref refid="class_se_race_mgr_1a1f8b9e3b0043002176ad9cd33b69afc1" kindref="member">SeRaceMgr::OnProcessRaceBuyRet</ref>(<ref refid="struct_se_t_m___race_buy_ret" kindref="compound">SeTM_RaceBuyRet</ref>*<sp/>pkBuy)</highlight></codeline>
<codeline lineno="727"><highlight class="normal">{</highlight></codeline>
<codeline lineno="728"><highlight class="normal"><sp/><sp/><sp/><sp/><ref refid="struct_se_match_race" kindref="compound">SeMatchRace</ref>*<sp/>pkRace<sp/>=<sp/><ref refid="class_se_race_mgr_1afc891150076c0efc650aa8989cbe9fd8" kindref="member">GetRace</ref>(pkBuy-&gt;<ref refid="struct_se_t_m___race_buy_ret_1a65b9d801ef4f83d66564b6b3a3393f26" kindref="member">dwSession</ref>);</highlight></codeline>
<codeline lineno="729"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(!pkRace)</highlight></codeline>
<codeline lineno="730"><highlight class="normal"><sp/><sp/><sp/><sp/>{</highlight></codeline>
<codeline lineno="731"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal">;</highlight></codeline>
<codeline lineno="732"><highlight class="normal"><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="733"><highlight class="normal"></highlight></codeline>
<codeline lineno="734"><highlight class="normal"><sp/><sp/><sp/><sp/>HSock<sp/>kRaceSock<sp/>=<sp/><ref refid="class_se_race_mgr_1a220a9a7426ccd94670119a48ab0cb56c" kindref="member">GetRaceSvrSock</ref>(pkRace-&gt;<ref refid="struct_se_match_race_1ac5807e52b290fa9cbf27bbe2cff05e1e" kindref="member">kRaceTownSign</ref>);</highlight></codeline>
<codeline lineno="735"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(!kRaceSock.IsInvalid())</highlight></codeline>
<codeline lineno="736"><highlight class="normal"><sp/><sp/><sp/><sp/>{</highlight></codeline>
<codeline lineno="737"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="_src_2_match_server_8cpp_1a1cd9d6d0396497f8a9d48e44d672f368" kindref="member">g_kMatchServer</ref>.<ref refid="class_match_server_1a2c17136fb8cf861e955737453f6c0951" kindref="member">SendMR_RaceBuyRet</ref>(pkBuy-&gt;<ref refid="struct_se_t_m___race_buy_ret_1a65b9d801ef4f83d66564b6b3a3393f26" kindref="member">dwSession</ref>,<sp/>pkBuy-&gt;<ref refid="struct_se_t_m___race_buy_ret_1a6a0d3cbff80153f44a34a69794f414aa" kindref="member">bSuccess</ref>,<sp/>pkBuy-&gt;<ref refid="struct_se_t_m___race_buy_ret_1a2ab53fb1b4cbc9b2141e1bb79bff685e" kindref="member">dwPlayerID</ref>,<sp/>pkBuy-&gt;<ref refid="struct_se_t_m___race_buy_ret_1a27228025b287ecea55340f0a031dab44" kindref="member">iType</ref>,<sp/>pkBuy-&gt;<ref refid="struct_se_t_m___race_buy_ret_1ac0fe9b77bbd76bdd07093ed288be9b75" kindref="member">dwParam1</ref>,<sp/>pkBuy-&gt;<ref refid="struct_se_t_m___race_buy_ret_1aa7d09ff3af52537cec84ecb241660a2f" kindref="member">dwParam2</ref>,<sp/>&amp;kRaceSock);</highlight></codeline>
<codeline lineno="738"><highlight class="normal"><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="739"><highlight class="normal">}</highlight></codeline>
<codeline lineno="740"><highlight class="normal"></highlight></codeline>
<codeline lineno="741"><highlight class="normal"></highlight><highlight class="keywordtype">void</highlight><highlight class="normal"><sp/><ref refid="class_se_race_mgr_1adf666e83cdcfb99e4503db794f616967" kindref="member">SeRaceMgr::OnProcessRSRegister</ref>(<ref refid="struct_h_town_sign" kindref="compound">HTownSign</ref><sp/>kTownSign)</highlight></codeline>
<codeline lineno="742"><highlight class="normal">{</highlight></codeline>
<codeline lineno="743"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordtype">int</highlight><highlight class="normal"><sp/>iDelNum<sp/>=<sp/>0;</highlight></codeline>
<codeline lineno="744"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">for</highlight><highlight class="normal">(<ref refid="_match_server_2_src_2_se_race_mgr_def_8h_1ae8205488e760719ced167c20fd921ef4" kindref="member">MRaceIter</ref><sp/>kItr<sp/>=<sp/><ref refid="class_se_race_mgr_1ad346a0191bf14a69de9422c1fd03b301" kindref="member">m_kMRace</ref>.begin();kItr<sp/>!=<sp/><ref refid="class_se_race_mgr_1ad346a0191bf14a69de9422c1fd03b301" kindref="member">m_kMRace</ref>.end();)</highlight></codeline>
<codeline lineno="745"><highlight class="normal"><sp/><sp/><sp/><sp/>{</highlight></codeline>
<codeline lineno="746"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="struct_se_match_race" kindref="compound">SeMatchRace</ref>*<sp/>pkRace<sp/>=<sp/>kItr-&gt;second;</highlight></codeline>
<codeline lineno="747"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal">(pkRace<sp/>&amp;&amp;<sp/>pkRace-&gt;<ref refid="struct_se_match_race_1ac5807e52b290fa9cbf27bbe2cff05e1e" kindref="member">kRaceTownSign</ref><sp/>==<sp/>kTownSign)</highlight></codeline>
<codeline lineno="748"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>{</highlight></codeline>
<codeline lineno="749"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>iDelNum++;</highlight></codeline>
<codeline lineno="750"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="_src_2_se_race_query_mgr_8cpp_1a57ccbe85ab92907667a84b975fab68e1" kindref="member">g_kRaceQueryMgr</ref>.<ref refid="class_se_race_query_mgr_1a2fb929c386139e11b4090b851952e00d" kindref="member">OnDestroyRoom</ref>(pkRace-&gt;<ref refid="struct_se_match_race_1a2b2ba94026424d343fd55b9308b49c38" kindref="member">iRoomIndex</ref>,<sp/>pkRace-&gt;<ref refid="struct_se_match_race_1a8523887086f21641745b808f82cc1828" kindref="member">dwMatchSession</ref>);</highlight></codeline>
<codeline lineno="751"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>SeMatchRace::DEL(pkRace);</highlight></codeline>
<codeline lineno="752"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="class_se_race_mgr_1ad346a0191bf14a69de9422c1fd03b301" kindref="member">m_kMRace</ref>.erase(kItr++);</highlight></codeline>
<codeline lineno="753"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">continue</highlight><highlight class="normal">;</highlight></codeline>
<codeline lineno="754"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="755"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>++kItr;</highlight></codeline>
<codeline lineno="756"><highlight class="normal"><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="757"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight></codeline>
<codeline lineno="758"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal">(iDelNum<sp/>&gt;<sp/>0)</highlight></codeline>
<codeline lineno="759"><highlight class="normal"><sp/><sp/><sp/><sp/>{</highlight></codeline>
<codeline lineno="760"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="_se_file_log_8h_1a83f3fe470b91cb8eed8762cc8e5e26c3" kindref="member">SeLogInfo</ref>(</highlight><highlight class="stringliteral">&quot;RS[%s]<sp/>ReRegister,Del<sp/>RaceRoom[%d]!&quot;</highlight><highlight class="normal">,<ref refid="_se_tool_8h_1ada81d4ae5d39c42af0a02b45f4a6f715" kindref="member">GetID2Str</ref>(kTownSign.<ref refid="struct_h_town_sign_1aad795425c3c60114ef0578356b339d2c" kindref="member">dwServerID</ref>),iDelNum);</highlight></codeline>
<codeline lineno="761"><highlight class="normal"><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="762"><highlight class="normal">}</highlight></codeline>
<codeline lineno="763"><highlight class="normal"></highlight></codeline>
<codeline lineno="764"><highlight class="normal"></highlight><highlight class="keywordtype">void</highlight><highlight class="normal"><sp/><ref refid="class_se_race_mgr_1a5e909ffab780d9d8193107c875cc1ef9" kindref="member">SeRaceMgr::OnProcessAddIncompleteRace</ref>(DWord<sp/>dwSession,<sp/>DWord<sp/>dwPlayerID,<sp/></highlight><highlight class="keywordtype">int</highlight><highlight class="normal"><sp/>iSeat)</highlight></codeline>
<codeline lineno="765"><highlight class="normal">{</highlight></codeline>
<codeline lineno="766"><highlight class="normal"><sp/><sp/><sp/><sp/><ref refid="struct_se_match_race" kindref="compound">SeMatchRace</ref>*<sp/>pkRace<sp/>=<sp/>g_kRaceMgr.<ref refid="class_se_race_mgr_1afc891150076c0efc650aa8989cbe9fd8" kindref="member">GetRace</ref>(dwSession);</highlight></codeline>
<codeline lineno="767"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(!pkRace)</highlight></codeline>
<codeline lineno="768"><highlight class="normal"><sp/><sp/><sp/><sp/>{</highlight></codeline>
<codeline lineno="769"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="_se_file_log_8h_1a59fe2018c00666084724bec1365b41f5" kindref="member">SeLogError</ref>(</highlight><highlight class="stringliteral">&quot;OnProcessAddIncompleteRace<sp/>can<sp/>not<sp/>find<sp/>MatchRace<sp/>:<sp/>roomID[%d]&quot;</highlight><highlight class="normal">,<sp/>dwSession);</highlight></codeline>
<codeline lineno="770"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal">;</highlight></codeline>
<codeline lineno="771"><highlight class="normal"><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="772"><highlight class="normal"></highlight></codeline>
<codeline lineno="773"><highlight class="normal"><sp/><sp/><sp/><sp/><ref refid="struct_se_race_player" kindref="compound">SeRacePlayer</ref>*<sp/>pPlayer<sp/>=<sp/>pkRace-&gt;<ref refid="struct_se_match_race_1a3ca2e37d06ca150904873fb695310259" kindref="member">GetRacePlayerByID</ref>(dwPlayerID);</highlight></codeline>
<codeline lineno="774"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(pPlayer<sp/>==<sp/>NULL)</highlight></codeline>
<codeline lineno="775"><highlight class="normal"><sp/><sp/><sp/><sp/>{</highlight></codeline>
<codeline lineno="776"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="_se_file_log_8h_1a59fe2018c00666084724bec1365b41f5" kindref="member">SeLogError</ref>(</highlight><highlight class="stringliteral">&quot;OnProcessAddIncompleteRace<sp/>can<sp/>not<sp/>find<sp/>Playr<sp/>:<sp/>PlayerID[%d]&quot;</highlight><highlight class="normal">,<sp/>dwPlayerID);<sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal">;</highlight></codeline>
<codeline lineno="777"><highlight class="normal"><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="778"><highlight class="normal"></highlight></codeline>
<codeline lineno="779"><highlight class="normal"><sp/><sp/><sp/><sp/>HSock<sp/>kTownSock<sp/>=<sp/>g_kRaceMgr.<ref refid="class_se_race_mgr_1a3a7dd145633602ee3b6b491eabaff87f" kindref="member">GetTownSock</ref>(pPlayer-&gt;<ref refid="struct_se_race_player_1ac5601dda3e2dfc69b74649cbbfe6e141" kindref="member">kTownSign</ref>);</highlight></codeline>
<codeline lineno="780"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(!kTownSock.IsInvalid())</highlight></codeline>
<codeline lineno="781"><highlight class="normal"><sp/><sp/><sp/><sp/>{</highlight></codeline>
<codeline lineno="782"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="_src_2_match_server_8cpp_1a1cd9d6d0396497f8a9d48e44d672f368" kindref="member">g_kMatchServer</ref>.<ref refid="class_match_server_1af089eef4def1791b5a230aa9c6e5ac08" kindref="member">SendMT_CommMatchMsg</ref>(dwSession,<sp/><ref refid="_se_ptl_define_8h_1a05bc9da3a865896a10de16ae1763a5baa2c5bd4c6185278988c3d16839099a43a" kindref="member">SCMM_NOTIFY_LEAVE_RACE_WITHOUTREON</ref>,<sp/>dwPlayerID,<sp/>iSeat,<sp/>0,&amp;kTownSock);</highlight></codeline>
<codeline lineno="783"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="_se_file_log_8h_1ab19c516672348b15ddabafb0bfb9d0a7" kindref="member">SeLogDebug</ref>(</highlight><highlight class="stringliteral">&quot;OnProcessAddIncompleteRace<sp/>SendMT_CommMatchMsg<sp/>:<sp/>PlayerID[%d],Seat[%d]&quot;</highlight><highlight class="normal">,dwPlayerID,iSeat);</highlight></codeline>
<codeline lineno="784"><highlight class="normal"><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="785"><highlight class="normal"></highlight></codeline>
<codeline lineno="786"><highlight class="normal"><sp/><sp/><sp/><sp/><ref refid="_src_2_se_race_query_mgr_8cpp_1a57ccbe85ab92907667a84b975fab68e1" kindref="member">g_kRaceQueryMgr</ref>.<ref refid="class_se_race_query_mgr_1a90cb8d63163621fcc33561889d167f18" kindref="member">OnProcessAddIncompleteRace</ref>(pkRace-&gt;<ref refid="struct_se_match_race_1a5c7ab2cd8f14bbfa4bfd87f2bbb624f9" kindref="member">dwMapID</ref>,<ref refid="class_se_race_mgr_1ac7b4b13555b32e878e2fca917d445c76" kindref="member">GetRoomIndexBySession</ref>(dwSession),<sp/>dwSession,<sp/>iSeat);</highlight></codeline>
<codeline lineno="787"><highlight class="normal">}</highlight></codeline>
<codeline lineno="788"><highlight class="normal"></highlight></codeline>
<codeline lineno="789"><highlight class="normal"></highlight><highlight class="keywordtype">void</highlight><highlight class="normal"><sp/><ref refid="class_se_race_mgr_1a3c6eaca88b501f2c883c44c54d1e8535" kindref="member">SeRaceMgr::OnProcessRemoveIncompleteRace</ref>(DWord<sp/>dwSession)</highlight></codeline>
<codeline lineno="790"><highlight class="normal">{</highlight></codeline>
<codeline lineno="791"><highlight class="normal"><sp/><sp/><sp/><sp/><ref refid="_src_2_se_race_query_mgr_8cpp_1a57ccbe85ab92907667a84b975fab68e1" kindref="member">g_kRaceQueryMgr</ref>.<ref refid="class_se_race_query_mgr_1a99b93998e8a70fc8cc501e7c3f2277e5" kindref="member">OnProcessRemoveIncompleteRace</ref>(dwSession);</highlight></codeline>
<codeline lineno="792"><highlight class="normal">}</highlight></codeline>
<codeline lineno="793"><highlight class="normal"></highlight></codeline>
<codeline lineno="794"><highlight class="normal"></highlight><highlight class="keywordtype">void</highlight><highlight class="normal"><sp/><ref refid="class_se_race_mgr_1aa48238c7b5a15721277bee134cfec5e7" kindref="member">SeRaceMgr::OnProcessIncmpRaceKDA</ref>(DWord<sp/>dwSession,<sp/><ref refid="struct_se_r_m___res_incmp_race_seat_base_info" kindref="compound">SeRM_ResIncmpRaceSeatBaseInfo</ref>*<sp/>pInfo)</highlight></codeline>
<codeline lineno="795"><highlight class="normal">{</highlight></codeline>
<codeline lineno="796"><highlight class="normal"><sp/><sp/><sp/><sp/><ref refid="struct_se_match_race" kindref="compound">SeMatchRace</ref>*<sp/>pRace<sp/>=<sp/><ref refid="class_se_race_mgr_1afc891150076c0efc650aa8989cbe9fd8" kindref="member">GetRace</ref>(dwSession);</highlight></codeline>
<codeline lineno="797"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(!pRace)</highlight></codeline>
<codeline lineno="798"><highlight class="normal"><sp/><sp/><sp/><sp/>{</highlight></codeline>
<codeline lineno="799"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="_se_file_log_8h_1a59fe2018c00666084724bec1365b41f5" kindref="member">SeLogError</ref>(</highlight><highlight class="stringliteral">&quot;OnProcessIncmpRaceKDA<sp/>can<sp/>not<sp/>find<sp/>the<sp/>room<sp/>with<sp/>RoomSessionID:[%d]&quot;</highlight><highlight class="normal">,<sp/>dwSession);</highlight></codeline>
<codeline lineno="800"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal">;</highlight></codeline>
<codeline lineno="801"><highlight class="normal"><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="802"><highlight class="normal"><sp/><sp/><sp/><sp/><ref refid="_src_2_se_race_query_mgr_8cpp_1a57ccbe85ab92907667a84b975fab68e1" kindref="member">g_kRaceQueryMgr</ref>.<ref refid="class_se_race_query_mgr_1af62bd86cd1cbeb11d39ec28adacb1d0b" kindref="member">OnProcessIncmpRaceKDA</ref>(pRace-&gt;<ref refid="struct_se_match_race_1a2b2ba94026424d343fd55b9308b49c38" kindref="member">iRoomIndex</ref>,<sp/>dwSession,pInfo);</highlight></codeline>
<codeline lineno="803"><highlight class="normal">}</highlight></codeline>
<codeline lineno="804"><highlight class="normal"></highlight></codeline>
<codeline lineno="805"><highlight class="normal"></highlight><highlight class="keywordtype">void</highlight><highlight class="normal"><sp/><ref refid="class_se_race_mgr_1a5661c924e708c442a79549e4d2782185" kindref="member">SeRaceMgr::OnProcessReconPlayerInfo</ref>(DWord<sp/>dwSession,<sp/>DWord<sp/>dwPlayerID,<sp/></highlight><highlight class="keywordtype">int</highlight><highlight class="normal"><sp/>iSeat)</highlight></codeline>
<codeline lineno="806"><highlight class="normal">{</highlight></codeline>
<codeline lineno="807"><highlight class="normal"><sp/><sp/><sp/><sp/><ref refid="_src_2_se_race_query_mgr_8cpp_1a57ccbe85ab92907667a84b975fab68e1" kindref="member">g_kRaceQueryMgr</ref>.<ref refid="class_se_race_query_mgr_1ac0b3806471b04a7d30505abb83515041" kindref="member">OnReconUpdatePlayerInfo</ref>(<ref refid="class_se_race_mgr_1ac7b4b13555b32e878e2fca917d445c76" kindref="member">GetRoomIndexBySession</ref>(dwSession),<sp/>dwSession,<sp/>dwPlayerID,<sp/>iSeat);</highlight></codeline>
<codeline lineno="808"><highlight class="normal"><sp/><sp/><sp/><sp/><ref refid="struct_se_match_race" kindref="compound">SeMatchRace</ref>*<sp/>pRace<sp/>=<sp/><ref refid="class_se_race_mgr_1afc891150076c0efc650aa8989cbe9fd8" kindref="member">GetRace</ref>(dwSession);</highlight></codeline>
<codeline lineno="809"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(pRace<sp/>!=<sp/>NULL)</highlight></codeline>
<codeline lineno="810"><highlight class="normal"><sp/><sp/><sp/><sp/>{</highlight></codeline>
<codeline lineno="811"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>pRace-&gt;<ref refid="struct_se_match_race_1a1f51c90f643641518fc163f150a11419" kindref="member">akMRacePlayer</ref>[iSeat].dwPlayerID<sp/>=<sp/>dwPlayerID;</highlight></codeline>
<codeline lineno="812"><highlight class="normal"><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="813"><highlight class="normal">}</highlight></codeline>
<codeline lineno="814"><highlight class="normal"></highlight></codeline>
<codeline lineno="815"><highlight class="normal"></highlight><highlight class="keywordtype">void</highlight><highlight class="normal"><sp/><ref refid="class_se_race_mgr_1abbb52196d0a28be23f351a8fa148695b" kindref="member">SeRaceMgr::OnProcessReconPlayerName</ref>(DWord<sp/>dwSession,<sp/>DWord<sp/>dwPlayerID,<sp/></highlight><highlight class="keyword">const</highlight><highlight class="normal"><sp/></highlight><highlight class="keywordtype">char</highlight><highlight class="normal"><sp/>cName[])</highlight></codeline>
<codeline lineno="816"><highlight class="normal">{</highlight></codeline>
<codeline lineno="817"><highlight class="normal"><sp/><sp/><sp/><sp/><ref refid="struct_se_match_race" kindref="compound">SeMatchRace</ref>*<sp/>pkRace<sp/>=<sp/><ref refid="class_se_race_mgr_1afc891150076c0efc650aa8989cbe9fd8" kindref="member">GetRace</ref>(dwSession);</highlight></codeline>
<codeline lineno="818"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(!pkRace)</highlight></codeline>
<codeline lineno="819"><highlight class="normal"><sp/><sp/><sp/><sp/>{</highlight></codeline>
<codeline lineno="820"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal">;</highlight></codeline>
<codeline lineno="821"><highlight class="normal"><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="822"><highlight class="normal"></highlight></codeline>
<codeline lineno="823"><highlight class="normal"><sp/><sp/><sp/><sp/>HSock<sp/>kRaceSock<sp/>=<sp/>g_kRaceMgr.<ref refid="class_se_race_mgr_1a220a9a7426ccd94670119a48ab0cb56c" kindref="member">GetRaceSvrSock</ref>(pkRace-&gt;<ref refid="struct_se_match_race_1ac5807e52b290fa9cbf27bbe2cff05e1e" kindref="member">kRaceTownSign</ref>);</highlight></codeline>
<codeline lineno="824"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(!kRaceSock.IsInvalid())</highlight></codeline>
<codeline lineno="825"><highlight class="normal"><sp/><sp/><sp/><sp/>{</highlight></codeline>
<codeline lineno="826"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="_src_2_match_server_8cpp_1a1cd9d6d0396497f8a9d48e44d672f368" kindref="member">g_kMatchServer</ref>.<ref refid="class_match_server_1af3ad67aa83eef3f7803d5de68ba56e5e" kindref="member">SendMR_ReconPLayerName</ref>(dwPlayerID,<sp/>cName,&amp;kRaceSock);</highlight></codeline>
<codeline lineno="827"><highlight class="normal"><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="828"><highlight class="normal">}</highlight></codeline>
<codeline lineno="829"><highlight class="normal"></highlight></codeline>
<codeline lineno="830"><highlight class="normal"></highlight></codeline>
<codeline lineno="831"><highlight class="normal"></highlight><highlight class="keywordtype">int</highlight><highlight class="normal"><sp/><ref refid="class_se_race_mgr_1a8f2896bfe2b0175670834789c2ba82ad" kindref="member">SeRaceMgr::GetRaceNum</ref>()</highlight></codeline>
<codeline lineno="832"><highlight class="normal">{</highlight></codeline>
<codeline lineno="833"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/>(</highlight><highlight class="keywordtype">int</highlight><highlight class="normal">)<ref refid="class_se_race_mgr_1ad346a0191bf14a69de9422c1fd03b301" kindref="member">m_kMRace</ref>.size();</highlight></codeline>
<codeline lineno="834"><highlight class="normal">}</highlight></codeline>
<codeline lineno="835"><highlight class="normal"></highlight></codeline>
<codeline lineno="836"><highlight class="normal"></highlight><highlight class="keywordtype">int</highlight><highlight class="normal"><sp/><ref refid="class_se_race_mgr_1ac7b4b13555b32e878e2fca917d445c76" kindref="member">SeRaceMgr::GetRoomIndexBySession</ref>(DWord<sp/>dwSession)</highlight></codeline>
<codeline lineno="837"><highlight class="normal">{</highlight></codeline>
<codeline lineno="838"><highlight class="normal"><sp/><sp/><sp/><sp/><ref refid="struct_se_match_race" kindref="compound">SeMatchRace</ref>*<sp/>pkRace<sp/>=<sp/><ref refid="class_se_race_mgr_1afc891150076c0efc650aa8989cbe9fd8" kindref="member">GetRace</ref>(dwSession);</highlight></codeline>
<codeline lineno="839"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal">(pkRace)</highlight></codeline>
<codeline lineno="840"><highlight class="normal"><sp/><sp/><sp/><sp/>{</highlight></codeline>
<codeline lineno="841"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/>pkRace-&gt;<ref refid="struct_se_match_race_1a2b2ba94026424d343fd55b9308b49c38" kindref="member">iRoomIndex</ref>;</highlight></codeline>
<codeline lineno="842"><highlight class="normal"><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="843"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/>-1;</highlight></codeline>
<codeline lineno="844"><highlight class="normal">}</highlight></codeline>
<codeline lineno="845"><highlight class="normal"></highlight></codeline>
<codeline lineno="846"><highlight class="normal"></highlight><highlight class="keywordtype">void</highlight><highlight class="normal"><sp/><ref refid="class_se_race_mgr_1af4493ec425bebc0a9343fe600a5d863e" kindref="member">SeRaceMgr::OnBiVoiceCreateRoom</ref>(DWord<sp/>dwSession,<sp/></highlight><highlight class="keywordtype">int</highlight><highlight class="normal"><sp/>iRoomID)</highlight></codeline>
<codeline lineno="847"><highlight class="normal">{</highlight></codeline>
<codeline lineno="848"><highlight class="normal"><sp/><sp/><sp/><sp/><ref refid="struct_se_match_race" kindref="compound">SeMatchRace</ref>*<sp/>pkRace<sp/>=<sp/><ref refid="class_se_race_mgr_1afc891150076c0efc650aa8989cbe9fd8" kindref="member">GetRace</ref>(dwSession);</highlight></codeline>
<codeline lineno="849"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(!pkRace)</highlight></codeline>
<codeline lineno="850"><highlight class="normal"><sp/><sp/><sp/><sp/>{</highlight></codeline>
<codeline lineno="851"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal">;</highlight></codeline>
<codeline lineno="852"><highlight class="normal"><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="853"><highlight class="normal"></highlight></codeline>
<codeline lineno="854"><highlight class="normal"><sp/><sp/><sp/><sp/>pkRace-&gt;<ref refid="struct_se_match_race_1a97a790bb865b5d4cb6d95b3a3ab937a4" kindref="member">iBiVoiceRoomID</ref><sp/>=<sp/>iRoomID;</highlight></codeline>
<codeline lineno="855"><highlight class="normal"></highlight></codeline>
<codeline lineno="856"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keyword">const</highlight><highlight class="normal"><sp/><ref refid="struct_se_race_svr" kindref="compound">SeRaceSvr</ref>*<sp/>pkSvr<sp/>=<sp/><ref refid="_src_2_se_race_svr_mgr_8cpp_1a2d3d387da69f6fc93ec49db8bf1ee871" kindref="member">g_kRaceSvrMgr</ref>.<ref refid="class_se_race_svr_mgr_1a5cb837611a3d12df40c032445a38666a" kindref="member">GetRaceSvr</ref>(pkRace-&gt;<ref refid="struct_se_match_race_1ac5807e52b290fa9cbf27bbe2cff05e1e" kindref="member">kRaceTownSign</ref>);</highlight></codeline>
<codeline lineno="857"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(!pkSvr)</highlight></codeline>
<codeline lineno="858"><highlight class="normal"><sp/><sp/><sp/><sp/>{</highlight></codeline>
<codeline lineno="859"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal">;</highlight></codeline>
<codeline lineno="860"><highlight class="normal"><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="861"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">for</highlight><highlight class="normal"><sp/>(MRacePlayer::iterator<sp/>itr<sp/>=<sp/>pkRace-&gt;<ref refid="struct_se_match_race_1a1f51c90f643641518fc163f150a11419" kindref="member">akMRacePlayer</ref>.begin();<sp/>itr<sp/>!=<sp/>pkRace-&gt;<ref refid="struct_se_match_race_1a1f51c90f643641518fc163f150a11419" kindref="member">akMRacePlayer</ref>.end();<sp/>++itr)</highlight></codeline>
<codeline lineno="862"><highlight class="normal"><sp/><sp/><sp/><sp/>{</highlight></codeline>
<codeline lineno="863"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">//<sp/>fixme</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="864"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="struct_se_race_player" kindref="compound">SeRacePlayer</ref>&amp;<sp/>rkPlayer<sp/>=<sp/>itr-&gt;second;</highlight></codeline>
<codeline lineno="865"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">//if(rkPlayer.bOwner)</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="866"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>{</highlight></codeline>
<codeline lineno="867"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>HSock<sp/>kTownSock<sp/>=<sp/><ref refid="class_se_race_mgr_1a3a7dd145633602ee3b6b491eabaff87f" kindref="member">GetTownSock</ref>(rkPlayer.<ref refid="struct_se_race_player_1ac5601dda3e2dfc69b74649cbbfe6e141" kindref="member">kTownSign</ref>);</highlight></codeline>
<codeline lineno="868"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(!kTownSock.IsInvalid())</highlight></codeline>
<codeline lineno="869"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>{</highlight></codeline>
<codeline lineno="870"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="_se_file_log_8h_1a83f3fe470b91cb8eed8762cc8e5e26c3" kindref="member">SeLogInfo</ref>(</highlight><highlight class="stringliteral">&quot;OnBiVoiceCreateRoom<sp/>and<sp/>SendBiVoiceEnterInfo<sp/>PlayerID[%d]<sp/>RoomID[%d]!&quot;</highlight><highlight class="normal">,rkPlayer.<ref refid="struct_se_race_player_1a1562e06b4a18a384dc8b152668a9c62f" kindref="member">dwPlayerID</ref>,iRoomID);</highlight></codeline>
<codeline lineno="871"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="_src_2_match_server_8cpp_1a1cd9d6d0396497f8a9d48e44d672f368" kindref="member">g_kMatchServer</ref>.<ref refid="class_match_server_1ab36a609730a080ef12e453966afdea67" kindref="member">SendMT_BiVoiceEnterInfo</ref>(rkPlayer.<ref refid="struct_se_race_player_1a1562e06b4a18a384dc8b152668a9c62f" kindref="member">dwPlayerID</ref>,<sp/>iRoomID,<sp/></highlight><highlight class="stringliteral">&quot;123456&quot;</highlight><highlight class="normal">,<sp/></highlight><highlight class="stringliteral">&quot;&quot;</highlight><highlight class="normal">,<sp/>&amp;kTownSock);</highlight></codeline>
<codeline lineno="872"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="873"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="874"><highlight class="normal"><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="875"><highlight class="normal">}</highlight></codeline>
<codeline lineno="876"><highlight class="normal"></highlight></codeline>
<codeline lineno="877"><highlight class="normal"></highlight><highlight class="keywordtype">bool</highlight><highlight class="normal"><sp/><ref refid="class_se_race_mgr_1aed313cc17a805bea5daeb0366013bae6" kindref="member">SeRaceMgr::SendMatchCommMsg</ref>(<ref refid="struct_se_match_race" kindref="compound">SeMatchRace</ref>*<sp/>pkRace,<ref refid="_se_ptl_define_8h_1a05bc9da3a865896a10de16ae1763a5ba" kindref="member">SeCommMatchMsg</ref><sp/>eMsg,DWord<sp/>dwParam)</highlight></codeline>
<codeline lineno="878"><highlight class="normal">{</highlight></codeline>
<codeline lineno="879"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">for</highlight><highlight class="normal">(MRacePlayer::iterator<sp/>itr<sp/>=<sp/>pkRace-&gt;<ref refid="struct_se_match_race_1a1f51c90f643641518fc163f150a11419" kindref="member">akMRacePlayer</ref>.begin();itr<sp/>!=<sp/>pkRace-&gt;<ref refid="struct_se_match_race_1a1f51c90f643641518fc163f150a11419" kindref="member">akMRacePlayer</ref>.end();++itr)</highlight></codeline>
<codeline lineno="880"><highlight class="normal"><sp/><sp/><sp/><sp/>{</highlight></codeline>
<codeline lineno="881"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="struct_se_race_player" kindref="compound">SeRacePlayer</ref>&amp;<sp/>rkPlayer<sp/>=<sp/>itr-&gt;second;</highlight></codeline>
<codeline lineno="882"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">//<sp/>fixme</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="883"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">//if(rkPlayer.bOwner)</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="884"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>{</highlight></codeline>
<codeline lineno="885"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>DWord<sp/>dwPlayerParam<sp/>=<sp/>0;</highlight></codeline>
<codeline lineno="886"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal">(rkPlayer.<ref refid="struct_se_race_player_1a7691bd1ec8aedc1ad18ed942231e3e4b" kindref="member">iRoomIndex</ref><sp/>!=<sp/>-1)</highlight></codeline>
<codeline lineno="887"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>{</highlight></codeline>
<codeline lineno="888"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>dwPlayerParam<sp/>=<sp/>rkPlayer.<ref refid="struct_se_race_player_1a7691bd1ec8aedc1ad18ed942231e3e4b" kindref="member">iRoomIndex</ref>;</highlight></codeline>
<codeline lineno="889"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="890"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">else</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="891"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>{</highlight></codeline>
<codeline lineno="892"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>dwPlayerParam<sp/>=<sp/>rkPlayer.<ref refid="struct_se_race_player_1a1562e06b4a18a384dc8b152668a9c62f" kindref="member">dwPlayerID</ref>;</highlight></codeline>
<codeline lineno="893"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="894"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight></codeline>
<codeline lineno="895"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>HSock<sp/>kTownSock<sp/>=<sp/><ref refid="class_se_race_mgr_1a3a7dd145633602ee3b6b491eabaff87f" kindref="member">GetTownSock</ref>(rkPlayer.<ref refid="struct_se_race_player_1ac5601dda3e2dfc69b74649cbbfe6e141" kindref="member">kTownSign</ref>);</highlight></codeline>
<codeline lineno="896"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal">(!kTownSock.IsInvalid())</highlight></codeline>
<codeline lineno="897"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>{</highlight></codeline>
<codeline lineno="898"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="_src_2_match_server_8cpp_1a1cd9d6d0396497f8a9d48e44d672f368" kindref="member">g_kMatchServer</ref>.<ref refid="class_match_server_1af089eef4def1791b5a230aa9c6e5ac08" kindref="member">SendMT_CommMatchMsg</ref>(pkRace-&gt;<ref refid="struct_se_match_race_1a8523887086f21641745b808f82cc1828" kindref="member">dwMatchSession</ref>,<sp/>eMsg,<sp/>dwPlayerParam,<sp/>-1,<sp/>dwParam,<sp/>&amp;kTownSock);</highlight></codeline>
<codeline lineno="899"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="900"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="901"><highlight class="normal"><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="902"><highlight class="normal"></highlight></codeline>
<codeline lineno="903"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/></highlight><highlight class="keyword">true</highlight><highlight class="normal">;</highlight></codeline>
<codeline lineno="904"><highlight class="normal">}</highlight></codeline>
<codeline lineno="905"><highlight class="normal"></highlight></codeline>
<codeline lineno="906"><highlight class="normal"></highlight><highlight class="keywordtype">bool</highlight><highlight class="normal"><sp/><ref refid="class_se_race_mgr_1a51dd9494f018279ef23edbf579d0b525" kindref="member">SeRaceMgr::SendMatchAddrMsg</ref>(<ref refid="struct_se_match_race" kindref="compound">SeMatchRace</ref>*<sp/>pkRace)</highlight></codeline>
<codeline lineno="907"><highlight class="normal">{</highlight></codeline>
<codeline lineno="908"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keyword">const</highlight><highlight class="normal"><sp/><ref refid="struct_se_race_svr" kindref="compound">SeRaceSvr</ref>*<sp/>pkSvr<sp/>=<sp/><ref refid="_src_2_se_race_svr_mgr_8cpp_1a2d3d387da69f6fc93ec49db8bf1ee871" kindref="member">g_kRaceSvrMgr</ref>.<ref refid="class_se_race_svr_mgr_1a5cb837611a3d12df40c032445a38666a" kindref="member">GetRaceSvr</ref>(pkRace-&gt;<ref refid="struct_se_match_race_1ac5807e52b290fa9cbf27bbe2cff05e1e" kindref="member">kRaceTownSign</ref>);<sp/></highlight></codeline>
<codeline lineno="909"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal">(!pkSvr)</highlight></codeline>
<codeline lineno="910"><highlight class="normal"><sp/><sp/><sp/><sp/>{</highlight></codeline>
<codeline lineno="911"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="_se_file_log_8h_1a59fe2018c00666084724bec1365b41f5" kindref="member">SeLogError</ref>(</highlight><highlight class="stringliteral">&quot;SendMatchAddrMsg<sp/>fail<sp/>racesvr<sp/>not<sp/>exist&quot;</highlight><highlight class="normal">,<sp/>1);</highlight></codeline>
<codeline lineno="912"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/></highlight><highlight class="keyword">false</highlight><highlight class="normal">;</highlight></codeline>
<codeline lineno="913"><highlight class="normal"><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="914"><highlight class="normal"></highlight></codeline>
<codeline lineno="915"><highlight class="normal"></highlight></codeline>
<codeline lineno="916"><highlight class="normal"><sp/><sp/><sp/><sp/>std::vector&lt;SeNoticeMatchPlayerInfo&gt;<sp/>vPlayerInfo;</highlight></codeline>
<codeline lineno="917"><highlight class="normal"></highlight></codeline>
<codeline lineno="918"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">for</highlight><highlight class="normal"><sp/>(MRacePlayer::iterator<sp/>itr<sp/>=<sp/>pkRace-&gt;<ref refid="struct_se_match_race_1a1f51c90f643641518fc163f150a11419" kindref="member">akMRacePlayer</ref>.begin();<sp/>itr<sp/>!=<sp/>pkRace-&gt;<ref refid="struct_se_match_race_1a1f51c90f643641518fc163f150a11419" kindref="member">akMRacePlayer</ref>.end();<sp/>++itr)</highlight></codeline>
<codeline lineno="919"><highlight class="normal"><sp/><sp/><sp/><sp/>{</highlight></codeline>
<codeline lineno="920"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="struct_se_race_player" kindref="compound">SeRacePlayer</ref>&amp;<sp/>rkPlayer<sp/>=<sp/>itr-&gt;second;</highlight></codeline>
<codeline lineno="921"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="struct_se_notice_match_player_info" kindref="compound">SeNoticeMatchPlayerInfo</ref><sp/>tPlayer;</highlight></codeline>
<codeline lineno="922"><highlight class="normal"></highlight></codeline>
<codeline lineno="923"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="_se_tool_8cpp_1a4d30fbe56257fc998ebc1346e53be0d8" kindref="member">StrCpy</ref>(tPlayer.<ref refid="struct_se_notice_match_player_info_1a91dd7139d3e09a9a3b64fe0934a5267f" kindref="member">acName</ref>,<sp/></highlight><highlight class="keyword">sizeof</highlight><highlight class="normal">(tPlayer.<ref refid="struct_se_notice_match_player_info_1a91dd7139d3e09a9a3b64fe0934a5267f" kindref="member">acName</ref>),<sp/>rkPlayer.<ref refid="struct_se_race_player_1afa52af4dc9c6a2c07cb13b72f9e832fc" kindref="member">akPlayerInfo</ref>.<ref refid="struct_se_ptl_match_player_1a3af269895af07bf8ec8ab75f255fde49" kindref="member">kBaseInfo</ref>.<ref refid="struct_se_match_base_info_1af0e5f25ef07f51e4f06ad85435b90678" kindref="member">acName</ref>.c_str());</highlight></codeline>
<codeline lineno="924"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>tPlayer.<ref refid="struct_se_notice_match_player_info_1a9251e8b5ce31731bb5fd2efdebb24883" kindref="member">dwPlayerID</ref><sp/>=<sp/>rkPlayer.<ref refid="struct_se_race_player_1a1562e06b4a18a384dc8b152668a9c62f" kindref="member">dwPlayerID</ref>;</highlight></codeline>
<codeline lineno="925"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>tPlayer.<ref refid="struct_se_notice_match_player_info_1ae8e684cb015f20626c59f6fe390d427b" kindref="member">byCamp</ref><sp/>=<sp/>rkPlayer.<ref refid="struct_se_race_player_1ad9851bb0940139ae58a6b6ff561bed43" kindref="member">eCamp</ref>;</highlight></codeline>
<codeline lineno="926"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>tPlayer.<ref refid="struct_se_notice_match_player_info_1ae54351abef40bfc7bf044e01f8c62b9b" kindref="member">iSeatIndex</ref><sp/>=<sp/>rkPlayer.<ref refid="struct_se_race_player_1a1558451c3d50c30090110db7b8d63ca4" kindref="member">iSeatIndex</ref>;</highlight></codeline>
<codeline lineno="927"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>vPlayerInfo.push_back(tPlayer);</highlight></codeline>
<codeline lineno="928"><highlight class="normal"><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="929"><highlight class="normal"></highlight></codeline>
<codeline lineno="930"><highlight class="normal"></highlight></codeline>
<codeline lineno="931"><highlight class="normal"></highlight></codeline>
<codeline lineno="932"><highlight class="normal"><sp/><sp/><sp/><sp/>DWord<sp/>dwRoomOwnerID<sp/>=<sp/>0;</highlight></codeline>
<codeline lineno="933"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">for</highlight><highlight class="normal">(MRacePlayer::iterator<sp/>itr<sp/>=<sp/>pkRace-&gt;<ref refid="struct_se_match_race_1a1f51c90f643641518fc163f150a11419" kindref="member">akMRacePlayer</ref>.begin();itr<sp/>!=<sp/>pkRace-&gt;<ref refid="struct_se_match_race_1a1f51c90f643641518fc163f150a11419" kindref="member">akMRacePlayer</ref>.end();++itr)</highlight></codeline>
<codeline lineno="934"><highlight class="normal"><sp/><sp/><sp/><sp/>{</highlight></codeline>
<codeline lineno="935"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">//<sp/>fixme</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="936"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="struct_se_race_player" kindref="compound">SeRacePlayer</ref>&amp;<sp/>rkPlayer<sp/>=<sp/>itr-&gt;second;</highlight></codeline>
<codeline lineno="937"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>dwRoomOwnerID<sp/>=<sp/>rkPlayer.<ref refid="struct_se_race_player_1a1562e06b4a18a384dc8b152668a9c62f" kindref="member">dwPlayerID</ref>;</highlight></codeline>
<codeline lineno="938"><highlight class="normal"></highlight></codeline>
<codeline lineno="939"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>HSock<sp/>kTownSock<sp/>=<sp/><ref refid="class_se_race_mgr_1a3a7dd145633602ee3b6b491eabaff87f" kindref="member">GetTownSock</ref>(rkPlayer.<ref refid="struct_se_race_player_1ac5601dda3e2dfc69b74649cbbfe6e141" kindref="member">kTownSign</ref>);</highlight></codeline>
<codeline lineno="940"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal">(!kTownSock.IsInvalid())</highlight></codeline>
<codeline lineno="941"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>{</highlight></codeline>
<codeline lineno="942"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="_src_2_match_server_8cpp_1a1cd9d6d0396497f8a9d48e44d672f368" kindref="member">g_kMatchServer</ref>.<ref refid="class_match_server_1ab0504e9a552891a7e72692321ff81964" kindref="member">SendMT_NotifyAddrToMatch</ref>(rkPlayer.<ref refid="struct_se_race_player_1a1562e06b4a18a384dc8b152668a9c62f" kindref="member">dwPlayerID</ref>,<sp/>pkRace-&gt;<ref refid="struct_se_match_race_1a8523887086f21641745b808f82cc1828" kindref="member">dwMatchSession</ref>,</highlight></codeline>
<codeline lineno="943"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>pkSvr-&gt;<ref refid="struct_se_race_svr_1ab7a203f16140661a867aed5a3010cbba" kindref="member">kAddrToMatch</ref>,<sp/>pkSvr-&gt;<ref refid="struct_se_race_svr_1a913ff58728829f631f4d5d2c8a7def48" kindref="member">kAddrToMatchUdp</ref>,<sp/>pkRace-&gt;<ref refid="struct_se_match_race_1a30a4dd82bc1c90da9e624e34d3fdc69c" kindref="member">dwKey</ref>,<sp/><ref refid="_se_ptl_comm_define_8h_1a77f91e01c5c1d6e63aeae4848cd17d45a05a102a489ec1aa2cfd3420bdefc4d5c" kindref="member">SRVT_RACE</ref>,<sp/>rkPlayer.<ref refid="struct_se_race_player_1a1558451c3d50c30090110db7b8d63ca4" kindref="member">iSeatIndex</ref>,<sp/>vPlayerInfo.size(),<sp/>vPlayerInfo,<sp/>&amp;kTownSock);</highlight></codeline>
<codeline lineno="944"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="_se_file_log_8h_1a83f3fe470b91cb8eed8762cc8e5e26c3" kindref="member">SeLogInfo</ref>(</highlight><highlight class="stringliteral">&quot;Send<sp/>player[%u]<sp/>racesvr:<sp/><sp/>session[%u]&quot;</highlight><highlight class="normal">,<sp/>rkPlayer.<ref refid="struct_se_race_player_1a1562e06b4a18a384dc8b152668a9c62f" kindref="member">dwPlayerID</ref>,<sp/>pkRace-&gt;<ref refid="struct_se_match_race_1a8523887086f21641745b808f82cc1828" kindref="member">dwMatchSession</ref>);</highlight></codeline>
<codeline lineno="945"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="946"><highlight class="normal"><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="947"><highlight class="normal"></highlight></codeline>
<codeline lineno="948"><highlight class="normal"><sp/><sp/><sp/><sp/>pkRace-&gt;<ref refid="struct_se_match_race_1af7fd4b9eef403239ffce20dfec790705" kindref="member">bSendMatchAddr</ref><sp/>=<sp/></highlight><highlight class="keyword">true</highlight><highlight class="normal">;</highlight></codeline>
<codeline lineno="949"><highlight class="normal"></highlight></codeline>
<codeline lineno="950"><highlight class="normal"><sp/><sp/><sp/><sp/>HSock<sp/>kHttpSock;</highlight></codeline>
<codeline lineno="951"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(<ref refid="_src_2_match_server_8cpp_1a1cd9d6d0396497f8a9d48e44d672f368" kindref="member">g_kMatchServer</ref>.<ref refid="class_match_server_1a2b7111c85a75dd776b6c11ed4d860425" kindref="member">GetRandHttpSock</ref>(kHttpSock))</highlight></codeline>
<codeline lineno="952"><highlight class="normal"><sp/><sp/><sp/><sp/>{</highlight></codeline>
<codeline lineno="953"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">//<sp/></highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="954"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="struct_se_syn_opr" kindref="compound">SeSynOpr</ref>*<sp/>pkSynOpr<sp/>=<sp/></highlight><highlight class="keyword">new</highlight><highlight class="normal"><sp/><ref refid="struct_se_syn_opr" kindref="compound">SeSynOpr</ref>;</highlight></codeline>
<codeline lineno="955"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>pkSynOpr-&gt;<ref refid="struct_se_syn_opr_1ad83fdcde2f32010023f2f0c2abddccf9" kindref="member">iID</ref><sp/>=<sp/>pkRace-&gt;<ref refid="struct_se_match_race_1a8523887086f21641745b808f82cc1828" kindref="member">dwMatchSession</ref>;<sp/><sp/><sp/><sp/><sp/></highlight></codeline>
<codeline lineno="956"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>DWord<sp/>dwKey<sp/>=<sp/><ref refid="src_2_global_server_8cpp_1a842dd477472778ad2894948f2fb7cfd9" kindref="member">g_kSynMgr</ref>.<ref refid="class_se_syn_mgr_1a4835ca66feaf0cb9b5b97e533d42c6a8" kindref="member">AddSynOpr</ref>(pkSynOpr);</highlight></codeline>
<codeline lineno="957"><highlight class="normal"></highlight></codeline>
<codeline lineno="958"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordtype">char</highlight><highlight class="normal"><sp/>acChatRoomName[256]<sp/>=<sp/>{<sp/>0<sp/>};</highlight></codeline>
<codeline lineno="959"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="_se_server_tool_8cpp_1ad2735ec90511f0d6ec1535cf448709b8" kindref="member">SPrintf</ref>(acChatRoomName,<sp/></highlight><highlight class="keyword">sizeof</highlight><highlight class="normal">(acChatRoomName),<sp/></highlight><highlight class="stringliteral">&quot;XGameRoomOver[%d]&quot;</highlight><highlight class="normal">,<sp/>dwRoomOwnerID);</highlight></codeline>
<codeline lineno="960"><highlight class="normal"></highlight></codeline>
<codeline lineno="961"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="_src_2_match_server_8cpp_1a1cd9d6d0396497f8a9d48e44d672f368" kindref="member">g_kMatchServer</ref>.<ref refid="class_match_server_1a33003ade519ab6598e53c69a900e1399" kindref="member">SendHS_BiVoiceCreateChatRoom</ref>(kHttpSock,<sp/>dwKey,<sp/></highlight><highlight class="stringliteral">&quot;&quot;</highlight><highlight class="normal">,<sp/>acChatRoomName,<sp/></highlight><highlight class="stringliteral">&quot;&quot;</highlight><highlight class="normal">,<sp/>0,<sp/>1,<sp/>10);</highlight></codeline>
<codeline lineno="962"><highlight class="normal"><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="963"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight></codeline>
<codeline lineno="964"><highlight class="normal"></highlight></codeline>
<codeline lineno="965"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/></highlight><highlight class="keyword">true</highlight><highlight class="normal">;</highlight></codeline>
<codeline lineno="966"><highlight class="normal">}</highlight></codeline>
<codeline lineno="967"><highlight class="normal"></highlight></codeline>
<codeline lineno="968"><highlight class="normal"></highlight><highlight class="keywordtype">void</highlight><highlight class="normal"><sp/><ref refid="class_se_race_mgr_1a555f6464f6b7113ca16fbe22555faa9f" kindref="member">SeRaceMgr::DoRaceOver</ref>(<ref refid="struct_se_match_race" kindref="compound">SeMatchRace</ref>*<sp/>pkRace)</highlight></codeline>
<codeline lineno="969"><highlight class="normal">{</highlight></codeline>
<codeline lineno="970"><highlight class="normal"><sp/><sp/><sp/><sp/>pkRace-&gt;<ref refid="struct_se_match_race_1a3a9af85294d2e4f80524c28c498324b1" kindref="member">eRaceState</ref><sp/>=<sp/><ref refid="_match_server_2_src_2_se_race_mgr_def_8h_1a3f0f87c08c5c7566ba4e99c73d523f20a073935cf9b37d59db9ab24d14ad45935" kindref="member">SMRS_RACE_OVER</ref>;</highlight></codeline>
<codeline lineno="971"><highlight class="normal"><sp/><sp/><sp/><sp/>pkRace-&gt;<ref refid="struct_se_match_race_1ac98eae2e335d69e4acbf6f7f869f8ef3" kindref="member">dwLastRecvTime</ref><sp/>=<sp/><ref refid="_src_2_match_server_8cpp_1a1cd9d6d0396497f8a9d48e44d672f368" kindref="member">g_kMatchServer</ref>.<ref refid="class_match_server_1ad3ce38db6c10f10891dbfd700cb954ca" kindref="member">GetServerTime</ref>();</highlight></codeline>
<codeline lineno="972"><highlight class="normal"><sp/><sp/><sp/><sp/><ref refid="_src_2_se_race_query_mgr_8cpp_1a57ccbe85ab92907667a84b975fab68e1" kindref="member">g_kRaceQueryMgr</ref>.<ref refid="class_se_race_query_mgr_1a2fb929c386139e11b4090b851952e00d" kindref="member">OnDestroyRoom</ref>(pkRace-&gt;<ref refid="struct_se_match_race_1a2b2ba94026424d343fd55b9308b49c38" kindref="member">iRoomIndex</ref>,<sp/>pkRace-&gt;<ref refid="struct_se_match_race_1a8523887086f21641745b808f82cc1828" kindref="member">dwMatchSession</ref>);</highlight></codeline>
<codeline lineno="973"><highlight class="normal"></highlight></codeline>
<codeline lineno="974"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="comment">//<sp/></highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="975"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">for</highlight><highlight class="normal">(MRacePlayer::iterator<sp/>itr<sp/>=<sp/>pkRace-&gt;<ref refid="struct_se_match_race_1a1f51c90f643641518fc163f150a11419" kindref="member">akMRacePlayer</ref>.begin();itr<sp/>!=<sp/>pkRace-&gt;<ref refid="struct_se_match_race_1a1f51c90f643641518fc163f150a11419" kindref="member">akMRacePlayer</ref>.end();++itr)</highlight></codeline>
<codeline lineno="976"><highlight class="normal"><sp/><sp/><sp/><sp/>{</highlight></codeline>
<codeline lineno="977"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="struct_se_race_player" kindref="compound">SeRacePlayer</ref>&amp;<sp/>rkRacePlayer<sp/>=<sp/>itr-&gt;second;</highlight></codeline>
<codeline lineno="978"><highlight class="normal"></highlight></codeline>
<codeline lineno="979"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="_src_2_se_match_mgr_8cpp_1abfc936168bb770a0771ac3b4df44abfb" kindref="member">g_kMatchMgr</ref>.<ref refid="class_se_match_mgr_1abf72d4e94970d6d9c102809756275c62" kindref="member">OnBattleOver</ref>(rkRacePlayer);</highlight></codeline>
<codeline lineno="980"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">//<sp/>fixme</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="981"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">//if(rkRacePlayer.bLeaveRace)</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="982"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">//{</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="983"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">//<sp/><sp/>continue;</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="984"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">//}</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="985"><highlight class="normal"></highlight></codeline>
<codeline lineno="986"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">//<sp/></highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="987"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>HSock<sp/>kSock<sp/>=<sp/><ref refid="class_se_race_mgr_1a3a7dd145633602ee3b6b491eabaff87f" kindref="member">GetTownSock</ref>(rkRacePlayer.<ref refid="struct_se_race_player_1ac5601dda3e2dfc69b74649cbbfe6e141" kindref="member">kTownSign</ref>);</highlight></codeline>
<codeline lineno="988"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(!kSock.IsInvalid())</highlight></codeline>
<codeline lineno="989"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>{</highlight></codeline>
<codeline lineno="990"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="_src_2_match_server_8cpp_1a1cd9d6d0396497f8a9d48e44d672f368" kindref="member">g_kMatchServer</ref>.<ref refid="class_match_server_1af089eef4def1791b5a230aa9c6e5ac08" kindref="member">SendMT_CommMatchMsg</ref>(pkRace-&gt;<ref refid="struct_se_match_race_1a5c7ab2cd8f14bbfa4bfd87f2bbb624f9" kindref="member">dwMapID</ref>,<sp/><ref refid="_se_ptl_define_8h_1a05bc9da3a865896a10de16ae1763a5baacc03fdb6d549c96de4a9b3dd245004a9" kindref="member">SCMM_RACE_OVER</ref>,<sp/>rkRacePlayer.<ref refid="struct_se_race_player_1a1562e06b4a18a384dc8b152668a9c62f" kindref="member">dwPlayerID</ref>,<sp/>0,<sp/>0,<sp/>&amp;kSock);</highlight></codeline>
<codeline lineno="991"><highlight class="normal"></highlight></codeline>
<codeline lineno="992"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="_se_file_log_8h_1a83f3fe470b91cb8eed8762cc8e5e26c3" kindref="member">SeLogInfo</ref>(<sp/></highlight><highlight class="stringliteral">&quot;Second:DoRaceOver&lt;&lt;MapID[%s]Session[%u]Camp[%d]Ply[%u]ReturnTown[%s]&quot;</highlight><highlight class="normal">,<ref refid="_se_tool_8h_1ada81d4ae5d39c42af0a02b45f4a6f715" kindref="member">GetID2Str</ref>(pkRace-&gt;<ref refid="struct_se_match_race_1a5c7ab2cd8f14bbfa4bfd87f2bbb624f9" kindref="member">dwMapID</ref>),<sp/>pkRace-&gt;<ref refid="struct_se_match_race_1a8523887086f21641745b808f82cc1828" kindref="member">dwMatchSession</ref>,<sp/></highlight></codeline>
<codeline lineno="993"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>rkRacePlayer.<ref refid="struct_se_race_player_1ad9851bb0940139ae58a6b6ff561bed43" kindref="member">eCamp</ref>,<sp/>rkRacePlayer.<ref refid="struct_se_race_player_1a1562e06b4a18a384dc8b152668a9c62f" kindref="member">dwPlayerID</ref>,<sp/><ref refid="_se_tool_8h_1ada81d4ae5d39c42af0a02b45f4a6f715" kindref="member">GetID2Str</ref>(rkRacePlayer.<ref refid="struct_se_race_player_1ac5601dda3e2dfc69b74649cbbfe6e141" kindref="member">kTownSign</ref>.<ref refid="struct_h_town_sign_1aad795425c3c60114ef0578356b339d2c" kindref="member">dwServerID</ref>));</highlight></codeline>
<codeline lineno="994"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="995"><highlight class="normal"><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="996"><highlight class="normal">}</highlight></codeline>
<codeline lineno="997"><highlight class="normal"></highlight></codeline>
<codeline lineno="998"><highlight class="normal"></highlight><highlight class="keywordtype">void</highlight><highlight class="normal"><sp/><ref refid="class_se_race_mgr_1a110c81b7444d524500f527f553a661a5" kindref="member">SeRaceMgr::RaceUpdate</ref>(DWord<sp/>dwServerTime)</highlight></codeline>
<codeline lineno="999"><highlight class="normal">{</highlight></codeline>
<codeline lineno="1000"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">for</highlight><highlight class="normal">(<ref refid="_match_server_2_src_2_se_race_mgr_def_8h_1ae8205488e760719ced167c20fd921ef4" kindref="member">MRaceIter</ref><sp/>kItr<sp/>=<sp/><ref refid="class_se_race_mgr_1ad346a0191bf14a69de9422c1fd03b301" kindref="member">m_kMRace</ref>.begin();kItr<sp/>!=<sp/><ref refid="class_se_race_mgr_1ad346a0191bf14a69de9422c1fd03b301" kindref="member">m_kMRace</ref>.end();)</highlight></codeline>
<codeline lineno="1001"><highlight class="normal"><sp/><sp/><sp/><sp/>{</highlight></codeline>
<codeline lineno="1002"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="struct_se_match_race" kindref="compound">SeMatchRace</ref>*<sp/>pkRace<sp/>=<sp/>kItr-&gt;second;</highlight></codeline>
<codeline lineno="1003"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal">(!pkRace)</highlight></codeline>
<codeline lineno="1004"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>{</highlight></codeline>
<codeline lineno="1005"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>++kItr;</highlight></codeline>
<codeline lineno="1006"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">continue</highlight><highlight class="normal">;</highlight></codeline>
<codeline lineno="1007"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="1008"><highlight class="normal"></highlight></codeline>
<codeline lineno="1009"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal">(pkRace-&gt;<ref refid="struct_se_match_race_1a3a9af85294d2e4f80524c28c498324b1" kindref="member">eRaceState</ref><sp/>==<sp/><ref refid="_match_server_2_src_2_se_race_mgr_def_8h_1a3f0f87c08c5c7566ba4e99c73d523f20a57a7cb033f87b9a0ef067cff9cab9322" kindref="member">SMRS_LOAD</ref>)</highlight></codeline>
<codeline lineno="1010"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>{</highlight></codeline>
<codeline lineno="1011"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal">(pkRace-&gt;<ref refid="struct_se_match_race_1ae0e7766eee9aa76f30450689370bd2a3" kindref="member">bAllLoad</ref>)</highlight></codeline>
<codeline lineno="1012"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>{</highlight></codeline>
<codeline lineno="1013"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal">(!<ref refid="class_se_race_mgr_1a70a11c10dd853739814641c8cd5d1d50" kindref="member">GetRacingSvr</ref>(pkRace))</highlight></codeline>
<codeline lineno="1014"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>{</highlight></codeline>
<codeline lineno="1015"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">//<sp/>fixme:</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="1016"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="_se_file_log_8h_1a59fe2018c00666084724bec1365b41f5" kindref="member">SeLogError</ref>(</highlight><highlight class="stringliteral">&quot;CreateRace<sp/>Failed&lt;&lt;GetRacingSvr<sp/>Failed!&quot;</highlight><highlight class="normal">,1);</highlight></codeline>
<codeline lineno="1017"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="class_se_race_mgr_1aed313cc17a805bea5daeb0366013bae6" kindref="member">SendMatchCommMsg</ref>(pkRace,<sp/><ref refid="_se_ptl_define_8h_1a05bc9da3a865896a10de16ae1763a5baa71853bae867c3f91cfcbd95d2fe2081b" kindref="member">SCMM_NOTIFY_LOAD_FAILED</ref>);</highlight></codeline>
<codeline lineno="1018"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="_src_2_se_race_query_mgr_8cpp_1a57ccbe85ab92907667a84b975fab68e1" kindref="member">g_kRaceQueryMgr</ref>.<ref refid="class_se_race_query_mgr_1a2fb929c386139e11b4090b851952e00d" kindref="member">OnDestroyRoom</ref>(pkRace-&gt;<ref refid="struct_se_match_race_1a2b2ba94026424d343fd55b9308b49c38" kindref="member">iRoomIndex</ref>,<sp/>pkRace-&gt;<ref refid="struct_se_match_race_1a8523887086f21641745b808f82cc1828" kindref="member">dwMatchSession</ref>);</highlight></codeline>
<codeline lineno="1019"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>SeMatchRace::DEL(pkRace);</highlight></codeline>
<codeline lineno="1020"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="class_se_race_mgr_1ad346a0191bf14a69de9422c1fd03b301" kindref="member">m_kMRace</ref>.erase(kItr++);</highlight></codeline>
<codeline lineno="1021"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">continue</highlight><highlight class="normal">;</highlight></codeline>
<codeline lineno="1022"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="1023"><highlight class="normal"></highlight></codeline>
<codeline lineno="1024"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="_se_ptl_define_8h_1a8eca7bda0a54efc38fadd9448b7947f9" kindref="member">VMatchRaceInfo</ref><sp/>akMatchRaceInfo;</highlight></codeline>
<codeline lineno="1025"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>pkRace-&gt;<ref refid="struct_se_match_race_1a6766acda61038d049284862620a2384f" kindref="member">GetMatchRaceInfo</ref>(akMatchRaceInfo);</highlight></codeline>
<codeline lineno="1026"><highlight class="normal"></highlight></codeline>
<codeline lineno="1027"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="struct_se_ptl_race_bet_info" kindref="compound">SePtlRaceBetInfo</ref><sp/>kRaceBet;</highlight></codeline>
<codeline lineno="1028"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="_src_2_match_server_8cpp_1a1cd9d6d0396497f8a9d48e44d672f368" kindref="member">g_kMatchServer</ref>.<ref refid="class_match_server_1a410ee319d1b1eb0b1ea7d4b06734ef73" kindref="member">GetRaceBetInfo</ref>(kRaceBet);</highlight></codeline>
<codeline lineno="1029"><highlight class="normal"></highlight></codeline>
<codeline lineno="1030"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>HSock<sp/>kRaceSock<sp/>=<sp/><ref refid="class_se_race_mgr_1a220a9a7426ccd94670119a48ab0cb56c" kindref="member">GetRaceSvrSock</ref>(pkRace-&gt;<ref refid="struct_se_match_race_1ac5807e52b290fa9cbf27bbe2cff05e1e" kindref="member">kRaceTownSign</ref>);</highlight></codeline>
<codeline lineno="1031"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal">(!kRaceSock.IsInvalid())</highlight></codeline>
<codeline lineno="1032"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>{</highlight></codeline>
<codeline lineno="1033"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="_src_2_match_server_8cpp_1a1cd9d6d0396497f8a9d48e44d672f368" kindref="member">g_kMatchServer</ref>.<ref refid="class_match_server_1a7e4345ea3c4553d5a4458376c99edbd2" kindref="member">OnSendRSValidatePlayerInfo</ref>(kRaceSock,<sp/>pkRace,<sp/></highlight><highlight class="keyword">false</highlight><highlight class="normal">,<sp/>kRaceBet,<sp/>akMatchRaceInfo);</highlight></codeline>
<codeline lineno="1034"><highlight class="normal"></highlight></codeline>
<codeline lineno="1035"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>pkRace-&gt;<ref refid="struct_se_match_race_1a3a9af85294d2e4f80524c28c498324b1" kindref="member">eRaceState</ref><sp/>=<sp/><ref refid="_match_server_2_src_2_se_race_mgr_def_8h_1a3f0f87c08c5c7566ba4e99c73d523f20a6d5af9dd76bb39f44817b6a2dde8b7ef" kindref="member">SMRS_VALIDATE</ref>;</highlight></codeline>
<codeline lineno="1036"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>pkRace-&gt;<ref refid="struct_se_match_race_1ac98eae2e335d69e4acbf6f7f869f8ef3" kindref="member">dwLastRecvTime</ref><sp/>=<sp/>dwServerTime;</highlight></codeline>
<codeline lineno="1037"><highlight class="normal"></highlight></codeline>
<codeline lineno="1038"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="_se_file_log_8h_1a83f3fe470b91cb8eed8762cc8e5e26c3" kindref="member">SeLogInfo</ref>(</highlight><highlight class="stringliteral">&quot;RaceBegin&lt;&lt;RSAreaId[%u]SvrId[%s]<sp/>MapID[%s]Session[%u]num[%d]&quot;</highlight><highlight class="normal">,pkRace-&gt;<ref refid="struct_se_match_race_1ac5807e52b290fa9cbf27bbe2cff05e1e" kindref="member">kRaceTownSign</ref>.<ref refid="struct_h_town_sign_1ad2078fab8662517a20a8c8702861c430" kindref="member">dwAreaID</ref>,</highlight></codeline>
<codeline lineno="1039"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="_se_tool_8h_1ada81d4ae5d39c42af0a02b45f4a6f715" kindref="member">GetID2Str</ref>(pkRace-&gt;<ref refid="struct_se_match_race_1ac5807e52b290fa9cbf27bbe2cff05e1e" kindref="member">kRaceTownSign</ref>.<ref refid="struct_h_town_sign_1aad795425c3c60114ef0578356b339d2c" kindref="member">dwServerID</ref>),<ref refid="_se_tool_8h_1ada81d4ae5d39c42af0a02b45f4a6f715" kindref="member">GetID2Str</ref>(pkRace-&gt;<ref refid="struct_se_match_race_1a5c7ab2cd8f14bbfa4bfd87f2bbb624f9" kindref="member">dwMapID</ref>),pkRace-&gt;<ref refid="struct_se_match_race_1a8523887086f21641745b808f82cc1828" kindref="member">dwMatchSession</ref>,(</highlight><highlight class="keywordtype">int</highlight><highlight class="normal">)pkRace-&gt;<ref refid="struct_se_match_race_1a1f51c90f643641518fc163f150a11419" kindref="member">akMRacePlayer</ref>.size());</highlight></codeline>
<codeline lineno="1040"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="1041"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="1042"><highlight class="normal"></highlight></codeline>
<codeline lineno="1043"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">//<sp/>10</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="1044"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal">((dwServerTime<sp/>-<sp/>pkRace-&gt;<ref refid="struct_se_match_race_1ac98eae2e335d69e4acbf6f7f869f8ef3" kindref="member">dwLastRecvTime</ref>)<sp/>&gt;<sp/>10<sp/>*<sp/>1000)</highlight></codeline>
<codeline lineno="1045"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>{</highlight></codeline>
<codeline lineno="1046"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="_se_file_log_8h_1a59fe2018c00666084724bec1365b41f5" kindref="member">SeLogError</ref>(</highlight><highlight class="stringliteral">&quot;CreateRace<sp/>Failed&lt;&lt;wait<sp/>over<sp/>10<sp/>min!&quot;</highlight><highlight class="normal">,<sp/>1);</highlight></codeline>
<codeline lineno="1047"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="class_se_race_mgr_1aed313cc17a805bea5daeb0366013bae6" kindref="member">SendMatchCommMsg</ref>(pkRace,<ref refid="_se_ptl_define_8h_1a05bc9da3a865896a10de16ae1763a5baa71853bae867c3f91cfcbd95d2fe2081b" kindref="member">SCMM_NOTIFY_LOAD_FAILED</ref>);</highlight></codeline>
<codeline lineno="1048"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="_src_2_se_race_query_mgr_8cpp_1a57ccbe85ab92907667a84b975fab68e1" kindref="member">g_kRaceQueryMgr</ref>.<ref refid="class_se_race_query_mgr_1a2fb929c386139e11b4090b851952e00d" kindref="member">OnDestroyRoom</ref>(pkRace-&gt;<ref refid="struct_se_match_race_1a2b2ba94026424d343fd55b9308b49c38" kindref="member">iRoomIndex</ref>,<sp/>pkRace-&gt;<ref refid="struct_se_match_race_1a8523887086f21641745b808f82cc1828" kindref="member">dwMatchSession</ref>);</highlight></codeline>
<codeline lineno="1049"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>SeMatchRace::DEL(pkRace);</highlight></codeline>
<codeline lineno="1050"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="class_se_race_mgr_1ad346a0191bf14a69de9422c1fd03b301" kindref="member">m_kMRace</ref>.erase(kItr++);</highlight></codeline>
<codeline lineno="1051"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">continue</highlight><highlight class="normal">;</highlight></codeline>
<codeline lineno="1052"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="1053"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="1054"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">else</highlight><highlight class="normal"><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal">(pkRace-&gt;<ref refid="struct_se_match_race_1a3a9af85294d2e4f80524c28c498324b1" kindref="member">eRaceState</ref><sp/>==<sp/><ref refid="_match_server_2_src_2_se_race_mgr_def_8h_1a3f0f87c08c5c7566ba4e99c73d523f20a073935cf9b37d59db9ab24d14ad45935" kindref="member">SMRS_RACE_OVER</ref>)</highlight></codeline>
<codeline lineno="1055"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>{</highlight></codeline>
<codeline lineno="1056"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">//<sp/></highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="1057"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal">((dwServerTime<sp/>-<sp/>pkRace-&gt;<ref refid="struct_se_match_race_1ac98eae2e335d69e4acbf6f7f869f8ef3" kindref="member">dwLastRecvTime</ref>)<sp/>&gt;<sp/>60<sp/>*<sp/>1000)</highlight></codeline>
<codeline lineno="1058"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>{</highlight></codeline>
<codeline lineno="1059"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="_se_file_log_8h_1a83f3fe470b91cb8eed8762cc8e5e26c3" kindref="member">SeLogInfo</ref>(</highlight><highlight class="stringliteral">&quot;RaceEnd&lt;&lt;MapID[%s]Session[%u]Town[%s]&quot;</highlight><highlight class="normal">,<ref refid="_se_tool_8h_1ada81d4ae5d39c42af0a02b45f4a6f715" kindref="member">GetID2Str</ref>(pkRace-&gt;<ref refid="struct_se_match_race_1a5c7ab2cd8f14bbfa4bfd87f2bbb624f9" kindref="member">dwMapID</ref>),pkRace-&gt;<ref refid="struct_se_match_race_1a8523887086f21641745b808f82cc1828" kindref="member">dwMatchSession</ref>,<ref refid="_se_tool_8h_1ada81d4ae5d39c42af0a02b45f4a6f715" kindref="member">GetID2Str</ref>(pkRace-&gt;<ref refid="struct_se_match_race_1ac5807e52b290fa9cbf27bbe2cff05e1e" kindref="member">kRaceTownSign</ref>.<ref refid="struct_h_town_sign_1aad795425c3c60114ef0578356b339d2c" kindref="member">dwServerID</ref>));</highlight></codeline>
<codeline lineno="1060"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>SeMatchRace::DEL(pkRace);</highlight></codeline>
<codeline lineno="1061"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="class_se_race_mgr_1ad346a0191bf14a69de9422c1fd03b301" kindref="member">m_kMRace</ref>.erase(kItr++);</highlight></codeline>
<codeline lineno="1062"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">continue</highlight><highlight class="normal">;</highlight></codeline>
<codeline lineno="1063"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="1064"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="1065"><highlight class="normal"></highlight></codeline>
<codeline lineno="1066"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">//<sp/>150</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="1067"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal">((dwServerTime<sp/>-<sp/>pkRace-&gt;<ref refid="struct_se_match_race_1ac98eae2e335d69e4acbf6f7f869f8ef3" kindref="member">dwLastRecvTime</ref>)<sp/>&gt;<sp/>150<sp/>*<sp/>60<sp/>*<sp/>1000)</highlight></codeline>
<codeline lineno="1068"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>{</highlight></codeline>
<codeline lineno="1069"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="_src_2_se_race_query_mgr_8cpp_1a57ccbe85ab92907667a84b975fab68e1" kindref="member">g_kRaceQueryMgr</ref>.<ref refid="class_se_race_query_mgr_1a2fb929c386139e11b4090b851952e00d" kindref="member">OnDestroyRoom</ref>(pkRace-&gt;<ref refid="struct_se_match_race_1a2b2ba94026424d343fd55b9308b49c38" kindref="member">iRoomIndex</ref>,<sp/>pkRace-&gt;<ref refid="struct_se_match_race_1a8523887086f21641745b808f82cc1828" kindref="member">dwMatchSession</ref>);</highlight></codeline>
<codeline lineno="1070"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>SeMatchRace::DEL(pkRace);</highlight></codeline>
<codeline lineno="1071"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="class_se_race_mgr_1ad346a0191bf14a69de9422c1fd03b301" kindref="member">m_kMRace</ref>.erase(kItr++);</highlight></codeline>
<codeline lineno="1072"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">continue</highlight><highlight class="normal">;</highlight></codeline>
<codeline lineno="1073"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="1074"><highlight class="normal"></highlight></codeline>
<codeline lineno="1075"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>++kItr;</highlight></codeline>
<codeline lineno="1076"><highlight class="normal"><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="1077"><highlight class="normal">}</highlight></codeline>
<codeline lineno="1078"><highlight class="normal"></highlight></codeline>
<codeline lineno="1079"><highlight class="normal"></highlight><highlight class="keywordtype">void</highlight><highlight class="normal"><sp/><sp/><ref refid="class_se_race_mgr_1a7c5f29d4907cb2df67da3642cdefe371" kindref="member">SeRaceMgr::ValidWaitUpdate</ref>(DWord<sp/>dwServerTime)</highlight></codeline>
<codeline lineno="1080"><highlight class="normal">{</highlight></codeline>
<codeline lineno="1081"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">for</highlight><highlight class="normal"><sp/>(MWaitValidPlayer::iterator<sp/>itr<sp/>=<sp/><ref refid="class_se_race_mgr_1aef4c8f4087ebc261a26cc362d5e94279" kindref="member">m_kMWaitValidPlayer</ref>.begin();<sp/>itr<sp/>!=<sp/><ref refid="class_se_race_mgr_1aef4c8f4087ebc261a26cc362d5e94279" kindref="member">m_kMWaitValidPlayer</ref>.end();)</highlight></codeline>
<codeline lineno="1082"><highlight class="normal"><sp/><sp/><sp/><sp/>{</highlight></codeline>
<codeline lineno="1083"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="struct_se_wait_valid_player" kindref="compound">SeWaitValidPlayer</ref>*<sp/>pkPlayer<sp/>=<sp/>itr-&gt;second;</highlight></codeline>
<codeline lineno="1084"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(!pkPlayer)</highlight></codeline>
<codeline lineno="1085"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>{</highlight></codeline>
<codeline lineno="1086"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="class_se_race_mgr_1aef4c8f4087ebc261a26cc362d5e94279" kindref="member">m_kMWaitValidPlayer</ref>.erase(itr++);</highlight></codeline>
<codeline lineno="1087"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">continue</highlight><highlight class="normal">;</highlight></codeline>
<codeline lineno="1088"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="1089"><highlight class="normal"></highlight></codeline>
<codeline lineno="1090"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">//<sp/>15</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="1091"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>((dwServerTime<sp/>-<sp/>pkPlayer-&gt;<ref refid="struct_se_wait_valid_player_1a8b86a3dd0fb861250095d75f0f83f833" kindref="member">dwCreateTime</ref>)<sp/>&gt;<sp/>15000)</highlight></codeline>
<codeline lineno="1092"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>{</highlight></codeline>
<codeline lineno="1093"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">//SeMatchRace*<sp/>pkRace<sp/>=<sp/>GetRace(pkPlayer-&gt;dwSession);</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="1094"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">//if<sp/>(pkRace)</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="1095"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">//{</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="1096"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">//<sp/><sp/>pkRace-&gt;akReconSeat.erase(pkPlayer-&gt;iSeat);</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="1097"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">//}</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="1098"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>SeWaitValidPlayer::DEL(pkPlayer);</highlight></codeline>
<codeline lineno="1099"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="class_se_race_mgr_1aef4c8f4087ebc261a26cc362d5e94279" kindref="member">m_kMWaitValidPlayer</ref>.erase(itr++);</highlight></codeline>
<codeline lineno="1100"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">continue</highlight><highlight class="normal">;</highlight></codeline>
<codeline lineno="1101"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="1102"><highlight class="normal"></highlight></codeline>
<codeline lineno="1103"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>++itr;</highlight></codeline>
<codeline lineno="1104"><highlight class="normal"><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="1105"><highlight class="normal">}</highlight></codeline>
<codeline lineno="1106"><highlight class="normal"></highlight></codeline>
<codeline lineno="1107"><highlight class="normal"><ref refid="struct_se_match_race" kindref="compound">SeMatchRace</ref>*<sp/><ref refid="class_se_race_mgr_1afc891150076c0efc650aa8989cbe9fd8" kindref="member">SeRaceMgr::GetRace</ref>(DWord<sp/>dwSession)</highlight></codeline>
<codeline lineno="1108"><highlight class="normal">{</highlight></codeline>
<codeline lineno="1109"><highlight class="normal"><sp/><sp/><sp/><sp/><ref refid="_match_server_2_src_2_se_race_mgr_def_8h_1ae8205488e760719ced167c20fd921ef4" kindref="member">MRaceIter</ref><sp/>kItr<sp/>=<sp/><ref refid="class_se_race_mgr_1ad346a0191bf14a69de9422c1fd03b301" kindref="member">m_kMRace</ref>.find(dwSession);</highlight></codeline>
<codeline lineno="1110"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal">(kItr<sp/>!=<sp/><ref refid="class_se_race_mgr_1ad346a0191bf14a69de9422c1fd03b301" kindref="member">m_kMRace</ref>.end())</highlight></codeline>
<codeline lineno="1111"><highlight class="normal"><sp/><sp/><sp/><sp/>{</highlight></codeline>
<codeline lineno="1112"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/>kItr-&gt;second;</highlight></codeline>
<codeline lineno="1113"><highlight class="normal"><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="1114"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/>NULL;</highlight></codeline>
<codeline lineno="1115"><highlight class="normal">}</highlight></codeline>
<codeline lineno="1116"><highlight class="normal"></highlight></codeline>
<codeline lineno="1117"><highlight class="normal"></highlight><highlight class="comment">//<sp/>fixme</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="1118"><highlight class="normal"><ref refid="struct_se_match_race" kindref="compound">SeMatchRace</ref>*<sp/><ref refid="class_se_race_mgr_1a211300f8529cff28321250404412fe14" kindref="member">SeRaceMgr::GetRaceByPlayerID</ref>(DWord<sp/>dwPlayerID)</highlight></codeline>
<codeline lineno="1119"><highlight class="normal">{</highlight></codeline>
<codeline lineno="1120"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">for</highlight><highlight class="normal"><sp/>(<ref refid="_match_server_2_src_2_se_race_mgr_def_8h_1ae8205488e760719ced167c20fd921ef4" kindref="member">MRaceIter</ref><sp/>itr<sp/>=<sp/><ref refid="class_se_race_mgr_1ad346a0191bf14a69de9422c1fd03b301" kindref="member">m_kMRace</ref>.begin();<sp/>itr<sp/>!=<sp/><ref refid="class_se_race_mgr_1ad346a0191bf14a69de9422c1fd03b301" kindref="member">m_kMRace</ref>.end();<sp/>++itr)</highlight></codeline>
<codeline lineno="1121"><highlight class="normal"><sp/><sp/><sp/><sp/>{</highlight></codeline>
<codeline lineno="1122"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="struct_se_match_race" kindref="compound">SeMatchRace</ref>*<sp/>pkRace<sp/>=<sp/>itr-&gt;second;</highlight></codeline>
<codeline lineno="1123"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(!pkRace)</highlight></codeline>
<codeline lineno="1124"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>{</highlight></codeline>
<codeline lineno="1125"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">continue</highlight><highlight class="normal">;</highlight></codeline>
<codeline lineno="1126"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="1127"><highlight class="normal"></highlight></codeline>
<codeline lineno="1128"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="_match_server_2_src_2_se_race_mgr_def_8h_1ab101f4de5df82aa4152f3bb13da3b518" kindref="member">MRacePlayer</ref>&amp;<sp/>rkMPlayer<sp/>=<sp/>pkRace-&gt;<ref refid="struct_se_match_race_1a1f51c90f643641518fc163f150a11419" kindref="member">akMRacePlayer</ref>;</highlight></codeline>
<codeline lineno="1129"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">for</highlight><highlight class="normal"><sp/>(MRacePlayer::iterator<sp/>itrM<sp/>=<sp/>rkMPlayer.begin();<sp/>itrM<sp/>!=<sp/>rkMPlayer.end();<sp/>++itrM)</highlight></codeline>
<codeline lineno="1130"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>{</highlight></codeline>
<codeline lineno="1131"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="struct_se_race_player" kindref="compound">SeRacePlayer</ref>&amp;<sp/>rkPlayer<sp/>=<sp/>itrM-&gt;second;</highlight></codeline>
<codeline lineno="1132"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(rkPlayer.<ref refid="struct_se_race_player_1a1562e06b4a18a384dc8b152668a9c62f" kindref="member">dwPlayerID</ref><sp/>==<sp/>dwPlayerID)</highlight></codeline>
<codeline lineno="1133"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>{</highlight></codeline>
<codeline lineno="1134"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/>pkRace;</highlight></codeline>
<codeline lineno="1135"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="1136"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="1137"><highlight class="normal"><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="1138"><highlight class="normal"></highlight></codeline>
<codeline lineno="1139"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/>NULL;</highlight></codeline>
<codeline lineno="1140"><highlight class="normal">}</highlight></codeline>
<codeline lineno="1141"><highlight class="normal"></highlight></codeline>
<codeline lineno="1142"><highlight class="normal"></highlight><highlight class="keywordtype">void</highlight><highlight class="normal"><sp/><ref refid="class_se_race_mgr_1a0ef051a10db4ce03c09723c3dcd5ce83" kindref="member">SeRaceMgr::DelRace</ref>(DWord<sp/>dwSession)</highlight></codeline>
<codeline lineno="1143"><highlight class="normal">{</highlight></codeline>
<codeline lineno="1144"><highlight class="normal"><sp/><sp/><sp/><sp/><ref refid="_match_server_2_src_2_se_race_mgr_def_8h_1ae8205488e760719ced167c20fd921ef4" kindref="member">MRaceIter</ref><sp/>kItr<sp/>=<sp/><ref refid="class_se_race_mgr_1ad346a0191bf14a69de9422c1fd03b301" kindref="member">m_kMRace</ref>.find(dwSession);</highlight></codeline>
<codeline lineno="1145"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal">(kItr<sp/>!=<sp/><ref refid="class_se_race_mgr_1ad346a0191bf14a69de9422c1fd03b301" kindref="member">m_kMRace</ref>.end())</highlight></codeline>
<codeline lineno="1146"><highlight class="normal"><sp/><sp/><sp/><sp/>{</highlight></codeline>
<codeline lineno="1147"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="struct_se_match_race" kindref="compound">SeMatchRace</ref>*<sp/>pkRace<sp/>=<sp/>kItr-&gt;second;</highlight></codeline>
<codeline lineno="1148"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="_src_2_se_race_query_mgr_8cpp_1a57ccbe85ab92907667a84b975fab68e1" kindref="member">g_kRaceQueryMgr</ref>.<ref refid="class_se_race_query_mgr_1a2fb929c386139e11b4090b851952e00d" kindref="member">OnDestroyRoom</ref>(pkRace-&gt;<ref refid="struct_se_match_race_1a2b2ba94026424d343fd55b9308b49c38" kindref="member">iRoomIndex</ref>,<sp/>pkRace-&gt;<ref refid="struct_se_match_race_1a8523887086f21641745b808f82cc1828" kindref="member">dwMatchSession</ref>);</highlight></codeline>
<codeline lineno="1149"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>SeMatchRace::DEL(pkRace);</highlight></codeline>
<codeline lineno="1150"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="class_se_race_mgr_1ad346a0191bf14a69de9422c1fd03b301" kindref="member">m_kMRace</ref>.erase(kItr);</highlight></codeline>
<codeline lineno="1151"><highlight class="normal"><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="1152"><highlight class="normal">}</highlight></codeline>
<codeline lineno="1153"><highlight class="normal"></highlight></codeline>
<codeline lineno="1154"><highlight class="normal"></highlight><highlight class="keywordtype">bool</highlight><highlight class="normal"><sp/><ref refid="class_se_race_mgr_1ac7e8ac9a9c03baf8c26ce6d4cd0142e6" kindref="member">SeRaceMgr::CheckMatchedRoomNum</ref>(</highlight><highlight class="keyword">const</highlight><highlight class="normal"><sp/><ref refid="struct_map_info_table" kindref="compound">MapInfoTable</ref>*<sp/>pkMapInfo,<sp/></highlight><highlight class="keywordtype">int</highlight><highlight class="normal"><sp/>iRoomNum,<sp/></highlight><highlight class="keywordtype">int</highlight><highlight class="normal"><sp/>iCampNum)</highlight></codeline>
<codeline lineno="1155"><highlight class="normal">{</highlight></codeline>
<codeline lineno="1156"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(!pkMapInfo<sp/>||<sp/>iRoomNum<sp/>&lt;=<sp/>0<sp/>||<sp/>iCampNum<sp/>&lt;=<sp/>0)</highlight></codeline>
<codeline lineno="1157"><highlight class="normal"><sp/><sp/><sp/><sp/>{</highlight></codeline>
<codeline lineno="1158"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/></highlight><highlight class="keyword">false</highlight><highlight class="normal">;</highlight></codeline>
<codeline lineno="1159"><highlight class="normal"><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="1160"><highlight class="normal"></highlight></codeline>
<codeline lineno="1161"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(pkMapInfo-&gt;<ref refid="struct_map_info_table_1af695ae74b8a96c5398ae5178f57b8693" kindref="member">uiMapTypeID</ref><sp/>==<sp/><ref refid="_se_ptl_comm_define_8h_1af62c3a00672953c86a2586d53c60663aa474d23812464d8e9c363423dfc253da6" kindref="member">SSD_LUANDOU_MAP</ref>)</highlight></codeline>
<codeline lineno="1162"><highlight class="normal"><sp/><sp/><sp/><sp/>{</highlight></codeline>
<codeline lineno="1163"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/></highlight><highlight class="keyword">true</highlight><highlight class="normal">;</highlight></codeline>
<codeline lineno="1164"><highlight class="normal"><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="1165"><highlight class="normal"></highlight></codeline>
<codeline lineno="1166"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>((pkMapInfo-&gt;<ref refid="struct_map_info_table_1a499e92e05e58a63185598cae78cd97db" kindref="member">uiProperty</ref><sp/>&amp;<sp/><ref refid="_map_info__table_8hpp_1a22fc8e4fc4fe78bf457b9ddc7a9f75f1a6ac56a6a6d0c575ed98b55d7c5461f74" kindref="member">MAPINFO_PROPERTY_BOSSPLAY</ref>)<sp/>==<sp/><ref refid="_map_info__table_8hpp_1a22fc8e4fc4fe78bf457b9ddc7a9f75f1a6ac56a6a6d0c575ed98b55d7c5461f74" kindref="member">MAPINFO_PROPERTY_BOSSPLAY</ref>)</highlight></codeline>
<codeline lineno="1167"><highlight class="normal"><sp/><sp/><sp/><sp/>{</highlight></codeline>
<codeline lineno="1168"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(iRoomNum<sp/>!=<sp/>iCampNum<sp/>&amp;&amp;<sp/>iRoomNum<sp/>!=<sp/>iCampNum<sp/>+<sp/>1)</highlight></codeline>
<codeline lineno="1169"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>{</highlight></codeline>
<codeline lineno="1170"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/></highlight><highlight class="keyword">false</highlight><highlight class="normal">;</highlight></codeline>
<codeline lineno="1171"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="1172"><highlight class="normal"><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="1173"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">else</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="1174"><highlight class="normal"><sp/><sp/><sp/><sp/>{</highlight></codeline>
<codeline lineno="1175"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">//<sp/>fixme</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="1176"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(iRoomNum<sp/>&gt;<sp/>iCampNum)</highlight></codeline>
<codeline lineno="1177"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>{</highlight></codeline>
<codeline lineno="1178"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/></highlight><highlight class="keyword">false</highlight><highlight class="normal">;</highlight></codeline>
<codeline lineno="1179"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="1180"><highlight class="normal"><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="1181"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight></codeline>
<codeline lineno="1182"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/></highlight><highlight class="keyword">true</highlight><highlight class="normal">;</highlight></codeline>
<codeline lineno="1183"><highlight class="normal">}</highlight></codeline>
<codeline lineno="1184"><highlight class="normal"></highlight></codeline>
<codeline lineno="1185"><highlight class="normal"></highlight><highlight class="keywordtype">bool</highlight><highlight class="normal"><sp/><ref refid="class_se_race_mgr_1ac84f1630bd2542dba13f04f6ec97ff5a" kindref="member">SeRaceMgr::CheckMatchedPlayerNum</ref>(</highlight><highlight class="keyword">const</highlight><highlight class="normal"><sp/><ref refid="struct_map_info_table" kindref="compound">MapInfoTable</ref>*<sp/>pkMapInfo,<sp/></highlight><highlight class="keywordtype">int</highlight><highlight class="normal"><sp/>iRacePlayers,<sp/></highlight><highlight class="keywordtype">int</highlight><highlight class="normal"><sp/>iCampPlayers,<sp/></highlight><highlight class="keywordtype">int</highlight><highlight class="normal"><sp/>iCamp)</highlight></codeline>
<codeline lineno="1186"><highlight class="normal">{</highlight></codeline>
<codeline lineno="1187"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(!pkMapInfo<sp/>||<sp/>iRacePlayers<sp/>&lt;=<sp/>0<sp/>||<sp/>iCampPlayers<sp/>&lt;=<sp/>0)</highlight></codeline>
<codeline lineno="1188"><highlight class="normal"><sp/><sp/><sp/><sp/>{</highlight></codeline>
<codeline lineno="1189"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/></highlight><highlight class="keyword">false</highlight><highlight class="normal">;</highlight></codeline>
<codeline lineno="1190"><highlight class="normal"><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="1191"><highlight class="normal"></highlight></codeline>
<codeline lineno="1192"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(pkMapInfo-&gt;<ref refid="struct_map_info_table_1af695ae74b8a96c5398ae5178f57b8693" kindref="member">uiMapTypeID</ref><sp/>==<sp/><ref refid="_se_ptl_comm_define_8h_1af62c3a00672953c86a2586d53c60663aa474d23812464d8e9c363423dfc253da6" kindref="member">SSD_LUANDOU_MAP</ref>)</highlight></codeline>
<codeline lineno="1193"><highlight class="normal"><sp/><sp/><sp/><sp/>{</highlight></codeline>
<codeline lineno="1194"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/></highlight><highlight class="keyword">true</highlight><highlight class="normal">;</highlight></codeline>
<codeline lineno="1195"><highlight class="normal"><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="1196"><highlight class="normal"></highlight></codeline>
<codeline lineno="1197"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(((pkMapInfo-&gt;<ref refid="struct_map_info_table_1a499e92e05e58a63185598cae78cd97db" kindref="member">uiProperty</ref><sp/>&amp;<sp/><ref refid="_map_info__table_8hpp_1a22fc8e4fc4fe78bf457b9ddc7a9f75f1a6ac56a6a6d0c575ed98b55d7c5461f74" kindref="member">MAPINFO_PROPERTY_BOSSPLAY</ref>)<sp/>==<sp/><ref refid="_map_info__table_8hpp_1a22fc8e4fc4fe78bf457b9ddc7a9f75f1a6ac56a6a6d0c575ed98b55d7c5461f74" kindref="member">MAPINFO_PROPERTY_BOSSPLAY</ref>))</highlight></codeline>
<codeline lineno="1198"><highlight class="normal"><sp/><sp/><sp/><sp/>{</highlight></codeline>
<codeline lineno="1199"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(iRacePlayers<sp/>!=<sp/>iCampPlayers<sp/>&amp;&amp;<sp/>iRacePlayers<sp/>!=<sp/>iCampPlayers<sp/>+<sp/>1)</highlight></codeline>
<codeline lineno="1200"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>{</highlight></codeline>
<codeline lineno="1201"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/></highlight><highlight class="keyword">false</highlight><highlight class="normal">;</highlight></codeline>
<codeline lineno="1202"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="1203"><highlight class="normal"><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="1204"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">else</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="1205"><highlight class="normal"><sp/><sp/><sp/><sp/>{</highlight></codeline>
<codeline lineno="1206"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">//<sp/>fixme</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="1207"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(iRacePlayers<sp/>&gt;<sp/>(iCamp<sp/>-<sp/>1)<sp/>*<sp/>iCampPlayers)</highlight></codeline>
<codeline lineno="1208"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>{</highlight></codeline>
<codeline lineno="1209"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/></highlight><highlight class="keyword">false</highlight><highlight class="normal">;</highlight></codeline>
<codeline lineno="1210"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="1211"><highlight class="normal"><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="1212"><highlight class="normal"></highlight></codeline>
<codeline lineno="1213"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/></highlight><highlight class="keyword">true</highlight><highlight class="normal">;</highlight></codeline>
<codeline lineno="1214"><highlight class="normal">}</highlight></codeline>
<codeline lineno="1215"><highlight class="normal"></highlight></codeline>
<codeline lineno="1216"><highlight class="normal"></highlight></codeline>
<codeline lineno="1217"><highlight class="normal">DWord<sp/><ref refid="class_se_race_mgr_1a71f19caa1f9b999539298346bdd387a6" kindref="member">SeRaceMgr::GenSession</ref>()</highlight></codeline>
<codeline lineno="1218"><highlight class="normal">{</highlight></codeline>
<codeline lineno="1219"><highlight class="normal"><sp/><sp/><sp/><sp/>++<ref refid="class_se_race_mgr_1ae09f45af005d7cb2e482fec7ba22c3e2" kindref="member">m_dwGenID</ref>;</highlight></codeline>
<codeline lineno="1220"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal">(<ref refid="class_se_race_mgr_1ae09f45af005d7cb2e482fec7ba22c3e2" kindref="member">m_dwGenID</ref><sp/>&gt;<sp/>9999999)</highlight></codeline>
<codeline lineno="1221"><highlight class="normal"><sp/><sp/><sp/><sp/>{</highlight></codeline>
<codeline lineno="1222"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="class_se_race_mgr_1ae09f45af005d7cb2e482fec7ba22c3e2" kindref="member">m_dwGenID</ref><sp/>=<sp/>4001;</highlight></codeline>
<codeline lineno="1223"><highlight class="normal"><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="1224"><highlight class="normal"></highlight></codeline>
<codeline lineno="1225"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/><ref refid="class_se_race_mgr_1ae09f45af005d7cb2e482fec7ba22c3e2" kindref="member">m_dwGenID</ref>;</highlight></codeline>
<codeline lineno="1226"><highlight class="normal">}</highlight></codeline>
<codeline lineno="1227"><highlight class="normal"></highlight></codeline>
<codeline lineno="1228"><highlight class="normal">DWord<sp/><ref refid="class_se_race_mgr_1a76dcbd2c0436dd8172ddb326b4a1f2a1" kindref="member">SeRaceMgr::GetSession</ref>()</highlight></codeline>
<codeline lineno="1229"><highlight class="normal">{</highlight></codeline>
<codeline lineno="1230"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/><ref refid="class_se_race_mgr_1ae09f45af005d7cb2e482fec7ba22c3e2" kindref="member">m_dwGenID</ref>;</highlight></codeline>
<codeline lineno="1231"><highlight class="normal">}</highlight></codeline>
<codeline lineno="1232"><highlight class="normal"></highlight></codeline>
<codeline lineno="1233"><highlight class="normal"></highlight><highlight class="keywordtype">void</highlight><highlight class="normal"><sp/><ref refid="class_se_race_mgr_1a4849cd078753c28044be5fe511fca562" kindref="member">SeRaceMgr::ResetSession</ref>(DWord<sp/>dwSession)</highlight></codeline>
<codeline lineno="1234"><highlight class="normal">{</highlight></codeline>
<codeline lineno="1235"><highlight class="normal"><sp/><sp/><sp/><sp/><ref refid="class_se_race_mgr_1ae09f45af005d7cb2e482fec7ba22c3e2" kindref="member">m_dwGenID</ref><sp/>=<sp/>dwSession;</highlight></codeline>
<codeline lineno="1236"><highlight class="normal">}</highlight></codeline>
<codeline lineno="1237"><highlight class="normal"></highlight></codeline>
<codeline lineno="1238"><highlight class="normal"></highlight><highlight class="keywordtype">bool</highlight><highlight class="normal"><sp/><ref refid="class_se_race_mgr_1acde9baec1a0425067a7f2376b52a87e2" kindref="member">SeRaceMgr::IsSessionExist</ref>(DWord<sp/>dwSession)</highlight></codeline>
<codeline lineno="1239"><highlight class="normal">{</highlight></codeline>
<codeline lineno="1240"><highlight class="normal"><sp/><sp/><sp/><sp/>MRace::iterator<sp/>itr<sp/>=<sp/><ref refid="class_se_race_mgr_1ad346a0191bf14a69de9422c1fd03b301" kindref="member">m_kMRace</ref>.find(dwSession);</highlight></codeline>
<codeline lineno="1241"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(itr<sp/>!=<sp/><ref refid="class_se_race_mgr_1ad346a0191bf14a69de9422c1fd03b301" kindref="member">m_kMRace</ref>.end())</highlight></codeline>
<codeline lineno="1242"><highlight class="normal"><sp/><sp/><sp/><sp/>{</highlight></codeline>
<codeline lineno="1243"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/></highlight><highlight class="keyword">true</highlight><highlight class="normal">;</highlight></codeline>
<codeline lineno="1244"><highlight class="normal"><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="1245"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/></highlight><highlight class="keyword">false</highlight><highlight class="normal">;</highlight></codeline>
<codeline lineno="1246"><highlight class="normal">}</highlight></codeline>
<codeline lineno="1247"><highlight class="normal"></highlight></codeline>
<codeline lineno="1248"><highlight class="normal">DWord<sp/><ref refid="class_se_race_mgr_1a14398a0223c50faa2013e5b3128c0874" kindref="member">SeRaceMgr::GetEnterKey</ref>()</highlight></codeline>
<codeline lineno="1249"><highlight class="normal">{</highlight></codeline>
<codeline lineno="1250"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/>rand();</highlight></codeline>
<codeline lineno="1251"><highlight class="normal">}</highlight></codeline>
<codeline lineno="1252"><highlight class="normal"></highlight></codeline>
<codeline lineno="1253"><highlight class="normal"></highlight><highlight class="keywordtype">bool</highlight><highlight class="normal"><sp/><ref refid="class_se_race_mgr_1a70a11c10dd853739814641c8cd5d1d50" kindref="member">SeRaceMgr::GetRacingSvr</ref>(<ref refid="struct_se_match_race" kindref="compound">SeMatchRace</ref>*<sp/>pkRace)</highlight></codeline>
<codeline lineno="1254"><highlight class="normal">{</highlight></codeline>
<codeline lineno="1255"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal">(!pkRace)</highlight></codeline>
<codeline lineno="1256"><highlight class="normal"><sp/><sp/><sp/><sp/>{</highlight></codeline>
<codeline lineno="1257"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/></highlight><highlight class="keyword">false</highlight><highlight class="normal">;</highlight></codeline>
<codeline lineno="1258"><highlight class="normal"><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="1259"><highlight class="normal"></highlight></codeline>
<codeline lineno="1260"><highlight class="normal"><sp/><sp/><sp/><sp/><ref refid="struct_se_race_svr" kindref="compound">SeRaceSvr</ref>*<sp/>pkRaceSvr<sp/>=<sp/><ref refid="_src_2_se_race_svr_mgr_8cpp_1a2d3d387da69f6fc93ec49db8bf1ee871" kindref="member">g_kRaceSvrMgr</ref>.<ref refid="class_se_race_svr_mgr_1afbc882fcb1d1600b4049e95eaf5bb5be" kindref="member">GetBestNormalRaceSvr</ref>(pkRace-&gt;<ref refid="struct_se_match_race_1a6b5eb0e64d829b9da814a5e024fe0878" kindref="member">dwMatchAreaID</ref>,<sp/>pkRace-&gt;<ref refid="struct_se_match_race_1aeae4054dac0ac31850d6a1cb0f1eb41c" kindref="member">GetFirstPlayerID</ref>());</highlight></codeline>
<codeline lineno="1261"><highlight class="normal"></highlight></codeline>
<codeline lineno="1262"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal">(!pkRaceSvr)</highlight></codeline>
<codeline lineno="1263"><highlight class="normal"><sp/><sp/><sp/><sp/>{</highlight></codeline>
<codeline lineno="1264"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/></highlight><highlight class="keyword">false</highlight><highlight class="normal">;</highlight></codeline>
<codeline lineno="1265"><highlight class="normal"><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="1266"><highlight class="normal"></highlight></codeline>
<codeline lineno="1267"><highlight class="normal"><sp/><sp/><sp/><sp/>pkRace-&gt;<ref refid="struct_se_match_race_1ac5807e52b290fa9cbf27bbe2cff05e1e" kindref="member">kRaceTownSign</ref>.<ref refid="struct_h_town_sign_1ad2078fab8662517a20a8c8702861c430" kindref="member">dwAreaID</ref><sp/>=<sp/>pkRaceSvr-&gt;<ref refid="struct_se_race_svr_1a6965461d139e1c495b8bbc01bb62f45e" kindref="member">dwAreaID</ref>;</highlight></codeline>
<codeline lineno="1268"><highlight class="normal"><sp/><sp/><sp/><sp/>pkRace-&gt;<ref refid="struct_se_match_race_1ac5807e52b290fa9cbf27bbe2cff05e1e" kindref="member">kRaceTownSign</ref>.<ref refid="struct_h_town_sign_1aad795425c3c60114ef0578356b339d2c" kindref="member">dwServerID</ref><sp/>=<sp/>pkRaceSvr-&gt;<ref refid="struct_se_race_svr_1a3d1e161ac9d92b11470b3cd2320943c9" kindref="member">dwServerID</ref>;</highlight></codeline>
<codeline lineno="1269"><highlight class="normal"></highlight></codeline>
<codeline lineno="1270"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/></highlight><highlight class="keyword">true</highlight><highlight class="normal">;</highlight></codeline>
<codeline lineno="1271"><highlight class="normal">}</highlight></codeline>
<codeline lineno="1272"><highlight class="normal"></highlight></codeline>
<codeline lineno="1273"><highlight class="normal">HSock<sp/><ref refid="class_se_race_mgr_1a3a7dd145633602ee3b6b491eabaff87f" kindref="member">SeRaceMgr::GetTownSock</ref>(<ref refid="struct_h_town_sign" kindref="compound">HTownSign</ref>&amp;<sp/>rkSign)</highlight></codeline>
<codeline lineno="1274"><highlight class="normal">{</highlight></codeline>
<codeline lineno="1275"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keyword">const</highlight><highlight class="normal"><sp/><ref refid="struct_se_town" kindref="compound">SeTown</ref>*<sp/>pkTown<sp/>=<sp/><ref refid="_match_server_2_src_2_se_town_mgr_8cpp_1a0d99b78f6d107c2f607862b30d586175" kindref="member">g_kTownMgr</ref>.<ref refid="class_se_town_mgr_1a3e1b7be924a0c5a9ae0dfaa087eb83e3" kindref="member">GetTown</ref>(rkSign);</highlight></codeline>
<codeline lineno="1276"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal">(pkTown<sp/>&amp;&amp;<sp/>pkTown-&gt;<ref refid="struct_se_town_1a2dc49f167eccdeb950673bdb68615734" kindref="member">pkConnect</ref>)</highlight></codeline>
<codeline lineno="1277"><highlight class="normal"><sp/><sp/><sp/><sp/>{</highlight></codeline>
<codeline lineno="1278"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/>pkTown-&gt;<ref refid="struct_se_town_1a2dc49f167eccdeb950673bdb68615734" kindref="member">pkConnect</ref>-&gt;<ref refid="struct_se_connect_1afaa6333d607da1a42b52df55799eab7b" kindref="member">kSock</ref>;</highlight></codeline>
<codeline lineno="1279"><highlight class="normal"><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="1280"><highlight class="normal"></highlight></codeline>
<codeline lineno="1281"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/>NULL;</highlight></codeline>
<codeline lineno="1282"><highlight class="normal">}</highlight></codeline>
<codeline lineno="1283"><highlight class="normal"></highlight></codeline>
<codeline lineno="1284"><highlight class="normal"><ref refid="struct_h_town_sign" kindref="compound">HTownSign</ref><sp/><ref refid="class_se_race_mgr_1a9dabb6c38e2b0997f05aae05078c3325" kindref="member">SeRaceMgr::GetTownSignByAreaID</ref>(<ref refid="_match_server_2_src_2_se_race_mgr_def_8h_1ab101f4de5df82aa4152f3bb13da3b518" kindref="member">MRacePlayer</ref>&amp;<sp/>rkMRacePlayer,DWord<sp/>dwAreaID)</highlight></codeline>
<codeline lineno="1285"><highlight class="normal">{</highlight></codeline>
<codeline lineno="1286"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">for</highlight><highlight class="normal">(MRacePlayer::iterator<sp/>itr<sp/>=<sp/>rkMRacePlayer.begin();itr<sp/>!=<sp/>rkMRacePlayer.end();++itr)</highlight></codeline>
<codeline lineno="1287"><highlight class="normal"><sp/><sp/><sp/><sp/>{</highlight></codeline>
<codeline lineno="1288"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="struct_se_race_player" kindref="compound">SeRacePlayer</ref>&amp;<sp/>rkRacePlayer<sp/>=<sp/>itr-&gt;second;</highlight></codeline>
<codeline lineno="1289"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal">(rkRacePlayer.<ref refid="struct_se_race_player_1ac5601dda3e2dfc69b74649cbbfe6e141" kindref="member">kTownSign</ref>.<ref refid="struct_h_town_sign_1ad2078fab8662517a20a8c8702861c430" kindref="member">dwAreaID</ref><sp/>==<sp/>dwAreaID)</highlight></codeline>
<codeline lineno="1290"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>{</highlight></codeline>
<codeline lineno="1291"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/>rkRacePlayer.<ref refid="struct_se_race_player_1ac5601dda3e2dfc69b74649cbbfe6e141" kindref="member">kTownSign</ref>;</highlight></codeline>
<codeline lineno="1292"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="1293"><highlight class="normal"><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="1294"><highlight class="normal"></highlight></codeline>
<codeline lineno="1295"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/>NULL;</highlight></codeline>
<codeline lineno="1296"><highlight class="normal">}</highlight></codeline>
<codeline lineno="1297"><highlight class="normal"></highlight></codeline>
<codeline lineno="1298"><highlight class="normal">HSock<sp/><ref refid="class_se_race_mgr_1a220a9a7426ccd94670119a48ab0cb56c" kindref="member">SeRaceMgr::GetRaceSvrSock</ref>(<ref refid="struct_h_town_sign" kindref="compound">HTownSign</ref>&amp;<sp/>rkSign)</highlight></codeline>
<codeline lineno="1299"><highlight class="normal">{</highlight></codeline>
<codeline lineno="1300"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keyword">const</highlight><highlight class="normal"><sp/><ref refid="struct_se_race_svr" kindref="compound">SeRaceSvr</ref>*<sp/>pkSvr<sp/>=<sp/><ref refid="_src_2_se_race_svr_mgr_8cpp_1a2d3d387da69f6fc93ec49db8bf1ee871" kindref="member">g_kRaceSvrMgr</ref>.<ref refid="class_se_race_svr_mgr_1a5cb837611a3d12df40c032445a38666a" kindref="member">GetRaceSvr</ref>(rkSign);</highlight></codeline>
<codeline lineno="1301"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal">(pkSvr<sp/>&amp;&amp;<sp/>pkSvr-&gt;<ref refid="struct_se_race_svr_1aa0cbcd4fadcbe00b225d0f95ad1214a5" kindref="member">pkConnect</ref>)</highlight></codeline>
<codeline lineno="1302"><highlight class="normal"><sp/><sp/><sp/><sp/>{</highlight></codeline>
<codeline lineno="1303"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/>pkSvr-&gt;<ref refid="struct_se_race_svr_1aa0cbcd4fadcbe00b225d0f95ad1214a5" kindref="member">pkConnect</ref>-&gt;<ref refid="struct_se_connect_1afaa6333d607da1a42b52df55799eab7b" kindref="member">kSock</ref>;</highlight></codeline>
<codeline lineno="1304"><highlight class="normal"><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="1305"><highlight class="normal"></highlight></codeline>
<codeline lineno="1306"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/>NULL;</highlight></codeline>
<codeline lineno="1307"><highlight class="normal">}</highlight></codeline>
<codeline lineno="1308"><highlight class="normal"></highlight></codeline>
<codeline lineno="1309"><highlight class="normal"></highlight><highlight class="keywordtype">void</highlight><highlight class="normal"><sp/><ref refid="class_se_race_mgr_1a3af4bb17e10c2cb191f381cea5bff3f4" kindref="member">SeRaceMgr::UpdateSvrStaCount</ref>()</highlight></codeline>
<codeline lineno="1310"><highlight class="normal">{</highlight></codeline>
<codeline lineno="1311"><highlight class="normal"><sp/><sp/><sp/><sp/>DWord<sp/>dwServerTime<sp/>=<sp/><ref refid="_src_2_match_server_8cpp_1a1cd9d6d0396497f8a9d48e44d672f368" kindref="member">g_kMatchServer</ref>.<ref refid="class_match_server_1ad3ce38db6c10f10891dbfd700cb954ca" kindref="member">GetServerTime</ref>();</highlight></codeline>
<codeline lineno="1312"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keyword">static</highlight><highlight class="normal"><sp/>DWord<sp/>s_dwPreTime<sp/>=<sp/>dwServerTime;</highlight></codeline>
<codeline lineno="1313"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal">((</highlight><highlight class="keywordtype">int</highlight><highlight class="normal">)(dwServerTime<sp/>-<sp/>s_dwPreTime)<sp/>&gt;=<sp/>1000<sp/>*<sp/>60)</highlight></codeline>
<codeline lineno="1314"><highlight class="normal"><sp/><sp/><sp/><sp/>{</highlight></codeline>
<codeline lineno="1315"><highlight class="normal"></highlight><highlight class="comment">//<sp/><sp/><sp/><sp/><sp/><sp/>SeLogInfo(&quot;MS[%s]SvrCountFailed[%d]&quot;,<sp/>GetID2Str(g_kMatchServer.GetServerID()),<sp/>m_iSvrAddFailCount);</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="1316"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>s_dwPreTime<sp/>=<sp/>dwServerTime;</highlight></codeline>
<codeline lineno="1317"><highlight class="normal"><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="1318"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight></codeline>
<codeline lineno="1319"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordtype">int</highlight><highlight class="normal"><sp/>iDTime<sp/>=<sp/>dwServerTime<sp/>-<sp/><ref refid="class_se_race_mgr_1a78023051427c080af12c34bf173ff085" kindref="member">m_dwLastRecordTime</ref>;</highlight></codeline>
<codeline lineno="1320"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal">(iDTime<sp/>&lt;<sp/>1800<sp/>*<sp/>1000)</highlight></codeline>
<codeline lineno="1321"><highlight class="normal"><sp/><sp/><sp/><sp/>{</highlight></codeline>
<codeline lineno="1322"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal">;</highlight></codeline>
<codeline lineno="1323"><highlight class="normal"><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="1324"><highlight class="normal"></highlight></codeline>
<codeline lineno="1325"><highlight class="normal"></highlight><highlight class="comment">//<sp/><sp/>SeLogInfo(&quot;MS[%s]SvrCountReset,MaxNum[%d]&quot;,<sp/>GetID2Str(g_kMatchServer.GetServerID()),<sp/>m_iSvrAddFailCount);</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="1326"><highlight class="normal"><sp/><sp/><sp/><sp/>m_dwLastRecordTime<sp/>=<sp/>dwServerTime;</highlight></codeline>
<codeline lineno="1327"><highlight class="normal"><sp/><sp/><sp/><sp/><ref refid="class_se_race_mgr_1a80c2ab087dee1e3e455ee2098777c4b9" kindref="member">m_iSvrAddFailCount</ref><sp/>=<sp/>0;</highlight></codeline>
<codeline lineno="1328"><highlight class="normal">}</highlight></codeline>
    </programlisting>
    <location file="F:/TeamWork/ServerVersion/projects/server/Server/Server/MatchServer/src/SeRaceMgr.cpp"/>
  </compounddef>
</doxygen>
