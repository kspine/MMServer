<?xml version='1.0' encoding='UTF-8' standalone='no'?>
<doxygen xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xsi:noNamespaceSchemaLocation="compound.xsd" version="1.8.6">
  <compounddef id="_src_2_se_l_g_process_8cpp" kind="file">
    <compoundname>SeLGProcess.cpp</compoundname>
    <includes refid="_src_2_global_server_8h" local="yes">GlobalServer.h</includes>
    <includes refid="_te_misc_8h" local="yes">TeMisc.h</includes>
    <includes refid="_se_l_g_process_8inc" local="yes">SeLGProcess.inc</includes>
    <incdepgraph>
      <node id="28701">
        <label>list</label>
      </node>
      <node id="28695">
        <label>locale</label>
      </node>
      <node id="28730">
        <label>SePtl_GS_To_LS.h</label>
        <link refid="_se_ptl___g_s___to___l_s_8h"/>
        <childnode refid="28726" relation="include">
        </childnode>
      </node>
      <node id="28740">
        <label>SeWGProcess.inl</label>
        <link refid="_se_w_g_process_8inl"/>
      </node>
      <node id="28705">
        <label>queue</label>
      </node>
      <node id="28699">
        <label>limits</label>
      </node>
      <node id="28677">
        <label>GlobalServer/Src/SeLGProcess.cpp</label>
        <link refid="Src/SeLGProcess.cpp"/>
        <childnode refid="28678" relation="include">
        </childnode>
        <childnode refid="28723" relation="include">
        </childnode>
        <childnode refid="28744" relation="include">
        </childnode>
      </node>
      <node id="28728">
        <label>SePtlCommDefine.h</label>
        <link refid="_se_ptl_comm_define_8h"/>
      </node>
      <node id="28715">
        <label>SeMemPool.h</label>
        <link refid="_se_mem_pool_8h"/>
        <childnode refid="28680" relation="include">
        </childnode>
        <childnode refid="28710" relation="include">
        </childnode>
        <childnode refid="28687" relation="include">
        </childnode>
      </node>
      <node id="28682">
        <label>windows.h</label>
      </node>
      <node id="28687">
        <label>assert.h</label>
      </node>
      <node id="28731">
        <label>SePtl_LS_To_GS.h</label>
        <link refid="_se_ptl___l_s___to___g_s_8h"/>
        <childnode refid="28726" relation="include">
        </childnode>
      </node>
      <node id="28734">
        <label>SeTimer.h</label>
        <link refid="_se_timer_8h"/>
      </node>
      <node id="28744">
        <label>SeLGProcess.inc</label>
        <link refid="_se_l_g_process_8inc"/>
      </node>
      <node id="28741">
        <label>SeLGProcess.inl</label>
        <link refid="_se_l_g_process_8inl"/>
      </node>
      <node id="28685">
        <label>stdlib.h</label>
      </node>
      <node id="28710">
        <label>EsLock.h</label>
      </node>
      <node id="28689">
        <label>cmath</label>
      </node>
      <node id="28729">
        <label>SePtl_GS_To_WS.h</label>
        <link refid="_se_ptl___g_s___to___w_s_8h"/>
        <childnode refid="28726" relation="include">
        </childnode>
      </node>
      <node id="28725">
        <label>SePtl_WS_To_GS.h</label>
        <link refid="_se_ptl___w_s___to___g_s_8h"/>
        <childnode refid="28726" relation="include">
        </childnode>
      </node>
      <node id="28698">
        <label>string</label>
      </node>
      <node id="28732">
        <label>SePtl_HS_To_HS.h</label>
        <link refid="_se_ptl___h_s___to___h_s_8h"/>
        <childnode refid="28726" relation="include">
        </childnode>
      </node>
      <node id="28702">
        <label>map</label>
      </node>
      <node id="28708">
        <label>SeFileLog.h</label>
        <link refid="_se_file_log_8h"/>
        <childnode refid="28709" relation="include">
        </childnode>
        <childnode refid="28691" relation="include">
        </childnode>
        <childnode refid="28710" relation="include">
        </childnode>
      </node>
      <node id="28684">
        <label>conio.h</label>
      </node>
      <node id="28727">
        <label>SePtlRandomNumDef.h</label>
        <link refid="_se_ptl_random_num_def_8h"/>
      </node>
      <node id="28738">
        <label>SeHttpSend.inl</label>
        <link refid="_global_server_2_src_2_se_http_send_8inl"/>
      </node>
      <node id="28683">
        <label>direct.h</label>
      </node>
      <node id="28696">
        <label>fstream</label>
      </node>
      <node id="28721">
        <label>SeTool.h</label>
        <link refid="_se_tool_8h"/>
        <childnode refid="28680" relation="include">
        </childnode>
        <childnode refid="28714" relation="include">
        </childnode>
        <childnode refid="28722" relation="include">
        </childnode>
        <childnode refid="28723" relation="include">
        </childnode>
        <childnode refid="28693" relation="include">
        </childnode>
        <childnode refid="28724" relation="include">
        </childnode>
      </node>
      <node id="28681">
        <label>winsock2.h</label>
      </node>
      <node id="28718">
        <label>TeDataBaseMgr.h</label>
      </node>
      <node id="28679">
        <label>SeServerMainDef.h</label>
        <link refid="_se_server_main_def_8h"/>
        <childnode refid="28680" relation="include">
        </childnode>
      </node>
      <node id="28723">
        <label>TeMisc.h</label>
        <link refid="_te_misc_8h"/>
        <childnode refid="28692" relation="include">
        </childnode>
      </node>
      <node id="28711">
        <label>SeCacheMgr.h</label>
        <link refid="_src_2_se_cache_mgr_8h"/>
        <childnode refid="28712" relation="include">
        </childnode>
      </node>
      <node id="28720">
        <label>SeServerDefine.h</label>
        <link refid="_se_server_define_8h"/>
        <childnode refid="28714" relation="include">
        </childnode>
        <childnode refid="28716" relation="include">
        </childnode>
        <childnode refid="28721" relation="include">
        </childnode>
      </node>
      <node id="28692">
        <label>string.h</label>
      </node>
      <node id="28719">
        <label>SeConfig.h</label>
        <link refid="_se_config_8h"/>
        <childnode refid="28714" relation="include">
        </childnode>
      </node>
      <node id="28690">
        <label>ctime</label>
      </node>
      <node id="28716">
        <label>TeNetMgr.h</label>
      </node>
      <node id="28700">
        <label>vector</label>
      </node>
      <node id="28713">
        <label>GlobalServerDef.h</label>
        <link refid="_src_2_global_server_def_8h"/>
        <childnode refid="28714" relation="include">
        </childnode>
        <childnode refid="28715" relation="include">
        </childnode>
        <childnode refid="28716" relation="include">
        </childnode>
        <childnode refid="28717" relation="include">
        </childnode>
        <childnode refid="28718" relation="include">
        </childnode>
        <childnode refid="28719" relation="include">
        </childnode>
        <childnode refid="28720" relation="include">
        </childnode>
        <childnode refid="28725" relation="include">
        </childnode>
        <childnode refid="28729" relation="include">
        </childnode>
        <childnode refid="28730" relation="include">
        </childnode>
        <childnode refid="28731" relation="include">
        </childnode>
        <childnode refid="28732" relation="include">
        </childnode>
      </node>
      <node id="28706">
        <label>new</label>
      </node>
      <node id="28678">
        <label>GlobalServer.h</label>
        <link refid="_src_2_global_server_8h"/>
        <childnode refid="28679" relation="include">
        </childnode>
        <childnode refid="28708" relation="include">
        </childnode>
        <childnode refid="28711" relation="include">
        </childnode>
        <childnode refid="28733" relation="include">
        </childnode>
        <childnode refid="28735" relation="include">
        </childnode>
        <childnode refid="28713" relation="include">
        </childnode>
        <childnode refid="28736" relation="include">
        </childnode>
        <childnode refid="28737" relation="include">
        </childnode>
        <childnode refid="28738" relation="include">
        </childnode>
        <childnode refid="28739" relation="include">
        </childnode>
        <childnode refid="28740" relation="include">
        </childnode>
        <childnode refid="28741" relation="include">
        </childnode>
        <childnode refid="28742" relation="include">
        </childnode>
        <childnode refid="28743" relation="include">
        </childnode>
      </node>
      <node id="28726">
        <label>SePtlDefine.h</label>
        <link refid="_se_ptl_define_8h"/>
        <childnode refid="28680" relation="include">
        </childnode>
        <childnode refid="28714" relation="include">
        </childnode>
        <childnode refid="28721" relation="include">
        </childnode>
        <childnode refid="28727" relation="include">
        </childnode>
        <childnode refid="28728" relation="include">
        </childnode>
        <childnode refid="28715" relation="include">
        </childnode>
      </node>
      <node id="28714">
        <label>SeShareDef.h</label>
        <link refid="_se_share_def_8h"/>
        <childnode refid="28680" relation="include">
        </childnode>
      </node>
      <node id="28697">
        <label>sstream</label>
      </node>
      <node id="28724">
        <label>EsString.h</label>
      </node>
      <node id="28733">
        <label>SeVirtConnMgr.h</label>
        <link refid="_se_virt_conn_mgr_8h"/>
        <childnode refid="28714" relation="include">
        </childnode>
        <childnode refid="28716" relation="include">
        </childnode>
        <childnode refid="28726" relation="include">
        </childnode>
        <childnode refid="28734" relation="include">
        </childnode>
      </node>
      <node id="28737">
        <label>SeGLSend.inl</label>
        <link refid="_se_g_l_send_8inl"/>
      </node>
      <node id="28743">
        <label>SeDBProcess.inl</label>
        <link refid="_global_server_2_src_2_se_d_b_process_8inl"/>
      </node>
      <node id="28680">
        <label>SeInclude.h</label>
        <link refid="_se_include_8h"/>
        <childnode refid="28681" relation="include">
        </childnode>
        <childnode refid="28682" relation="include">
        </childnode>
        <childnode refid="28683" relation="include">
        </childnode>
        <childnode refid="28684" relation="include">
        </childnode>
        <childnode refid="28685" relation="include">
        </childnode>
        <childnode refid="28686" relation="include">
        </childnode>
        <childnode refid="28687" relation="include">
        </childnode>
        <childnode refid="28688" relation="include">
        </childnode>
        <childnode refid="28689" relation="include">
        </childnode>
        <childnode refid="28690" relation="include">
        </childnode>
        <childnode refid="28691" relation="include">
        </childnode>
        <childnode refid="28692" relation="include">
        </childnode>
        <childnode refid="28693" relation="include">
        </childnode>
        <childnode refid="28694" relation="include">
        </childnode>
        <childnode refid="28695" relation="include">
        </childnode>
        <childnode refid="28696" relation="include">
        </childnode>
        <childnode refid="28697" relation="include">
        </childnode>
        <childnode refid="28698" relation="include">
        </childnode>
        <childnode refid="28699" relation="include">
        </childnode>
        <childnode refid="28700" relation="include">
        </childnode>
        <childnode refid="28701" relation="include">
        </childnode>
        <childnode refid="28702" relation="include">
        </childnode>
        <childnode refid="28703" relation="include">
        </childnode>
        <childnode refid="28704" relation="include">
        </childnode>
        <childnode refid="28705" relation="include">
        </childnode>
        <childnode refid="28706" relation="include">
        </childnode>
        <childnode refid="28707" relation="include">
        </childnode>
      </node>
      <node id="28709">
        <label>time.h</label>
      </node>
      <node id="28686">
        <label>math.h</label>
      </node>
      <node id="28717">
        <label>SeSynMgr.h</label>
        <link refid="_se_syn_mgr_8h"/>
        <childnode refid="28680" relation="include">
        </childnode>
      </node>
      <node id="28693">
        <label>EsType.h</label>
      </node>
      <node id="28688">
        <label>cctype</label>
      </node>
      <node id="28722">
        <label>SeToolTemplate.inl</label>
        <link refid="_se_tool_template_8inl"/>
      </node>
      <node id="28736">
        <label>SeGWSend.inl</label>
        <link refid="_se_g_w_send_8inl"/>
      </node>
      <node id="28739">
        <label>SeDBSend.inl</label>
        <link refid="_global_server_2_src_2_se_d_b_send_8inl"/>
      </node>
      <node id="28703">
        <label>unordered_map</label>
      </node>
      <node id="28707">
        <label>SeDefine.h</label>
        <link refid="_se_define_8h"/>
      </node>
      <node id="28735">
        <label>SeServerTool.h</label>
        <link refid="_se_server_tool_8h"/>
        <childnode refid="28680" relation="include">
        </childnode>
        <childnode refid="28721" relation="include">
        </childnode>
        <childnode refid="28726" relation="include">
        </childnode>
      </node>
      <node id="28712">
        <label>SeCacheMgrDef.h</label>
        <link refid="_src_2_se_cache_mgr_def_8h"/>
        <childnode refid="28713" relation="include">
        </childnode>
      </node>
      <node id="28742">
        <label>SeHttpProcess.inl</label>
        <link refid="_global_server_2_src_2_se_http_process_8inl"/>
      </node>
      <node id="28704">
        <label>set</label>
      </node>
      <node id="28694">
        <label>algorithm</label>
      </node>
      <node id="28691">
        <label>stdio.h</label>
      </node>
    </incdepgraph>
      <sectiondef kind="define">
      <memberdef kind="define" id="_src_2_se_l_g_process_8cpp_1a24cd3c37a165a8c4626d9e78df4574ff" prot="public" static="no">
        <name>SERVER</name>
        <initializer><ref refid="class_global_server" kindref="compound">GlobalServer</ref></initializer>
        <briefdescription>
        </briefdescription>
        <detaileddescription>
        </detaileddescription>
        <inbodydescription>
        </inbodydescription>
        <location file="F:/TeamWork/ServerVersion/projects/server/Server/Server/GlobalServer/Src/SeLGProcess.cpp" line="4" column="9" bodyfile="F:/TeamWork/ServerVersion/projects/server/Server/Server/GlobalServer/Src/SeLGProcess.cpp" bodystart="4" bodyend="-1"/>
      </memberdef>
      </sectiondef>
    <briefdescription>
    </briefdescription>
    <detaileddescription>
    </detaileddescription>
    <programlisting>
<codeline lineno="1"><highlight class="preprocessor">#include<sp/>&quot;<ref refid="_src_2_global_server_8h" kindref="compound">GlobalServer.h</ref>&quot;</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="2"><highlight class="normal"></highlight><highlight class="preprocessor">#include<sp/>&quot;<ref refid="_te_misc_8h" kindref="compound">TeMisc.h</ref>&quot;</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="3"><highlight class="normal"></highlight></codeline>
<codeline lineno="4" refid="_src_2_se_l_g_process_8cpp_1a24cd3c37a165a8c4626d9e78df4574ff" refkind="member"><highlight class="normal"></highlight><highlight class="preprocessor">#define<sp/>SERVER<sp/>GlobalServer</highlight></codeline>
<codeline lineno="5"><highlight class="preprocessor"></highlight><highlight class="preprocessor">#include<sp/>&quot;<ref refid="_se_l_g_process_8inc" kindref="compound">SeLGProcess.inc</ref>&quot;</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="6"><highlight class="normal"></highlight><highlight class="preprocessor">#undef<sp/>SERVER</highlight></codeline>
<codeline lineno="7"><highlight class="preprocessor"></highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="8"><highlight class="normal"></highlight><highlight class="keywordtype">bool</highlight><highlight class="normal"><sp/><ref refid="class_global_server_1a98d1176832be29cef843868d8ff16aa5" kindref="member">GlobalServer::PreProcessLG</ref>(</highlight><highlight class="keywordtype">void</highlight><highlight class="normal">*<sp/>pkData,<sp/></highlight><highlight class="keywordtype">int</highlight><highlight class="normal"><sp/>iSize,<sp/></highlight><highlight class="keywordtype">void</highlight><highlight class="normal">*<sp/>pkSender)</highlight></codeline>
<codeline lineno="9"><highlight class="normal">{</highlight></codeline>
<codeline lineno="10"><highlight class="normal"><sp/><sp/><sp/><sp/><ref refid="struct_se_virt_conn" kindref="compound">SeVirtConn</ref>*<sp/>pkLS<sp/>=<sp/>(<ref refid="struct_se_virt_conn" kindref="compound">SeVirtConn</ref>*)pkSender;</highlight></codeline>
<codeline lineno="11"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(!pkLS)</highlight></codeline>
<codeline lineno="12"><highlight class="normal"><sp/><sp/><sp/><sp/>{</highlight></codeline>
<codeline lineno="13"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/></highlight><highlight class="keyword">false</highlight><highlight class="normal">;</highlight></codeline>
<codeline lineno="14"><highlight class="normal"><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="15"><highlight class="normal"></highlight></codeline>
<codeline lineno="16"><highlight class="normal"><sp/><sp/><sp/><sp/><ref refid="struct_se_c_m_d" kindref="compound">SeCMD</ref>*<sp/>pkCmd<sp/>=<sp/>(<ref refid="struct_se_c_m_d" kindref="compound">SeCMD</ref>*)pkData;</highlight></codeline>
<codeline lineno="17"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(!pkCmd)</highlight></codeline>
<codeline lineno="18"><highlight class="normal"><sp/><sp/><sp/><sp/>{</highlight></codeline>
<codeline lineno="19"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/></highlight><highlight class="keyword">false</highlight><highlight class="normal">;</highlight></codeline>
<codeline lineno="20"><highlight class="normal"><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="21"><highlight class="normal"></highlight></codeline>
<codeline lineno="22"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(pkLS-&gt;<ref refid="struct_se_virt_conn_1a498d90b78881f21f62000e5848c654e2" kindref="member">eState</ref><sp/>==<sp/><ref refid="_se_virt_conn_mgr_8h_1ad6484f55baf154efe4f216e3d9c1f459af2fd418c27e38c5887061982c04bebe5" kindref="member">SVCS_NULL</ref><sp/>&amp;&amp;<sp/>pkCmd-&gt;<ref refid="struct_se_c_m_d_1a2efa122a60040d09cfca777f9155394c" kindref="member">wCmd</ref><sp/>!=<sp/><ref refid="_se_ptl___l_s___to___g_s_8h_1a982f547bc7cce542bf7295cf8080b9a0adef3743e0958befc40bd99325138098a" kindref="member">CMD_LG_REGISTER</ref>)</highlight></codeline>
<codeline lineno="23"><highlight class="normal"><sp/><sp/><sp/><sp/>{</highlight></codeline>
<codeline lineno="24"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="class_global_server_1aab15fb083ac582e71e2a686f44b21297" kindref="member">m_kNetMgr</ref>.Disconnect(pkLS-&gt;<ref refid="struct_se_virt_conn_1a2ed0654cfe8f298d1dc8fbe76a310df0" kindref="member">kSock</ref>);</highlight></codeline>
<codeline lineno="25"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/></highlight><highlight class="keyword">false</highlight><highlight class="normal">;</highlight></codeline>
<codeline lineno="26"><highlight class="normal"><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="27"><highlight class="normal"></highlight></codeline>
<codeline lineno="28"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/></highlight><highlight class="keyword">true</highlight><highlight class="normal">;</highlight></codeline>
<codeline lineno="29"><highlight class="normal">}</highlight></codeline>
<codeline lineno="30"><highlight class="normal"></highlight></codeline>
<codeline lineno="31"><highlight class="normal"></highlight><highlight class="keywordtype">void</highlight><highlight class="normal"><sp/><ref refid="class_global_server_1a89916052169d2ef50e803a74fbe6c379" kindref="member">GlobalServer::ProcessLG_Register</ref>(<ref refid="struct_se_l_g___register" kindref="compound">SeLG_Register</ref>*<sp/>pkData,<sp/></highlight><highlight class="keywordtype">int</highlight><highlight class="normal"><sp/>iSize,<sp/></highlight><highlight class="keywordtype">void</highlight><highlight class="normal">*<sp/>pkSender)</highlight></codeline>
<codeline lineno="32"><highlight class="normal">{</highlight></codeline>
<codeline lineno="33"><highlight class="normal"><sp/><sp/><sp/><sp/><ref refid="struct_se_virt_conn" kindref="compound">SeVirtConn</ref>*<sp/>pkLS<sp/>=<sp/>(<ref refid="struct_se_virt_conn" kindref="compound">SeVirtConn</ref>*)pkSender;</highlight></codeline>
<codeline lineno="34"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(pkLS-&gt;<ref refid="struct_se_virt_conn_1a498d90b78881f21f62000e5848c654e2" kindref="member">eState</ref><sp/>!=<sp/><ref refid="_se_virt_conn_mgr_8h_1ad6484f55baf154efe4f216e3d9c1f459af2fd418c27e38c5887061982c04bebe5" kindref="member">SVCS_NULL</ref>)</highlight></codeline>
<codeline lineno="35"><highlight class="normal"><sp/><sp/><sp/><sp/>{</highlight></codeline>
<codeline lineno="36"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal">;</highlight></codeline>
<codeline lineno="37"><highlight class="normal"><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="38"><highlight class="normal"></highlight></codeline>
<codeline lineno="39"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(pkData-&gt;<ref refid="struct_se_l_g___register_1ae46ee62af74ed985093738db9d10ec27" kindref="member">dwLoginMagic</ref><sp/>!=<sp/><ref refid="_se_ptl_comm_define_8h_1af62c3a00672953c86a2586d53c60663aa051b38374860159471f6a78f1167a7eb" kindref="member">SSD_MSANGO_MAGIC</ref><sp/>||<sp/>pkData-&gt;<ref refid="struct_se_l_g___register_1ae882e945ebc60444ea10ae2d789c4463" kindref="member">dwServerID</ref><sp/>==<sp/>0<sp/>||<sp/>pkData-&gt;<ref refid="struct_se_l_g___register_1a0fc12fbda3f17b25de4c46847cacc0d8" kindref="member">dwAreaID</ref><sp/>==<sp/>0)</highlight></codeline>
<codeline lineno="40"><highlight class="normal"><sp/><sp/><sp/><sp/>{</highlight></codeline>
<codeline lineno="41"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="class_global_server_1aab15fb083ac582e71e2a686f44b21297" kindref="member">m_kNetMgr</ref>.Disconnect(pkLS-&gt;<ref refid="struct_se_virt_conn_1a2ed0654cfe8f298d1dc8fbe76a310df0" kindref="member">kSock</ref>);</highlight></codeline>
<codeline lineno="42"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal">;</highlight></codeline>
<codeline lineno="43"><highlight class="normal"><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="44"><highlight class="normal"></highlight></codeline>
<codeline lineno="45"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="comment">//<sp/>防止重复注册</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="46"><highlight class="normal"><sp/><sp/><sp/><sp/><ref refid="struct_se_virt_conn" kindref="compound">SeVirtConn</ref>*<sp/>pkFindLS<sp/>=<sp/><ref refid="_se_virt_conn_mgr_8cpp_1aa8e9d5beed961f4e26b9cadd49603980" kindref="member">g_kVirtConnMgr</ref>.<ref refid="class_se_virt_conn_mgr_1a4ac4e87a3086c8361093ba6296ab3f2c" kindref="member">GetClientConnByID</ref>(<ref refid="_se_ptl_define_8h_1aefb47f3959b8be9e164448819e4bb7f9a5d0e2f397aac5a9e03ae4098d230f655" kindref="member">SSI_LS</ref>,<sp/>pkData-&gt;<ref refid="struct_se_l_g___register_1ae882e945ebc60444ea10ae2d789c4463" kindref="member">dwServerID</ref>);</highlight></codeline>
<codeline lineno="47"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(pkFindLS)</highlight></codeline>
<codeline lineno="48"><highlight class="normal"><sp/><sp/><sp/><sp/>{</highlight></codeline>
<codeline lineno="49"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="class_global_server_1aa3ad5073867ede180e19c3ba22ddcc5f" kindref="member">SendGL_RegisterRet</ref>(<ref refid="_se_server_define_8h_1a83f922065d39660cc6ff3ff3e193daa1ac80442ea100ef13c4582723562f3ea53" kindref="member">SRR_REPEAT</ref>,&amp;pkLS-&gt;<ref refid="struct_se_virt_conn_1a2ed0654cfe8f298d1dc8fbe76a310df0" kindref="member">kSock</ref>);</highlight></codeline>
<codeline lineno="50"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="_se_file_log_8h_1a59fe2018c00666084724bec1365b41f5" kindref="member">SeLogError</ref>(</highlight><highlight class="stringliteral">&quot;LS<sp/>has<sp/>been<sp/>registered:[%s:%d]<sp/>id[%s]<sp/>area[%s]&quot;</highlight><highlight class="normal">,<sp/></highlight></codeline>
<codeline lineno="51"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>pkLS-&gt;<ref refid="struct_se_virt_conn_1ad05e8487648793f2d2340a47856acb71" kindref="member">kNetAddr</ref>.<ref refid="struct_se_net_addr_1a23b51e87d8b7b2201a03833c9adde232" kindref="member">acIP</ref>,<sp/>pkLS-&gt;<ref refid="struct_se_virt_conn_1ad05e8487648793f2d2340a47856acb71" kindref="member">kNetAddr</ref>.<ref refid="struct_se_net_addr_1a989fa5b025bc039122e8d2a29838fde9" kindref="member">iPort</ref>,<sp/><ref refid="_se_tool_8h_1ada81d4ae5d39c42af0a02b45f4a6f715" kindref="member">GetID2Str</ref>(pkData-&gt;<ref refid="struct_se_l_g___register_1ae882e945ebc60444ea10ae2d789c4463" kindref="member">dwServerID</ref>),<sp/><ref refid="class_global_server_1a0b947916daa4545af7147df758bb6f10" kindref="member">GetAreaName</ref>(pkData-&gt;<ref refid="struct_se_l_g___register_1a0fc12fbda3f17b25de4c46847cacc0d8" kindref="member">dwAreaID</ref>).c_str());</highlight></codeline>
<codeline lineno="52"><highlight class="normal"></highlight></codeline>
<codeline lineno="53"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordtype">int</highlight><highlight class="normal"><sp/>iDTime<sp/>=<sp/>(int)(<ref refid="class_global_server_1adc2f8b46002eac2c3f52e076a3a107c2" kindref="member">m_dwCurTime</ref><sp/>-<sp/>pkFindLS-&gt;<ref refid="struct_se_virt_conn_1a5d5f05afd1fb01e667d072755cba8b2f" kindref="member">dwLastRecvTime</ref>);</highlight></codeline>
<codeline lineno="54"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(iDTime<sp/>&gt;=<sp/>5000)</highlight></codeline>
<codeline lineno="55"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>{</highlight></codeline>
<codeline lineno="56"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="class_global_server_1aab15fb083ac582e71e2a686f44b21297" kindref="member">m_kNetMgr</ref>.Disconnect(pkFindLS-&gt;<ref refid="struct_se_virt_conn_1a2ed0654cfe8f298d1dc8fbe76a310df0" kindref="member">kSock</ref>);</highlight></codeline>
<codeline lineno="57"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="58"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal">;</highlight></codeline>
<codeline lineno="59"><highlight class="normal"><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="60"><highlight class="normal"></highlight></codeline>
<codeline lineno="61"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordtype">bool</highlight><highlight class="normal"><sp/>bRegSuc<sp/>=<sp/><ref refid="_se_virt_conn_mgr_8cpp_1aa8e9d5beed961f4e26b9cadd49603980" kindref="member">g_kVirtConnMgr</ref>.<ref refid="class_se_virt_conn_mgr_1a53d31fe08eaa3629a8a268f2d37a05e8" kindref="member">OnClientRegister</ref>(pkLS,<sp/><ref refid="_se_ptl_define_8h_1aefb47f3959b8be9e164448819e4bb7f9a5d0e2f397aac5a9e03ae4098d230f655" kindref="member">SSI_LS</ref>,<sp/>pkData-&gt;<ref refid="struct_se_l_g___register_1ae882e945ebc60444ea10ae2d789c4463" kindref="member">dwServerID</ref>,<sp/>pkData-&gt;<ref refid="struct_se_l_g___register_1a0fc12fbda3f17b25de4c46847cacc0d8" kindref="member">dwAreaID</ref>);</highlight></codeline>
<codeline lineno="62"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(!bRegSuc)</highlight></codeline>
<codeline lineno="63"><highlight class="normal"><sp/><sp/><sp/><sp/>{</highlight></codeline>
<codeline lineno="64"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="class_global_server_1aa3ad5073867ede180e19c3ba22ddcc5f" kindref="member">SendGL_RegisterRet</ref>(<ref refid="_se_server_define_8h_1a83f922065d39660cc6ff3ff3e193daa1a0c11500a53c08ce9bb0e66eef6351485" kindref="member">SRR_FAILED</ref>,<sp/>&amp;pkLS-&gt;<ref refid="struct_se_virt_conn_1a2ed0654cfe8f298d1dc8fbe76a310df0" kindref="member">kSock</ref>);</highlight></codeline>
<codeline lineno="65"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="_se_file_log_8h_1a59fe2018c00666084724bec1365b41f5" kindref="member">SeLogError</ref>(</highlight><highlight class="stringliteral">&quot;LS<sp/>register<sp/>to<sp/>conn<sp/>mgr<sp/>fail:[%s:%d]<sp/>id[%s]<sp/>area[%s]&quot;</highlight><highlight class="normal">,</highlight></codeline>
<codeline lineno="66"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>pkLS-&gt;<ref refid="struct_se_virt_conn_1ad05e8487648793f2d2340a47856acb71" kindref="member">kNetAddr</ref>.<ref refid="struct_se_net_addr_1a23b51e87d8b7b2201a03833c9adde232" kindref="member">acIP</ref>,<sp/>pkLS-&gt;<ref refid="struct_se_virt_conn_1ad05e8487648793f2d2340a47856acb71" kindref="member">kNetAddr</ref>.<ref refid="struct_se_net_addr_1a989fa5b025bc039122e8d2a29838fde9" kindref="member">iPort</ref>,<sp/><ref refid="_se_tool_8h_1ada81d4ae5d39c42af0a02b45f4a6f715" kindref="member">GetID2Str</ref>(pkData-&gt;<ref refid="struct_se_l_g___register_1ae882e945ebc60444ea10ae2d789c4463" kindref="member">dwServerID</ref>),<sp/><ref refid="class_global_server_1a0b947916daa4545af7147df758bb6f10" kindref="member">GetAreaName</ref>(pkData-&gt;<ref refid="struct_se_l_g___register_1a0fc12fbda3f17b25de4c46847cacc0d8" kindref="member">dwAreaID</ref>).c_str());</highlight></codeline>
<codeline lineno="67"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal">;</highlight></codeline>
<codeline lineno="68"><highlight class="normal"><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="69"><highlight class="normal"></highlight></codeline>
<codeline lineno="70"><highlight class="normal"><sp/><sp/><sp/><sp/><ref refid="class_global_server_1aa3ad5073867ede180e19c3ba22ddcc5f" kindref="member">SendGL_RegisterRet</ref>(<ref refid="_se_server_define_8h_1a83f922065d39660cc6ff3ff3e193daa1a9066cbcd85981ad03cd92ba399a18338" kindref="member">SRR_SUCCESS</ref>,&amp;pkLS-&gt;<ref refid="struct_se_virt_conn_1a2ed0654cfe8f298d1dc8fbe76a310df0" kindref="member">kSock</ref>);</highlight></codeline>
<codeline lineno="71"><highlight class="normal"></highlight></codeline>
<codeline lineno="72"><highlight class="normal"><sp/><sp/><sp/><sp/><ref refid="_se_file_log_8h_1a83f3fe470b91cb8eed8762cc8e5e26c3" kindref="member">SeLogInfo</ref>(</highlight><highlight class="stringliteral">&quot;LS<sp/>register<sp/>successfully:[%s:%d]<sp/>id[%s]<sp/>area[%s]&quot;</highlight><highlight class="normal">,<sp/></highlight></codeline>
<codeline lineno="73"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>pkLS-&gt;<ref refid="struct_se_virt_conn_1ad05e8487648793f2d2340a47856acb71" kindref="member">kNetAddr</ref>.<ref refid="struct_se_net_addr_1a23b51e87d8b7b2201a03833c9adde232" kindref="member">acIP</ref>,<sp/>pkLS-&gt;<ref refid="struct_se_virt_conn_1ad05e8487648793f2d2340a47856acb71" kindref="member">kNetAddr</ref>.<ref refid="struct_se_net_addr_1a989fa5b025bc039122e8d2a29838fde9" kindref="member">iPort</ref>,<sp/><ref refid="_se_tool_8h_1ada81d4ae5d39c42af0a02b45f4a6f715" kindref="member">GetID2Str</ref>(pkData-&gt;<ref refid="struct_se_l_g___register_1ae882e945ebc60444ea10ae2d789c4463" kindref="member">dwServerID</ref>),<sp/><ref refid="class_global_server_1a0b947916daa4545af7147df758bb6f10" kindref="member">GetAreaName</ref>(pkData-&gt;<ref refid="struct_se_l_g___register_1a0fc12fbda3f17b25de4c46847cacc0d8" kindref="member">dwAreaID</ref>).c_str());</highlight></codeline>
<codeline lineno="74"><highlight class="normal">}</highlight></codeline>
<codeline lineno="75"><highlight class="normal"></highlight></codeline>
<codeline lineno="76"><highlight class="normal"></highlight><highlight class="keywordtype">void</highlight><highlight class="normal"><sp/><ref refid="class_global_server_1a62266274abac53f3989f91974ce26b60" kindref="member">GlobalServer::ProcessLG_HeartPackage</ref>(<ref refid="struct_se_l_g___heart_package" kindref="compound">SeLG_HeartPackage</ref>*<sp/>pkData,<sp/></highlight><highlight class="keywordtype">int</highlight><highlight class="normal"><sp/>iSize,<sp/></highlight><highlight class="keywordtype">void</highlight><highlight class="normal">*<sp/>pkSender)</highlight></codeline>
<codeline lineno="77"><highlight class="normal">{</highlight></codeline>
<codeline lineno="78"><highlight class="normal"><sp/><sp/><sp/><sp/><ref refid="struct_se_virt_conn" kindref="compound">SeVirtConn</ref>*<sp/>pkLS<sp/>=<sp/>(<ref refid="struct_se_virt_conn" kindref="compound">SeVirtConn</ref>*)pkSender;</highlight></codeline>
<codeline lineno="79"><highlight class="normal"></highlight></codeline>
<codeline lineno="80"><highlight class="normal"><sp/><sp/><sp/><sp/><ref refid="class_global_server_1ad80f4cefd4e2445a9e0049f627de5852" kindref="member">SendGL_HeartPackageRet</ref>(&amp;pkLS-&gt;<ref refid="struct_se_virt_conn_1a2ed0654cfe8f298d1dc8fbe76a310df0" kindref="member">kSock</ref>);</highlight></codeline>
<codeline lineno="81"><highlight class="normal">}</highlight></codeline>
<codeline lineno="82"><highlight class="normal"></highlight></codeline>
<codeline lineno="83"><highlight class="normal"></highlight><highlight class="keywordtype">void</highlight><highlight class="normal"><sp/><ref refid="class_global_server_1a22f0473ab0bf844ed5586de8c4ffe2fa" kindref="member">GlobalServer::ProcessLG_AccountLogin</ref>(<ref refid="struct_se_l_g___account_login" kindref="compound">SeLG_AccountLogin</ref>*<sp/>pkData,<sp/></highlight><highlight class="keywordtype">int</highlight><highlight class="normal"><sp/>iSize,<sp/></highlight><highlight class="keywordtype">void</highlight><highlight class="normal">*<sp/>pkSender)</highlight></codeline>
<codeline lineno="84"><highlight class="normal">{</highlight></codeline>
<codeline lineno="85"><highlight class="normal"><sp/><sp/><sp/><sp/><ref refid="struct_se_virt_conn" kindref="compound">SeVirtConn</ref>*<sp/>pkLS<sp/>=<sp/>(<ref refid="struct_se_virt_conn" kindref="compound">SeVirtConn</ref>*)pkSender;</highlight></codeline>
<codeline lineno="86"><highlight class="normal"></highlight></codeline>
<codeline lineno="87"><highlight class="normal"></highlight><highlight class="comment">//<sp/><sp/>//<sp/>测试代码</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="88"><highlight class="normal"></highlight><highlight class="comment">//<sp/><sp/>DWord<sp/>dwPlayerID<sp/>=<sp/>(DWord)atoi(pkData-&gt;acAccount);</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="89"><highlight class="normal"></highlight><highlight class="comment">//<sp/><sp/>if<sp/>(dwPlayerID<sp/>&lt;=<sp/>0)</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="90"><highlight class="normal"></highlight><highlight class="comment">//<sp/><sp/>{</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="91"><highlight class="normal"></highlight><highlight class="comment">//<sp/><sp/><sp/><sp/><sp/><sp/>return;</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="92"><highlight class="normal"></highlight><highlight class="comment">//<sp/><sp/>}</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="93"><highlight class="normal"></highlight></codeline>
<codeline lineno="94"><highlight class="normal"></highlight></codeline>
<codeline lineno="95"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="comment">//<sp/>test_code</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="96"><highlight class="normal"><sp/><sp/><sp/><sp/><ref refid="struct_se_account" kindref="compound">SeAccount</ref>*<sp/>pkAccount<sp/>=<sp/><ref refid="src_2_se_cache_mgr_8cpp_1ab94106ad98afc36210e2252c4ed5cf77" kindref="member">g_kCacheMgr</ref>.<ref refid="class_se_cache_mgr_1a51926841004d920d660ed744ccc221ae" kindref="member">GetAccountByAccount</ref>(pkData-&gt;<ref refid="struct_se_l_g___account_login_1a2f1cb66ae8d1d57f960e666d6807bb27" kindref="member">acAccount</ref>);</highlight></codeline>
<codeline lineno="97"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="comment">//SeAccount*<sp/>pkAccount<sp/>=<sp/>g_kCacheMgr.GetAccountByID(dwPlayerID);</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="98"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(!pkAccount)</highlight></codeline>
<codeline lineno="99"><highlight class="normal"><sp/><sp/><sp/><sp/>{</highlight></codeline>
<codeline lineno="100"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">//添加查询数据库操作，没有帐号就创建帐号</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="101"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="struct_se_wait_login_account" kindref="compound">SeWaitLoginAccount</ref>*<sp/>pkWaitAccount<sp/>=<sp/>SeWaitLoginAccount::NEW();</highlight></codeline>
<codeline lineno="102"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>pkWaitAccount-&gt;<ref refid="struct_se_wait_login_account_1ab8c6328721e99dd953f9027026fc4d88" kindref="member">kLSSock</ref><sp/>=<sp/>pkLS-&gt;<ref refid="struct_se_virt_conn_1a2ed0654cfe8f298d1dc8fbe76a310df0" kindref="member">kSock</ref>;</highlight></codeline>
<codeline lineno="103"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>pkWaitAccount-&gt;<ref refid="struct_se_wait_login_account_1a091164d42696ae79365a299d0d948da0" kindref="member">dwPackKey</ref><sp/>=<sp/>pkData-&gt;<ref refid="struct_se_l_g___account_login_1ab3defdc0cd96b0f6a261022cbfcfe5fb" kindref="member">dwPackKey</ref>;</highlight></codeline>
<codeline lineno="104"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>pkWaitAccount-&gt;<ref refid="struct_se_wait_login_account_1ac0f232216e852a1a5d918536b99ee979" kindref="member">dwBeginTime</ref><sp/>=<sp/><ref refid="class_global_server_1a0f7391b92b1ebf68ab0201806771afec" kindref="member">GetServerTime</ref>();</highlight></codeline>
<codeline lineno="105"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>pkWaitAccount-&gt;<ref refid="struct_se_wait_login_account_1afb884ac0d93900554bbef8da3b809d51" kindref="member">dwVersion</ref><sp/>=<sp/>pkData-&gt;<ref refid="struct_se_l_g___account_login_1a353f9bcb0de0ef73b69aa826957516d5" kindref="member">dwVersion</ref>;</highlight></codeline>
<codeline lineno="106"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>pkWaitAccount-&gt;<ref refid="struct_se_wait_login_account_1a68569deca8a2a5b431caef34eb3fe661" kindref="member">dwIP</ref><sp/>=<sp/>pkData-&gt;<ref refid="struct_se_l_g___account_login_1a7abc839e714516014965b4e5221b70fc" kindref="member">dwIP</ref>;</highlight></codeline>
<codeline lineno="107"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>pkWaitAccount-&gt;<ref refid="struct_se_wait_login_account_1aebc5fdae2bbabf8a1669a07417cd1173" kindref="member">bForceKick</ref><sp/>=<sp/>pkData-&gt;<ref refid="struct_se_l_g___account_login_1a18df586fe0acec81160fca5aab7db5a5" kindref="member">bForceKick</ref>;</highlight></codeline>
<codeline lineno="108"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">//pkWaitAccount-&gt;ePlatFlag<sp/>=<sp/>ePlatFlag;</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="109"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="_se_tool_8cpp_1a4d30fbe56257fc998ebc1346e53be0d8" kindref="member">StrCpy</ref>(pkWaitAccount-&gt;<ref refid="struct_se_wait_login_account_1aa1d2fcececbe8af0f52d65274d07a00f" kindref="member">acGameAccount</ref>,<sp/></highlight><highlight class="keyword">sizeof</highlight><highlight class="normal">(pkWaitAccount-&gt;<ref refid="struct_se_wait_login_account_1aa1d2fcececbe8af0f52d65274d07a00f" kindref="member">acGameAccount</ref>),<sp/>pkData-&gt;<ref refid="struct_se_l_g___account_login_1a2f1cb66ae8d1d57f960e666d6807bb27" kindref="member">acAccount</ref>);</highlight></codeline>
<codeline lineno="110"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="_se_tool_8cpp_1a4d30fbe56257fc998ebc1346e53be0d8" kindref="member">StrCpy</ref>(pkWaitAccount-&gt;<ref refid="struct_se_wait_login_account_1add7e3e521c72513c1ae8eb5ef92748ca" kindref="member">acGamePassword</ref>,<sp/></highlight><highlight class="keyword">sizeof</highlight><highlight class="normal">(pkWaitAccount-&gt;<ref refid="struct_se_wait_login_account_1add7e3e521c72513c1ae8eb5ef92748ca" kindref="member">acGamePassword</ref>),<sp/>pkData-&gt;<ref refid="struct_se_l_g___account_login_1a63e3aa94cca9cba600bfb6ae19baf8ae" kindref="member">acPassword</ref>);</highlight></codeline>
<codeline lineno="111"><highlight class="normal"></highlight></codeline>
<codeline lineno="112"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="struct_se_syn_opr" kindref="compound">SeSynOpr</ref>*<sp/>pkSynOpr<sp/>=<sp/></highlight><highlight class="keyword">new</highlight><highlight class="normal"><sp/><ref refid="struct_se_syn_opr" kindref="compound">SeSynOpr</ref>;</highlight></codeline>
<codeline lineno="113"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>pkSynOpr-&gt;<ref refid="struct_se_syn_opr_1a878609860d903fc401d7be95f7b39d7a" kindref="member">pkVoid</ref><sp/>=<sp/>(</highlight><highlight class="keywordtype">void</highlight><highlight class="normal">*)pkWaitAccount;</highlight></codeline>
<codeline lineno="114"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>DWord<sp/>dwPackKey<sp/>=<sp/><ref refid="src_2_global_server_8cpp_1a842dd477472778ad2894948f2fb7cfd9" kindref="member">g_kSynMgr</ref>.<ref refid="class_se_syn_mgr_1a4835ca66feaf0cb9b5b97e533d42c6a8" kindref="member">AddSynOpr</ref>(pkSynOpr);</highlight></codeline>
<codeline lineno="115"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="class_global_server_1a462c439a46483417febc3504d7bef054" kindref="member">SendDB_AccountQuery</ref>(pkWaitAccount);</highlight></codeline>
<codeline lineno="116"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="_se_file_log_8h_1ab19c516672348b15ddabafb0bfb9d0a7" kindref="member">SeLogDebug</ref>(</highlight><highlight class="stringliteral">&quot;SendDB_AccountQuery<sp/>player[%s]&quot;</highlight><highlight class="normal">,<sp/>pkData-&gt;<ref refid="struct_se_l_g___account_login_1a2f1cb66ae8d1d57f960e666d6807bb27" kindref="member">acAccount</ref>);</highlight></codeline>
<codeline lineno="117"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal">;</highlight></codeline>
<codeline lineno="118"><highlight class="normal"></highlight></codeline>
<codeline lineno="119"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">//先查询完数据库再添加帐号缓存</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="120"><highlight class="normal"></highlight></codeline>
<codeline lineno="121"><highlight class="normal"></highlight><highlight class="comment">//<sp/><sp/><sp/><sp/><sp/><sp/>SeAccount<sp/>kAccount;</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="122"><highlight class="normal"></highlight><highlight class="comment">//<sp/><sp/><sp/><sp/><sp/><sp/>kAccount.dwPlayerID<sp/>=<sp/>dwPlayerID;</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="123"><highlight class="normal"></highlight><highlight class="comment">//<sp/><sp/><sp/><sp/><sp/><sp/>StrCpy(kAccount.acAccount,<sp/>sizeof(kAccount.acAccount),<sp/>pkData-&gt;acAccount);</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="124"><highlight class="normal"></highlight><highlight class="comment">//<sp/></highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="125"><highlight class="normal"></highlight><highlight class="comment">//<sp/><sp/><sp/><sp/><sp/><sp/>pkAccount<sp/>=<sp/>g_kCacheMgr.AddAccount(kAccount);</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="126"><highlight class="normal"></highlight><highlight class="comment">//<sp/><sp/><sp/><sp/><sp/><sp/>if<sp/>(!pkAccount)</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="127"><highlight class="normal"></highlight><highlight class="comment">//<sp/><sp/><sp/><sp/><sp/><sp/>{</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="128"><highlight class="normal"></highlight><highlight class="comment">//<sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>SeLogError(&quot;g_kCacheMgr<sp/>AddAccount<sp/>error<sp/>AccountID[%u]&quot;,<sp/>dwPlayerID);</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="129"><highlight class="normal"></highlight><highlight class="comment">//<sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>return;</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="130"><highlight class="normal"></highlight><highlight class="comment">//<sp/><sp/><sp/><sp/><sp/><sp/>}</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="131"><highlight class="normal"><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="132"><highlight class="normal"></highlight></codeline>
<codeline lineno="133"><highlight class="normal"><sp/><sp/><sp/><sp/><ref refid="struct_se_wait_login_account" kindref="compound">SeWaitLoginAccount</ref>*<sp/>pkWaitLogin<sp/>=<sp/>SeWaitLoginAccount::NEW();</highlight></codeline>
<codeline lineno="134"><highlight class="normal"><sp/><sp/><sp/><sp/>pkWaitLogin-&gt;<ref refid="struct_se_wait_login_account_1ab8c6328721e99dd953f9027026fc4d88" kindref="member">kLSSock</ref><sp/>=<sp/>pkLS-&gt;<ref refid="struct_se_virt_conn_1a2ed0654cfe8f298d1dc8fbe76a310df0" kindref="member">kSock</ref>;</highlight></codeline>
<codeline lineno="135"><highlight class="normal"><sp/><sp/><sp/><sp/>pkWaitLogin-&gt;<ref refid="struct_se_wait_login_account_1a091164d42696ae79365a299d0d948da0" kindref="member">dwPackKey</ref><sp/>=<sp/>pkData-&gt;<ref refid="struct_se_l_g___account_login_1ab3defdc0cd96b0f6a261022cbfcfe5fb" kindref="member">dwPackKey</ref>;</highlight></codeline>
<codeline lineno="136"><highlight class="normal"><sp/><sp/><sp/><sp/>pkWaitLogin-&gt;<ref refid="struct_se_wait_login_account_1afb884ac0d93900554bbef8da3b809d51" kindref="member">dwVersion</ref><sp/>=<sp/>pkData-&gt;<ref refid="struct_se_l_g___account_login_1a353f9bcb0de0ef73b69aa826957516d5" kindref="member">dwVersion</ref>;</highlight></codeline>
<codeline lineno="137"><highlight class="normal"><sp/><sp/><sp/><sp/>pkWaitLogin-&gt;<ref refid="struct_se_wait_login_account_1a68569deca8a2a5b431caef34eb3fe661" kindref="member">dwIP</ref><sp/>=<sp/>pkData-&gt;<ref refid="struct_se_l_g___account_login_1a7abc839e714516014965b4e5221b70fc" kindref="member">dwIP</ref>;</highlight></codeline>
<codeline lineno="138"><highlight class="normal"><sp/><sp/><sp/><sp/>pkWaitLogin-&gt;<ref refid="struct_se_wait_login_account_1aebc5fdae2bbabf8a1669a07417cd1173" kindref="member">bForceKick</ref><sp/>=<sp/>pkData-&gt;<ref refid="struct_se_l_g___account_login_1a18df586fe0acec81160fca5aab7db5a5" kindref="member">bForceKick</ref>;</highlight></codeline>
<codeline lineno="139"><highlight class="normal"><sp/><sp/><sp/><sp/>pkWaitLogin-&gt;<ref refid="struct_se_wait_login_account_1ac0f232216e852a1a5d918536b99ee979" kindref="member">dwBeginTime</ref><sp/>=<sp/><ref refid="class_global_server_1a0f7391b92b1ebf68ab0201806771afec" kindref="member">GetServerTime</ref>();</highlight></codeline>
<codeline lineno="140"><highlight class="normal"></highlight></codeline>
<codeline lineno="141"><highlight class="normal"><sp/><sp/><sp/><sp/><ref refid="class_global_server_1aec57364bffa3037dc2ee400384568b81" kindref="member">OnLoginQueryRet</ref>(pkWaitLogin,<sp/>pkAccount);</highlight></codeline>
<codeline lineno="142"><highlight class="normal"></highlight></codeline>
<codeline lineno="143"><highlight class="normal"><sp/><sp/><sp/><sp/>SeWaitLoginAccount::DEL(pkWaitLogin);</highlight></codeline>
<codeline lineno="144"><highlight class="normal">}</highlight></codeline>
<codeline lineno="145"><highlight class="normal"></highlight></codeline>
<codeline lineno="146"><highlight class="normal"></highlight><highlight class="keywordtype">void</highlight><highlight class="normal"><sp/><ref refid="class_global_server_1a342f1a57819ea63f16c403e3911ff1b0" kindref="member">GlobalServer::ProcessLG_PlayerLogin</ref>(<sp/><ref refid="struct_se_l_g___player_login" kindref="compound">SeLG_PlayerLogin</ref>*<sp/>pkData,<sp/></highlight><highlight class="keywordtype">int</highlight><highlight class="normal"><sp/>iSize,<sp/></highlight><highlight class="keywordtype">void</highlight><highlight class="normal">*<sp/>pkSender<sp/>)</highlight></codeline>
<codeline lineno="147"><highlight class="normal">{</highlight></codeline>
<codeline lineno="148"><highlight class="normal"><sp/><sp/><sp/><sp/><ref refid="struct_se_virt_conn" kindref="compound">SeVirtConn</ref>*<sp/>pkLS<sp/>=<sp/>(<ref refid="struct_se_virt_conn" kindref="compound">SeVirtConn</ref>*)pkSender;</highlight></codeline>
<codeline lineno="149"><highlight class="normal"></highlight></codeline>
<codeline lineno="150"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="comment">//<sp/>获取游客账号信息</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="151"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordtype">char</highlight><highlight class="normal"><sp/>acGuestID[<ref refid="_se_ptl_comm_define_8h_1af62c3a00672953c86a2586d53c60663aa18cafe3efe01affef3c9def797330428" kindref="member">SSD_MAX_ACCOUNT</ref>]<sp/>=<sp/>{0};</highlight></codeline>
<codeline lineno="152"><highlight class="normal"><sp/><sp/><sp/><sp/><ref refid="_se_ptl_comm_define_8h_1af7f6cc6b9a8752659fc0e51c18ce75ef" kindref="member">SePlatFlag</ref><sp/>ePlatFlag<sp/>=<sp/>(<ref refid="_se_ptl_comm_define_8h_1af7f6cc6b9a8752659fc0e51c18ce75ef" kindref="member">SePlatFlag</ref>)pkData-&gt;<ref refid="struct_se_l_g___player_login_1aea8e920acfca82911cb9eadc091ff5c3" kindref="member">iPlatFlag</ref>;</highlight></codeline>
<codeline lineno="153"><highlight class="normal"><sp/><sp/><sp/><sp/>if<sp/>(strcmp(pkData-&gt;<ref refid="struct_se_l_g___player_login_1af9ec3ced982a1a8e8e3a4e5b1133bc7e" kindref="member">acLoginType</ref>,<sp/></highlight><highlight class="stringliteral">&quot;LoginType_Quick_Visitor&quot;</highlight><highlight class="normal">)<sp/>==<sp/>0)</highlight></codeline>
<codeline lineno="154"><highlight class="normal"><sp/><sp/><sp/><sp/>{</highlight></codeline>
<codeline lineno="155"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>ePlatFlag<sp/>=<sp/><ref refid="_se_ptl_comm_define_8h_1af7f6cc6b9a8752659fc0e51c18ce75efad1a25517d044bfaa1956c318f88fe5fe" kindref="member">PFG_GUEST</ref>;</highlight></codeline>
<codeline lineno="156"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="_se_tool_8cpp_1a4d30fbe56257fc998ebc1346e53be0d8" kindref="member">StrCpy</ref>(acGuestID,<sp/></highlight><highlight class="keyword">sizeof</highlight><highlight class="normal">(acGuestID),<sp/>pkData-&gt;<ref refid="struct_se_l_g___player_login_1ab8ebb4bb0203bee0785394bc5e66a5fa" kindref="member">acAccount</ref>);</highlight></codeline>
<codeline lineno="157"><highlight class="normal"><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="158"><highlight class="normal"></highlight></codeline>
<codeline lineno="159"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordtype">char</highlight><highlight class="normal"><sp/>acGameAccount[<ref refid="_se_ptl_comm_define_8h_1af62c3a00672953c86a2586d53c60663aa18cafe3efe01affef3c9def797330428" kindref="member">SSD_MAX_ACCOUNT</ref>]<sp/>=<sp/>{0};</highlight></codeline>
<codeline lineno="160"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordtype">bool</highlight><highlight class="normal"><sp/>bSuccess<sp/>=<sp/><ref refid="class_global_server_1a808fa2b9308883886429ac9422783763" kindref="member">GenGameAccount</ref>(ePlatFlag,<sp/>pkData-&gt;<ref refid="struct_se_l_g___player_login_1acc77d7bdde4960a053a015b2e6e55e4a" kindref="member">dwAccountID</ref>,<sp/>pkData-&gt;<ref refid="struct_se_l_g___player_login_1ab8ebb4bb0203bee0785394bc5e66a5fa" kindref="member">acAccount</ref>,<sp/>acGameAccount);</highlight></codeline>
<codeline lineno="161"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(!bSuccess)</highlight></codeline>
<codeline lineno="162"><highlight class="normal"><sp/><sp/><sp/><sp/>{</highlight></codeline>
<codeline lineno="163"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="_se_file_log_8h_1a59fe2018c00666084724bec1365b41f5" kindref="member">SeLogError</ref>(</highlight><highlight class="stringliteral">&quot;ProcessLG_PlayerLogin<sp/>GenGameAccount<sp/>Fail:<sp/>account[%s]&quot;</highlight><highlight class="normal">,<sp/>pkData-&gt;<ref refid="struct_se_l_g___player_login_1ab8ebb4bb0203bee0785394bc5e66a5fa" kindref="member">acAccount</ref>);</highlight></codeline>
<codeline lineno="164"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="class_global_server_1a969ba44a6b49ab513446006edc11bb28" kindref="member">SendGL_AccountLoginFailed</ref>(pkData-&gt;<ref refid="struct_se_l_g___player_login_1aa2e5978f171d675c34a2bce4ebead3d6" kindref="member">dwPackKey</ref>,<sp/><ref refid="_se_ptl_comm_define_8h_1afcf506db0541bc2b07b7c9aa18f131f2ab2b9e309dd1c36dc0f541e4d6aafdccf" kindref="member">LFR_ACCOUNT_VERITYFY</ref>,<sp/>0,<sp/>0,<sp/>&amp;pkLS-&gt;<ref refid="struct_se_virt_conn_1a2ed0654cfe8f298d1dc8fbe76a310df0" kindref="member">kSock</ref>);</highlight></codeline>
<codeline lineno="165"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal">;</highlight></codeline>
<codeline lineno="166"><highlight class="normal"><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="167"><highlight class="normal"></highlight></codeline>
<codeline lineno="168"><highlight class="normal"><sp/><sp/><sp/><sp/><ref refid="struct_se_virt_conn" kindref="compound">SeVirtConn</ref>*<sp/>pkHttpConn<sp/>=<sp/><ref refid="_se_virt_conn_mgr_8cpp_1aa8e9d5beed961f4e26b9cadd49603980" kindref="member">g_kVirtConnMgr</ref>.<ref refid="class_se_virt_conn_mgr_1ad71bdf80c770bf13f932d45b0928ee56" kindref="member">GetClientConnByIndex</ref>(<ref refid="_se_ptl_define_8h_1aefb47f3959b8be9e164448819e4bb7f9a14ae0326467b75807a6f563065d0f2f5" kindref="member">SSI_HS</ref>);</highlight></codeline>
<codeline lineno="169"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(!pkHttpConn)</highlight></codeline>
<codeline lineno="170"><highlight class="normal"><sp/><sp/><sp/><sp/>{</highlight></codeline>
<codeline lineno="171"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="_se_file_log_8h_1a59fe2018c00666084724bec1365b41f5" kindref="member">SeLogError</ref>(</highlight><highlight class="stringliteral">&quot;ProcessLG_PlayerLogin<sp/>could&apos;t<sp/>find<sp/>httpsvr:<sp/>account[%s]&quot;</highlight><highlight class="normal">,<sp/>pkData-&gt;<ref refid="struct_se_l_g___player_login_1ab8ebb4bb0203bee0785394bc5e66a5fa" kindref="member">acAccount</ref>);</highlight></codeline>
<codeline lineno="172"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="class_global_server_1a969ba44a6b49ab513446006edc11bb28" kindref="member">SendGL_AccountLoginFailed</ref>(pkData-&gt;<ref refid="struct_se_l_g___player_login_1aa2e5978f171d675c34a2bce4ebead3d6" kindref="member">dwPackKey</ref>,<sp/><ref refid="_se_ptl_comm_define_8h_1afcf506db0541bc2b07b7c9aa18f131f2aead2e1d7551d746da75767e901117bd9" kindref="member">LFR_SERVER_DISCONNECT</ref>,<sp/>0,<sp/>0,<sp/>&amp;pkLS-&gt;<ref refid="struct_se_virt_conn_1a2ed0654cfe8f298d1dc8fbe76a310df0" kindref="member">kSock</ref>);</highlight></codeline>
<codeline lineno="173"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal">;</highlight></codeline>
<codeline lineno="174"><highlight class="normal"><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="175"><highlight class="normal"></highlight></codeline>
<codeline lineno="176"><highlight class="normal"><sp/><sp/><sp/><sp/><ref refid="struct_se_wait_login_account" kindref="compound">SeWaitLoginAccount</ref>*<sp/>pkWaitAccount<sp/>=<sp/>SeWaitLoginAccount::NEW();</highlight></codeline>
<codeline lineno="177"><highlight class="normal"><sp/><sp/><sp/><sp/>pkWaitAccount-&gt;<ref refid="struct_se_wait_login_account_1ab8c6328721e99dd953f9027026fc4d88" kindref="member">kLSSock</ref><sp/>=<sp/>pkLS-&gt;<ref refid="struct_se_virt_conn_1a2ed0654cfe8f298d1dc8fbe76a310df0" kindref="member">kSock</ref>;</highlight></codeline>
<codeline lineno="178"><highlight class="normal"><sp/><sp/><sp/><sp/>pkWaitAccount-&gt;<ref refid="struct_se_wait_login_account_1a091164d42696ae79365a299d0d948da0" kindref="member">dwPackKey</ref><sp/>=<sp/>pkData-&gt;<ref refid="struct_se_l_g___player_login_1aa2e5978f171d675c34a2bce4ebead3d6" kindref="member">dwPackKey</ref>;</highlight></codeline>
<codeline lineno="179"><highlight class="normal"><sp/><sp/><sp/><sp/>pkWaitAccount-&gt;<ref refid="struct_se_wait_login_account_1ac0f232216e852a1a5d918536b99ee979" kindref="member">dwBeginTime</ref><sp/>=<sp/><ref refid="class_global_server_1a0f7391b92b1ebf68ab0201806771afec" kindref="member">GetServerTime</ref>();</highlight></codeline>
<codeline lineno="180"><highlight class="normal"><sp/><sp/><sp/><sp/>pkWaitAccount-&gt;<ref refid="struct_se_wait_login_account_1afb884ac0d93900554bbef8da3b809d51" kindref="member">dwVersion</ref><sp/>=<sp/>pkData-&gt;<ref refid="struct_se_l_g___player_login_1a5442916215b5a45987795cd9b23ebff0" kindref="member">dwVersion</ref>;</highlight></codeline>
<codeline lineno="181"><highlight class="normal"><sp/><sp/><sp/><sp/>pkWaitAccount-&gt;<ref refid="struct_se_wait_login_account_1a68569deca8a2a5b431caef34eb3fe661" kindref="member">dwIP</ref><sp/>=<sp/>pkData-&gt;<ref refid="struct_se_l_g___player_login_1aedfea0cadebf45a1708fb2e0bb38bf26" kindref="member">dwIP</ref>;</highlight></codeline>
<codeline lineno="182"><highlight class="normal"><sp/><sp/><sp/><sp/>pkWaitAccount-&gt;<ref refid="struct_se_wait_login_account_1aebc5fdae2bbabf8a1669a07417cd1173" kindref="member">bForceKick</ref><sp/>=<sp/>pkData-&gt;<ref refid="struct_se_l_g___player_login_1ac63d25d7adabfa0e6a206801e0342ed8" kindref="member">bForceKick</ref>;</highlight></codeline>
<codeline lineno="183"><highlight class="normal"><sp/><sp/><sp/><sp/>pkWaitAccount-&gt;<ref refid="struct_se_wait_login_account_1ac5b74cd6df2349f2b48bb32b3fbe5029" kindref="member">ePlatFlag</ref><sp/>=<sp/>ePlatFlag;</highlight></codeline>
<codeline lineno="184"><highlight class="normal"><sp/><sp/><sp/><sp/><ref refid="_se_tool_8cpp_1a4d30fbe56257fc998ebc1346e53be0d8" kindref="member">StrCpy</ref>(pkWaitAccount-&gt;<ref refid="struct_se_wait_login_account_1aa1d2fcececbe8af0f52d65274d07a00f" kindref="member">acGameAccount</ref>,<sp/></highlight><highlight class="keyword">sizeof</highlight><highlight class="normal">(pkWaitAccount-&gt;<ref refid="struct_se_wait_login_account_1aa1d2fcececbe8af0f52d65274d07a00f" kindref="member">acGameAccount</ref>),<sp/>acGameAccount);</highlight></codeline>
<codeline lineno="185"><highlight class="normal"><sp/><sp/><sp/><sp/><ref refid="_se_tool_8cpp_1a4d30fbe56257fc998ebc1346e53be0d8" kindref="member">StrCpy</ref>(pkWaitAccount-&gt;<ref refid="struct_se_wait_login_account_1ac179fe98e5bb1f77c3fb8745d596184b" kindref="member">acMobileInfo</ref>,<sp/></highlight><highlight class="keyword">sizeof</highlight><highlight class="normal">(pkWaitAccount-&gt;<ref refid="struct_se_wait_login_account_1ac179fe98e5bb1f77c3fb8745d596184b" kindref="member">acMobileInfo</ref>),<sp/>pkData-&gt;<ref refid="struct_se_l_g___player_login_1ad03be1257e93426644a0fec384b744d4" kindref="member">acMobileInfo</ref>);</highlight></codeline>
<codeline lineno="186"><highlight class="normal"></highlight></codeline>
<codeline lineno="187"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(ePlatFlag<sp/>==<sp/><ref refid="_se_ptl_comm_define_8h_1af7f6cc6b9a8752659fc0e51c18ce75efab95015b87be40c46ddaa351bc73f1419" kindref="member">PFG_DIANHUN</ref><sp/>||<sp/>ePlatFlag<sp/>==<sp/><ref refid="_se_ptl_comm_define_8h_1af7f6cc6b9a8752659fc0e51c18ce75efad1a25517d044bfaa1956c318f88fe5fe" kindref="member">PFG_GUEST</ref>)</highlight></codeline>
<codeline lineno="188"><highlight class="normal"><sp/><sp/><sp/><sp/>{</highlight></codeline>
<codeline lineno="189"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">//<sp/>按照给定的规则计算签名</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="190"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordtype">char</highlight><highlight class="normal"><sp/>acSignPlain[512]<sp/>=<sp/>{0};</highlight></codeline>
<codeline lineno="191"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="_se_server_tool_8cpp_1ad2735ec90511f0d6ec1535cf448709b8" kindref="member">SPrintf</ref>(acSignPlain,<sp/></highlight><highlight class="keyword">sizeof</highlight><highlight class="normal">(acSignPlain),<sp/></highlight><highlight class="stringliteral">&quot;%s%s%s%u%u%s%sCheckAccountF9B5B48128E7D8747&quot;</highlight><highlight class="normal">,</highlight></codeline>
<codeline lineno="192"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>acGuestID,</highlight></codeline>
<codeline lineno="193"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>pkData-&gt;<ref refid="struct_se_l_g___player_login_1ad03be1257e93426644a0fec384b744d4" kindref="member">acMobileInfo</ref>,</highlight></codeline>
<codeline lineno="194"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>pkData-&gt;<ref refid="struct_se_l_g___player_login_1ab8ebb4bb0203bee0785394bc5e66a5fa" kindref="member">acAccount</ref>,<sp/></highlight></codeline>
<codeline lineno="195"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>pkData-&gt;<ref refid="struct_se_l_g___player_login_1acc77d7bdde4960a053a015b2e6e55e4a" kindref="member">dwAccountID</ref>,</highlight></codeline>
<codeline lineno="196"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="src_2_global_server_def_8h_1a4b8ccf0bf46575671a44659ec3daa697a474a72a5ac1e3d565ede673f09db9cf1" kindref="member">APPID_DIANHUN</ref>,</highlight></codeline>
<codeline lineno="197"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>pkData-&gt;<ref refid="struct_se_l_g___player_login_1af9ec3ced982a1a8e8e3a4e5b1133bc7e" kindref="member">acLoginType</ref>,</highlight></codeline>
<codeline lineno="198"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>pkData-&gt;<ref refid="struct_se_l_g___player_login_1aa34b4cb9cc13591f504304825ec3d9fe" kindref="member">acToken</ref>);</highlight></codeline>
<codeline lineno="199"><highlight class="normal"></highlight></codeline>
<codeline lineno="200"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="struct_te_m_d5" kindref="compound">TeMD5</ref><sp/>kSignMD5<sp/>=<sp/><ref refid="_te_misc_8cpp_1aabf953ad61a495b9024aef916dd8bbd0" kindref="member">GetMD5</ref>(acSignPlain,<sp/>strlen(acSignPlain));</highlight></codeline>
<codeline lineno="201"><highlight class="normal"></highlight></codeline>
<codeline lineno="202"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordtype">char</highlight><highlight class="normal"><sp/>acSignCipher[64]<sp/>=<sp/>{0};</highlight></codeline>
<codeline lineno="203"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="_se_tool_8cpp_1a4d30fbe56257fc998ebc1346e53be0d8" kindref="member">StrCpy</ref>(acSignCipher,<sp/></highlight><highlight class="keyword">sizeof</highlight><highlight class="normal">(acSignCipher),<sp/><ref refid="_se_tool_8h_1adbd57b0a2e2b5bccf6ba29ea002839e8" kindref="member">GetMD52Str</ref>(kSignMD5.<ref refid="struct_te_m_d5_1a4a87587ff2453882ccfb8a1fe64b9b94" kindref="member">abyMD5</ref>));</highlight></codeline>
<codeline lineno="204"><highlight class="normal"></highlight></codeline>
<codeline lineno="205"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="struct_se_syn_opr" kindref="compound">SeSynOpr</ref>*<sp/>pkSynOpr<sp/>=<sp/></highlight><highlight class="keyword">new</highlight><highlight class="normal"><sp/><ref refid="struct_se_syn_opr" kindref="compound">SeSynOpr</ref>;</highlight></codeline>
<codeline lineno="206"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>pkSynOpr-&gt;<ref refid="struct_se_syn_opr_1a878609860d903fc401d7be95f7b39d7a" kindref="member">pkVoid</ref><sp/>=<sp/>(</highlight><highlight class="keywordtype">void</highlight><highlight class="normal">*)pkWaitAccount;</highlight></codeline>
<codeline lineno="207"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>DWord<sp/>dwPackKey<sp/>=<sp/><ref refid="src_2_global_server_8cpp_1a842dd477472778ad2894948f2fb7cfd9" kindref="member">g_kSynMgr</ref>.<ref refid="class_se_syn_mgr_1a4835ca66feaf0cb9b5b97e533d42c6a8" kindref="member">AddSynOpr</ref>(pkSynOpr);</highlight></codeline>
<codeline lineno="208"><highlight class="normal"></highlight></codeline>
<codeline lineno="209"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(!<ref refid="class_global_server_1afbf729239c5610395f5492b41ac2cbcf" kindref="member">SendHS_DHAccountLogin</ref>(pkHttpConn-&gt;<ref refid="struct_se_virt_conn_1a2ed0654cfe8f298d1dc8fbe76a310df0" kindref="member">kSock</ref>,<sp/>dwPackKey,<sp/>pkData,<sp/>acGuestID,<sp/>acSignCipher))</highlight></codeline>
<codeline lineno="210"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>{</highlight></codeline>
<codeline lineno="211"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>SeWaitLoginAccount::DEL(pkWaitAccount);</highlight></codeline>
<codeline lineno="212"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>pkWaitAccount<sp/>=<sp/>NULL;</highlight></codeline>
<codeline lineno="213"><highlight class="normal"></highlight></codeline>
<codeline lineno="214"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>pkSynOpr<sp/>=<sp/>(<ref refid="struct_se_syn_opr" kindref="compound">SeSynOpr</ref>*)<ref refid="src_2_global_server_8cpp_1a842dd477472778ad2894948f2fb7cfd9" kindref="member">g_kSynMgr</ref>.<ref refid="class_se_syn_mgr_1a80689a25c3aa30e57d561338af8432c0" kindref="member">GetOutSynOpr</ref>(dwPackKey);</highlight></codeline>
<codeline lineno="215"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(pkSynOpr)</highlight></codeline>
<codeline lineno="216"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>{</highlight></codeline>
<codeline lineno="217"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="_se_define_8h_1abdf73516460d2bbbfdea4a92bcecc080" kindref="member">SAFE_DELETE</ref>(pkSynOpr);</highlight></codeline>
<codeline lineno="218"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="219"><highlight class="normal"></highlight></codeline>
<codeline lineno="220"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="class_global_server_1a969ba44a6b49ab513446006edc11bb28" kindref="member">SendGL_AccountLoginFailed</ref>(pkData-&gt;<ref refid="struct_se_l_g___player_login_1aa2e5978f171d675c34a2bce4ebead3d6" kindref="member">dwPackKey</ref>,<sp/><ref refid="_se_ptl_comm_define_8h_1afcf506db0541bc2b07b7c9aa18f131f2aead2e1d7551d746da75767e901117bd9" kindref="member">LFR_SERVER_DISCONNECT</ref>,<sp/>0,<sp/>0,<sp/>&amp;pkLS-&gt;<ref refid="struct_se_virt_conn_1a2ed0654cfe8f298d1dc8fbe76a310df0" kindref="member">kSock</ref>);</highlight></codeline>
<codeline lineno="221"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal">;</highlight></codeline>
<codeline lineno="222"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="223"><highlight class="normal"><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="224"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">else</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="225"><highlight class="normal"><sp/><sp/><sp/><sp/>{</highlight></codeline>
<codeline lineno="226"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>SeWaitLoginAccount::DEL(pkWaitAccount);</highlight></codeline>
<codeline lineno="227"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>pkWaitAccount<sp/>=<sp/>NULL;</highlight></codeline>
<codeline lineno="228"><highlight class="normal"></highlight></codeline>
<codeline lineno="229"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="class_global_server_1a969ba44a6b49ab513446006edc11bb28" kindref="member">SendGL_AccountLoginFailed</ref>(pkData-&gt;<ref refid="struct_se_l_g___player_login_1aa2e5978f171d675c34a2bce4ebead3d6" kindref="member">dwPackKey</ref>,<sp/><ref refid="_se_ptl_comm_define_8h_1afcf506db0541bc2b07b7c9aa18f131f2a07534a5cf02641a5ed6510a54d9ab6aa" kindref="member">LFR_INVALID_PLAT</ref>,<sp/>0,<sp/>0,<sp/>&amp;pkLS-&gt;<ref refid="struct_se_virt_conn_1a2ed0654cfe8f298d1dc8fbe76a310df0" kindref="member">kSock</ref>);</highlight></codeline>
<codeline lineno="230"><highlight class="normal"><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="231"><highlight class="normal">}</highlight></codeline>
<codeline lineno="232"><highlight class="normal"></highlight></codeline>
<codeline lineno="233"><highlight class="normal"></highlight><highlight class="keywordtype">void</highlight><highlight class="normal"><sp/><ref refid="class_global_server_1a0ed5e7688c53f98efb1b51f329bb7b18" kindref="member">GlobalServer::ProcessLG_PlayerTownIndex</ref>(<ref refid="struct_se_l_g___player_town_index" kindref="compound">SeLG_PlayerTownIndex</ref>*<sp/>pkData,<sp/></highlight><highlight class="keywordtype">int</highlight><highlight class="normal"><sp/>iSize,<sp/></highlight><highlight class="keywordtype">void</highlight><highlight class="normal">*<sp/>pkSender)</highlight></codeline>
<codeline lineno="234"><highlight class="normal">{</highlight></codeline>
<codeline lineno="235"><highlight class="normal"><sp/><sp/><sp/><sp/><ref refid="struct_se_d_b_time" kindref="compound">SeDBTime</ref><sp/>kNowTime;</highlight></codeline>
<codeline lineno="236"><highlight class="normal"><sp/><sp/><sp/><sp/><ref refid="_se_tool_8cpp_1ab5215c746438d47cd602ac9cd661d806" kindref="member">NowTime</ref>(kNowTime);</highlight></codeline>
<codeline lineno="237"><highlight class="normal"></highlight></codeline>
<codeline lineno="238"><highlight class="normal"><sp/><sp/><sp/><sp/><ref refid="struct_se_account" kindref="compound">SeAccount</ref>*<sp/>pkAccount<sp/>=<sp/><ref refid="src_2_se_cache_mgr_8cpp_1ab94106ad98afc36210e2252c4ed5cf77" kindref="member">g_kCacheMgr</ref>.<ref refid="class_se_cache_mgr_1a4641bb4d7efe4df9545d6247284b6bb1" kindref="member">GetAccountByID</ref>(pkData-&gt;<ref refid="struct_se_l_g___player_town_index_1aa52cabdc9c3621c91c51a96d46f3dcb5" kindref="member">dwPlayerID</ref>);</highlight></codeline>
<codeline lineno="239"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(pkAccount)</highlight></codeline>
<codeline lineno="240"><highlight class="normal"><sp/><sp/><sp/><sp/>{</highlight></codeline>
<codeline lineno="241"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>pkAccount-&gt;<ref refid="struct_se_account_1a576679d28726ab18497999cb448a2801" kindref="member">iTownIndex</ref><sp/>=<sp/>pkData-&gt;<ref refid="struct_se_l_g___player_town_index_1a679e4c19014b3b65d121667dfe54bff5" kindref="member">iTownIndex</ref>;</highlight></codeline>
<codeline lineno="242"><highlight class="normal"><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="243"><highlight class="normal">}</highlight></codeline>
<codeline lineno="244"><highlight class="normal"></highlight></codeline>
<codeline lineno="245"><highlight class="normal"></highlight><highlight class="keywordtype">void</highlight><highlight class="normal"><sp/><ref refid="class_global_server_1a12afec6aca1f01be9e7cb1a25b8848f2" kindref="member">GlobalServer::ProcessLG_PlayerLogout</ref>(<ref refid="struct_se_l_g___player_logout" kindref="compound">SeLG_PlayerLogout</ref>*<sp/>pkData,<sp/></highlight><highlight class="keywordtype">int</highlight><highlight class="normal"><sp/>iSize,<sp/></highlight><highlight class="keywordtype">void</highlight><highlight class="normal">*<sp/>pkSender)</highlight></codeline>
<codeline lineno="246"><highlight class="normal">{</highlight></codeline>
<codeline lineno="247"><highlight class="normal"><sp/><sp/><sp/><sp/><ref refid="src_2_se_cache_mgr_8cpp_1ab94106ad98afc36210e2252c4ed5cf77" kindref="member">g_kCacheMgr</ref>.<ref refid="class_se_cache_mgr_1a6b2c37857f4d7986d0cbab356351f1ee" kindref="member">OnAccountLogout</ref>(pkData-&gt;<ref refid="struct_se_l_g___player_logout_1af586561c44f2269844299630ad9ce035" kindref="member">dwPlayerID</ref>);</highlight></codeline>
<codeline lineno="248"><highlight class="normal">}</highlight></codeline>
    </programlisting>
    <location file="F:/TeamWork/ServerVersion/projects/server/Server/Server/GlobalServer/Src/SeLGProcess.cpp"/>
  </compounddef>
</doxygen>
