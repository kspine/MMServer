<?xml version='1.0' encoding='UTF-8' standalone='no'?>
<doxygen xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xsi:noNamespaceSchemaLocation="compound.xsd" version="1.8.6">
  <compounddef id="_src_2_global_server_8cpp" kind="file">
    <compoundname>GlobalServer.cpp</compoundname>
    <includes refid="_src_2_global_server_8h" local="yes">GlobalServer.h</includes>
    <includes refid="_se_server_tool_8h" local="yes">SeServerTool.h</includes>
    <incdepgraph>
      <node id="25258">
        <label>list</label>
      </node>
      <node id="25252">
        <label>locale</label>
      </node>
      <node id="25287">
        <label>SePtl_GS_To_LS.h</label>
        <link refid="_se_ptl___g_s___to___l_s_8h"/>
        <childnode refid="25283" relation="include">
        </childnode>
      </node>
      <node id="25297">
        <label>SeWGProcess.inl</label>
        <link refid="_se_w_g_process_8inl"/>
      </node>
      <node id="25262">
        <label>queue</label>
      </node>
      <node id="25256">
        <label>limits</label>
      </node>
      <node id="25285">
        <label>SePtlCommDefine.h</label>
        <link refid="_se_ptl_comm_define_8h"/>
      </node>
      <node id="25272">
        <label>SeMemPool.h</label>
        <link refid="_se_mem_pool_8h"/>
        <childnode refid="25237" relation="include">
        </childnode>
        <childnode refid="25267" relation="include">
        </childnode>
        <childnode refid="25244" relation="include">
        </childnode>
      </node>
      <node id="25239">
        <label>windows.h</label>
      </node>
      <node id="25244">
        <label>assert.h</label>
      </node>
      <node id="25288">
        <label>SePtl_LS_To_GS.h</label>
        <link refid="_se_ptl___l_s___to___g_s_8h"/>
        <childnode refid="25283" relation="include">
        </childnode>
      </node>
      <node id="25291">
        <label>SeTimer.h</label>
        <link refid="_se_timer_8h"/>
      </node>
      <node id="25298">
        <label>SeLGProcess.inl</label>
        <link refid="_se_l_g_process_8inl"/>
      </node>
      <node id="25242">
        <label>stdlib.h</label>
      </node>
      <node id="25267">
        <label>EsLock.h</label>
      </node>
      <node id="25246">
        <label>cmath</label>
      </node>
      <node id="25286">
        <label>SePtl_GS_To_WS.h</label>
        <link refid="_se_ptl___g_s___to___w_s_8h"/>
        <childnode refid="25283" relation="include">
        </childnode>
      </node>
      <node id="25282">
        <label>SePtl_WS_To_GS.h</label>
        <link refid="_se_ptl___w_s___to___g_s_8h"/>
        <childnode refid="25283" relation="include">
        </childnode>
      </node>
      <node id="25234">
        <label>GlobalServer/Src/GlobalServer.cpp</label>
        <link refid="Src/GlobalServer.cpp"/>
        <childnode refid="25235" relation="include">
        </childnode>
        <childnode refid="25292" relation="include">
        </childnode>
      </node>
      <node id="25255">
        <label>string</label>
      </node>
      <node id="25289">
        <label>SePtl_HS_To_HS.h</label>
        <link refid="_se_ptl___h_s___to___h_s_8h"/>
        <childnode refid="25283" relation="include">
        </childnode>
      </node>
      <node id="25259">
        <label>map</label>
      </node>
      <node id="25265">
        <label>SeFileLog.h</label>
        <link refid="_se_file_log_8h"/>
        <childnode refid="25266" relation="include">
        </childnode>
        <childnode refid="25248" relation="include">
        </childnode>
        <childnode refid="25267" relation="include">
        </childnode>
      </node>
      <node id="25241">
        <label>conio.h</label>
      </node>
      <node id="25284">
        <label>SePtlRandomNumDef.h</label>
        <link refid="_se_ptl_random_num_def_8h"/>
      </node>
      <node id="25295">
        <label>SeHttpSend.inl</label>
        <link refid="_global_server_2_src_2_se_http_send_8inl"/>
      </node>
      <node id="25240">
        <label>direct.h</label>
      </node>
      <node id="25253">
        <label>fstream</label>
      </node>
      <node id="25278">
        <label>SeTool.h</label>
        <link refid="_se_tool_8h"/>
        <childnode refid="25237" relation="include">
        </childnode>
        <childnode refid="25271" relation="include">
        </childnode>
        <childnode refid="25279" relation="include">
        </childnode>
        <childnode refid="25280" relation="include">
        </childnode>
        <childnode refid="25250" relation="include">
        </childnode>
        <childnode refid="25281" relation="include">
        </childnode>
      </node>
      <node id="25238">
        <label>winsock2.h</label>
      </node>
      <node id="25275">
        <label>TeDataBaseMgr.h</label>
      </node>
      <node id="25236">
        <label>SeServerMainDef.h</label>
        <link refid="_se_server_main_def_8h"/>
        <childnode refid="25237" relation="include">
        </childnode>
      </node>
      <node id="25280">
        <label>TeMisc.h</label>
        <link refid="_te_misc_8h"/>
        <childnode refid="25249" relation="include">
        </childnode>
      </node>
      <node id="25268">
        <label>SeCacheMgr.h</label>
        <link refid="_src_2_se_cache_mgr_8h"/>
        <childnode refid="25269" relation="include">
        </childnode>
      </node>
      <node id="25277">
        <label>SeServerDefine.h</label>
        <link refid="_se_server_define_8h"/>
        <childnode refid="25271" relation="include">
        </childnode>
        <childnode refid="25273" relation="include">
        </childnode>
        <childnode refid="25278" relation="include">
        </childnode>
      </node>
      <node id="25249">
        <label>string.h</label>
      </node>
      <node id="25276">
        <label>SeConfig.h</label>
        <link refid="_se_config_8h"/>
        <childnode refid="25271" relation="include">
        </childnode>
      </node>
      <node id="25247">
        <label>ctime</label>
      </node>
      <node id="25273">
        <label>TeNetMgr.h</label>
      </node>
      <node id="25257">
        <label>vector</label>
      </node>
      <node id="25270">
        <label>GlobalServerDef.h</label>
        <link refid="_src_2_global_server_def_8h"/>
        <childnode refid="25271" relation="include">
        </childnode>
        <childnode refid="25272" relation="include">
        </childnode>
        <childnode refid="25273" relation="include">
        </childnode>
        <childnode refid="25274" relation="include">
        </childnode>
        <childnode refid="25275" relation="include">
        </childnode>
        <childnode refid="25276" relation="include">
        </childnode>
        <childnode refid="25277" relation="include">
        </childnode>
        <childnode refid="25282" relation="include">
        </childnode>
        <childnode refid="25286" relation="include">
        </childnode>
        <childnode refid="25287" relation="include">
        </childnode>
        <childnode refid="25288" relation="include">
        </childnode>
        <childnode refid="25289" relation="include">
        </childnode>
      </node>
      <node id="25263">
        <label>new</label>
      </node>
      <node id="25235">
        <label>GlobalServer.h</label>
        <link refid="_src_2_global_server_8h"/>
        <childnode refid="25236" relation="include">
        </childnode>
        <childnode refid="25265" relation="include">
        </childnode>
        <childnode refid="25268" relation="include">
        </childnode>
        <childnode refid="25290" relation="include">
        </childnode>
        <childnode refid="25292" relation="include">
        </childnode>
        <childnode refid="25270" relation="include">
        </childnode>
        <childnode refid="25293" relation="include">
        </childnode>
        <childnode refid="25294" relation="include">
        </childnode>
        <childnode refid="25295" relation="include">
        </childnode>
        <childnode refid="25296" relation="include">
        </childnode>
        <childnode refid="25297" relation="include">
        </childnode>
        <childnode refid="25298" relation="include">
        </childnode>
        <childnode refid="25299" relation="include">
        </childnode>
        <childnode refid="25300" relation="include">
        </childnode>
      </node>
      <node id="25283">
        <label>SePtlDefine.h</label>
        <link refid="_se_ptl_define_8h"/>
        <childnode refid="25237" relation="include">
        </childnode>
        <childnode refid="25271" relation="include">
        </childnode>
        <childnode refid="25278" relation="include">
        </childnode>
        <childnode refid="25284" relation="include">
        </childnode>
        <childnode refid="25285" relation="include">
        </childnode>
        <childnode refid="25272" relation="include">
        </childnode>
      </node>
      <node id="25271">
        <label>SeShareDef.h</label>
        <link refid="_se_share_def_8h"/>
        <childnode refid="25237" relation="include">
        </childnode>
      </node>
      <node id="25254">
        <label>sstream</label>
      </node>
      <node id="25281">
        <label>EsString.h</label>
      </node>
      <node id="25290">
        <label>SeVirtConnMgr.h</label>
        <link refid="_se_virt_conn_mgr_8h"/>
        <childnode refid="25271" relation="include">
        </childnode>
        <childnode refid="25273" relation="include">
        </childnode>
        <childnode refid="25283" relation="include">
        </childnode>
        <childnode refid="25291" relation="include">
        </childnode>
      </node>
      <node id="25294">
        <label>SeGLSend.inl</label>
        <link refid="_se_g_l_send_8inl"/>
      </node>
      <node id="25300">
        <label>SeDBProcess.inl</label>
        <link refid="_global_server_2_src_2_se_d_b_process_8inl"/>
      </node>
      <node id="25237">
        <label>SeInclude.h</label>
        <link refid="_se_include_8h"/>
        <childnode refid="25238" relation="include">
        </childnode>
        <childnode refid="25239" relation="include">
        </childnode>
        <childnode refid="25240" relation="include">
        </childnode>
        <childnode refid="25241" relation="include">
        </childnode>
        <childnode refid="25242" relation="include">
        </childnode>
        <childnode refid="25243" relation="include">
        </childnode>
        <childnode refid="25244" relation="include">
        </childnode>
        <childnode refid="25245" relation="include">
        </childnode>
        <childnode refid="25246" relation="include">
        </childnode>
        <childnode refid="25247" relation="include">
        </childnode>
        <childnode refid="25248" relation="include">
        </childnode>
        <childnode refid="25249" relation="include">
        </childnode>
        <childnode refid="25250" relation="include">
        </childnode>
        <childnode refid="25251" relation="include">
        </childnode>
        <childnode refid="25252" relation="include">
        </childnode>
        <childnode refid="25253" relation="include">
        </childnode>
        <childnode refid="25254" relation="include">
        </childnode>
        <childnode refid="25255" relation="include">
        </childnode>
        <childnode refid="25256" relation="include">
        </childnode>
        <childnode refid="25257" relation="include">
        </childnode>
        <childnode refid="25258" relation="include">
        </childnode>
        <childnode refid="25259" relation="include">
        </childnode>
        <childnode refid="25260" relation="include">
        </childnode>
        <childnode refid="25261" relation="include">
        </childnode>
        <childnode refid="25262" relation="include">
        </childnode>
        <childnode refid="25263" relation="include">
        </childnode>
        <childnode refid="25264" relation="include">
        </childnode>
      </node>
      <node id="25266">
        <label>time.h</label>
      </node>
      <node id="25243">
        <label>math.h</label>
      </node>
      <node id="25274">
        <label>SeSynMgr.h</label>
        <link refid="_se_syn_mgr_8h"/>
        <childnode refid="25237" relation="include">
        </childnode>
      </node>
      <node id="25250">
        <label>EsType.h</label>
      </node>
      <node id="25245">
        <label>cctype</label>
      </node>
      <node id="25279">
        <label>SeToolTemplate.inl</label>
        <link refid="_se_tool_template_8inl"/>
      </node>
      <node id="25293">
        <label>SeGWSend.inl</label>
        <link refid="_se_g_w_send_8inl"/>
      </node>
      <node id="25296">
        <label>SeDBSend.inl</label>
        <link refid="_global_server_2_src_2_se_d_b_send_8inl"/>
      </node>
      <node id="25260">
        <label>unordered_map</label>
      </node>
      <node id="25264">
        <label>SeDefine.h</label>
        <link refid="_se_define_8h"/>
      </node>
      <node id="25292">
        <label>SeServerTool.h</label>
        <link refid="_se_server_tool_8h"/>
        <childnode refid="25237" relation="include">
        </childnode>
        <childnode refid="25278" relation="include">
        </childnode>
        <childnode refid="25283" relation="include">
        </childnode>
      </node>
      <node id="25269">
        <label>SeCacheMgrDef.h</label>
        <link refid="_src_2_se_cache_mgr_def_8h"/>
        <childnode refid="25270" relation="include">
        </childnode>
      </node>
      <node id="25299">
        <label>SeHttpProcess.inl</label>
        <link refid="_global_server_2_src_2_se_http_process_8inl"/>
      </node>
      <node id="25261">
        <label>set</label>
      </node>
      <node id="25251">
        <label>algorithm</label>
      </node>
      <node id="25248">
        <label>stdio.h</label>
      </node>
    </incdepgraph>
      <sectiondef kind="var">
      <memberdef kind="variable" id="_src_2_global_server_8cpp_1ad3c5be510462fb4da4ca8841ca39ae2a" prot="public" static="no" mutable="no">
        <type><ref refid="class_global_server" kindref="compound">GlobalServer</ref></type>
        <definition>GlobalServer g_kGlobalServer</definition>
        <argsstring></argsstring>
        <name>g_kGlobalServer</name>
        <briefdescription>
        </briefdescription>
        <detaileddescription>
        </detaileddescription>
        <inbodydescription>
        </inbodydescription>
        <location file="F:/TeamWork/ServerVersion/projects/server/Server/Server/GlobalServer/Src/GlobalServer.cpp" line="4" column="1" bodyfile="F:/TeamWork/ServerVersion/projects/server/Server/Server/GlobalServer/Src/GlobalServer.cpp" bodystart="4" bodyend="-1"/>
      </memberdef>
      <memberdef kind="variable" id="_src_2_global_server_8cpp_1a842dd477472778ad2894948f2fb7cfd9" prot="public" static="no" mutable="no">
        <type><ref refid="class_se_syn_mgr" kindref="compound">SeSynMgr</ref></type>
        <definition>SeSynMgr g_kSynMgr</definition>
        <argsstring></argsstring>
        <name>g_kSynMgr</name>
        <briefdescription>
        </briefdescription>
        <detaileddescription>
        </detaileddescription>
        <inbodydescription>
        </inbodydescription>
        <location file="F:/TeamWork/ServerVersion/projects/server/Server/Server/GlobalServer/Src/GlobalServer.cpp" line="5" column="1" bodyfile="F:/TeamWork/ServerVersion/projects/server/Server/Server/GlobalServer/Src/GlobalServer.cpp" bodystart="5" bodyend="-1"/>
      </memberdef>
      </sectiondef>
      <sectiondef kind="func">
      <memberdef kind="function" id="_src_2_global_server_8cpp_1a0845ecb4aaccf919e823c0c4e14849f3" prot="public" static="no" const="no" explicit="no" inline="no" virt="non-virtual">
        <type></type>
        <definition>IMPLEMENT_POOL1</definition>
        <argsstring>(SeDBQuery, SeQueryType, 256, 256)</argsstring>
        <name>IMPLEMENT_POOL1</name>
        <param>
          <type><ref refid="struct_se_d_b_query" kindref="compound">SeDBQuery</ref></type>
        </param>
        <param>
          <type><ref refid="_src_2_d_b_server_def_8h_1aa7b9fd5ab21ba090d0a4f10c2e866608" kindref="member">SeQueryType</ref></type>
        </param>
        <param>
          <type>256</type>
        </param>
        <param>
          <type>256</type>
        </param>
        <briefdescription>
        </briefdescription>
        <detaileddescription>
        </detaileddescription>
        <inbodydescription>
        </inbodydescription>
        <location file="F:/TeamWork/ServerVersion/projects/server/Server/Server/GlobalServer/Src/GlobalServer.cpp" line="7" column="1"/>
      </memberdef>
      <memberdef kind="function" id="_src_2_global_server_8cpp_1a4c7bc51537bcebf7bb49276c53951520" prot="public" static="no" const="no" explicit="no" inline="no" virt="non-virtual">
        <type></type>
        <definition>IMPLEMENT_POOL</definition>
        <argsstring>(SeWaitLoginAccount, 512, 256)</argsstring>
        <name>IMPLEMENT_POOL</name>
        <param>
          <type><ref refid="struct_se_wait_login_account" kindref="compound">SeWaitLoginAccount</ref></type>
        </param>
        <param>
          <type>512</type>
        </param>
        <param>
          <type>256</type>
        </param>
        <briefdescription>
        </briefdescription>
        <detaileddescription>
        </detaileddescription>
        <inbodydescription>
        </inbodydescription>
        <location file="F:/TeamWork/ServerVersion/projects/server/Server/Server/GlobalServer/Src/GlobalServer.cpp" line="8" column="1"/>
      </memberdef>
      <memberdef kind="function" id="_src_2_global_server_8cpp_1aff3731bec214b8457eff10460652f3b0" prot="public" static="no" const="no" explicit="no" inline="no" virt="non-virtual">
        <type></type>
        <definition>IMPLEMENT_POOL</definition>
        <argsstring>(SeAddNickName, 512, 512)</argsstring>
        <name>IMPLEMENT_POOL</name>
        <param>
          <type><ref refid="struct_se_add_nick_name" kindref="compound">SeAddNickName</ref></type>
        </param>
        <param>
          <type>512</type>
        </param>
        <param>
          <type>512</type>
        </param>
        <briefdescription>
        </briefdescription>
        <detaileddescription>
        </detaileddescription>
        <inbodydescription>
        </inbodydescription>
        <location file="F:/TeamWork/ServerVersion/projects/server/Server/Server/GlobalServer/Src/GlobalServer.cpp" line="9" column="1"/>
      </memberdef>
      <memberdef kind="function" id="_src_2_global_server_8cpp_1a03595bfee2a55045aa751deab1e562d0" prot="public" static="no" const="no" explicit="no" inline="no" virt="non-virtual">
        <type>bool</type>
        <definition>bool sendRegPack</definition>
        <argsstring>(int iServerIdx)</argsstring>
        <name>sendRegPack</name>
        <param>
          <type>int</type>
          <declname>iServerIdx</declname>
        </param>
        <briefdescription>
        </briefdescription>
        <detaileddescription>
        </detaileddescription>
        <inbodydescription>
        </inbodydescription>
        <location file="F:/TeamWork/ServerVersion/projects/server/Server/Server/GlobalServer/Src/GlobalServer.cpp" line="11" column="1" bodyfile="F:/TeamWork/ServerVersion/projects/server/Server/Server/GlobalServer/Src/GlobalServer.cpp" bodystart="11" bodyend="14"/>
      </memberdef>
      <memberdef kind="function" id="_src_2_global_server_8cpp_1a1829928f14924b8a97ed00808758de08" prot="public" static="no" const="no" explicit="no" inline="no" virt="non-virtual">
        <type>bool</type>
        <definition>bool sendHeartPack</definition>
        <argsstring>(int iServerIdx)</argsstring>
        <name>sendHeartPack</name>
        <param>
          <type>int</type>
          <declname>iServerIdx</declname>
        </param>
        <briefdescription>
        </briefdescription>
        <detaileddescription>
        </detaileddescription>
        <inbodydescription>
        </inbodydescription>
        <location file="F:/TeamWork/ServerVersion/projects/server/Server/Server/GlobalServer/Src/GlobalServer.cpp" line="16" column="1" bodyfile="F:/TeamWork/ServerVersion/projects/server/Server/Server/GlobalServer/Src/GlobalServer.cpp" bodystart="16" bodyend="19"/>
      </memberdef>
      </sectiondef>
    <briefdescription>
    </briefdescription>
    <detaileddescription>
    </detaileddescription>
    <programlisting>
<codeline lineno="1"><highlight class="preprocessor">#include<sp/>&quot;<ref refid="_src_2_global_server_8h" kindref="compound">GlobalServer.h</ref>&quot;</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="2"><highlight class="normal"></highlight><highlight class="preprocessor">#include<sp/>&quot;<ref refid="_se_server_tool_8h" kindref="compound">SeServerTool.h</ref>&quot;</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="3"><highlight class="normal"></highlight></codeline>
<codeline lineno="4" refid="_src_2_global_server_8cpp_1ad3c5be510462fb4da4ca8841ca39ae2a" refkind="member"><highlight class="normal"><ref refid="class_global_server" kindref="compound">GlobalServer</ref><sp/><sp/><sp/><sp/><ref refid="src_2_global_server_8cpp_1ad3c5be510462fb4da4ca8841ca39ae2a" kindref="member">g_kGlobalServer</ref>;</highlight></codeline>
<codeline lineno="5" refid="_src_2_global_server_8cpp_1a842dd477472778ad2894948f2fb7cfd9" refkind="member"><highlight class="normal"><ref refid="class_se_syn_mgr" kindref="compound">SeSynMgr</ref><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="src_2_global_server_8cpp_1a842dd477472778ad2894948f2fb7cfd9" kindref="member">g_kSynMgr</ref>;</highlight></codeline>
<codeline lineno="6"><highlight class="normal"></highlight></codeline>
<codeline lineno="7"><highlight class="normal"><ref refid="src_2_global_server_8cpp_1a0845ecb4aaccf919e823c0c4e14849f3" kindref="member">IMPLEMENT_POOL1</ref>(<ref refid="struct_se_d_b_query" kindref="compound">SeDBQuery</ref>,<sp/><ref refid="_src_2_d_b_server_def_8h_1aa7b9fd5ab21ba090d0a4f10c2e866608" kindref="member">SeQueryType</ref>,256,256);</highlight></codeline>
<codeline lineno="8"><highlight class="normal"><ref refid="src_2_global_server_8cpp_1a4c7bc51537bcebf7bb49276c53951520" kindref="member">IMPLEMENT_POOL</ref>(<ref refid="struct_se_wait_login_account" kindref="compound">SeWaitLoginAccount</ref>,<sp/>512,<sp/>256);</highlight></codeline>
<codeline lineno="9"><highlight class="normal"><ref refid="src_2_global_server_8cpp_1a4c7bc51537bcebf7bb49276c53951520" kindref="member">IMPLEMENT_POOL</ref>(<ref refid="struct_se_add_nick_name" kindref="compound">SeAddNickName</ref>,<sp/>512,<sp/>512);</highlight></codeline>
<codeline lineno="10"><highlight class="normal"></highlight></codeline>
<codeline lineno="11" refid="_src_2_global_server_8cpp_1a03595bfee2a55045aa751deab1e562d0" refkind="member"><highlight class="normal"></highlight><highlight class="keywordtype">bool</highlight><highlight class="normal"><sp/><ref refid="src_2_global_server_8cpp_1a03595bfee2a55045aa751deab1e562d0" kindref="member">sendRegPack</ref>(</highlight><highlight class="keywordtype">int</highlight><highlight class="normal"><sp/>iServerIdx)</highlight></codeline>
<codeline lineno="12"><highlight class="normal">{</highlight></codeline>
<codeline lineno="13"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/></highlight><highlight class="keyword">false</highlight><highlight class="normal">;</highlight></codeline>
<codeline lineno="14"><highlight class="normal">}</highlight></codeline>
<codeline lineno="15"><highlight class="normal"></highlight></codeline>
<codeline lineno="16" refid="_src_2_global_server_8cpp_1a1829928f14924b8a97ed00808758de08" refkind="member"><highlight class="normal"></highlight><highlight class="keywordtype">bool</highlight><highlight class="normal"><sp/><ref refid="src_2_global_server_8cpp_1a1829928f14924b8a97ed00808758de08" kindref="member">sendHeartPack</ref>(</highlight><highlight class="keywordtype">int</highlight><highlight class="normal"><sp/>iServerIdx)</highlight></codeline>
<codeline lineno="17"><highlight class="normal">{</highlight></codeline>
<codeline lineno="18"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/></highlight><highlight class="keyword">false</highlight><highlight class="normal">;</highlight></codeline>
<codeline lineno="19"><highlight class="normal">}</highlight></codeline>
<codeline lineno="20"><highlight class="normal"></highlight></codeline>
<codeline lineno="21"><highlight class="normal"><ref refid="class_global_server_1a4eea6b2fbef9c0e2e38486544ba2ed65" kindref="member">GlobalServer::GlobalServer</ref>(</highlight><highlight class="keywordtype">void</highlight><highlight class="normal">)</highlight></codeline>
<codeline lineno="22"><highlight class="normal">{</highlight></codeline>
<codeline lineno="23"><highlight class="normal"><sp/><sp/><sp/><sp/>memset(<ref refid="class_global_server_1a284999c37541944c4f717a632392a866" kindref="member">m_acSend</ref>,0,</highlight><highlight class="keyword">sizeof</highlight><highlight class="normal">(<ref refid="class_global_server_1a284999c37541944c4f717a632392a866" kindref="member">m_acSend</ref>));</highlight></codeline>
<codeline lineno="24"><highlight class="normal"><sp/><sp/><sp/><sp/><ref refid="class_global_server_1adc2f8b46002eac2c3f52e076a3a107c2" kindref="member">m_dwCurTime</ref><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>=<sp/>0;</highlight></codeline>
<codeline lineno="25"><highlight class="normal"></highlight></codeline>
<codeline lineno="26"><highlight class="normal"><sp/><sp/><sp/><sp/><ref refid="class_global_server_1af57d2447acf0ccf49a3d2c583875c85d" kindref="member">m_dwHeartPackageTime</ref><sp/><sp/><sp/><sp/>=<sp/>0;</highlight></codeline>
<codeline lineno="27"><highlight class="normal"></highlight></codeline>
<codeline lineno="28"><highlight class="normal"><sp/><sp/><sp/><sp/><ref refid="class_global_server_1adb424635ec867002bdc5569fba60b666" kindref="member">m_iUnitAccountDB</ref><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>=<sp/>-1;</highlight></codeline>
<codeline lineno="29"><highlight class="normal"></highlight></codeline>
<codeline lineno="30"><highlight class="normal"><sp/><sp/><sp/><sp/><ref refid="class_global_server_1aa8266a68de35c9295ba1b49e3fd2b766" kindref="member">m_dwGenPlayerID</ref><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>=<sp/>0;</highlight></codeline>
<codeline lineno="31"><highlight class="normal"></highlight></codeline>
<codeline lineno="32"><highlight class="normal"><sp/><sp/><sp/><sp/><ref refid="class_global_server_1aaad1ac26a0d93306cdb73879d1617edb" kindref="member">m_dwLoadCount</ref><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>=<sp/>0;</highlight></codeline>
<codeline lineno="33"><highlight class="normal"><sp/><sp/><sp/><sp/><ref refid="class_global_server_1a0a4879864d5a5cc5964713eb03d1979d" kindref="member">m_dwLoadSumTime</ref><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>=<sp/>0;</highlight></codeline>
<codeline lineno="34"><highlight class="normal">};</highlight></codeline>
<codeline lineno="35"><highlight class="normal"></highlight></codeline>
<codeline lineno="36"><highlight class="normal"><ref refid="class_global_server_1a740bd912c7708d466b7d035b18a45b2e" kindref="member">GlobalServer::~GlobalServer</ref>(</highlight><highlight class="keywordtype">void</highlight><highlight class="normal">)</highlight></codeline>
<codeline lineno="37"><highlight class="normal">{</highlight></codeline>
<codeline lineno="38"><highlight class="normal"></highlight></codeline>
<codeline lineno="39"><highlight class="normal">};</highlight></codeline>
<codeline lineno="40"><highlight class="normal"></highlight></codeline>
<codeline lineno="41"><highlight class="normal"></highlight><highlight class="keywordtype">bool</highlight><highlight class="normal"><sp/><ref refid="class_global_server_1a0f488564b47400b7f7e4d4c0fae011e5" kindref="member">GlobalServer::Initialize</ref>(</highlight><highlight class="keywordtype">void</highlight><highlight class="normal">)</highlight></codeline>
<codeline lineno="42"><highlight class="normal">{</highlight></codeline>
<codeline lineno="43"><highlight class="normal"><sp/><sp/><sp/><sp/>srand(<ref refid="class_global_server_1adc2f8b46002eac2c3f52e076a3a107c2" kindref="member">m_dwCurTime</ref>);</highlight></codeline>
<codeline lineno="44"><highlight class="normal"></highlight></codeline>
<codeline lineno="45"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal">(!<ref refid="class_global_server_1afa1574bfeacb7ab222f6842ab808f01a" kindref="member">LoadConfig</ref>(</highlight><highlight class="stringliteral">&quot;./Data/GlobalServer.ini&quot;</highlight><highlight class="normal">))</highlight></codeline>
<codeline lineno="46"><highlight class="normal"><sp/><sp/><sp/><sp/>{</highlight></codeline>
<codeline lineno="47"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/></highlight><highlight class="keyword">false</highlight><highlight class="normal">;</highlight></codeline>
<codeline lineno="48"><highlight class="normal"><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="49"><highlight class="normal"></highlight></codeline>
<codeline lineno="50"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(!<ref refid="class_global_server_1ac939393de3f116f2895633c0ee291c74" kindref="member">InitializeDB</ref>())</highlight></codeline>
<codeline lineno="51"><highlight class="normal"><sp/><sp/><sp/><sp/>{</highlight></codeline>
<codeline lineno="52"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/></highlight><highlight class="keyword">false</highlight><highlight class="normal">;</highlight></codeline>
<codeline lineno="53"><highlight class="normal"><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="54"><highlight class="normal"></highlight></codeline>
<codeline lineno="55"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal">(!<ref refid="class_global_server_1aaedfe2b1dc5669a7cd435b13e0bf3840" kindref="member">InitializeNet</ref>())</highlight></codeline>
<codeline lineno="56"><highlight class="normal"><sp/><sp/><sp/><sp/>{</highlight></codeline>
<codeline lineno="57"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/></highlight><highlight class="keyword">false</highlight><highlight class="normal">;</highlight></codeline>
<codeline lineno="58"><highlight class="normal"><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="59"><highlight class="normal"></highlight></codeline>
<codeline lineno="60"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(!<ref refid="_se_virt_conn_mgr_8cpp_1aa8e9d5beed961f4e26b9cadd49603980" kindref="member">g_kVirtConnMgr</ref>.<ref refid="class_se_virt_conn_mgr_1a6982c2146c5829aa21e4f2bd5487a3d4" kindref="member">Initialize</ref>(&amp;<ref refid="class_global_server_1aab15fb083ac582e71e2a686f44b21297" kindref="member">m_kNetMgr</ref>,<sp/>(</highlight><highlight class="keywordtype">void</highlight><highlight class="normal">*)<ref refid="src_2_global_server_8cpp_1a03595bfee2a55045aa751deab1e562d0" kindref="member">sendRegPack</ref>,<sp/>(</highlight><highlight class="keywordtype">void</highlight><highlight class="normal">*)<ref refid="src_2_global_server_8cpp_1a1829928f14924b8a97ed00808758de08" kindref="member">sendHeartPack</ref>))</highlight></codeline>
<codeline lineno="61"><highlight class="normal"><sp/><sp/><sp/><sp/>{</highlight></codeline>
<codeline lineno="62"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="_se_file_log_8h_1a59fe2018c00666084724bec1365b41f5" kindref="member">SeLogError</ref>(</highlight><highlight class="stringliteral">&quot;Init<sp/>VirtConnMgr<sp/>Failed&quot;</highlight><highlight class="normal">,<sp/>1);</highlight></codeline>
<codeline lineno="63"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/></highlight><highlight class="keyword">false</highlight><highlight class="normal">;</highlight></codeline>
<codeline lineno="64"><highlight class="normal"><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="65"><highlight class="normal"></highlight></codeline>
<codeline lineno="66"><highlight class="normal"><sp/><sp/><sp/><sp/><ref refid="class_global_server_1a0753830621fca60e4541a2cfd5a55381" kindref="member">SendDB_AccountInitGenID</ref>();</highlight></codeline>
<codeline lineno="67"><highlight class="normal"></highlight></codeline>
<codeline lineno="68"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/></highlight><highlight class="keyword">true</highlight><highlight class="normal">;</highlight></codeline>
<codeline lineno="69"><highlight class="normal">}</highlight></codeline>
<codeline lineno="70"><highlight class="normal"></highlight></codeline>
<codeline lineno="71"><highlight class="normal"></highlight><highlight class="keywordtype">void</highlight><highlight class="normal"><sp/><ref refid="class_global_server_1a9ec490da6fed2d0097e78ed59e9463f6" kindref="member">GlobalServer::Update</ref>(</highlight><highlight class="keywordtype">void</highlight><highlight class="normal">)</highlight></codeline>
<codeline lineno="72"><highlight class="normal">{</highlight></codeline>
<codeline lineno="73"><highlight class="normal"><sp/><sp/><sp/><sp/><ref refid="class_global_server_1adc2f8b46002eac2c3f52e076a3a107c2" kindref="member">m_dwCurTime</ref><sp/>=<sp/>GetTickCount();</highlight></codeline>
<codeline lineno="74"><highlight class="normal"></highlight></codeline>
<codeline lineno="75"><highlight class="normal"><sp/><sp/><sp/><sp/><ref refid="class_global_server_1aab15fb083ac582e71e2a686f44b21297" kindref="member">m_kNetMgr</ref>.Update();</highlight></codeline>
<codeline lineno="76"><highlight class="normal"></highlight></codeline>
<codeline lineno="77"><highlight class="normal"><sp/><sp/><sp/><sp/><ref refid="class_global_server_1a7da4482cf41b17bcb30de2cbc5933804" kindref="member">m_kDBMgr</ref>.Update();</highlight></codeline>
<codeline lineno="78"><highlight class="normal"></highlight></codeline>
<codeline lineno="79"><highlight class="normal"><sp/><sp/><sp/><sp/><ref refid="class_global_server_1a782b4b0ade24605d25c4ee0bd8fef01e" kindref="member">UpdateState</ref>();</highlight></codeline>
<codeline lineno="80"><highlight class="normal"></highlight></codeline>
<codeline lineno="81"><highlight class="normal"><sp/><sp/><sp/><sp/><ref refid="class_global_server_1ae03207722877f8034517367d6a8425a1" kindref="member">UpdateLogShow</ref>();</highlight></codeline>
<codeline lineno="82"><highlight class="normal"></highlight></codeline>
<codeline lineno="83"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="comment">//UpdateHeartPackage();</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="84"><highlight class="normal"></highlight></codeline>
<codeline lineno="85"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="comment">//UpdateGS2WSTime();</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="86"><highlight class="normal"></highlight></codeline>
<codeline lineno="87"><highlight class="normal"><sp/><sp/><sp/><sp/><ref refid="_se_virt_conn_mgr_8cpp_1aa8e9d5beed961f4e26b9cadd49603980" kindref="member">g_kVirtConnMgr</ref>.<ref refid="class_se_virt_conn_mgr_1a1a2056beaab510c633febd91090592ee" kindref="member">Update</ref>(<ref refid="class_global_server_1adc2f8b46002eac2c3f52e076a3a107c2" kindref="member">m_dwCurTime</ref>);</highlight></codeline>
<codeline lineno="88"><highlight class="normal"></highlight></codeline>
<codeline lineno="89"><highlight class="normal"><sp/><sp/><sp/><sp/><ref refid="src_2_se_cache_mgr_8cpp_1ab94106ad98afc36210e2252c4ed5cf77" kindref="member">g_kCacheMgr</ref>.<ref refid="class_se_cache_mgr_1ae7a5b7ea7140b8b1df759c20d2f2dc8f" kindref="member">Update</ref>();</highlight></codeline>
<codeline lineno="90"><highlight class="normal"></highlight></codeline>
<codeline lineno="91"><highlight class="normal">}</highlight></codeline>
<codeline lineno="92"><highlight class="normal"></highlight></codeline>
<codeline lineno="93"><highlight class="normal"></highlight><highlight class="keywordtype">void</highlight><highlight class="normal"><sp/><ref refid="class_global_server_1a45d017a595c98d8052a32ec3e9bfb13a" kindref="member">GlobalServer::Finialize</ref>(</highlight><highlight class="keywordtype">void</highlight><highlight class="normal">)</highlight></codeline>
<codeline lineno="94"><highlight class="normal">{</highlight></codeline>
<codeline lineno="95"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">for</highlight><highlight class="normal">(MapAllWS::iterator<sp/>itr<sp/>=<sp/><ref refid="class_global_server_1a1149e611d703f0185fa3b79a8834efb3" kindref="member">m_kAllWS</ref>.begin();itr<sp/>!=<sp/><ref refid="class_global_server_1a1149e611d703f0185fa3b79a8834efb3" kindref="member">m_kAllWS</ref>.end();++itr)</highlight></codeline>
<codeline lineno="96"><highlight class="normal"><sp/><sp/><sp/><sp/>{</highlight></codeline>
<codeline lineno="97"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="struct_se_w_s_data" kindref="compound">SeWSData</ref>*<sp/>pkWSData<sp/>=<sp/>itr-&gt;second;</highlight></codeline>
<codeline lineno="98"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal">(pkWSData)</highlight></codeline>
<codeline lineno="99"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>{</highlight></codeline>
<codeline lineno="100"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keyword">delete</highlight><highlight class="normal"><sp/>pkWSData;</highlight></codeline>
<codeline lineno="101"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>pkWSData<sp/>=<sp/>NULL;</highlight></codeline>
<codeline lineno="102"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="103"><highlight class="normal"><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="104"><highlight class="normal"><sp/><sp/><sp/><sp/><ref refid="class_global_server_1a1149e611d703f0185fa3b79a8834efb3" kindref="member">m_kAllWS</ref>.clear();</highlight></codeline>
<codeline lineno="105"><highlight class="normal"></highlight></codeline>
<codeline lineno="106"><highlight class="normal"><sp/><sp/><sp/><sp/><ref refid="class_global_server_1aab15fb083ac582e71e2a686f44b21297" kindref="member">m_kNetMgr</ref>.Finialize();</highlight></codeline>
<codeline lineno="107"><highlight class="normal"><sp/><sp/><sp/><sp/><ref refid="class_global_server_1a7da4482cf41b17bcb30de2cbc5933804" kindref="member">m_kDBMgr</ref>.Finialize();</highlight></codeline>
<codeline lineno="108"><highlight class="normal">}</highlight></codeline>
<codeline lineno="109"><highlight class="normal"></highlight></codeline>
<codeline lineno="110"><highlight class="normal"></highlight><highlight class="keywordtype">void</highlight><highlight class="normal"><sp/><ref refid="class_global_server_1a0c703d59adf63bd16089dadf3825f0e3" kindref="member">GlobalServer::ShowConsoleTitle</ref>(</highlight><highlight class="keywordtype">int</highlight><highlight class="normal"><sp/>iDTime)</highlight></codeline>
<codeline lineno="111"><highlight class="normal">{</highlight></codeline>
<codeline lineno="112"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordtype">int</highlight><highlight class="normal"><sp/>iOnlineNum(0),<sp/>iCacheNum(0),<sp/>iSelTownNum(0),<sp/>iUnUpdateCount(0);</highlight></codeline>
<codeline lineno="113"><highlight class="normal"><sp/><sp/><sp/><sp/><ref refid="src_2_se_cache_mgr_8cpp_1ab94106ad98afc36210e2252c4ed5cf77" kindref="member">g_kCacheMgr</ref>.<ref refid="class_se_cache_mgr_1a7445e533c95dce24eb902e58345eb0fb" kindref="member">GetCacheState</ref>(iOnlineNum,<sp/>iCacheNum,<sp/>iSelTownNum,<sp/>iUnUpdateCount);</highlight></codeline>
<codeline lineno="114"><highlight class="normal"></highlight></codeline>
<codeline lineno="115"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordtype">char</highlight><highlight class="normal"><sp/>acString[128];</highlight></codeline>
<codeline lineno="116"><highlight class="normal"><sp/><sp/><sp/><sp/><ref refid="_se_server_tool_8cpp_1ad2735ec90511f0d6ec1535cf448709b8" kindref="member">SPrintf</ref>(acString,<sp/></highlight><highlight class="keyword">sizeof</highlight><highlight class="normal">(acString),<sp/></highlight><highlight class="stringliteral">&quot;GS<sp/>DT[%d]<sp/>OL[%d]<sp/>SltTown[%d]<sp/>Cache[%d]&quot;</highlight><highlight class="normal">,<sp/></highlight></codeline>
<codeline lineno="117"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>iDTime,<sp/></highlight></codeline>
<codeline lineno="118"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>iOnlineNum,<sp/></highlight></codeline>
<codeline lineno="119"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>iSelTownNum,<sp/></highlight></codeline>
<codeline lineno="120"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>iCacheNum);</highlight></codeline>
<codeline lineno="121"><highlight class="normal"></highlight></codeline>
<codeline lineno="122"><highlight class="normal"></highlight><highlight class="preprocessor">#ifdef<sp/>_WIN32</highlight></codeline>
<codeline lineno="123"><highlight class="preprocessor"></highlight><highlight class="normal"><sp/><sp/><sp/><sp/>SetConsoleTitle(acString);</highlight></codeline>
<codeline lineno="124"><highlight class="normal"></highlight><highlight class="preprocessor">#else</highlight></codeline>
<codeline lineno="125"><highlight class="preprocessor"></highlight><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="comment">//SeLogInfo(&quot;%s&quot;,<sp/>acString);</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="126"><highlight class="normal"></highlight><highlight class="preprocessor">#endif</highlight></codeline>
<codeline lineno="127"><highlight class="preprocessor"></highlight><highlight class="normal">}</highlight></codeline>
<codeline lineno="128"><highlight class="normal"></highlight></codeline>
<codeline lineno="129"><highlight class="normal"></highlight><highlight class="keywordtype">void</highlight><highlight class="normal"><sp/><ref refid="class_global_server_1a4c63a616b72da7d8063d8530ae55813b" kindref="member">GlobalServer::OnNetConnected</ref>(</highlight><highlight class="keyword">const</highlight><highlight class="normal"><sp/>HSock&amp;<sp/>rkSock,</highlight><highlight class="keyword">const</highlight><highlight class="normal"><sp/></highlight><highlight class="keywordtype">char</highlight><highlight class="normal">*<sp/>pcIP,</highlight><highlight class="keywordtype">int</highlight><highlight class="normal"><sp/>iPort)</highlight></codeline>
<codeline lineno="130"><highlight class="normal">{</highlight></codeline>
<codeline lineno="131"><highlight class="normal">}</highlight></codeline>
<codeline lineno="132"><highlight class="normal"></highlight></codeline>
<codeline lineno="133"><highlight class="normal"></highlight><highlight class="keywordtype">void</highlight><highlight class="normal"><sp/><ref refid="class_global_server_1afda21a52501747d08ec324a149f52d87" kindref="member">GlobalServer::OnNetAccept</ref>(</highlight><highlight class="keyword">const</highlight><highlight class="normal"><sp/>HSock&amp;<sp/>rkSock,</highlight><highlight class="keywordtype">int</highlight><highlight class="normal"><sp/>iListenPort,</highlight><highlight class="keyword">const</highlight><highlight class="normal"><sp/></highlight><highlight class="keywordtype">char</highlight><highlight class="normal">*<sp/>pcIP,</highlight><highlight class="keywordtype">int</highlight><highlight class="normal"><sp/>iPort)</highlight></codeline>
<codeline lineno="134"><highlight class="normal">{</highlight></codeline>
<codeline lineno="135"><highlight class="normal"><sp/><sp/><sp/><sp/><ref refid="_se_virt_conn_mgr_8cpp_1aa8e9d5beed961f4e26b9cadd49603980" kindref="member">g_kVirtConnMgr</ref>.<ref refid="class_se_virt_conn_mgr_1a63500bd2371897e90065d32e0e16d086" kindref="member">AddClientConn</ref>(rkSock,<sp/>pcIP,<sp/>iPort);</highlight></codeline>
<codeline lineno="136"><highlight class="normal">}</highlight></codeline>
<codeline lineno="137"><highlight class="normal"></highlight></codeline>
<codeline lineno="138"><highlight class="normal"></highlight><highlight class="keywordtype">void</highlight><highlight class="normal"><sp/><ref refid="class_global_server_1a2958ca2143d3d5db4bda0d765a70752b" kindref="member">GlobalServer::OnNetRecv</ref>(</highlight><highlight class="keyword">const</highlight><highlight class="normal"><sp/>HSock&amp;<sp/>rkSock,</highlight><highlight class="keywordtype">void</highlight><highlight class="normal">*<sp/>pkData,</highlight><highlight class="keywordtype">int</highlight><highlight class="normal"><sp/>iSize)</highlight></codeline>
<codeline lineno="139"><highlight class="normal">{</highlight></codeline>
<codeline lineno="140"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal">(iSize<sp/>&lt;<sp/></highlight><highlight class="keyword">sizeof</highlight><highlight class="normal">(<ref refid="struct_se_c_m_d" kindref="compound">SeCMD</ref>))</highlight></codeline>
<codeline lineno="141"><highlight class="normal"><sp/><sp/><sp/><sp/>{</highlight></codeline>
<codeline lineno="142"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="class_global_server_1aab15fb083ac582e71e2a686f44b21297" kindref="member">m_kNetMgr</ref>.Disconnect(rkSock);</highlight></codeline>
<codeline lineno="143"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal">;</highlight></codeline>
<codeline lineno="144"><highlight class="normal"><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="145"><highlight class="normal"></highlight></codeline>
<codeline lineno="146"><highlight class="normal"><sp/><sp/><sp/><sp/><ref refid="struct_se_virt_conn" kindref="compound">SeVirtConn</ref>*<sp/>pkClientConn<sp/>=<sp/><ref refid="_se_virt_conn_mgr_8cpp_1aa8e9d5beed961f4e26b9cadd49603980" kindref="member">g_kVirtConnMgr</ref>.<ref refid="class_se_virt_conn_mgr_1a51ee10bf4c869460a221b78e3d9296d7" kindref="member">GetClientConnBySock</ref>(rkSock);</highlight></codeline>
<codeline lineno="147"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(!pkClientConn)</highlight></codeline>
<codeline lineno="148"><highlight class="normal"><sp/><sp/><sp/><sp/>{</highlight></codeline>
<codeline lineno="149"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal">;</highlight></codeline>
<codeline lineno="150"><highlight class="normal"><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="151"><highlight class="normal"></highlight></codeline>
<codeline lineno="152"><highlight class="normal"><sp/><sp/><sp/><sp/>pkClientConn-&gt;<ref refid="struct_se_virt_conn_1a5d5f05afd1fb01e667d072755cba8b2f" kindref="member">dwLastRecvTime</ref><sp/>=<sp/><ref refid="class_global_server_1a0f7391b92b1ebf68ab0201806771afec" kindref="member">GetServerTime</ref>();</highlight></codeline>
<codeline lineno="153"><highlight class="normal"></highlight></codeline>
<codeline lineno="154"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(pkClientConn-&gt;<ref refid="struct_se_virt_conn_1a498d90b78881f21f62000e5848c654e2" kindref="member">eState</ref><sp/>==<sp/><ref refid="_se_virt_conn_mgr_8h_1ad6484f55baf154efe4f216e3d9c1f459af2fd418c27e38c5887061982c04bebe5" kindref="member">SVCS_NULL</ref>)</highlight></codeline>
<codeline lineno="155"><highlight class="normal"><sp/><sp/><sp/><sp/>{</highlight></codeline>
<codeline lineno="156"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="struct_se_c_m_d" kindref="compound">SeCMD</ref>*<sp/>pkCmd<sp/>=<sp/>(<ref refid="struct_se_c_m_d" kindref="compound">SeCMD</ref><sp/>*)pkData;</highlight></codeline>
<codeline lineno="157"><highlight class="normal"></highlight></codeline>
<codeline lineno="158"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(pkCmd-&gt;<ref refid="struct_se_c_m_d_1a2efa122a60040d09cfca777f9155394c" kindref="member">wCmd</ref><sp/>==<sp/><ref refid="_se_ptl___l_s___to___g_s_8h_1a982f547bc7cce542bf7295cf8080b9a0adef3743e0958befc40bd99325138098a" kindref="member">CMD_LG_REGISTER</ref>)</highlight></codeline>
<codeline lineno="159"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>{</highlight></codeline>
<codeline lineno="160"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="class_global_server_1a3b4e43f96daf9545e617eaa4f14f94f3" kindref="member">ProcessLGData</ref>(pkData,<sp/>iSize,<sp/>pkClientConn);</highlight></codeline>
<codeline lineno="161"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="162"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">else</highlight><highlight class="normal"><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(pkCmd-&gt;<ref refid="struct_se_c_m_d_1a2efa122a60040d09cfca777f9155394c" kindref="member">wCmd</ref><sp/>==<sp/><ref refid="_se_ptl___w_s___to___g_s_8h_1a70ddbf2bc8bb46ddb9a35e3a82a8c9d5a3ed2567560bd2c15a562969a626ce7b5" kindref="member">CMD_WG_REGISTER</ref>)</highlight></codeline>
<codeline lineno="163"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>{</highlight></codeline>
<codeline lineno="164"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="class_global_server_1a08118bb3aa0c24616dc83953f7e927e6" kindref="member">ProcessWGData</ref>(pkData,<sp/>iSize,<sp/>pkClientConn);</highlight></codeline>
<codeline lineno="165"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="166"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">else</highlight><highlight class="normal"><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(pkCmd-&gt;<ref refid="struct_se_c_m_d_1a2efa122a60040d09cfca777f9155394c" kindref="member">wCmd</ref><sp/>==<sp/><ref refid="_se_ptl___h_s___to___h_s_8h_1a382bac0bd1371fe71c9fef6957a88a8baebea2af27ada9ed324304d85ebbbbfd5" kindref="member">CMD_HS_REGISTER</ref>)</highlight></codeline>
<codeline lineno="167"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>{</highlight></codeline>
<codeline lineno="168"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="class_global_server_1a5c02e62d667148158578f9641bd40ce0" kindref="member">ProcessHSData</ref>(pkData,<sp/>iSize,<sp/>pkClientConn);</highlight></codeline>
<codeline lineno="169"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="170"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">else</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="171"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>{</highlight></codeline>
<codeline lineno="172"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="class_global_server_1aab15fb083ac582e71e2a686f44b21297" kindref="member">m_kNetMgr</ref>.Disconnect(rkSock);</highlight></codeline>
<codeline lineno="173"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="174"><highlight class="normal"><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="175"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">else</highlight><highlight class="normal"><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(pkClientConn-&gt;<ref refid="struct_se_virt_conn_1a498d90b78881f21f62000e5848c654e2" kindref="member">eState</ref><sp/>==<sp/><ref refid="_se_virt_conn_mgr_8h_1ad6484f55baf154efe4f216e3d9c1f459a1e34c360626a791e16a13af7a6bd44fe" kindref="member">SVCS_REGISTERED</ref>)</highlight></codeline>
<codeline lineno="176"><highlight class="normal"><sp/><sp/><sp/><sp/>{</highlight></codeline>
<codeline lineno="177"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(pkClientConn-&gt;<ref refid="struct_se_virt_conn_1a40b26e62b433113fadaa391c2c11397a" kindref="member">eIndex</ref><sp/>==<sp/><ref refid="_se_ptl_define_8h_1aefb47f3959b8be9e164448819e4bb7f9a5d0e2f397aac5a9e03ae4098d230f655" kindref="member">SSI_LS</ref>)</highlight></codeline>
<codeline lineno="178"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>{</highlight></codeline>
<codeline lineno="179"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="class_global_server_1a3b4e43f96daf9545e617eaa4f14f94f3" kindref="member">ProcessLGData</ref>(pkData,<sp/>iSize,<sp/>pkClientConn);</highlight></codeline>
<codeline lineno="180"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="181"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">else</highlight><highlight class="normal"><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(pkClientConn-&gt;<ref refid="struct_se_virt_conn_1a40b26e62b433113fadaa391c2c11397a" kindref="member">eIndex</ref><sp/>==<sp/><ref refid="_se_ptl_define_8h_1aefb47f3959b8be9e164448819e4bb7f9ac22c01ccbb196aab5a0eef785eb6ce26" kindref="member">SSI_WS</ref>)</highlight></codeline>
<codeline lineno="182"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>{</highlight></codeline>
<codeline lineno="183"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="class_global_server_1a08118bb3aa0c24616dc83953f7e927e6" kindref="member">ProcessWGData</ref>(pkData,<sp/>iSize,<sp/>pkClientConn);</highlight></codeline>
<codeline lineno="184"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="185"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">else</highlight><highlight class="normal"><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(pkClientConn-&gt;<ref refid="struct_se_virt_conn_1a40b26e62b433113fadaa391c2c11397a" kindref="member">eIndex</ref><sp/>==<sp/><ref refid="_se_ptl_define_8h_1aefb47f3959b8be9e164448819e4bb7f9a14ae0326467b75807a6f563065d0f2f5" kindref="member">SSI_HS</ref>)</highlight></codeline>
<codeline lineno="186"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>{</highlight></codeline>
<codeline lineno="187"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="class_global_server_1a5c02e62d667148158578f9641bd40ce0" kindref="member">ProcessHSData</ref>(pkData,<sp/>iSize,<sp/>pkClientConn);</highlight></codeline>
<codeline lineno="188"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="189"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">else</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="190"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>{</highlight></codeline>
<codeline lineno="191"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="class_global_server_1aab15fb083ac582e71e2a686f44b21297" kindref="member">m_kNetMgr</ref>.Disconnect(rkSock);</highlight></codeline>
<codeline lineno="192"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="193"><highlight class="normal"><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="194"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">else</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="195"><highlight class="normal"><sp/><sp/><sp/><sp/>{</highlight></codeline>
<codeline lineno="196"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="class_global_server_1aab15fb083ac582e71e2a686f44b21297" kindref="member">m_kNetMgr</ref>.Disconnect(rkSock);</highlight></codeline>
<codeline lineno="197"><highlight class="normal"><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="198"><highlight class="normal">}</highlight></codeline>
<codeline lineno="199"><highlight class="normal"></highlight></codeline>
<codeline lineno="200"><highlight class="normal"></highlight><highlight class="keywordtype">void</highlight><highlight class="normal"><sp/><ref refid="class_global_server_1a78c7fa08d683d8e0446a1254b55557f6" kindref="member">GlobalServer::OnNetDisconnect</ref>(</highlight><highlight class="keyword">const</highlight><highlight class="normal"><sp/>HSock&amp;<sp/>rkSock,TeDisconnectCode<sp/>eCode,</highlight><highlight class="keywordtype">int</highlight><highlight class="normal"><sp/>iParam)</highlight></codeline>
<codeline lineno="201"><highlight class="normal">{</highlight></codeline>
<codeline lineno="202"><highlight class="normal"><sp/><sp/><sp/><sp/><ref refid="_se_virt_conn_mgr_8cpp_1aa8e9d5beed961f4e26b9cadd49603980" kindref="member">g_kVirtConnMgr</ref>.<ref refid="class_se_virt_conn_mgr_1aa4e7eaccafa14a4a55c97f4857da9ee9" kindref="member">OnClientDisconnect</ref>(rkSock);</highlight></codeline>
<codeline lineno="203"><highlight class="normal">}</highlight></codeline>
<codeline lineno="204"><highlight class="normal"></highlight></codeline>
<codeline lineno="205"><highlight class="normal"></highlight><highlight class="keywordtype">void</highlight><highlight class="normal"><sp/><ref refid="class_global_server_1a783b588cc46861dbf3a2fc2aa3796451" kindref="member">GlobalServer::OnDBResponse</ref>(</highlight><highlight class="keywordtype">int</highlight><highlight class="normal"><sp/>iDB,<sp/>TeDBResSet&amp;<sp/>rkResSet)</highlight></codeline>
<codeline lineno="206"><highlight class="normal">{</highlight></codeline>
<codeline lineno="207"><highlight class="normal"><sp/><sp/><sp/><sp/><ref refid="class_global_server_1ae7286b8d3b191d0505731f9dbc4fd4e6" kindref="member">ProcessDB</ref>(iDB,<sp/>rkResSet);</highlight></codeline>
<codeline lineno="208"><highlight class="normal">}</highlight></codeline>
<codeline lineno="209"><highlight class="normal"></highlight></codeline>
<codeline lineno="210"><highlight class="normal"></highlight><highlight class="keywordtype">int</highlight><highlight class="normal"><sp/><ref refid="class_global_server_1ae420935aa7228b72d0fd13aea50a9d70" kindref="member">GlobalServer::GetMaxCacheNum</ref>(</highlight><highlight class="keywordtype">void</highlight><highlight class="normal">)</highlight></codeline>
<codeline lineno="211"><highlight class="normal">{</highlight></codeline>
<codeline lineno="212"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/><ref refid="class_global_server_1a5c5b73f8fcd4a44b79d2f7b1429fd2d0" kindref="member">m_kConfig</ref>.<ref refid="struct_se_global_config_1a73abf30ea6721c631308a948106b6806" kindref="member">iMaxCacheNum</ref>;</highlight></codeline>
<codeline lineno="213"><highlight class="normal">}</highlight></codeline>
<codeline lineno="214"><highlight class="normal"></highlight></codeline>
<codeline lineno="215"><highlight class="normal"></highlight><highlight class="keywordtype">int</highlight><highlight class="normal"><sp/><ref refid="class_global_server_1a52b6ddce0d4737752bc9586c6b152d0e" kindref="member">GlobalServer::GetDBQueryNums</ref>(</highlight><highlight class="keywordtype">void</highlight><highlight class="normal">)</highlight></codeline>
<codeline lineno="216"><highlight class="normal">{</highlight></codeline>
<codeline lineno="217"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/>(</highlight><highlight class="keywordtype">int</highlight><highlight class="normal">)<ref refid="class_global_server_1a986c25fcbc7236f96dc12adadd9e0c34" kindref="member">m_kAllDBQuery</ref>.size();</highlight></codeline>
<codeline lineno="218"><highlight class="normal">}</highlight></codeline>
<codeline lineno="219"><highlight class="normal"></highlight></codeline>
<codeline lineno="220"><highlight class="normal">DWord<sp/><ref refid="class_global_server_1a0f7391b92b1ebf68ab0201806771afec" kindref="member">GlobalServer::GetServerTime</ref>(</highlight><highlight class="keywordtype">void</highlight><highlight class="normal">)</highlight></codeline>
<codeline lineno="221"><highlight class="normal">{</highlight></codeline>
<codeline lineno="222"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/><ref refid="class_global_server_1adc2f8b46002eac2c3f52e076a3a107c2" kindref="member">m_dwCurTime</ref>;</highlight></codeline>
<codeline lineno="223"><highlight class="normal">}</highlight></codeline>
<codeline lineno="224"><highlight class="normal"></highlight></codeline>
<codeline lineno="225"><highlight class="normal"></highlight><highlight class="keywordtype">bool</highlight><highlight class="normal"><sp/><ref refid="class_global_server_1afa1574bfeacb7ab222f6842ab808f01a" kindref="member">GlobalServer::LoadConfig</ref>(</highlight><highlight class="keyword">const</highlight><highlight class="normal"><sp/></highlight><highlight class="keywordtype">char</highlight><highlight class="normal">*<sp/>pcFile)</highlight></codeline>
<codeline lineno="226"><highlight class="normal">{</highlight></codeline>
<codeline lineno="227"><highlight class="normal"><sp/><sp/><sp/><sp/>memset(&amp;<ref refid="class_global_server_1a5c5b73f8fcd4a44b79d2f7b1429fd2d0" kindref="member">m_kConfig</ref>,0,</highlight><highlight class="keyword">sizeof</highlight><highlight class="normal">(<ref refid="class_global_server_1a5c5b73f8fcd4a44b79d2f7b1429fd2d0" kindref="member">m_kConfig</ref>));</highlight></codeline>
<codeline lineno="228"><highlight class="normal"></highlight></codeline>
<codeline lineno="229"><highlight class="normal"><sp/><sp/><sp/><sp/><ref refid="class_se_config" kindref="compound">SeConfig</ref><sp/>kConfig;</highlight></codeline>
<codeline lineno="230"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal">(!kConfig.<ref refid="class_se_config_1a077cfce8454c31d293c2d2341980ffca" kindref="member">Load</ref>(pcFile))</highlight></codeline>
<codeline lineno="231"><highlight class="normal"><sp/><sp/><sp/><sp/>{</highlight></codeline>
<codeline lineno="232"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="_se_file_log_8h_1a59fe2018c00666084724bec1365b41f5" kindref="member">SeLogError</ref>(</highlight><highlight class="stringliteral">&quot;Loading<sp/>config<sp/>file<sp/>failed:<sp/>%s&quot;</highlight><highlight class="normal">,pcFile);</highlight></codeline>
<codeline lineno="233"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/></highlight><highlight class="keyword">false</highlight><highlight class="normal">;</highlight></codeline>
<codeline lineno="234"><highlight class="normal"><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="235"><highlight class="normal"></highlight></codeline>
<codeline lineno="236"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keyword">const</highlight><highlight class="normal"><sp/></highlight><highlight class="keywordtype">char</highlight><highlight class="normal">*<sp/>pcValue<sp/>=<sp/>kConfig.<ref refid="class_se_config_1a8839d0f5e6b831b66fd018826a304086" kindref="member">GetValue</ref>(</highlight><highlight class="stringliteral">&quot;ServerID&quot;</highlight><highlight class="normal">);</highlight></codeline>
<codeline lineno="237"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal">(!pcValue)</highlight></codeline>
<codeline lineno="238"><highlight class="normal"><sp/><sp/><sp/><sp/>{</highlight></codeline>
<codeline lineno="239"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="_se_file_log_8h_1a59fe2018c00666084724bec1365b41f5" kindref="member">SeLogError</ref>(</highlight><highlight class="stringliteral">&quot;Loading<sp/>config<sp/>file<sp/>failed:<sp/>%s[ServerID]&quot;</highlight><highlight class="normal">,pcFile);</highlight></codeline>
<codeline lineno="240"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/></highlight><highlight class="keyword">false</highlight><highlight class="normal">;</highlight></codeline>
<codeline lineno="241"><highlight class="normal"><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="242"><highlight class="normal"><sp/><sp/><sp/><sp/><ref refid="class_global_server_1a5c5b73f8fcd4a44b79d2f7b1429fd2d0" kindref="member">m_kConfig</ref>.<ref refid="struct_se_global_config_1a82fa08087983fbbf98ca85d3cbca05c5" kindref="member">dwServerID</ref><sp/>=<sp/><ref refid="_se_tool_8cpp_1a03bcc77ad4ef4845b20fc5cf4db96834" kindref="member">GetStr2ID</ref>(pcValue);</highlight></codeline>
<codeline lineno="243"><highlight class="normal"></highlight></codeline>
<codeline lineno="244"><highlight class="normal"><sp/><sp/><sp/><sp/><ref refid="struct_se_net_addr" kindref="compound">SeNetAddr</ref>*<sp/>pkAddr<sp/>=<sp/>kConfig.<ref refid="class_se_config_1a0bd6ce789230fc24e8e09674c0265d5d" kindref="member">GetNetAddr</ref>(</highlight><highlight class="stringliteral">&quot;AddrToServer&quot;</highlight><highlight class="normal">);</highlight></codeline>
<codeline lineno="245"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal">(!pkAddr)</highlight></codeline>
<codeline lineno="246"><highlight class="normal"><sp/><sp/><sp/><sp/>{</highlight></codeline>
<codeline lineno="247"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="_se_file_log_8h_1a59fe2018c00666084724bec1365b41f5" kindref="member">SeLogError</ref>(</highlight><highlight class="stringliteral">&quot;Loading<sp/>config<sp/>file<sp/>failed:<sp/>%s[AddrToServer]&quot;</highlight><highlight class="normal">,pcFile);</highlight></codeline>
<codeline lineno="248"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/></highlight><highlight class="keyword">false</highlight><highlight class="normal">;</highlight></codeline>
<codeline lineno="249"><highlight class="normal"><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="250"><highlight class="normal"><sp/><sp/><sp/><sp/><ref refid="class_global_server_1a5c5b73f8fcd4a44b79d2f7b1429fd2d0" kindref="member">m_kConfig</ref>.<ref refid="struct_se_global_config_1a5139a946d121802a0719ab286d9248ae" kindref="member">kAddrToServer</ref><sp/>=<sp/>*pkAddr;</highlight></codeline>
<codeline lineno="251"><highlight class="normal"></highlight></codeline>
<codeline lineno="252"><highlight class="normal"><sp/><sp/><sp/><sp/><ref refid="struct_se_d_b_addr" kindref="compound">SeDBAddr</ref>*<sp/>pkDBAddr<sp/>=<sp/>kConfig.<ref refid="class_se_config_1a4afab93102626e63e8d44a4cb8b97f35" kindref="member">GetDBAddr</ref>(</highlight><highlight class="stringliteral">&quot;UnitAccountDB&quot;</highlight><highlight class="normal">);</highlight></codeline>
<codeline lineno="253"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(<sp/>!pkDBAddr<sp/>)</highlight></codeline>
<codeline lineno="254"><highlight class="normal"><sp/><sp/><sp/><sp/>{</highlight></codeline>
<codeline lineno="255"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="_se_file_log_8h_1a59fe2018c00666084724bec1365b41f5" kindref="member">SeLogError</ref>(</highlight><highlight class="stringliteral">&quot;Loading<sp/>config<sp/>file<sp/>failed:%s[UnitAccountDB]&quot;</highlight><highlight class="normal">,<sp/>pcFile);</highlight></codeline>
<codeline lineno="256"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/></highlight><highlight class="keyword">false</highlight><highlight class="normal">;</highlight></codeline>
<codeline lineno="257"><highlight class="normal"><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="258"><highlight class="normal"><sp/><sp/><sp/><sp/><ref refid="class_global_server_1a5c5b73f8fcd4a44b79d2f7b1429fd2d0" kindref="member">m_kConfig</ref>.<ref refid="struct_se_global_config_1a3d51a3e1cccee9be3e3d9e91c0ddb08f" kindref="member">kUnitAccountDB</ref><sp/>=<sp/>*pkDBAddr;</highlight></codeline>
<codeline lineno="259"><highlight class="normal"></highlight></codeline>
<codeline lineno="260"><highlight class="normal"><sp/><sp/><sp/><sp/><ref refid="class_global_server_1ae7b92d28b2d5d969f62d4bac7c2f1b46" kindref="member">LoadDynamicConfig</ref>();</highlight></codeline>
<codeline lineno="261"><highlight class="normal"></highlight></codeline>
<codeline lineno="262"><highlight class="normal"><sp/><sp/><sp/><sp/><ref refid="_se_file_log_8h_1a83f3fe470b91cb8eed8762cc8e5e26c3" kindref="member">SeLogInfo</ref>(</highlight><highlight class="stringliteral">&quot;Load<sp/>config<sp/>file<sp/>successfull&quot;</highlight><highlight class="normal">,1);</highlight></codeline>
<codeline lineno="263"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/></highlight><highlight class="keyword">true</highlight><highlight class="normal">;</highlight></codeline>
<codeline lineno="264"><highlight class="normal">}</highlight></codeline>
<codeline lineno="265"><highlight class="normal"></highlight></codeline>
<codeline lineno="266"><highlight class="normal"></highlight><highlight class="keywordtype">void</highlight><highlight class="normal"><sp/><ref refid="class_global_server_1ae7b92d28b2d5d969f62d4bac7c2f1b46" kindref="member">GlobalServer::LoadDynamicConfig</ref>(</highlight><highlight class="keywordtype">void</highlight><highlight class="normal">)</highlight></codeline>
<codeline lineno="267"><highlight class="normal">{</highlight></codeline>
<codeline lineno="268"><highlight class="normal"><sp/><sp/><sp/><sp/><ref refid="class_se_config" kindref="compound">SeConfig</ref><sp/>kConfig;</highlight></codeline>
<codeline lineno="269"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(!kConfig.<ref refid="class_se_config_1a077cfce8454c31d293c2d2341980ffca" kindref="member">Load</ref>(</highlight><highlight class="stringliteral">&quot;./Data/GlobalServer.ini&quot;</highlight><highlight class="normal">))</highlight></codeline>
<codeline lineno="270"><highlight class="normal"><sp/><sp/><sp/><sp/>{</highlight></codeline>
<codeline lineno="271"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal">;</highlight></codeline>
<codeline lineno="272"><highlight class="normal"><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="273"><highlight class="normal"></highlight></codeline>
<codeline lineno="274"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keyword">const</highlight><highlight class="normal"><sp/></highlight><highlight class="keywordtype">char</highlight><highlight class="normal">*<sp/>pcValue<sp/>=<sp/>kConfig.<ref refid="class_se_config_1a8839d0f5e6b831b66fd018826a304086" kindref="member">GetValue</ref>(</highlight><highlight class="stringliteral">&quot;LogShowType&quot;</highlight><highlight class="normal">);</highlight></codeline>
<codeline lineno="275"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(pcValue)</highlight></codeline>
<codeline lineno="276"><highlight class="normal"><sp/><sp/><sp/><sp/>{</highlight></codeline>
<codeline lineno="277"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="class_global_server_1a5c5b73f8fcd4a44b79d2f7b1429fd2d0" kindref="member">m_kConfig</ref>.<ref refid="struct_se_global_config_1adf203dc3c86f3a5cdad439ba199b0e86" kindref="member">iLogShowType</ref><sp/>=<sp/>atoi(pcValue);</highlight></codeline>
<codeline lineno="278"><highlight class="normal"><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="279"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">else</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="280"><highlight class="normal"><sp/><sp/><sp/><sp/>{</highlight></codeline>
<codeline lineno="281"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="class_global_server_1a5c5b73f8fcd4a44b79d2f7b1429fd2d0" kindref="member">m_kConfig</ref>.<ref refid="struct_se_global_config_1adf203dc3c86f3a5cdad439ba199b0e86" kindref="member">iLogShowType</ref><sp/>=<sp/>0;</highlight></codeline>
<codeline lineno="282"><highlight class="normal"><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="283"><highlight class="normal"></highlight></codeline>
<codeline lineno="284"><highlight class="normal"><sp/><sp/><sp/><sp/>pcValue<sp/>=<sp/>kConfig.<ref refid="class_se_config_1a8839d0f5e6b831b66fd018826a304086" kindref="member">GetValue</ref>(</highlight><highlight class="stringliteral">&quot;MaxCacheNum&quot;</highlight><highlight class="normal">);</highlight></codeline>
<codeline lineno="285"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(pcValue)</highlight></codeline>
<codeline lineno="286"><highlight class="normal"><sp/><sp/><sp/><sp/>{</highlight></codeline>
<codeline lineno="287"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="class_global_server_1a5c5b73f8fcd4a44b79d2f7b1429fd2d0" kindref="member">m_kConfig</ref>.<ref refid="struct_se_global_config_1a73abf30ea6721c631308a948106b6806" kindref="member">iMaxCacheNum</ref><sp/>=<sp/>atoi(pcValue);</highlight></codeline>
<codeline lineno="288"><highlight class="normal"><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="289"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">else</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="290"><highlight class="normal"><sp/><sp/><sp/><sp/>{</highlight></codeline>
<codeline lineno="291"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="class_global_server_1a5c5b73f8fcd4a44b79d2f7b1429fd2d0" kindref="member">m_kConfig</ref>.<ref refid="struct_se_global_config_1a73abf30ea6721c631308a948106b6806" kindref="member">iMaxCacheNum</ref><sp/>=<sp/>1024<sp/>*<sp/>1024<sp/>*<sp/>3;</highlight></codeline>
<codeline lineno="292"><highlight class="normal"><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="293"><highlight class="normal"></highlight></codeline>
<codeline lineno="294"><highlight class="normal"><sp/><sp/><sp/><sp/>pcValue<sp/>=<sp/>kConfig.<ref refid="class_se_config_1a8839d0f5e6b831b66fd018826a304086" kindref="member">GetValue</ref>(</highlight><highlight class="stringliteral">&quot;HeartPackageTime&quot;</highlight><highlight class="normal">);</highlight></codeline>
<codeline lineno="295"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(pcValue)</highlight></codeline>
<codeline lineno="296"><highlight class="normal"><sp/><sp/><sp/><sp/>{</highlight></codeline>
<codeline lineno="297"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="class_global_server_1a5c5b73f8fcd4a44b79d2f7b1429fd2d0" kindref="member">m_kConfig</ref>.<ref refid="struct_se_global_config_1a8dce0a3617013724766735d78f23f5f2" kindref="member">dwHeartPackageTime</ref><sp/>=<sp/>(DWord)atoi(pcValue);</highlight></codeline>
<codeline lineno="298"><highlight class="normal"><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="299"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">else</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="300"><highlight class="normal"><sp/><sp/><sp/><sp/>{</highlight></codeline>
<codeline lineno="301"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="class_global_server_1a5c5b73f8fcd4a44b79d2f7b1429fd2d0" kindref="member">m_kConfig</ref>.<ref refid="struct_se_global_config_1a8dce0a3617013724766735d78f23f5f2" kindref="member">dwHeartPackageTime</ref><sp/>=<sp/>20000;</highlight></codeline>
<codeline lineno="302"><highlight class="normal"><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="303"><highlight class="normal"></highlight></codeline>
<codeline lineno="304"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordtype">int</highlight><highlight class="normal"><sp/>iCount<sp/>=<sp/>0;</highlight></codeline>
<codeline lineno="305"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">while</highlight><highlight class="normal"><sp/>(</highlight><highlight class="keyword">true</highlight><highlight class="normal">)</highlight></codeline>
<codeline lineno="306"><highlight class="normal"><sp/><sp/><sp/><sp/>{</highlight></codeline>
<codeline lineno="307"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordtype">char</highlight><highlight class="normal"><sp/>acName[64]<sp/>=<sp/>{<sp/>0<sp/>};</highlight></codeline>
<codeline lineno="308"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="_se_server_tool_8cpp_1ad2735ec90511f0d6ec1535cf448709b8" kindref="member">SPrintf</ref>(acName,<sp/></highlight><highlight class="keyword">sizeof</highlight><highlight class="normal">(acName),<sp/></highlight><highlight class="stringliteral">&quot;Area%d&quot;</highlight><highlight class="normal">,<sp/>++iCount);</highlight></codeline>
<codeline lineno="309"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keyword">const</highlight><highlight class="normal"><sp/></highlight><highlight class="keywordtype">char</highlight><highlight class="normal">*<sp/>pcValue<sp/>=<sp/>kConfig.<ref refid="class_se_config_1a8839d0f5e6b831b66fd018826a304086" kindref="member">GetValue</ref>(acName);</highlight></codeline>
<codeline lineno="310"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(!pcValue)</highlight></codeline>
<codeline lineno="311"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>{</highlight></codeline>
<codeline lineno="312"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">break</highlight><highlight class="normal">;</highlight></codeline>
<codeline lineno="313"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="314"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>std::string<sp/>kStr<sp/>=<sp/>pcValue;</highlight></codeline>
<codeline lineno="315"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordtype">int</highlight><highlight class="normal"><sp/>iAreaIDEnd<sp/>=<sp/>(int)kStr.find_first_of(</highlight><highlight class="stringliteral">&quot;<sp/>&quot;</highlight><highlight class="normal">);</highlight></codeline>
<codeline lineno="316"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>std::string<sp/>kIDStr<sp/>=<sp/>std::string(kStr,<sp/>0,<sp/>iAreaIDEnd);</highlight></codeline>
<codeline lineno="317"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>std::string<sp/>kAreaName<sp/>=<sp/>std::string(kStr,<sp/>iAreaIDEnd<sp/>+<sp/>1,<sp/>kStr.size());</highlight></codeline>
<codeline lineno="318"><highlight class="normal"></highlight></codeline>
<codeline lineno="319"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="class_global_server_1a71b0e2fba1cffbb14f5fc46be39615dd" kindref="member">m_kID2AreaName</ref>[atoi(kIDStr.c_str())]<sp/>=<sp/>kAreaName;</highlight></codeline>
<codeline lineno="320"><highlight class="normal"><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="321"><highlight class="normal">}</highlight></codeline>
<codeline lineno="322"><highlight class="normal"></highlight></codeline>
<codeline lineno="323"><highlight class="normal"></highlight><highlight class="keywordtype">bool</highlight><highlight class="normal"><sp/><ref refid="class_global_server_1ac939393de3f116f2895633c0ee291c74" kindref="member">GlobalServer::InitializeDB</ref>(</highlight><highlight class="keywordtype">void</highlight><highlight class="normal">)</highlight></codeline>
<codeline lineno="324"><highlight class="normal">{</highlight></codeline>
<codeline lineno="325"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(!<ref refid="class_global_server_1a7da4482cf41b17bcb30de2cbc5933804" kindref="member">m_kDBMgr</ref>.Initialize(</highlight><highlight class="keyword">this</highlight><highlight class="normal">))</highlight></codeline>
<codeline lineno="326"><highlight class="normal"><sp/><sp/><sp/><sp/>{</highlight></codeline>
<codeline lineno="327"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="_se_file_log_8h_1a59fe2018c00666084724bec1365b41f5" kindref="member">SeLogError</ref>(</highlight><highlight class="stringliteral">&quot;Initialize<sp/>DB<sp/>failed!&quot;</highlight><highlight class="normal">,<sp/>1);</highlight></codeline>
<codeline lineno="328"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/></highlight><highlight class="keyword">false</highlight><highlight class="normal">;</highlight></codeline>
<codeline lineno="329"><highlight class="normal"><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="330"><highlight class="normal"></highlight></codeline>
<codeline lineno="331"><highlight class="normal"><sp/><sp/><sp/><sp/><ref refid="struct_se_d_b_addr" kindref="compound">SeDBAddr</ref>&amp;<sp/>rkUnitAccountDb<sp/>=<sp/><ref refid="class_global_server_1a5c5b73f8fcd4a44b79d2f7b1429fd2d0" kindref="member">m_kConfig</ref>.<ref refid="struct_se_global_config_1a3d51a3e1cccee9be3e3d9e91c0ddb08f" kindref="member">kUnitAccountDB</ref>;</highlight></codeline>
<codeline lineno="332"><highlight class="normal"><sp/><sp/><sp/><sp/><ref refid="class_global_server_1adb424635ec867002bdc5569fba60b666" kindref="member">m_iUnitAccountDB</ref><sp/>=<sp/><ref refid="class_global_server_1a7da4482cf41b17bcb30de2cbc5933804" kindref="member">m_kDBMgr</ref>.AddDBServerInfo(rkUnitAccountDb.<ref refid="struct_se_d_b_addr_1ad9ca5b457c92daf4c9e26583e9505fdd" kindref="member">acIP</ref>,<sp/>rkUnitAccountDb.<ref refid="struct_se_d_b_addr_1a1ac445b204c6f0f79b8be0d866d6c345" kindref="member">iPort</ref>,<sp/>rkUnitAccountDb.<ref refid="struct_se_d_b_addr_1ae8a70001edc6281b45cb6692e94557c7" kindref="member">acDBName</ref>,<sp/>rkUnitAccountDb.<ref refid="struct_se_d_b_addr_1a8c395e74313d9eba8aec4c1d43837786" kindref="member">acDBUser</ref>,<sp/>rkUnitAccountDb.<ref refid="struct_se_d_b_addr_1a54fa6e30b317baf8e70247984fbd3118" kindref="member">acDBPassword</ref>,<sp/><ref refid="src_2_global_server_def_8h_1a4b8ccf0bf46575671a44659ec3daa697afbdb1297c666ddefe6878e1538b53383" kindref="member">SAD_DB_LOGIC</ref>);</highlight></codeline>
<codeline lineno="333"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(!<ref refid="class_global_server_1a7da4482cf41b17bcb30de2cbc5933804" kindref="member">m_kDBMgr</ref>.ConnectDB(<ref refid="class_global_server_1adb424635ec867002bdc5569fba60b666" kindref="member">m_iUnitAccountDB</ref>))</highlight></codeline>
<codeline lineno="334"><highlight class="normal"><sp/><sp/><sp/><sp/>{</highlight></codeline>
<codeline lineno="335"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="_se_file_log_8h_1a59fe2018c00666084724bec1365b41f5" kindref="member">SeLogError</ref>(</highlight><highlight class="stringliteral">&quot;Connect<sp/>UnitAccountDB<sp/>failed:[%s:%d:%s]&quot;</highlight><highlight class="normal">,<sp/>rkUnitAccountDb.<ref refid="struct_se_d_b_addr_1ad9ca5b457c92daf4c9e26583e9505fdd" kindref="member">acIP</ref>,<sp/>rkUnitAccountDb.<ref refid="struct_se_d_b_addr_1a1ac445b204c6f0f79b8be0d866d6c345" kindref="member">iPort</ref>,<sp/>rkUnitAccountDb.<ref refid="struct_se_d_b_addr_1ae8a70001edc6281b45cb6692e94557c7" kindref="member">acDBName</ref>);</highlight></codeline>
<codeline lineno="336"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/></highlight><highlight class="keyword">false</highlight><highlight class="normal">;</highlight></codeline>
<codeline lineno="337"><highlight class="normal"><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="338"><highlight class="normal"></highlight></codeline>
<codeline lineno="339"><highlight class="normal"><sp/><sp/><sp/><sp/><ref refid="_se_file_log_8h_1a83f3fe470b91cb8eed8762cc8e5e26c3" kindref="member">SeLogInfo</ref>(</highlight><highlight class="stringliteral">&quot;Connect<sp/>UnitAccountDB<sp/>successfully<sp/>:<sp/>[%s:%d<sp/>:<sp/>%s]&quot;</highlight><highlight class="normal">,<sp/>rkUnitAccountDb.<ref refid="struct_se_d_b_addr_1ad9ca5b457c92daf4c9e26583e9505fdd" kindref="member">acIP</ref>,<sp/>rkUnitAccountDb.<ref refid="struct_se_d_b_addr_1a1ac445b204c6f0f79b8be0d866d6c345" kindref="member">iPort</ref>,<sp/>rkUnitAccountDb.<ref refid="struct_se_d_b_addr_1ae8a70001edc6281b45cb6692e94557c7" kindref="member">acDBName</ref>);</highlight></codeline>
<codeline lineno="340"><highlight class="normal"></highlight></codeline>
<codeline lineno="341"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/></highlight><highlight class="keyword">true</highlight><highlight class="normal">;</highlight></codeline>
<codeline lineno="342"><highlight class="normal">}</highlight></codeline>
<codeline lineno="343"><highlight class="normal"></highlight></codeline>
<codeline lineno="344"><highlight class="normal"></highlight><highlight class="keywordtype">bool</highlight><highlight class="normal"><sp/><ref refid="class_global_server_1aaedfe2b1dc5669a7cd435b13e0bf3840" kindref="member">GlobalServer::InitializeNet</ref>(</highlight><highlight class="keywordtype">void</highlight><highlight class="normal">)</highlight></codeline>
<codeline lineno="345"><highlight class="normal">{</highlight></codeline>
<codeline lineno="346"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal">(!<ref refid="class_global_server_1aab15fb083ac582e71e2a686f44b21297" kindref="member">m_kNetMgr</ref>.Initialize(</highlight><highlight class="keyword">this</highlight><highlight class="normal">,4))</highlight></codeline>
<codeline lineno="347"><highlight class="normal"><sp/><sp/><sp/><sp/>{</highlight></codeline>
<codeline lineno="348"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="_se_file_log_8h_1a59fe2018c00666084724bec1365b41f5" kindref="member">SeLogError</ref>(</highlight><highlight class="stringliteral">&quot;Initialize<sp/>net<sp/>failed&quot;</highlight><highlight class="normal">,1);</highlight></codeline>
<codeline lineno="349"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/></highlight><highlight class="keyword">false</highlight><highlight class="normal">;</highlight></codeline>
<codeline lineno="350"><highlight class="normal"><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="351"><highlight class="normal"><sp/><sp/><sp/><sp/><ref refid="_se_file_log_8h_1a83f3fe470b91cb8eed8762cc8e5e26c3" kindref="member">SeLogInfo</ref>(</highlight><highlight class="stringliteral">&quot;Initialize<sp/>net<sp/>successfully&quot;</highlight><highlight class="normal">,1);</highlight></codeline>
<codeline lineno="352"><highlight class="normal"></highlight></codeline>
<codeline lineno="353"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal">(!<ref refid="class_global_server_1aab15fb083ac582e71e2a686f44b21297" kindref="member">m_kNetMgr</ref>.Listen(<ref refid="class_global_server_1a5c5b73f8fcd4a44b79d2f7b1429fd2d0" kindref="member">m_kConfig</ref>.<ref refid="struct_se_global_config_1a5139a946d121802a0719ab286d9248ae" kindref="member">kAddrToServer</ref>.<ref refid="struct_se_net_addr_1a989fa5b025bc039122e8d2a29838fde9" kindref="member">iPort</ref>,8,<sp/><ref refid="_se_server_define_8h_1a141dc49d73e6790790a053c29623f606" kindref="member">SERVER_BUFFER_SIZE</ref>))</highlight></codeline>
<codeline lineno="354"><highlight class="normal"><sp/><sp/><sp/><sp/>{</highlight></codeline>
<codeline lineno="355"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="_se_file_log_8h_1a59fe2018c00666084724bec1365b41f5" kindref="member">SeLogError</ref>(</highlight><highlight class="stringliteral">&quot;Initialize<sp/>login<sp/>tcp<sp/>port<sp/>failed:[%s:%d]&quot;</highlight><highlight class="normal">,<ref refid="class_global_server_1a5c5b73f8fcd4a44b79d2f7b1429fd2d0" kindref="member">m_kConfig</ref>.<ref refid="struct_se_global_config_1a5139a946d121802a0719ab286d9248ae" kindref="member">kAddrToServer</ref>.<ref refid="struct_se_net_addr_1a23b51e87d8b7b2201a03833c9adde232" kindref="member">acIP</ref>,<ref refid="class_global_server_1a5c5b73f8fcd4a44b79d2f7b1429fd2d0" kindref="member">m_kConfig</ref>.<ref refid="struct_se_global_config_1a5139a946d121802a0719ab286d9248ae" kindref="member">kAddrToServer</ref>.<ref refid="struct_se_net_addr_1a989fa5b025bc039122e8d2a29838fde9" kindref="member">iPort</ref>);</highlight></codeline>
<codeline lineno="356"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/></highlight><highlight class="keyword">false</highlight><highlight class="normal">;</highlight></codeline>
<codeline lineno="357"><highlight class="normal"><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="358"><highlight class="normal"><sp/><sp/><sp/><sp/><ref refid="_se_file_log_8h_1a83f3fe470b91cb8eed8762cc8e5e26c3" kindref="member">SeLogInfo</ref>(</highlight><highlight class="stringliteral">&quot;Initialize<sp/>server<sp/>tcp<sp/>port<sp/>successfully:[%s:%d]&quot;</highlight><highlight class="normal">,<ref refid="class_global_server_1a5c5b73f8fcd4a44b79d2f7b1429fd2d0" kindref="member">m_kConfig</ref>.<ref refid="struct_se_global_config_1a5139a946d121802a0719ab286d9248ae" kindref="member">kAddrToServer</ref>.<ref refid="struct_se_net_addr_1a23b51e87d8b7b2201a03833c9adde232" kindref="member">acIP</ref>,<ref refid="class_global_server_1a5c5b73f8fcd4a44b79d2f7b1429fd2d0" kindref="member">m_kConfig</ref>.<ref refid="struct_se_global_config_1a5139a946d121802a0719ab286d9248ae" kindref="member">kAddrToServer</ref>.<ref refid="struct_se_net_addr_1a989fa5b025bc039122e8d2a29838fde9" kindref="member">iPort</ref>);</highlight></codeline>
<codeline lineno="359"><highlight class="normal"></highlight></codeline>
<codeline lineno="360"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/></highlight><highlight class="keyword">true</highlight><highlight class="normal">;</highlight></codeline>
<codeline lineno="361"><highlight class="normal">}</highlight></codeline>
<codeline lineno="362"><highlight class="normal"></highlight></codeline>
<codeline lineno="363"><highlight class="normal"></highlight><highlight class="keywordtype">void</highlight><highlight class="normal"><sp/><ref refid="class_global_server_1ac5c333eb2847b07e28a2ed3f8c68a20d" kindref="member">GlobalServer::ConnectToDS</ref>(</highlight><highlight class="keywordtype">void</highlight><highlight class="normal">)</highlight></codeline>
<codeline lineno="364"><highlight class="normal">{</highlight></codeline>
<codeline lineno="365"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight></codeline>
<codeline lineno="366"><highlight class="normal">}</highlight></codeline>
<codeline lineno="367"><highlight class="normal"></highlight></codeline>
<codeline lineno="368"><highlight class="normal"></highlight><highlight class="keywordtype">void</highlight><highlight class="normal"><sp/><ref refid="class_global_server_1af54700a86d36500ef80a2cbec3dde870" kindref="member">GlobalServer::RegisterToDS</ref>(</highlight><highlight class="keywordtype">void</highlight><highlight class="normal">)</highlight></codeline>
<codeline lineno="369"><highlight class="normal">{</highlight></codeline>
<codeline lineno="370"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight></codeline>
<codeline lineno="371"><highlight class="normal">}</highlight></codeline>
<codeline lineno="372"><highlight class="normal"></highlight></codeline>
<codeline lineno="373"><highlight class="normal"></highlight><highlight class="keywordtype">void</highlight><highlight class="normal"><sp/><ref refid="class_global_server_1a782b4b0ade24605d25c4ee0bd8fef01e" kindref="member">GlobalServer::UpdateState</ref>(</highlight><highlight class="keywordtype">void</highlight><highlight class="normal">)</highlight></codeline>
<codeline lineno="374"><highlight class="normal">{</highlight></codeline>
<codeline lineno="375"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight></codeline>
<codeline lineno="376"><highlight class="normal">}</highlight></codeline>
<codeline lineno="377"><highlight class="normal"></highlight></codeline>
<codeline lineno="378"><highlight class="normal"></highlight><highlight class="keywordtype">void</highlight><highlight class="normal"><sp/><ref refid="class_global_server_1ae03207722877f8034517367d6a8425a1" kindref="member">GlobalServer::UpdateLogShow</ref>(</highlight><highlight class="keywordtype">void</highlight><highlight class="normal">)</highlight></codeline>
<codeline lineno="379"><highlight class="normal">{</highlight></codeline>
<codeline lineno="380"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keyword">static</highlight><highlight class="normal"><sp/>DWord<sp/>s_dwPreTime<sp/>=<sp/><ref refid="class_global_server_1a0f7391b92b1ebf68ab0201806771afec" kindref="member">GetServerTime</ref>();</highlight></codeline>
<codeline lineno="381"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal">((</highlight><highlight class="keywordtype">int</highlight><highlight class="normal">)(<ref refid="class_global_server_1a0f7391b92b1ebf68ab0201806771afec" kindref="member">GetServerTime</ref>()<sp/>-<sp/>s_dwPreTime)<sp/>&gt;=<sp/>1000)</highlight></codeline>
<codeline lineno="382"><highlight class="normal"><sp/><sp/><sp/><sp/>{</highlight></codeline>
<codeline lineno="383"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>s_dwPreTime<sp/>=<sp/><ref refid="class_global_server_1a0f7391b92b1ebf68ab0201806771afec" kindref="member">GetServerTime</ref>();</highlight></codeline>
<codeline lineno="384"><highlight class="normal"></highlight></codeline>
<codeline lineno="385"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal">(<ref refid="class_global_server_1a5c5b73f8fcd4a44b79d2f7b1429fd2d0" kindref="member">m_kConfig</ref>.<ref refid="struct_se_global_config_1adf203dc3c86f3a5cdad439ba199b0e86" kindref="member">iLogShowType</ref><sp/>==<sp/>1<sp/>&amp;&amp;<sp/><ref refid="class_global_server_1aaad1ac26a0d93306cdb73879d1617edb" kindref="member">m_dwLoadCount</ref><sp/>&gt;<sp/>0)</highlight></codeline>
<codeline lineno="386"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>{</highlight></codeline>
<codeline lineno="387"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal">(<ref refid="class_global_server_1aaad1ac26a0d93306cdb73879d1617edb" kindref="member">m_dwLoadCount</ref><sp/>&gt;<sp/>0)</highlight></codeline>
<codeline lineno="388"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>{</highlight></codeline>
<codeline lineno="389"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="_se_file_log_8h_1a83f3fe470b91cb8eed8762cc8e5e26c3" kindref="member">SeLogInfo</ref>(</highlight><highlight class="stringliteral">&quot;Load<sp/>Complete<sp/>PlayerNum[%d]<sp/>AvgTime[%d]<sp/>In<sp/>sec&quot;</highlight><highlight class="normal">,<sp/><ref refid="class_global_server_1aaad1ac26a0d93306cdb73879d1617edb" kindref="member">m_dwLoadCount</ref>,<sp/><ref refid="class_global_server_1a0a4879864d5a5cc5964713eb03d1979d" kindref="member">m_dwLoadSumTime</ref><sp/>/<sp/><ref refid="class_global_server_1aaad1ac26a0d93306cdb73879d1617edb" kindref="member">m_dwLoadCount</ref>);</highlight></codeline>
<codeline lineno="390"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="class_global_server_1aaad1ac26a0d93306cdb73879d1617edb" kindref="member">m_dwLoadCount</ref><sp/>=<sp/>0;</highlight></codeline>
<codeline lineno="391"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="class_global_server_1a0a4879864d5a5cc5964713eb03d1979d" kindref="member">m_dwLoadSumTime</ref><sp/>=<sp/>0;</highlight></codeline>
<codeline lineno="392"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="393"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="394"><highlight class="normal"><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="395"><highlight class="normal">}</highlight></codeline>
<codeline lineno="396"><highlight class="normal"></highlight></codeline>
<codeline lineno="397"><highlight class="normal"></highlight><highlight class="keywordtype">void</highlight><highlight class="normal"><sp/><ref refid="class_global_server_1a18c66d83edde07de4bd17488be7cddfa" kindref="member">GlobalServer::UpdateGS2WSTime</ref>(</highlight><highlight class="keywordtype">void</highlight><highlight class="normal">)</highlight></codeline>
<codeline lineno="398"><highlight class="normal">{</highlight></codeline>
<codeline lineno="399"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keyword">static</highlight><highlight class="normal"><sp/>DWord<sp/>s_dwPreTime<sp/>=<sp/><ref refid="class_global_server_1a0f7391b92b1ebf68ab0201806771afec" kindref="member">GetServerTime</ref>();</highlight></codeline>
<codeline lineno="400"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordtype">int</highlight><highlight class="normal"><sp/>iDTime<sp/>=<sp/>(int)(<ref refid="class_global_server_1a0f7391b92b1ebf68ab0201806771afec" kindref="member">GetServerTime</ref>()<sp/>-<sp/>s_dwPreTime);</highlight></codeline>
<codeline lineno="401"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal">(iDTime<sp/>&lt;<sp/>1000)</highlight></codeline>
<codeline lineno="402"><highlight class="normal"><sp/><sp/><sp/><sp/>{</highlight></codeline>
<codeline lineno="403"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal">;</highlight></codeline>
<codeline lineno="404"><highlight class="normal"><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="405"><highlight class="normal"><sp/><sp/><sp/><sp/>s_dwPreTime<sp/>=<sp/><ref refid="class_global_server_1a0f7391b92b1ebf68ab0201806771afec" kindref="member">GetServerTime</ref>();</highlight></codeline>
<codeline lineno="406"><highlight class="normal"></highlight></codeline>
<codeline lineno="407"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">for</highlight><highlight class="normal">(MapAllWS::iterator<sp/>itr<sp/>=<sp/><ref refid="class_global_server_1a1149e611d703f0185fa3b79a8834efb3" kindref="member">m_kAllWS</ref>.begin();itr<sp/>!=<sp/><ref refid="class_global_server_1a1149e611d703f0185fa3b79a8834efb3" kindref="member">m_kAllWS</ref>.end();++itr)</highlight></codeline>
<codeline lineno="408"><highlight class="normal"><sp/><sp/><sp/><sp/>{</highlight></codeline>
<codeline lineno="409"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="struct_se_w_s_data" kindref="compound">SeWSData</ref>*<sp/>pkWS<sp/>=<sp/>itr-&gt;second;</highlight></codeline>
<codeline lineno="410"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(pkWS-&gt;<ref refid="struct_se_w_s_data_1ab8d44ccc33163e1fc1aa2b425ad34e53" kindref="member">eState</ref><sp/>!=<sp/><ref refid="src_2_global_server_def_8h_1a2ea29fb43c02c342774401daa3815e3ba302e598532950ed6a543c508b7514705" kindref="member">WSS_LOGIN_OK</ref>)</highlight></codeline>
<codeline lineno="411"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>{</highlight></codeline>
<codeline lineno="412"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">continue</highlight><highlight class="normal">;</highlight></codeline>
<codeline lineno="413"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="414"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>iDTime<sp/>=<sp/>(int)(<ref refid="class_global_server_1a0f7391b92b1ebf68ab0201806771afec" kindref="member">GetServerTime</ref>()<sp/>-<sp/>pkWS-&gt;<ref refid="struct_se_w_s_data_1a86148f9d13629aed1e8914be75d21637" kindref="member">dwRecvTime</ref>);</highlight></codeline>
<codeline lineno="415"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal">(iDTime<sp/>&gt;<sp/>20<sp/>*<sp/>1000)</highlight></codeline>
<codeline lineno="416"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>{</highlight></codeline>
<codeline lineno="417"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="_se_file_log_8h_1a83f3fe470b91cb8eed8762cc8e5e26c3" kindref="member">SeLogInfo</ref>(</highlight><highlight class="stringliteral">&quot;LastRecvTime<sp/>OverTime<sp/>Disconnect<sp/>WS[%s]<sp/>addr[%s:%d]&quot;</highlight><highlight class="normal">,<sp/><ref refid="_se_tool_8h_1ada81d4ae5d39c42af0a02b45f4a6f715" kindref="member">GetID2Str</ref>(pkWS-&gt;<ref refid="struct_se_w_s_data_1af325940f9ea9a1f5b4e1c05478a4f43c" kindref="member">dwServerID</ref>),<sp/>pkWS-&gt;<ref refid="struct_se_w_s_data_1a5f3b6eb3e3b530c7ba8f1debf8f91299" kindref="member">kNetAddr</ref>.<ref refid="struct_se_net_addr_1a23b51e87d8b7b2201a03833c9adde232" kindref="member">acIP</ref>,<sp/>pkWS-&gt;<ref refid="struct_se_w_s_data_1a5f3b6eb3e3b530c7ba8f1debf8f91299" kindref="member">kNetAddr</ref>.<ref refid="struct_se_net_addr_1a989fa5b025bc039122e8d2a29838fde9" kindref="member">iPort</ref>);</highlight></codeline>
<codeline lineno="418"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="class_global_server_1aab15fb083ac582e71e2a686f44b21297" kindref="member">m_kNetMgr</ref>.Disconnect(pkWS-&gt;<ref refid="struct_se_w_s_data_1ad3ea1dc90d4bb1dd98d3dc5089d3ea85" kindref="member">kSock</ref>);</highlight></codeline>
<codeline lineno="419"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="420"><highlight class="normal"><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="421"><highlight class="normal">}</highlight></codeline>
<codeline lineno="422"><highlight class="normal"></highlight></codeline>
<codeline lineno="423"><highlight class="normal"><ref refid="struct_se_w_s_data" kindref="compound">SeWSData</ref>*<sp/><ref refid="class_global_server_1a0df1684f3285e319ebd96712a47feb42" kindref="member">GlobalServer::GetWSByID</ref>(DWord<sp/>dwServerID)</highlight></codeline>
<codeline lineno="424"><highlight class="normal">{</highlight></codeline>
<codeline lineno="425"><highlight class="normal"><sp/><sp/><sp/><sp/>MapAllWS::iterator<sp/>itr<sp/>=<sp/><ref refid="class_global_server_1a1149e611d703f0185fa3b79a8834efb3" kindref="member">m_kAllWS</ref>.begin();</highlight></codeline>
<codeline lineno="426"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">for</highlight><highlight class="normal">(;itr<sp/>!=<sp/><ref refid="class_global_server_1a1149e611d703f0185fa3b79a8834efb3" kindref="member">m_kAllWS</ref>.end();++itr)</highlight></codeline>
<codeline lineno="427"><highlight class="normal"><sp/><sp/><sp/><sp/>{</highlight></codeline>
<codeline lineno="428"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="struct_se_w_s_data" kindref="compound">SeWSData</ref>*<sp/>pkWS<sp/>=<sp/>itr-&gt;second;</highlight></codeline>
<codeline lineno="429"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal">(pkWS-&gt;<ref refid="struct_se_w_s_data_1ab8d44ccc33163e1fc1aa2b425ad34e53" kindref="member">eState</ref><sp/>==<sp/><ref refid="src_2_global_server_def_8h_1a2ea29fb43c02c342774401daa3815e3ba302e598532950ed6a543c508b7514705" kindref="member">WSS_LOGIN_OK</ref><sp/>&amp;&amp;<sp/>pkWS-&gt;<ref refid="struct_se_w_s_data_1af325940f9ea9a1f5b4e1c05478a4f43c" kindref="member">dwServerID</ref><sp/>==<sp/>dwServerID)</highlight></codeline>
<codeline lineno="430"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>{</highlight></codeline>
<codeline lineno="431"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/>pkWS;</highlight></codeline>
<codeline lineno="432"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="433"><highlight class="normal"><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="434"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/>NULL;</highlight></codeline>
<codeline lineno="435"><highlight class="normal">}</highlight></codeline>
<codeline lineno="436"><highlight class="normal"></highlight></codeline>
<codeline lineno="437"><highlight class="normal"><ref refid="struct_se_w_s_data" kindref="compound">SeWSData</ref>*<sp/><ref refid="class_global_server_1ad77611c842810b2e30cafc67166df59d" kindref="member">GlobalServer::GetWSByAreaID</ref>(DWord<sp/>dwAreaID)</highlight></codeline>
<codeline lineno="438"><highlight class="normal">{</highlight></codeline>
<codeline lineno="439"><highlight class="normal"><sp/><sp/><sp/><sp/>MapAllWS::iterator<sp/>itr<sp/>=<sp/><ref refid="class_global_server_1a1149e611d703f0185fa3b79a8834efb3" kindref="member">m_kAllWS</ref>.begin();</highlight></codeline>
<codeline lineno="440"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">for</highlight><highlight class="normal">(;itr<sp/>!=<sp/><ref refid="class_global_server_1a1149e611d703f0185fa3b79a8834efb3" kindref="member">m_kAllWS</ref>.end();++itr)</highlight></codeline>
<codeline lineno="441"><highlight class="normal"><sp/><sp/><sp/><sp/>{</highlight></codeline>
<codeline lineno="442"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="struct_se_w_s_data" kindref="compound">SeWSData</ref>*<sp/>pkWS<sp/>=<sp/>itr-&gt;second;</highlight></codeline>
<codeline lineno="443"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal">(pkWS-&gt;<ref refid="struct_se_w_s_data_1ab8d44ccc33163e1fc1aa2b425ad34e53" kindref="member">eState</ref><sp/>==<sp/><ref refid="src_2_global_server_def_8h_1a2ea29fb43c02c342774401daa3815e3ba302e598532950ed6a543c508b7514705" kindref="member">WSS_LOGIN_OK</ref><sp/>&amp;&amp;<sp/>pkWS-&gt;<ref refid="struct_se_w_s_data_1abac3ec5bcdbbe4c6518693c41f959f09" kindref="member">dwAreaID</ref><sp/>==<sp/>dwAreaID)</highlight></codeline>
<codeline lineno="444"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>{</highlight></codeline>
<codeline lineno="445"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/>pkWS;</highlight></codeline>
<codeline lineno="446"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="447"><highlight class="normal"><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="448"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/>NULL;</highlight></codeline>
<codeline lineno="449"><highlight class="normal">}</highlight></codeline>
<codeline lineno="450"><highlight class="normal"></highlight></codeline>
<codeline lineno="451"><highlight class="normal">std::string<sp/><ref refid="class_global_server_1a0b947916daa4545af7147df758bb6f10" kindref="member">GlobalServer::GetAreaName</ref>(DWord<sp/>dwID)</highlight></codeline>
<codeline lineno="452"><highlight class="normal">{</highlight></codeline>
<codeline lineno="453"><highlight class="normal"><sp/><sp/><sp/><sp/>std::string<sp/>kAreaName;</highlight></codeline>
<codeline lineno="454"><highlight class="normal"></highlight></codeline>
<codeline lineno="455"><highlight class="normal"><sp/><sp/><sp/><sp/>MAPID2AreaName::iterator<sp/>iMapItr<sp/>=<sp/><ref refid="class_global_server_1a71b0e2fba1cffbb14f5fc46be39615dd" kindref="member">m_kID2AreaName</ref>.find(dwID);</highlight></codeline>
<codeline lineno="456"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal">(iMapItr<sp/>!=<sp/><ref refid="class_global_server_1a71b0e2fba1cffbb14f5fc46be39615dd" kindref="member">m_kID2AreaName</ref>.end())</highlight></codeline>
<codeline lineno="457"><highlight class="normal"><sp/><sp/><sp/><sp/>{</highlight></codeline>
<codeline lineno="458"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>kAreaName<sp/>=<sp/>iMapItr-&gt;second;</highlight></codeline>
<codeline lineno="459"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/>kAreaName;</highlight></codeline>
<codeline lineno="460"><highlight class="normal"><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="461"><highlight class="normal"></highlight></codeline>
<codeline lineno="462"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">switch</highlight><highlight class="normal">(dwID)</highlight></codeline>
<codeline lineno="463"><highlight class="normal"><sp/><sp/><sp/><sp/>{</highlight></codeline>
<codeline lineno="464"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">case</highlight><highlight class="normal"><sp/>1:</highlight></codeline>
<codeline lineno="465"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>{</highlight></codeline>
<codeline lineno="466"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>kAreaName<sp/>=<sp/></highlight><highlight class="stringliteral">&quot;&quot;</highlight><highlight class="normal">;</highlight></codeline>
<codeline lineno="467"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">break</highlight><highlight class="normal">;</highlight></codeline>
<codeline lineno="468"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="469"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">case</highlight><highlight class="normal"><sp/>2:</highlight></codeline>
<codeline lineno="470"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>{</highlight></codeline>
<codeline lineno="471"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>kAreaName<sp/>=<sp/></highlight><highlight class="stringliteral">&quot;&quot;</highlight><highlight class="normal">;</highlight></codeline>
<codeline lineno="472"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">break</highlight><highlight class="normal">;</highlight></codeline>
<codeline lineno="473"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="474"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">case</highlight><highlight class="normal"><sp/>3:</highlight></codeline>
<codeline lineno="475"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>{</highlight></codeline>
<codeline lineno="476"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>kAreaName<sp/>=<sp/></highlight><highlight class="stringliteral">&quot;&quot;</highlight><highlight class="normal">;</highlight></codeline>
<codeline lineno="477"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">break</highlight><highlight class="normal">;</highlight></codeline>
<codeline lineno="478"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="479"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">case</highlight><highlight class="normal"><sp/>4:</highlight></codeline>
<codeline lineno="480"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>{</highlight></codeline>
<codeline lineno="481"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>kAreaName<sp/>=<sp/></highlight><highlight class="stringliteral">&quot;&quot;</highlight><highlight class="normal">;</highlight></codeline>
<codeline lineno="482"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">break</highlight><highlight class="normal">;</highlight></codeline>
<codeline lineno="483"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="484"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">case</highlight><highlight class="normal"><sp/>5:</highlight></codeline>
<codeline lineno="485"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>{</highlight></codeline>
<codeline lineno="486"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>kAreaName<sp/>=<sp/></highlight><highlight class="stringliteral">&quot;&quot;</highlight><highlight class="normal">;</highlight></codeline>
<codeline lineno="487"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">break</highlight><highlight class="normal">;</highlight></codeline>
<codeline lineno="488"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="489"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">case</highlight><highlight class="normal"><sp/>6:</highlight></codeline>
<codeline lineno="490"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>{</highlight></codeline>
<codeline lineno="491"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>kAreaName<sp/>=<sp/></highlight><highlight class="stringliteral">&quot;&quot;</highlight><highlight class="normal">;</highlight></codeline>
<codeline lineno="492"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">break</highlight><highlight class="normal">;</highlight></codeline>
<codeline lineno="493"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="494"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">case</highlight><highlight class="normal"><sp/>7:</highlight></codeline>
<codeline lineno="495"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>{</highlight></codeline>
<codeline lineno="496"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>kAreaName<sp/>=<sp/></highlight><highlight class="stringliteral">&quot;&quot;</highlight><highlight class="normal">;</highlight></codeline>
<codeline lineno="497"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">break</highlight><highlight class="normal">;</highlight></codeline>
<codeline lineno="498"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="499"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">case</highlight><highlight class="normal"><sp/>8:</highlight></codeline>
<codeline lineno="500"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>{</highlight></codeline>
<codeline lineno="501"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>kAreaName<sp/>=<sp/></highlight><highlight class="stringliteral">&quot;&quot;</highlight><highlight class="normal">;</highlight></codeline>
<codeline lineno="502"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">break</highlight><highlight class="normal">;</highlight></codeline>
<codeline lineno="503"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="504"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">case</highlight><highlight class="normal"><sp/>9:</highlight></codeline>
<codeline lineno="505"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>{</highlight></codeline>
<codeline lineno="506"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>kAreaName<sp/>=<sp/></highlight><highlight class="stringliteral">&quot;&quot;</highlight><highlight class="normal">;</highlight></codeline>
<codeline lineno="507"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">break</highlight><highlight class="normal">;</highlight></codeline>
<codeline lineno="508"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="509"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">case</highlight><highlight class="normal"><sp/>10:</highlight></codeline>
<codeline lineno="510"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>{</highlight></codeline>
<codeline lineno="511"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>kAreaName<sp/>=<sp/></highlight><highlight class="stringliteral">&quot;&quot;</highlight><highlight class="normal">;</highlight></codeline>
<codeline lineno="512"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">break</highlight><highlight class="normal">;</highlight></codeline>
<codeline lineno="513"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="514"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">case</highlight><highlight class="normal"><sp/>11:</highlight></codeline>
<codeline lineno="515"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>{</highlight></codeline>
<codeline lineno="516"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>kAreaName<sp/>=<sp/></highlight><highlight class="stringliteral">&quot;&quot;</highlight><highlight class="normal">;</highlight></codeline>
<codeline lineno="517"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">break</highlight><highlight class="normal">;</highlight></codeline>
<codeline lineno="518"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="519"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">case</highlight><highlight class="normal"><sp/>100:</highlight></codeline>
<codeline lineno="520"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>{</highlight></codeline>
<codeline lineno="521"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>kAreaName<sp/>=<sp/></highlight><highlight class="stringliteral">&quot;&quot;</highlight><highlight class="normal">;</highlight></codeline>
<codeline lineno="522"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">break</highlight><highlight class="normal">;</highlight></codeline>
<codeline lineno="523"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="524"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">default</highlight><highlight class="normal">:</highlight></codeline>
<codeline lineno="525"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>{</highlight></codeline>
<codeline lineno="526"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>kAreaName<sp/>=<sp/></highlight><highlight class="stringliteral">&quot;&quot;</highlight><highlight class="normal">;</highlight></codeline>
<codeline lineno="527"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">break</highlight><highlight class="normal">;</highlight></codeline>
<codeline lineno="528"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="529"><highlight class="normal"><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="530"><highlight class="normal"></highlight></codeline>
<codeline lineno="531"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/>kAreaName;</highlight></codeline>
<codeline lineno="532"><highlight class="normal">}</highlight></codeline>
<codeline lineno="533"><highlight class="normal"></highlight></codeline>
<codeline lineno="534"><highlight class="normal"></highlight><highlight class="keywordtype">void</highlight><highlight class="normal"><sp/><ref refid="class_global_server_1a4e63d86cca14c7b61b1b3e722062ff33" kindref="member">GlobalServer::SetLoginLogInfo</ref>(DWord<sp/>dwCount,DWord<sp/>dwCousumeTime)</highlight></codeline>
<codeline lineno="535"><highlight class="normal">{</highlight></codeline>
<codeline lineno="536"><highlight class="normal"><sp/><sp/><sp/><sp/><ref refid="class_global_server_1aaad1ac26a0d93306cdb73879d1617edb" kindref="member">m_dwLoadCount</ref><sp/>+=<sp/>dwCount;</highlight></codeline>
<codeline lineno="537"><highlight class="normal"><sp/><sp/><sp/><sp/><ref refid="class_global_server_1a0a4879864d5a5cc5964713eb03d1979d" kindref="member">m_dwLoadSumTime</ref><sp/>+=<sp/>dwCousumeTime;</highlight></codeline>
<codeline lineno="538"><highlight class="normal">}</highlight></codeline>
<codeline lineno="539"><highlight class="normal"></highlight></codeline>
<codeline lineno="540"><highlight class="normal"></highlight><highlight class="keywordtype">void</highlight><highlight class="normal"><sp/><ref refid="class_global_server_1aec57364bffa3037dc2ee400384568b81" kindref="member">GlobalServer::OnLoginQueryRet</ref>(<ref refid="struct_se_wait_login_account" kindref="compound">SeWaitLoginAccount</ref>*<sp/>pkWaitAccount,<sp/><ref refid="struct_se_account" kindref="compound">SeAccount</ref>*<sp/>pkAccount)</highlight></codeline>
<codeline lineno="541"><highlight class="normal">{</highlight></codeline>
<codeline lineno="542"><highlight class="normal"><sp/><sp/><sp/><sp/><ref refid="struct_se_virt_conn" kindref="compound">SeVirtConn</ref>*<sp/>pkLS<sp/>=<sp/><ref refid="_se_virt_conn_mgr_8cpp_1aa8e9d5beed961f4e26b9cadd49603980" kindref="member">g_kVirtConnMgr</ref>.<ref refid="class_se_virt_conn_mgr_1a51ee10bf4c869460a221b78e3d9296d7" kindref="member">GetClientConnBySock</ref>(pkWaitAccount-&gt;<ref refid="struct_se_wait_login_account_1ab8c6328721e99dd953f9027026fc4d88" kindref="member">kLSSock</ref>);</highlight></codeline>
<codeline lineno="543"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(!pkLS)</highlight></codeline>
<codeline lineno="544"><highlight class="normal"><sp/><sp/><sp/><sp/>{</highlight></codeline>
<codeline lineno="545"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal">;</highlight></codeline>
<codeline lineno="546"><highlight class="normal"><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="547"><highlight class="normal"></highlight></codeline>
<codeline lineno="548"><highlight class="normal"><sp/><sp/><sp/><sp/><ref refid="_se_file_log_8h_1a83f3fe470b91cb8eed8762cc8e5e26c3" kindref="member">SeLogInfo</ref>(</highlight><highlight class="stringliteral">&quot;OnLoginQueryRet<sp/>:<sp/>PlayerID[%u],<sp/>Account(pkAccount)[%s].<sp/>WaitAccount[%s]&quot;</highlight><highlight class="normal">,<sp/>pkAccount-&gt;<ref refid="struct_se_account_1a8dc70048ca61ae341e9260a6ecd190ca" kindref="member">dwPlayerID</ref>,<sp/>pkAccount-&gt;<ref refid="struct_se_account_1aad27000c60dde60de8616c207645dfa1" kindref="member">acAccount</ref>,<sp/>pkWaitAccount-&gt;<ref refid="struct_se_wait_login_account_1aa1d2fcececbe8af0f52d65274d07a00f" kindref="member">acGameAccount</ref>);</highlight></codeline>
<codeline lineno="549"><highlight class="normal"></highlight></codeline>
<codeline lineno="550"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(pkAccount-&gt;<ref refid="struct_se_flag_base_1acf91f4bfc15d101c5c2c51e0d6fe7ec7" kindref="member">HasFlag</ref>(<ref refid="src_2_se_cache_mgr_def_8h_1ac50d1f4ffe247d9aa194f67eee5e19bda71820933947c6b665cf4b4d232ac1ac0" kindref="member">SAF_LOGINED</ref>))</highlight></codeline>
<codeline lineno="551"><highlight class="normal"><sp/><sp/><sp/><sp/>{</highlight></codeline>
<codeline lineno="552"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="struct_se_virt_conn" kindref="compound">SeVirtConn</ref>*<sp/>pkFindLS<sp/>=<sp/>NULL;</highlight></codeline>
<codeline lineno="553"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(pkAccount-&gt;<ref refid="struct_se_account_1ad96afc7c94c58fcbc38fdf8f7916198d" kindref="member">dwLastLoginAreaID</ref><sp/>==<sp/>pkLS-&gt;<ref refid="struct_se_virt_conn_1accce5905eca3877d6286e3ad10d87b95" kindref="member">dwAreaID</ref>)</highlight></codeline>
<codeline lineno="554"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>{</highlight></codeline>
<codeline lineno="555"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>pkFindLS<sp/>=<sp/>pkLS;</highlight></codeline>
<codeline lineno="556"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="557"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">else</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="558"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>{</highlight></codeline>
<codeline lineno="559"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>pkFindLS<sp/>=<sp/><ref refid="_se_virt_conn_mgr_8cpp_1aa8e9d5beed961f4e26b9cadd49603980" kindref="member">g_kVirtConnMgr</ref>.<ref refid="class_se_virt_conn_mgr_1acdf19894323074172e21b03c1660238b" kindref="member">GetClientConnByAreaID</ref>(<ref refid="_se_ptl_define_8h_1aefb47f3959b8be9e164448819e4bb7f9a5d0e2f397aac5a9e03ae4098d230f655" kindref="member">SSI_LS</ref>,<sp/>pkAccount-&gt;<ref refid="struct_se_account_1ad96afc7c94c58fcbc38fdf8f7916198d" kindref="member">dwLastLoginAreaID</ref>);</highlight></codeline>
<codeline lineno="560"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="561"><highlight class="normal"></highlight></codeline>
<codeline lineno="562"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(pkFindLS)</highlight></codeline>
<codeline lineno="563"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>{</highlight></codeline>
<codeline lineno="564"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(pkWaitAccount-&gt;<ref refid="struct_se_wait_login_account_1aebc5fdae2bbabf8a1669a07417cd1173" kindref="member">bForceKick</ref><sp/>||<sp/>pkAccount-&gt;<ref refid="struct_se_account_1a576679d28726ab18497999cb448a2801" kindref="member">iTownIndex</ref><sp/>&lt;<sp/>0)</highlight></codeline>
<codeline lineno="565"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>{</highlight></codeline>
<codeline lineno="566"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="_se_file_log_8h_1a83f3fe470b91cb8eed8762cc8e5e26c3" kindref="member">SeLogInfo</ref>(</highlight><highlight class="stringliteral">&quot;OnLoginQueryRet<sp/>:<sp/>SendGL_KickAccount<sp/>playerID[%d],player[%s]&quot;</highlight><highlight class="normal">,pkAccount-&gt;<ref refid="struct_se_account_1a8dc70048ca61ae341e9260a6ecd190ca" kindref="member">dwPlayerID</ref>,pkAccount-&gt;<ref refid="struct_se_account_1aad27000c60dde60de8616c207645dfa1" kindref="member">acAccount</ref>);</highlight></codeline>
<codeline lineno="567"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="class_global_server_1aeed88340e8b711a24f418544202d6aa5" kindref="member">SendGL_KickAccount</ref>(pkAccount-&gt;<ref refid="struct_se_account_1a8dc70048ca61ae341e9260a6ecd190ca" kindref="member">dwPlayerID</ref>,<sp/>&amp;pkFindLS-&gt;<ref refid="struct_se_virt_conn_1a2ed0654cfe8f298d1dc8fbe76a310df0" kindref="member">kSock</ref>);</highlight></codeline>
<codeline lineno="568"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="569"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">else</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="570"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>{</highlight></codeline>
<codeline lineno="571"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="_se_file_log_8h_1a83f3fe470b91cb8eed8762cc8e5e26c3" kindref="member">SeLogInfo</ref>(</highlight><highlight class="stringliteral">&quot;OnLoginQueryRet<sp/>:<sp/>SendGL_AccountWillLogin<sp/>playerID[%d],player[%s]&quot;</highlight><highlight class="normal">,<sp/>pkAccount-&gt;<ref refid="struct_se_account_1a8dc70048ca61ae341e9260a6ecd190ca" kindref="member">dwPlayerID</ref>,<sp/>pkAccount-&gt;<ref refid="struct_se_account_1aad27000c60dde60de8616c207645dfa1" kindref="member">acAccount</ref>);</highlight></codeline>
<codeline lineno="572"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="class_global_server_1a214468c090b0fa29b5a9842580b57d8c" kindref="member">SendGL_AccountWillLogin</ref>(pkAccount-&gt;<ref refid="struct_se_account_1a8dc70048ca61ae341e9260a6ecd190ca" kindref="member">dwPlayerID</ref>,<sp/>pkAccount-&gt;<ref refid="struct_se_account_1ad96afc7c94c58fcbc38fdf8f7916198d" kindref="member">dwLastLoginAreaID</ref>,<sp/>&amp;pkFindLS-&gt;<ref refid="struct_se_virt_conn_1a2ed0654cfe8f298d1dc8fbe76a310df0" kindref="member">kSock</ref>);</highlight></codeline>
<codeline lineno="573"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="class_global_server_1a969ba44a6b49ab513446006edc11bb28" kindref="member">SendGL_AccountLoginFailed</ref>(pkWaitAccount-&gt;<ref refid="struct_se_wait_login_account_1a091164d42696ae79365a299d0d948da0" kindref="member">dwPackKey</ref>,<sp/><ref refid="_se_ptl_comm_define_8h_1afcf506db0541bc2b07b7c9aa18f131f2a0f2355b7ec5b2eda997f8380a69520fe" kindref="member">LFR_OTHER_LOGGED</ref>,<sp/>0,<sp/>0,<sp/>&amp;pkLS-&gt;<ref refid="struct_se_virt_conn_1a2ed0654cfe8f298d1dc8fbe76a310df0" kindref="member">kSock</ref>);</highlight></codeline>
<codeline lineno="574"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal">;</highlight></codeline>
<codeline lineno="575"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="576"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="577"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">else</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="578"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>{</highlight></codeline>
<codeline lineno="579"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="_se_file_log_8h_1a83f3fe470b91cb8eed8762cc8e5e26c3" kindref="member">SeLogInfo</ref>(</highlight><highlight class="stringliteral">&quot;Could&apos;t<sp/>find<sp/>lastloginarea:<sp/>account[%u]<sp/>last[%u],<sp/>now[%u]&quot;</highlight><highlight class="normal">,<sp/>pkAccount-&gt;<ref refid="struct_se_account_1a8dc70048ca61ae341e9260a6ecd190ca" kindref="member">dwPlayerID</ref>,<sp/>pkAccount-&gt;<ref refid="struct_se_account_1ad96afc7c94c58fcbc38fdf8f7916198d" kindref="member">dwLastLoginAreaID</ref>,<sp/>pkLS-&gt;<ref refid="struct_se_virt_conn_1accce5905eca3877d6286e3ad10d87b95" kindref="member">dwAreaID</ref>);</highlight></codeline>
<codeline lineno="580"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="581"><highlight class="normal"></highlight></codeline>
<codeline lineno="582"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="_se_file_log_8h_1a83f3fe470b91cb8eed8762cc8e5e26c3" kindref="member">SeLogInfo</ref>(</highlight><highlight class="stringliteral">&quot;Account[%u]<sp/>already<sp/>login<sp/>area[%u]&quot;</highlight><highlight class="normal">,<sp/>pkAccount-&gt;<ref refid="struct_se_account_1a8dc70048ca61ae341e9260a6ecd190ca" kindref="member">dwPlayerID</ref>,<sp/>pkAccount-&gt;<ref refid="struct_se_account_1ad96afc7c94c58fcbc38fdf8f7916198d" kindref="member">dwLastLoginAreaID</ref>);</highlight></codeline>
<codeline lineno="583"><highlight class="normal"><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="584"><highlight class="normal"></highlight></codeline>
<codeline lineno="585"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="comment">//<sp/></highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="586"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordtype">char</highlight><highlight class="normal"><sp/>acLoginIP[20]<sp/>=<sp/>{<sp/>0<sp/>};</highlight></codeline>
<codeline lineno="587"><highlight class="normal"><sp/><sp/><sp/><sp/><ref refid="_se_server_tool_8cpp_1ad2735ec90511f0d6ec1535cf448709b8" kindref="member">SPrintf</ref>(acLoginIP,<sp/></highlight><highlight class="keyword">sizeof</highlight><highlight class="normal">(acLoginIP),<sp/><ref refid="_se_tool_8h_1a2c55f61adbd2f00984214b01f3f335fe" kindref="member">GetDWord2IPString</ref>(pkWaitAccount-&gt;<ref refid="struct_se_wait_login_account_1a68569deca8a2a5b431caef34eb3fe661" kindref="member">dwIP</ref>));</highlight></codeline>
<codeline lineno="588"><highlight class="normal"><sp/><sp/><sp/><sp/><ref refid="src_2_se_cache_mgr_8cpp_1ab94106ad98afc36210e2252c4ed5cf77" kindref="member">g_kCacheMgr</ref>.<ref refid="class_se_cache_mgr_1a4aa516af0d7671d11ff5cc5c158555f4" kindref="member">OnUpdateAccountDynamic</ref>(pkAccount,<sp/>acLoginIP,<sp/>pkLS-&gt;<ref refid="struct_se_virt_conn_1accce5905eca3877d6286e3ad10d87b95" kindref="member">dwAreaID</ref>);</highlight></codeline>
<codeline lineno="589"><highlight class="normal"></highlight></codeline>
<codeline lineno="590"><highlight class="normal"><sp/><sp/><sp/><sp/>DWord<sp/>dwConsumeTime<sp/>=<sp/><ref refid="class_global_server_1a0f7391b92b1ebf68ab0201806771afec" kindref="member">GetServerTime</ref>()<sp/>-<sp/>pkWaitAccount-&gt;<ref refid="struct_se_wait_login_account_1ac0f232216e852a1a5d918536b99ee979" kindref="member">dwBeginTime</ref>;</highlight></codeline>
<codeline lineno="591"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(<ref refid="class_global_server_1a5c5b73f8fcd4a44b79d2f7b1429fd2d0" kindref="member">m_kConfig</ref>.<ref refid="struct_se_global_config_1adf203dc3c86f3a5cdad439ba199b0e86" kindref="member">iLogShowType</ref><sp/>==<sp/>0)</highlight></codeline>
<codeline lineno="592"><highlight class="normal"><sp/><sp/><sp/><sp/>{</highlight></codeline>
<codeline lineno="593"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="_se_file_log_8h_1a83f3fe470b91cb8eed8762cc8e5e26c3" kindref="member">SeLogInfo</ref>(</highlight><highlight class="stringliteral">&quot;Account[%d]<sp/>Login<sp/>Successfully<sp/>time:consume[%u]&quot;</highlight><highlight class="normal">,<sp/>pkAccount-&gt;<ref refid="struct_se_account_1a8dc70048ca61ae341e9260a6ecd190ca" kindref="member">dwPlayerID</ref>,<sp/>dwConsumeTime);</highlight></codeline>
<codeline lineno="594"><highlight class="normal"><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="595"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">else</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="596"><highlight class="normal"><sp/><sp/><sp/><sp/>{</highlight></codeline>
<codeline lineno="597"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="class_global_server_1a4e63d86cca14c7b61b1b3e722062ff33" kindref="member">SetLoginLogInfo</ref>(1,<sp/>dwConsumeTime);</highlight></codeline>
<codeline lineno="598"><highlight class="normal"><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="599"><highlight class="normal"></highlight></codeline>
<codeline lineno="600"><highlight class="normal"><sp/><sp/><sp/><sp/><ref refid="src_2_se_cache_mgr_8cpp_1ab94106ad98afc36210e2252c4ed5cf77" kindref="member">g_kCacheMgr</ref>.<ref refid="class_se_cache_mgr_1a842a6ed6d65972b3c30ddb8eb0ee1f0f" kindref="member">OnAccountLogin</ref>(pkAccount);</highlight></codeline>
<codeline lineno="601"><highlight class="normal"></highlight></codeline>
<codeline lineno="602"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="comment">//<sp/></highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="603"><highlight class="normal"><sp/><sp/><sp/><sp/><ref refid="struct_se_ptl_account_info" kindref="compound">SePtlAccountInfo</ref><sp/>kAccountInfo;</highlight></codeline>
<codeline lineno="604"><highlight class="normal"><sp/><sp/><sp/><sp/>kAccountInfo.<ref refid="struct_se_ptl_account_info_1a3e4e53e3d4f51a328fcbbab2aa346574" kindref="member">dwRegVersion</ref><sp/>=<sp/>pkAccount-&gt;<ref refid="struct_se_account_1a8fdf2441cfc83390f9ac738dda1b07cd" kindref="member">dwRegVersion</ref>;</highlight></codeline>
<codeline lineno="605"><highlight class="normal"><sp/><sp/><sp/><sp/><ref refid="_se_tool_8cpp_1a4d30fbe56257fc998ebc1346e53be0d8" kindref="member">StrCpy</ref>(kAccountInfo.<ref refid="struct_se_ptl_account_info_1a918ee1d161df6298dfa543bf4dddae0d" kindref="member">acRegIP</ref>,<sp/></highlight><highlight class="keyword">sizeof</highlight><highlight class="normal">(kAccountInfo.<ref refid="struct_se_ptl_account_info_1a918ee1d161df6298dfa543bf4dddae0d" kindref="member">acRegIP</ref>),<sp/>pkAccount-&gt;<ref refid="struct_se_account_1a463c6df60f4f7a4b16ed42a22d531f38" kindref="member">acRegIP</ref>);</highlight></codeline>
<codeline lineno="606"><highlight class="normal"><sp/><sp/><sp/><sp/>kAccountInfo.<ref refid="struct_se_ptl_account_info_1a2c695644fe2efa899cdbf4e06cc3396a" kindref="member">iPlatFlag</ref><sp/>=<sp/>pkAccount-&gt;<ref refid="struct_se_account_1a3e1e04f77306ea3aeba9302e86b6eb03" kindref="member">ePlatFlag</ref>;</highlight></codeline>
<codeline lineno="607"><highlight class="normal"><sp/><sp/><sp/><sp/><ref refid="_se_tool_8cpp_1a4d30fbe56257fc998ebc1346e53be0d8" kindref="member">StrCpy</ref>(kAccountInfo.<ref refid="struct_se_ptl_account_info_1a3e8de5dcb547e8e90a1543166745decf" kindref="member">acAccount</ref>,<sp/></highlight><highlight class="keyword">sizeof</highlight><highlight class="normal">(kAccountInfo.<ref refid="struct_se_ptl_account_info_1a3e8de5dcb547e8e90a1543166745decf" kindref="member">acAccount</ref>),<sp/>pkAccount-&gt;<ref refid="struct_se_account_1aad27000c60dde60de8616c207645dfa1" kindref="member">acAccount</ref>);</highlight></codeline>
<codeline lineno="608"><highlight class="normal"><sp/><sp/><sp/><sp/><ref refid="_se_tool_8cpp_1a4d30fbe56257fc998ebc1346e53be0d8" kindref="member">StrCpy</ref>(kAccountInfo.<ref refid="struct_se_ptl_account_info_1a2c00c03f7a3659bb1fb8ed53876423ef" kindref="member">acNickName</ref>,<sp/></highlight><highlight class="keyword">sizeof</highlight><highlight class="normal">(kAccountInfo.<ref refid="struct_se_ptl_account_info_1a2c00c03f7a3659bb1fb8ed53876423ef" kindref="member">acNickName</ref>),<sp/>pkAccount-&gt;<ref refid="struct_se_account_1ac9bf7b39d6d401affccf186d2d05f2f7" kindref="member">chName</ref>);</highlight></codeline>
<codeline lineno="609"><highlight class="normal"></highlight></codeline>
<codeline lineno="610"><highlight class="normal"><sp/><sp/><sp/><sp/><ref refid="class_global_server_1ac2ecbce87eeb77eb13aa5415e6ce60ae" kindref="member">SendGL_AccountLoginSuccess</ref>(pkWaitAccount-&gt;<ref refid="struct_se_wait_login_account_1a091164d42696ae79365a299d0d948da0" kindref="member">dwPackKey</ref>,<sp/>pkAccount-&gt;<ref refid="struct_se_account_1a8dc70048ca61ae341e9260a6ecd190ca" kindref="member">dwPlayerID</ref>,<sp/>kAccountInfo,<sp/>&amp;pkLS-&gt;<ref refid="struct_se_virt_conn_1a2ed0654cfe8f298d1dc8fbe76a310df0" kindref="member">kSock</ref>);</highlight></codeline>
<codeline lineno="611"><highlight class="normal">}</highlight></codeline>
<codeline lineno="612"><highlight class="normal"></highlight></codeline>
<codeline lineno="613"><highlight class="normal">DWord<sp/><ref refid="class_global_server_1ad7028d472023fe6a3cdc6f44a3a16a6e" kindref="member">GlobalServer::GenPlayerID</ref>(</highlight><highlight class="keywordtype">void</highlight><highlight class="normal">)</highlight></codeline>
<codeline lineno="614"><highlight class="normal">{</highlight></codeline>
<codeline lineno="615"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(<ref refid="class_global_server_1aa8266a68de35c9295ba1b49e3fd2b766" kindref="member">m_dwGenPlayerID</ref><sp/>==<sp/>0)</highlight></codeline>
<codeline lineno="616"><highlight class="normal"><sp/><sp/><sp/><sp/>{</highlight></codeline>
<codeline lineno="617"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="_se_file_log_8h_1a59fe2018c00666084724bec1365b41f5" kindref="member">SeLogError</ref>(<sp/></highlight><highlight class="stringliteral">&quot;[AccountServer]<sp/>Account<sp/>generate<sp/>id<sp/>error!&quot;</highlight><highlight class="normal">,<sp/>1);</highlight></codeline>
<codeline lineno="618"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/>0;</highlight></codeline>
<codeline lineno="619"><highlight class="normal"><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="620"><highlight class="normal"></highlight></codeline>
<codeline lineno="621"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/><ref refid="class_global_server_1aa8266a68de35c9295ba1b49e3fd2b766" kindref="member">m_dwGenPlayerID</ref>++;</highlight></codeline>
<codeline lineno="622"><highlight class="normal">}</highlight></codeline>
<codeline lineno="623"><highlight class="normal"></highlight></codeline>
<codeline lineno="624"><highlight class="normal"></highlight><highlight class="keywordtype">bool</highlight><highlight class="normal"><sp/><ref refid="class_global_server_1a808fa2b9308883886429ac9422783763" kindref="member">GlobalServer::GenGameAccount</ref>(<ref refid="_se_ptl_comm_define_8h_1af7f6cc6b9a8752659fc0e51c18ce75ef" kindref="member">SePlatFlag</ref><sp/>ePlatFlag,<sp/>DWord<sp/>dwPlatAccountID,<sp/></highlight><highlight class="keyword">const</highlight><highlight class="normal"><sp/></highlight><highlight class="keywordtype">char</highlight><highlight class="normal">*<sp/>pcPlatAccount,<sp/></highlight><highlight class="keywordtype">char</highlight><highlight class="normal">*<sp/>pcGameAccount)</highlight></codeline>
<codeline lineno="625"><highlight class="normal">{</highlight></codeline>
<codeline lineno="626"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordtype">bool</highlight><highlight class="normal"><sp/>bDone<sp/>=<sp/></highlight><highlight class="keyword">false</highlight><highlight class="normal">;</highlight></codeline>
<codeline lineno="627"><highlight class="normal"></highlight></codeline>
<codeline lineno="628"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(ePlatFlag<sp/>==<sp/><ref refid="_se_ptl_comm_define_8h_1af7f6cc6b9a8752659fc0e51c18ce75efad1a25517d044bfaa1956c318f88fe5fe" kindref="member">PFG_GUEST</ref>)</highlight></codeline>
<codeline lineno="629"><highlight class="normal"><sp/><sp/><sp/><sp/>{</highlight></codeline>
<codeline lineno="630"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(pcPlatAccount<sp/>&amp;&amp;<sp/>strcmp(pcPlatAccount,<sp/></highlight><highlight class="stringliteral">&quot;&quot;</highlight><highlight class="normal">)<sp/>!=<sp/>0)</highlight></codeline>
<codeline lineno="631"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>{</highlight></codeline>
<codeline lineno="632"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="_se_server_tool_8cpp_1ad2735ec90511f0d6ec1535cf448709b8" kindref="member">SPrintf</ref>(pcGameAccount,<sp/><ref refid="_se_ptl_comm_define_8h_1af62c3a00672953c86a2586d53c60663aa18cafe3efe01affef3c9def797330428" kindref="member">SSD_MAX_ACCOUNT</ref>,<sp/></highlight><highlight class="stringliteral">&quot;%s@dianhun&quot;</highlight><highlight class="normal">,<sp/>pcPlatAccount);</highlight></codeline>
<codeline lineno="633"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>bDone<sp/>=<sp/></highlight><highlight class="keyword">true</highlight><highlight class="normal">;</highlight></codeline>
<codeline lineno="634"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="635"><highlight class="normal"><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="636"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">else</highlight><highlight class="normal"><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(ePlatFlag<sp/>==<sp/><ref refid="_se_ptl_comm_define_8h_1af7f6cc6b9a8752659fc0e51c18ce75efab95015b87be40c46ddaa351bc73f1419" kindref="member">PFG_DIANHUN</ref>)</highlight></codeline>
<codeline lineno="637"><highlight class="normal"><sp/><sp/><sp/><sp/>{</highlight></codeline>
<codeline lineno="638"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(dwPlatAccountID<sp/>&gt;<sp/>0)</highlight></codeline>
<codeline lineno="639"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>{</highlight></codeline>
<codeline lineno="640"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="_se_server_tool_8cpp_1ad2735ec90511f0d6ec1535cf448709b8" kindref="member">SPrintf</ref>(pcGameAccount,<sp/><ref refid="_se_ptl_comm_define_8h_1af62c3a00672953c86a2586d53c60663aa18cafe3efe01affef3c9def797330428" kindref="member">SSD_MAX_ACCOUNT</ref>,<sp/></highlight><highlight class="stringliteral">&quot;%d@dianhun&quot;</highlight><highlight class="normal">,<sp/>dwPlatAccountID);</highlight></codeline>
<codeline lineno="641"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>bDone<sp/>=<sp/></highlight><highlight class="keyword">true</highlight><highlight class="normal">;</highlight></codeline>
<codeline lineno="642"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="643"><highlight class="normal"><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="644"><highlight class="normal"></highlight></codeline>
<codeline lineno="645"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/>bDone;</highlight></codeline>
<codeline lineno="646"><highlight class="normal">}</highlight></codeline>
<codeline lineno="647"><highlight class="normal"></highlight></codeline>
<codeline lineno="648"><highlight class="normal"></highlight><highlight class="keywordtype">int</highlight><highlight class="normal"><sp/><ref refid="class_global_server_1aa4210e9d185bd913143815dd2e55b496" kindref="member">GlobalServer::GetAccountHash</ref>(</highlight><highlight class="keyword">const</highlight><highlight class="normal"><sp/></highlight><highlight class="keywordtype">char</highlight><highlight class="normal">*<sp/>pcAccount,<sp/></highlight><highlight class="keywordtype">int</highlight><highlight class="normal"><sp/>iMaxDB)</highlight></codeline>
<codeline lineno="649"><highlight class="normal">{</highlight></codeline>
<codeline lineno="650"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(0<sp/>==<sp/>iMaxDB)</highlight></codeline>
<codeline lineno="651"><highlight class="normal"><sp/><sp/><sp/><sp/>{</highlight></codeline>
<codeline lineno="652"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/>0;</highlight></codeline>
<codeline lineno="653"><highlight class="normal"><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="654"><highlight class="normal"></highlight></codeline>
<codeline lineno="655"><highlight class="normal"><sp/><sp/><sp/><sp/><ref refid="namespace_json_1a800fb90eb6ee8d5d62b600c06f87f7d4" kindref="member">UInt</ref><sp/><ref refid="src_2_se_race_data_8cpp_1a07d19e1f12dc78752d3f86e32a951b33" kindref="member">uiCount</ref><sp/>=<sp/>0;</highlight></codeline>
<codeline lineno="656"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">while</highlight><highlight class="normal"><sp/>(*pcAccount)</highlight></codeline>
<codeline lineno="657"><highlight class="normal"><sp/><sp/><sp/><sp/>{</highlight></codeline>
<codeline lineno="658"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>uiCount<sp/>+=<sp/>(Byte)*pcAccount;</highlight></codeline>
<codeline lineno="659"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>pcAccount++;</highlight></codeline>
<codeline lineno="660"><highlight class="normal"><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="661"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/>(</highlight><highlight class="keywordtype">int</highlight><highlight class="normal">)(uiCount<sp/>%<sp/>iMaxDB);</highlight></codeline>
<codeline lineno="662"><highlight class="normal">}</highlight></codeline>
    </programlisting>
    <location file="F:/TeamWork/ServerVersion/projects/server/Server/Server/GlobalServer/Src/GlobalServer.cpp"/>
  </compounddef>
</doxygen>
